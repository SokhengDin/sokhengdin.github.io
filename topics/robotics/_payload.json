[{"data":1,"prerenderedAt":12788},["Reactive",2],{"topics/robotics":3},[4,6451,10439,12340,12580],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":9,"description":10,"author":11,"slug":12,"tag":12,"img":13,"body":14,"_type":6446,"_id":6447,"_source":6448,"_file":6449,"_extension":6450},"/topics/robotics/nmpc-cgmres","robotics",false,"","Nonlinear Model Predictive Control with C/GMRES","Optimal Control theory","Din Sokheng","nmpc-cgmres","/topics/robotics/nmpc/nmpc_cgmres.gif",{"type":15,"children":16,"toc":6434},"root",[17,26,32,39,44,50,59,64,70,75,164,180,198,203,212,216,227,233,242,246,250,265,271,276,283,483,494,499,503,507,545,550,554,559,563,567,572,578,586,598,1759,1773,2598,2603,2735,2740,3091,3096,3869,3874,4354,4374,4861,4872,6245,6256,6262,6294,6312,6322,6327,6339,6345,6359,6365,6370,6376,6429],{"type":18,"tag":19,"props":20,"children":22},"element","h2",{"id":21},"the-optimal-control-theory-in-control-system",[23],{"type":24,"value":25},"text","The Optimal Control Theory in Control System",{"type":18,"tag":27,"props":28,"children":29},"p",{},[30],{"type":24,"value":31},"Optimal Control is a branch of control theory in control system, the theory works by solving the optimization problem of the dynamical system in order to find the optimal solution for the system",{"type":18,"tag":33,"props":34,"children":36},"h3",{"id":35},"what-is-model-predictive-control",[37],{"type":24,"value":38},"What is Model Predictive Control ?",{"type":18,"tag":27,"props":40,"children":41},{},[42],{"type":24,"value":43},"Model Predictive Control (MPC) is the optimal control method that use optimization algorithms to solve the cost function the occurs from the desired input and obtain back the optimal input control over the finite and infinite horizons. Recently, MPC is hyping up among the control system researcher, since it is fast, efficiency and robustness for any high complex system.",{"type":18,"tag":33,"props":45,"children":47},{"id":46},"hamilton-jacobian-bellman-equation-hjbe",[48],{"type":24,"value":49},"Hamilton Jacobian Bellman Equation (HJBE)",{"type":18,"tag":27,"props":51,"children":52},{},[53,55],{"type":24,"value":54},"Actually, the HJBE is a nonlinear partial differential equation that it consists necessary conditions for optimality of control by minimizing the loss function of the system. ",{"type":18,"tag":56,"props":57,"children":58},"br",{},[],{"type":18,"tag":27,"props":60,"children":61},{},[62],{"type":24,"value":63},"We have the Hamiltonian Jacobian Bellman Equation",{"type":18,"tag":65,"props":66,"children":69},"math-render-b",{"latex-express":67,"styles":68},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T} Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}","text-center",[],{"type":18,"tag":27,"props":71,"children":72},{},[73],{"type":24,"value":74},"Which",{"type":18,"tag":76,"props":77,"children":78},"ul",{},[79,91,106,119,128,137,146,155],{"type":18,"tag":80,"props":81,"children":82},"li",{},[83,89],{"type":18,"tag":84,"props":85,"children":88},"math-render",{"latex-express":86,"styles":87},"N","inline-flex",[],{"type":24,"value":90}," is the number of prediction future horizons or shooting node.",{"type":18,"tag":80,"props":92,"children":93},{},[94,98,100,104],{"type":18,"tag":84,"props":95,"children":97},{"latex-express":96,"styles":87},"x_{k}",[],{"type":24,"value":99}," is the state of the system at shooting node ",{"type":18,"tag":84,"props":101,"children":103},{"latex-express":102,"styles":87},"k",[],{"type":24,"value":105}," .",{"type":18,"tag":80,"props":107,"children":108},{},[109,113,115,118],{"type":18,"tag":84,"props":110,"children":112},{"latex-express":111,"styles":87},"u_{k}",[],{"type":24,"value":114}," is the input control of the system at shooting node ",{"type":18,"tag":84,"props":116,"children":117},{"latex-express":102,"styles":87},[],{"type":24,"value":105},{"type":18,"tag":80,"props":120,"children":121},{},[122,126],{"type":18,"tag":84,"props":123,"children":125},{"latex-express":124,"styles":87},"Q, R",[],{"type":24,"value":127}," are diagonal matrix which helps the optimization solving the nlp problem.",{"type":18,"tag":80,"props":129,"children":130},{},[131,135],{"type":18,"tag":84,"props":132,"children":134},{"latex-express":133,"styles":87},"f(x,u)",[],{"type":24,"value":136}," is the state representation of the system.",{"type":18,"tag":80,"props":138,"children":139},{},[140,144],{"type":18,"tag":84,"props":141,"children":143},{"latex-express":142,"styles":87},"C(x,u)",[],{"type":24,"value":145},"  is the constraint of the system.",{"type":18,"tag":80,"props":147,"children":148},{},[149,153],{"type":18,"tag":84,"props":150,"children":152},{"latex-express":151,"styles":87},"\\lambda",[],{"type":24,"value":154},"  is the costate vector for state representation.",{"type":18,"tag":80,"props":156,"children":157},{},[158,162],{"type":18,"tag":84,"props":159,"children":161},{"latex-express":160,"styles":87},"\\mu",[],{"type":24,"value":163},"  is the Lagrange multiplier vector for the equality constraint.",{"type":18,"tag":27,"props":165,"children":166},{},[167,169,175,177],{"type":24,"value":168},"Nonlinear Model Predictive Control has multiples solving method, but in this demonstration I will stick with the Continuation/GMRES method proposed by professor ",{"type":18,"tag":170,"props":171,"children":172},"strong",{},[173],{"type":24,"value":174}," Toshiyuki Ohtsuka ",{"type":24,"value":176},". ",{"type":18,"tag":56,"props":178,"children":179},{},[],{"type":18,"tag":27,"props":181,"children":182},{},[183,185,189,191,196],{"type":24,"value":184},"Supposed we want to obtain solution vector ",{"type":18,"tag":84,"props":186,"children":188},{"latex-express":187,"styles":87},"U(t) = [ u_{0}^{*}, \\mu_{0}^{*}, \\cdots, u_{N-1}^{*}, \\mu_{N-1}^{*} ]",[],{"type":24,"value":190},"   at sampling time $t$, we then define the discretization of ",{"type":18,"tag":170,"props":192,"children":193},{},[194],{"type":24,"value":195}," Euler Lagrangian Equation (ELE) ",{"type":24,"value":197},".",{"type":18,"tag":65,"props":199,"children":202},{"latex-express":200,"style":201},"\n\\begin{align}\n    x_{i+1}^{*}(t) &= x_{i}^{*}(t) + f(x_{i}^{*}(t), u_{i}^{*}(t))  \\\\\n    \\lambda_{i}^{*}(t) &= \\lambda_{i+1}^{*}(t) + \\frac{\\partial H}{\\partial x}\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) \\\\\n    \\lambda_{N}^{*}(t) &= \\frac{\\partial \\phi(x)}{\\partial x} \\\\\n    \\frac{\\partial H}{\\partial u} &\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) = 0 \\\\\n    C&(x_{i}^{*}(t),u_{i}^{*}(t)) = 0\n\\end{align}\n","text-ceneter",[],{"type":18,"tag":27,"props":204,"children":205},{},[206,208],{"type":24,"value":207},"To solve this nonlinear problem iteratively, we use Newton's method ",{"type":18,"tag":84,"props":209,"children":211},{"latex-express":210,"styles":87},"F(x,u)=0",[],{"type":18,"tag":65,"props":213,"children":215},{"latex-express":214,"styles":68},"\n\\begin{equation*}\n    F(x,u) = \\begin{bmatrix}\n        \\frac{\\partial H}{\\partial u} \\left( x_{0}^{*}, u_{0}^{*}(t), \\lambda_{1}^{*}(t), \\mu_{0}^{*}(t) \\right) \\\\\n        C(x_{0}^{*}(t),u_{0}^{*}(t))  \\\\\n        \\vdots \\\\\n        \\frac{\\partial H}{\\partial u} \\left( x_{N-1}^{*}, u_{N-1}^{*}(t), \\lambda_{N}^{*}(t), \\mu_{N-1}^{*}(t) \\right) \\\\\n        C(x_{N-1}^{*}(t),u_{N-1}^{*}(t)) \\\\\n    \\end{bmatrix} = 0\n\\end{equation*}",[],{"type":18,"tag":27,"props":217,"children":218},{},[219,221,225],{"type":24,"value":220},"Solving this problem directly will caused big computational complexity, hence we use Continuation to reduce the complexity of the ",{"type":18,"tag":84,"props":222,"children":224},{"latex-express":223,"styles":87},"F(x,u)",[],{"type":24,"value":226}," function and then solve it by using GMRES method.",{"type":18,"tag":33,"props":228,"children":230},{"id":229},"continuation",[231],{"type":24,"value":232},"Continuation",{"type":18,"tag":27,"props":234,"children":235},{},[236,238],{"type":24,"value":237},"Denote  ",{"type":18,"tag":84,"props":239,"children":241},{"latex-express":240,"styles":87},"\\zeta, \\alpha, h \\in{\\mathbb{R} }",[],{"type":18,"tag":65,"props":243,"children":245},{"latex-express":244,"styles":68},"\n\\begin{equation}\n    \\frac{\\partial F}{\\partial u}(x,u) \\dot{u}(t) = -\\zeta F(x,u)(t)-\\frac{\\partial F}{\\partial x}(x,u)(t)\\dot{x}-\\frac{\\partial F}{\\partial t}(x,u)(t) \n\\end{equation}",[],{"type":18,"tag":65,"props":247,"children":249},{"latex-express":248,"styles":68},"\n\\begin{equation}\n    \\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h} = -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}\n\\end{equation}",[],{"type":18,"tag":27,"props":251,"children":252},{},[253,255,259,261],{"type":24,"value":254},"Let ",{"type":18,"tag":65,"props":256,"children":258},{"latex-express":257,"styles":68},"right=\\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h}",[],{"type":24,"value":260}," and ",{"type":18,"tag":65,"props":262,"children":264},{"latex-express":263,"styles":68},"left =  -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}",[],{"type":18,"tag":33,"props":266,"children":268},{"id":267},"generalized-minimal-residue-method-gmres",[269],{"type":24,"value":270},"Generalized Minimal Residue Method (GMRES)",{"type":18,"tag":27,"props":272,"children":273},{},[274],{"type":24,"value":275},"The Generalized Minimal Residual (GMRES) algorithm is an iterative method for solving linear systems of equations. It is often used for large sparse linear systems.",{"type":18,"tag":277,"props":278,"children":280},"h4",{"id":279},"algorithm-description",[281],{"type":24,"value":282},"Algorithm Description",{"type":18,"tag":284,"props":285,"children":286},"ol",{},[287,342,449,468],{"type":18,"tag":80,"props":288,"children":289},{},[290,295,297],{"type":18,"tag":170,"props":291,"children":292},{},[293],{"type":24,"value":294},"Initialize",{"type":24,"value":296},":",{"type":18,"tag":76,"props":298,"children":299},{},[300,310,320],{"type":18,"tag":80,"props":301,"children":302},{},[303,305,309],{"type":24,"value":304},"Choose an initial guess for the solution, denoted as ",{"type":18,"tag":84,"props":306,"children":308},{"latex-express":307,"styles":87},"x_{0}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":311,"children":312},{},[313,315,319],{"type":24,"value":314},"Set the residual vector ",{"type":18,"tag":84,"props":316,"children":318},{"latex-express":317,"styles":87},"r_{0}=\\left\\| Ax_{0}-b \\right\\|",[],{"type":24,"value":197},{"type":18,"tag":80,"props":321,"children":322},{},[323,325,329,331,335,337,341],{"type":24,"value":324},"Set ",{"type":18,"tag":84,"props":326,"children":328},{"latex-express":327,"styles":87},"v_{1}=\\frac{r_{0} }{\\left\\| r_{0} \\right\\|}",[],{"type":24,"value":330},", where ",{"type":18,"tag":84,"props":332,"children":334},{"latex-express":333,"styles":87},"\\left\\| r_{0} \\right\\|",[],{"type":24,"value":336},"  is the norm of ",{"type":18,"tag":84,"props":338,"children":340},{"latex-express":339,"styles":87},"r_{0}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":343,"children":344},{},[345,350,351],{"type":18,"tag":170,"props":346,"children":347},{},[348],{"type":24,"value":349},"Iterative Process",{"type":24,"value":296},{"type":18,"tag":76,"props":352,"children":353},{},[354,364,438],{"type":18,"tag":80,"props":355,"children":356},{},[357,359,363],{"type":24,"value":358},"Choose a vector ",{"type":18,"tag":84,"props":360,"children":362},{"latex-express":361,"styles":87},"v_{1}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":365,"children":366},{},[367,369,373,375,379,380],{"type":24,"value":368},"For ",{"type":18,"tag":84,"props":370,"children":372},{"latex-express":371,"styles":87},"k=0",[],{"type":24,"value":374}," to ",{"type":18,"tag":84,"props":376,"children":378},{"latex-express":377,"styles":87},"maxiteration",[],{"type":24,"value":296},{"type":18,"tag":76,"props":381,"children":382},{},[383,419],{"type":18,"tag":80,"props":384,"children":385},{},[386,388],{"type":24,"value":387},"Arnoldi process:",{"type":18,"tag":76,"props":389,"children":390},{},[391,398,405,412],{"type":18,"tag":80,"props":392,"children":393},{},[394],{"type":18,"tag":84,"props":395,"children":397},{"latex-express":396,"styles":87},"h_{i,j} = \\left(Av_{j}, v_{i} \\right)",[],{"type":18,"tag":80,"props":399,"children":400},{},[401],{"type":18,"tag":84,"props":402,"children":404},{"latex-express":403,"styles":87},"\\hat{v}_{j+1} = Av_{j} - \\sum_{i=1}^{j}h_{i,j}v_{i}",[],{"type":18,"tag":80,"props":406,"children":407},{},[408],{"type":18,"tag":84,"props":409,"children":411},{"latex-express":410,"styles":87},"h_{j+1,j} = \\left \\| \\hat{v}_{j+1}  \\right\\|_{2}",[],{"type":18,"tag":80,"props":413,"children":414},{},[415],{"type":18,"tag":84,"props":416,"children":418},{"latex-express":417,"styles":87},"v_{j+1} = \\frac{\\hat{v}_{j+1} }{h_{j+1,j} }",[],{"type":18,"tag":80,"props":420,"children":421},{},[422,424],{"type":24,"value":423},"Check for convergence:",{"type":18,"tag":76,"props":425,"children":426},{},[427],{"type":18,"tag":80,"props":428,"children":429},{},[430,432,436],{"type":24,"value":431},"If ",{"type":18,"tag":84,"props":433,"children":435},{"latex-express":434,"styles":87},"||r_k|| \u003C tolerance",[],{"type":24,"value":437},", exit the loop.",{"type":18,"tag":80,"props":439,"children":440},{},[441,443,447],{"type":24,"value":442},"If no convergence is achieved after ",{"type":18,"tag":84,"props":444,"children":446},{"latex-express":445,"styles":87},"maxiterations",[],{"type":24,"value":448},", exit with an error message.",{"type":18,"tag":80,"props":450,"children":451},{},[452,461,463,467],{"type":18,"tag":170,"props":453,"children":454},{},[455,457],{"type":24,"value":456},"Find ",{"type":18,"tag":84,"props":458,"children":460},{"latex-express":459,"styles":87},"y",[],{"type":24,"value":462},": which minimize ",{"type":18,"tag":84,"props":464,"children":466},{"latex-express":465,"styles":87},"\\left\\| r_{0}e_{1}-\\hat{H}_{m}y \\right \\|_{2}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":469,"children":470},{},[471,476,478,482],{"type":18,"tag":170,"props":472,"children":473},{},[474],{"type":24,"value":475},"Compute",{"type":24,"value":477},": ",{"type":18,"tag":84,"props":479,"children":481},{"latex-express":480,"styles":87},"x_{m} = x_{0}+V_{m}y_{m}",[],{"type":24,"value":197},{"type":18,"tag":27,"props":484,"children":485},{},[486,488,492],{"type":24,"value":487},"For example differential model, let ",{"type":18,"tag":84,"props":489,"children":491},{"latex-express":490,"styles":87},"x, y, \\phi",[],{"type":24,"value":493}," is the state presentation of the model\n$$ \\dot{x} = f(x,u) $$",{"type":18,"tag":27,"props":495,"children":496},{},[497],{"type":24,"value":498},"Then the HJBE defined as",{"type":18,"tag":65,"props":500,"children":502},{"latex-express":501,"styles":68},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}\n",[],{"type":18,"tag":27,"props":504,"children":505},{},[506],{"type":24,"value":74},{"type":18,"tag":76,"props":508,"children":509},{},[510,517,524,531,538],{"type":18,"tag":80,"props":511,"children":512},{},[513],{"type":18,"tag":84,"props":514,"children":516},{"latex-express":515,"styles":87},"f(x,u) = \\begin{bmatrix} u_{1}*\\cos{(\\phi)} \\\\ u_{1}*\\sin{(\\phi)} \\\\ u_{2} \\end{bmatrix}",[],{"type":18,"tag":80,"props":518,"children":519},{},[520],{"type":18,"tag":84,"props":521,"children":523},{"latex-express":522,"styles":87},"C(x,u) = \\begin{bmatrix} \\left(u_{1}-\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min} }{2})^{2} \\\\\n          \\left(u_{2}-\\frac{u_{2max}+u_{2min}}{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2}\n\\end{bmatrix}",[],{"type":18,"tag":80,"props":525,"children":526},{},[527],{"type":18,"tag":84,"props":528,"children":530},{"latex-express":529,"styles":87},"\\phi(x) = (x_{N}-x_{N,ref})^{T}Q(x_{N}-x_{N,ref})",[],{"type":18,"tag":80,"props":532,"children":533},{},[534],{"type":18,"tag":84,"props":535,"children":537},{"latex-express":536,"styles":87},"\\lambda = \\begin{bmatrix} \\lambda_{1} & \\lambda_{2} & \\lambda_{3} \\end{bmatrix}",[],{"type":18,"tag":80,"props":539,"children":540},{},[541],{"type":18,"tag":84,"props":542,"children":544},{"latex-express":543,"styles":87}," \\mu = \\begin{bmatrix} \\mu_{1} & \\mu_{2} \\end{bmatrix}",[],{"type":18,"tag":27,"props":546,"children":547},{},[548],{"type":24,"value":549},"Subtitute all of these term into HJBE",{"type":18,"tag":65,"props":551,"children":553},{"latex-express":552,"styles":68},"\n\\begin{align*}\nH(x,u,\\lambda,\\mu) &= \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref})\n                     + (x_{N-1}-x_{N-1,ref})^{T}Q(x_{N-1}-x_{N-1,ref}) \\\\ & + \\begin{bmatrix} \\lambda_{1} \\\\ \\lambda_{2} \\\\ \\lambda_{3} \\end{bmatrix}^{T} \\begin{bmatrix} u_{1}*\\cos(\\phi) \\\\ u_{1}*\\sin(\\phi) \\\\ u_{2} \\end{bmatrix}\n                     + \\begin{bmatrix} \\mu_{1} \\\\ \\mu_{2} \\end{bmatrix}^{T} \\begin{bmatrix} \\left(u_{1}+\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min}}{2})^{2} \\\\\n            \\left(u_{2}+\\frac{u_{2max}+u_{2min}}{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2} \n\\end{bmatrix}\n\\end{align*}",[],{"type":18,"tag":27,"props":555,"children":556},{},[557],{"type":24,"value":558},"By doing partial derivative of HJBE, we get",{"type":18,"tag":65,"props":560,"children":562},{"latex-express":561,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial x} = \\begin{bmatrix}\n     (x-x_{ref})q_{1} \\\\\n     (y-y_{ref})q_{2} \\\\ \n     (\\phi-\\phi_{ref})q_{3} - \\lambda_{1}\\sin{(\\phi)}u_{1} + \\lambda_{2}\\cos{(\\phi)}u_{1}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":18,"tag":65,"props":564,"children":566},{"latex-express":565,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial u} = \\begin{bmatrix}\n      (u_{1}-u_{1,ref})r_{1}+\\lambda_{1}\\cos{(\\phi)}+\\lambda_{2}\\sin{(\\phi)} \\\\ \n      (u_{2}-u_{2,ref})r_{2}+\\lambda_{3}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":18,"tag":27,"props":568,"children":569},{},[570],{"type":24,"value":571},"I know this is quite complicated, this is just only input control without constraint and solver with single shooting method.",{"type":18,"tag":19,"props":573,"children":575},{"id":574},"implementing-in-python",[576],{"type":24,"value":577},"Implementing in Python",{"type":18,"tag":27,"props":579,"children":580},{},[581,583],{"type":24,"value":582},"It is safe to say that you will need to start from basic first. Like creating class for model representation, but for now I will just go with CGMRES implementing only, since I have done many demonstration of how to create class for model. ",{"type":18,"tag":56,"props":584,"children":585},{},[],{"type":18,"tag":27,"props":587,"children":588},{},[589,591,596],{"type":24,"value":590},"Let's create class for ",{"type":18,"tag":170,"props":592,"children":593},{},[594],{"type":24,"value":595}," Hamiltion Jacobian Bellman Equation ",{"type":24,"value":597}," which we already derived from above equation.",{"type":18,"tag":599,"props":600,"children":605},"code",{"className":601,"code":603,"language":604,"meta":8},[602],"language-python","class HJBEquation:\n\n    def __init__(self, q1, q2, q3, r1, r2, u_max, u_min):\n\n        self.q1 = q1\n        self.q2 = q2\n        self.q3 = q3\n\n        self.r1 = r1\n        self.r2 = r2\n\n        self.u1_min = u_min[0]\n        self.u2_min = u_min[0]\n\n        self.u1_max = u_max[0]\n        self.u2_max = u_max[1]\n\n    def dhdx(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n\n        dhdx1 = (x-x_r)*self.q1\n        dhdx2 = (y-y_r)*self.q2\n        dhdx3 = (yaw-yaw_r)*self.q3-u1*lam1*np.sin(yaw)+u1*lam2*np.cos(yaw)\n\n        return dhdx1, dhdx2, dhdx3\n\n    def dhdu(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n\n        dhdu1 = self.r1*(u1-u1_r)+lam1*np.cos(yaw)+lam2*np.sin(yaw)+2*mu1*u1*(u1+(self.u1_max+self.u1_min)/2)\n        dhdu2 = self.r2*(u2-u2_r)+lam3+2*mu2*(u2+(self.u2_max+self.u2_min)/2)\n\n        return dhdu1, dhdu2\n\n    def dphidx(self, x, y, yaw, x_r, y_r, yaw_r):\n        dphidx1 = self.q1*(x-x_r)\n        dphidx2 = self.q2*(y-y_r)\n        dphidx3 = self.q3*(yaw-yaw_r)\n\n        return dphidx1, dphidx2, dphidx3\n","python",[606],{"type":18,"tag":607,"props":608,"children":609},"pre",{},[610],{"type":18,"tag":599,"props":611,"children":612},{"__ignoreMap":8},[613,642,651,680,688,717,743,769,777,803,829,837,873,906,914,948,982,990,1016,1024,1066,1106,1200,1208,1226,1234,1260,1268,1424,1544,1552,1569,1577,1603,1647,1691,1734,1742],{"type":18,"tag":614,"props":615,"children":618},"span",{"class":616,"line":617},"line",1,[619,625,631,637],{"type":18,"tag":614,"props":620,"children":622},{"class":621},"ct-857441",[623],{"type":24,"value":624},"class",{"type":18,"tag":614,"props":626,"children":628},{"class":627},"ct-767297",[629],{"type":24,"value":630}," ",{"type":18,"tag":614,"props":632,"children":634},{"class":633},"ct-806137",[635],{"type":24,"value":636},"HJBEquation",{"type":18,"tag":614,"props":638,"children":639},{"class":627},[640],{"type":24,"value":641},":\n",{"type":18,"tag":614,"props":643,"children":645},{"class":616,"line":644},2,[646],{"type":18,"tag":614,"props":647,"children":648},{},[649],{"type":24,"value":650},"\n",{"type":18,"tag":614,"props":652,"children":654},{"class":616,"line":653},3,[655,660,665,669,675],{"type":18,"tag":614,"props":656,"children":657},{"class":627},[658],{"type":24,"value":659},"    ",{"type":18,"tag":614,"props":661,"children":662},{"class":621},[663],{"type":24,"value":664},"def",{"type":18,"tag":614,"props":666,"children":667},{"class":627},[668],{"type":24,"value":630},{"type":18,"tag":614,"props":670,"children":672},{"class":671},"ct-533739",[673],{"type":24,"value":674},"__init__",{"type":18,"tag":614,"props":676,"children":677},{"class":627},[678],{"type":24,"value":679},"(self, q1, q2, q3, r1, r2, u_max, u_min):\n",{"type":18,"tag":614,"props":681,"children":683},{"class":616,"line":682},4,[684],{"type":18,"tag":614,"props":685,"children":686},{},[687],{"type":24,"value":650},{"type":18,"tag":614,"props":689,"children":691},{"class":616,"line":690},5,[692,697,702,707,712],{"type":18,"tag":614,"props":693,"children":694},{"class":627},[695],{"type":24,"value":696},"        ",{"type":18,"tag":614,"props":698,"children":699},{"class":671},[700],{"type":24,"value":701},"self",{"type":18,"tag":614,"props":703,"children":704},{"class":627},[705],{"type":24,"value":706},".q1 ",{"type":18,"tag":614,"props":708,"children":709},{"class":621},[710],{"type":24,"value":711},"=",{"type":18,"tag":614,"props":713,"children":714},{"class":627},[715],{"type":24,"value":716}," q1\n",{"type":18,"tag":614,"props":718,"children":720},{"class":616,"line":719},6,[721,725,729,734,738],{"type":18,"tag":614,"props":722,"children":723},{"class":627},[724],{"type":24,"value":696},{"type":18,"tag":614,"props":726,"children":727},{"class":671},[728],{"type":24,"value":701},{"type":18,"tag":614,"props":730,"children":731},{"class":627},[732],{"type":24,"value":733},".q2 ",{"type":18,"tag":614,"props":735,"children":736},{"class":621},[737],{"type":24,"value":711},{"type":18,"tag":614,"props":739,"children":740},{"class":627},[741],{"type":24,"value":742}," q2\n",{"type":18,"tag":614,"props":744,"children":746},{"class":616,"line":745},7,[747,751,755,760,764],{"type":18,"tag":614,"props":748,"children":749},{"class":627},[750],{"type":24,"value":696},{"type":18,"tag":614,"props":752,"children":753},{"class":671},[754],{"type":24,"value":701},{"type":18,"tag":614,"props":756,"children":757},{"class":627},[758],{"type":24,"value":759},".q3 ",{"type":18,"tag":614,"props":761,"children":762},{"class":621},[763],{"type":24,"value":711},{"type":18,"tag":614,"props":765,"children":766},{"class":627},[767],{"type":24,"value":768}," q3\n",{"type":18,"tag":614,"props":770,"children":772},{"class":616,"line":771},8,[773],{"type":18,"tag":614,"props":774,"children":775},{},[776],{"type":24,"value":650},{"type":18,"tag":614,"props":778,"children":780},{"class":616,"line":779},9,[781,785,789,794,798],{"type":18,"tag":614,"props":782,"children":783},{"class":627},[784],{"type":24,"value":696},{"type":18,"tag":614,"props":786,"children":787},{"class":671},[788],{"type":24,"value":701},{"type":18,"tag":614,"props":790,"children":791},{"class":627},[792],{"type":24,"value":793},".r1 ",{"type":18,"tag":614,"props":795,"children":796},{"class":621},[797],{"type":24,"value":711},{"type":18,"tag":614,"props":799,"children":800},{"class":627},[801],{"type":24,"value":802}," r1\n",{"type":18,"tag":614,"props":804,"children":806},{"class":616,"line":805},10,[807,811,815,820,824],{"type":18,"tag":614,"props":808,"children":809},{"class":627},[810],{"type":24,"value":696},{"type":18,"tag":614,"props":812,"children":813},{"class":671},[814],{"type":24,"value":701},{"type":18,"tag":614,"props":816,"children":817},{"class":627},[818],{"type":24,"value":819},".r2 ",{"type":18,"tag":614,"props":821,"children":822},{"class":621},[823],{"type":24,"value":711},{"type":18,"tag":614,"props":825,"children":826},{"class":627},[827],{"type":24,"value":828}," r2\n",{"type":18,"tag":614,"props":830,"children":832},{"class":616,"line":831},11,[833],{"type":18,"tag":614,"props":834,"children":835},{},[836],{"type":24,"value":650},{"type":18,"tag":614,"props":838,"children":840},{"class":616,"line":839},12,[841,845,849,854,858,863,868],{"type":18,"tag":614,"props":842,"children":843},{"class":627},[844],{"type":24,"value":696},{"type":18,"tag":614,"props":846,"children":847},{"class":671},[848],{"type":24,"value":701},{"type":18,"tag":614,"props":850,"children":851},{"class":627},[852],{"type":24,"value":853},".u1_min ",{"type":18,"tag":614,"props":855,"children":856},{"class":621},[857],{"type":24,"value":711},{"type":18,"tag":614,"props":859,"children":860},{"class":627},[861],{"type":24,"value":862}," u_min[",{"type":18,"tag":614,"props":864,"children":865},{"class":671},[866],{"type":24,"value":867},"0",{"type":18,"tag":614,"props":869,"children":870},{"class":627},[871],{"type":24,"value":872},"]\n",{"type":18,"tag":614,"props":874,"children":876},{"class":616,"line":875},13,[877,881,885,890,894,898,902],{"type":18,"tag":614,"props":878,"children":879},{"class":627},[880],{"type":24,"value":696},{"type":18,"tag":614,"props":882,"children":883},{"class":671},[884],{"type":24,"value":701},{"type":18,"tag":614,"props":886,"children":887},{"class":627},[888],{"type":24,"value":889},".u2_min ",{"type":18,"tag":614,"props":891,"children":892},{"class":621},[893],{"type":24,"value":711},{"type":18,"tag":614,"props":895,"children":896},{"class":627},[897],{"type":24,"value":862},{"type":18,"tag":614,"props":899,"children":900},{"class":671},[901],{"type":24,"value":867},{"type":18,"tag":614,"props":903,"children":904},{"class":627},[905],{"type":24,"value":872},{"type":18,"tag":614,"props":907,"children":909},{"class":616,"line":908},14,[910],{"type":18,"tag":614,"props":911,"children":912},{},[913],{"type":24,"value":650},{"type":18,"tag":614,"props":915,"children":917},{"class":616,"line":916},15,[918,922,926,931,935,940,944],{"type":18,"tag":614,"props":919,"children":920},{"class":627},[921],{"type":24,"value":696},{"type":18,"tag":614,"props":923,"children":924},{"class":671},[925],{"type":24,"value":701},{"type":18,"tag":614,"props":927,"children":928},{"class":627},[929],{"type":24,"value":930},".u1_max ",{"type":18,"tag":614,"props":932,"children":933},{"class":621},[934],{"type":24,"value":711},{"type":18,"tag":614,"props":936,"children":937},{"class":627},[938],{"type":24,"value":939}," u_max[",{"type":18,"tag":614,"props":941,"children":942},{"class":671},[943],{"type":24,"value":867},{"type":18,"tag":614,"props":945,"children":946},{"class":627},[947],{"type":24,"value":872},{"type":18,"tag":614,"props":949,"children":951},{"class":616,"line":950},16,[952,956,960,965,969,973,978],{"type":18,"tag":614,"props":953,"children":954},{"class":627},[955],{"type":24,"value":696},{"type":18,"tag":614,"props":957,"children":958},{"class":671},[959],{"type":24,"value":701},{"type":18,"tag":614,"props":961,"children":962},{"class":627},[963],{"type":24,"value":964},".u2_max ",{"type":18,"tag":614,"props":966,"children":967},{"class":621},[968],{"type":24,"value":711},{"type":18,"tag":614,"props":970,"children":971},{"class":627},[972],{"type":24,"value":939},{"type":18,"tag":614,"props":974,"children":975},{"class":671},[976],{"type":24,"value":977},"1",{"type":18,"tag":614,"props":979,"children":980},{"class":627},[981],{"type":24,"value":872},{"type":18,"tag":614,"props":983,"children":985},{"class":616,"line":984},17,[986],{"type":18,"tag":614,"props":987,"children":988},{},[989],{"type":24,"value":650},{"type":18,"tag":614,"props":991,"children":993},{"class":616,"line":992},18,[994,998,1002,1006,1011],{"type":18,"tag":614,"props":995,"children":996},{"class":627},[997],{"type":24,"value":659},{"type":18,"tag":614,"props":999,"children":1000},{"class":621},[1001],{"type":24,"value":664},{"type":18,"tag":614,"props":1003,"children":1004},{"class":627},[1005],{"type":24,"value":630},{"type":18,"tag":614,"props":1007,"children":1008},{"class":633},[1009],{"type":24,"value":1010},"dhdx",{"type":18,"tag":614,"props":1012,"children":1013},{"class":627},[1014],{"type":24,"value":1015},"(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n",{"type":18,"tag":614,"props":1017,"children":1019},{"class":616,"line":1018},19,[1020],{"type":18,"tag":614,"props":1021,"children":1022},{},[1023],{"type":24,"value":650},{"type":18,"tag":614,"props":1025,"children":1027},{"class":616,"line":1026},20,[1028,1033,1037,1042,1047,1052,1057,1061],{"type":18,"tag":614,"props":1029,"children":1030},{"class":627},[1031],{"type":24,"value":1032},"        dhdx1 ",{"type":18,"tag":614,"props":1034,"children":1035},{"class":621},[1036],{"type":24,"value":711},{"type":18,"tag":614,"props":1038,"children":1039},{"class":627},[1040],{"type":24,"value":1041}," (x",{"type":18,"tag":614,"props":1043,"children":1044},{"class":621},[1045],{"type":24,"value":1046},"-",{"type":18,"tag":614,"props":1048,"children":1049},{"class":627},[1050],{"type":24,"value":1051},"x_r)",{"type":18,"tag":614,"props":1053,"children":1054},{"class":621},[1055],{"type":24,"value":1056},"*",{"type":18,"tag":614,"props":1058,"children":1059},{"class":671},[1060],{"type":24,"value":701},{"type":18,"tag":614,"props":1062,"children":1063},{"class":627},[1064],{"type":24,"value":1065},".q1\n",{"type":18,"tag":614,"props":1067,"children":1069},{"class":616,"line":1068},21,[1070,1075,1079,1084,1088,1093,1097,1101],{"type":18,"tag":614,"props":1071,"children":1072},{"class":627},[1073],{"type":24,"value":1074},"        dhdx2 ",{"type":18,"tag":614,"props":1076,"children":1077},{"class":621},[1078],{"type":24,"value":711},{"type":18,"tag":614,"props":1080,"children":1081},{"class":627},[1082],{"type":24,"value":1083}," (y",{"type":18,"tag":614,"props":1085,"children":1086},{"class":621},[1087],{"type":24,"value":1046},{"type":18,"tag":614,"props":1089,"children":1090},{"class":627},[1091],{"type":24,"value":1092},"y_r)",{"type":18,"tag":614,"props":1094,"children":1095},{"class":621},[1096],{"type":24,"value":1056},{"type":18,"tag":614,"props":1098,"children":1099},{"class":671},[1100],{"type":24,"value":701},{"type":18,"tag":614,"props":1102,"children":1103},{"class":627},[1104],{"type":24,"value":1105},".q2\n",{"type":18,"tag":614,"props":1107,"children":1109},{"class":616,"line":1108},22,[1110,1115,1119,1124,1128,1133,1137,1141,1146,1150,1155,1159,1164,1168,1173,1178,1182,1186,1191,1195],{"type":18,"tag":614,"props":1111,"children":1112},{"class":627},[1113],{"type":24,"value":1114},"        dhdx3 ",{"type":18,"tag":614,"props":1116,"children":1117},{"class":621},[1118],{"type":24,"value":711},{"type":18,"tag":614,"props":1120,"children":1121},{"class":627},[1122],{"type":24,"value":1123}," (yaw",{"type":18,"tag":614,"props":1125,"children":1126},{"class":621},[1127],{"type":24,"value":1046},{"type":18,"tag":614,"props":1129,"children":1130},{"class":627},[1131],{"type":24,"value":1132},"yaw_r)",{"type":18,"tag":614,"props":1134,"children":1135},{"class":621},[1136],{"type":24,"value":1056},{"type":18,"tag":614,"props":1138,"children":1139},{"class":671},[1140],{"type":24,"value":701},{"type":18,"tag":614,"props":1142,"children":1143},{"class":627},[1144],{"type":24,"value":1145},".q3",{"type":18,"tag":614,"props":1147,"children":1148},{"class":621},[1149],{"type":24,"value":1046},{"type":18,"tag":614,"props":1151,"children":1152},{"class":627},[1153],{"type":24,"value":1154},"u1",{"type":18,"tag":614,"props":1156,"children":1157},{"class":621},[1158],{"type":24,"value":1056},{"type":18,"tag":614,"props":1160,"children":1161},{"class":627},[1162],{"type":24,"value":1163},"lam1",{"type":18,"tag":614,"props":1165,"children":1166},{"class":621},[1167],{"type":24,"value":1056},{"type":18,"tag":614,"props":1169,"children":1170},{"class":627},[1171],{"type":24,"value":1172},"np.sin(yaw)",{"type":18,"tag":614,"props":1174,"children":1175},{"class":621},[1176],{"type":24,"value":1177},"+",{"type":18,"tag":614,"props":1179,"children":1180},{"class":627},[1181],{"type":24,"value":1154},{"type":18,"tag":614,"props":1183,"children":1184},{"class":621},[1185],{"type":24,"value":1056},{"type":18,"tag":614,"props":1187,"children":1188},{"class":627},[1189],{"type":24,"value":1190},"lam2",{"type":18,"tag":614,"props":1192,"children":1193},{"class":621},[1194],{"type":24,"value":1056},{"type":18,"tag":614,"props":1196,"children":1197},{"class":627},[1198],{"type":24,"value":1199},"np.cos(yaw)\n",{"type":18,"tag":614,"props":1201,"children":1203},{"class":616,"line":1202},23,[1204],{"type":18,"tag":614,"props":1205,"children":1206},{},[1207],{"type":24,"value":650},{"type":18,"tag":614,"props":1209,"children":1211},{"class":616,"line":1210},24,[1212,1216,1221],{"type":18,"tag":614,"props":1213,"children":1214},{"class":627},[1215],{"type":24,"value":696},{"type":18,"tag":614,"props":1217,"children":1218},{"class":621},[1219],{"type":24,"value":1220},"return",{"type":18,"tag":614,"props":1222,"children":1223},{"class":627},[1224],{"type":24,"value":1225}," dhdx1, dhdx2, dhdx3\n",{"type":18,"tag":614,"props":1227,"children":1229},{"class":616,"line":1228},25,[1230],{"type":18,"tag":614,"props":1231,"children":1232},{},[1233],{"type":24,"value":650},{"type":18,"tag":614,"props":1235,"children":1237},{"class":616,"line":1236},26,[1238,1242,1246,1250,1255],{"type":18,"tag":614,"props":1239,"children":1240},{"class":627},[1241],{"type":24,"value":659},{"type":18,"tag":614,"props":1243,"children":1244},{"class":621},[1245],{"type":24,"value":664},{"type":18,"tag":614,"props":1247,"children":1248},{"class":627},[1249],{"type":24,"value":630},{"type":18,"tag":614,"props":1251,"children":1252},{"class":633},[1253],{"type":24,"value":1254},"dhdu",{"type":18,"tag":614,"props":1256,"children":1257},{"class":627},[1258],{"type":24,"value":1259},"(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n",{"type":18,"tag":614,"props":1261,"children":1263},{"class":616,"line":1262},27,[1264],{"type":18,"tag":614,"props":1265,"children":1266},{},[1267],{"type":24,"value":650},{"type":18,"tag":614,"props":1269,"children":1271},{"class":616,"line":1270},28,[1272,1277,1281,1285,1289,1294,1298,1303,1307,1312,1316,1320,1324,1329,1333,1337,1341,1345,1349,1354,1358,1363,1367,1371,1375,1379,1383,1388,1392,1397,1401,1405,1410,1415,1419],{"type":18,"tag":614,"props":1273,"children":1274},{"class":627},[1275],{"type":24,"value":1276},"        dhdu1 ",{"type":18,"tag":614,"props":1278,"children":1279},{"class":621},[1280],{"type":24,"value":711},{"type":18,"tag":614,"props":1282,"children":1283},{"class":627},[1284],{"type":24,"value":630},{"type":18,"tag":614,"props":1286,"children":1287},{"class":671},[1288],{"type":24,"value":701},{"type":18,"tag":614,"props":1290,"children":1291},{"class":627},[1292],{"type":24,"value":1293},".r1",{"type":18,"tag":614,"props":1295,"children":1296},{"class":621},[1297],{"type":24,"value":1056},{"type":18,"tag":614,"props":1299,"children":1300},{"class":627},[1301],{"type":24,"value":1302},"(u1",{"type":18,"tag":614,"props":1304,"children":1305},{"class":621},[1306],{"type":24,"value":1046},{"type":18,"tag":614,"props":1308,"children":1309},{"class":627},[1310],{"type":24,"value":1311},"u1_r)",{"type":18,"tag":614,"props":1313,"children":1314},{"class":621},[1315],{"type":24,"value":1177},{"type":18,"tag":614,"props":1317,"children":1318},{"class":627},[1319],{"type":24,"value":1163},{"type":18,"tag":614,"props":1321,"children":1322},{"class":621},[1323],{"type":24,"value":1056},{"type":18,"tag":614,"props":1325,"children":1326},{"class":627},[1327],{"type":24,"value":1328},"np.cos(yaw)",{"type":18,"tag":614,"props":1330,"children":1331},{"class":621},[1332],{"type":24,"value":1177},{"type":18,"tag":614,"props":1334,"children":1335},{"class":627},[1336],{"type":24,"value":1190},{"type":18,"tag":614,"props":1338,"children":1339},{"class":621},[1340],{"type":24,"value":1056},{"type":18,"tag":614,"props":1342,"children":1343},{"class":627},[1344],{"type":24,"value":1172},{"type":18,"tag":614,"props":1346,"children":1347},{"class":621},[1348],{"type":24,"value":1177},{"type":18,"tag":614,"props":1350,"children":1351},{"class":671},[1352],{"type":24,"value":1353},"2",{"type":18,"tag":614,"props":1355,"children":1356},{"class":621},[1357],{"type":24,"value":1056},{"type":18,"tag":614,"props":1359,"children":1360},{"class":627},[1361],{"type":24,"value":1362},"mu1",{"type":18,"tag":614,"props":1364,"children":1365},{"class":621},[1366],{"type":24,"value":1056},{"type":18,"tag":614,"props":1368,"children":1369},{"class":627},[1370],{"type":24,"value":1154},{"type":18,"tag":614,"props":1372,"children":1373},{"class":621},[1374],{"type":24,"value":1056},{"type":18,"tag":614,"props":1376,"children":1377},{"class":627},[1378],{"type":24,"value":1302},{"type":18,"tag":614,"props":1380,"children":1381},{"class":621},[1382],{"type":24,"value":1177},{"type":18,"tag":614,"props":1384,"children":1385},{"class":627},[1386],{"type":24,"value":1387},"(",{"type":18,"tag":614,"props":1389,"children":1390},{"class":671},[1391],{"type":24,"value":701},{"type":18,"tag":614,"props":1393,"children":1394},{"class":627},[1395],{"type":24,"value":1396},".u1_max",{"type":18,"tag":614,"props":1398,"children":1399},{"class":621},[1400],{"type":24,"value":1177},{"type":18,"tag":614,"props":1402,"children":1403},{"class":671},[1404],{"type":24,"value":701},{"type":18,"tag":614,"props":1406,"children":1407},{"class":627},[1408],{"type":24,"value":1409},".u1_min)",{"type":18,"tag":614,"props":1411,"children":1412},{"class":621},[1413],{"type":24,"value":1414},"/",{"type":18,"tag":614,"props":1416,"children":1417},{"class":671},[1418],{"type":24,"value":1353},{"type":18,"tag":614,"props":1420,"children":1421},{"class":627},[1422],{"type":24,"value":1423},")\n",{"type":18,"tag":614,"props":1425,"children":1427},{"class":616,"line":1426},29,[1428,1433,1437,1441,1445,1450,1454,1459,1463,1468,1472,1477,1481,1485,1489,1494,1498,1502,1506,1510,1514,1519,1523,1527,1532,1536,1540],{"type":18,"tag":614,"props":1429,"children":1430},{"class":627},[1431],{"type":24,"value":1432},"        dhdu2 ",{"type":18,"tag":614,"props":1434,"children":1435},{"class":621},[1436],{"type":24,"value":711},{"type":18,"tag":614,"props":1438,"children":1439},{"class":627},[1440],{"type":24,"value":630},{"type":18,"tag":614,"props":1442,"children":1443},{"class":671},[1444],{"type":24,"value":701},{"type":18,"tag":614,"props":1446,"children":1447},{"class":627},[1448],{"type":24,"value":1449},".r2",{"type":18,"tag":614,"props":1451,"children":1452},{"class":621},[1453],{"type":24,"value":1056},{"type":18,"tag":614,"props":1455,"children":1456},{"class":627},[1457],{"type":24,"value":1458},"(u2",{"type":18,"tag":614,"props":1460,"children":1461},{"class":621},[1462],{"type":24,"value":1046},{"type":18,"tag":614,"props":1464,"children":1465},{"class":627},[1466],{"type":24,"value":1467},"u2_r)",{"type":18,"tag":614,"props":1469,"children":1470},{"class":621},[1471],{"type":24,"value":1177},{"type":18,"tag":614,"props":1473,"children":1474},{"class":627},[1475],{"type":24,"value":1476},"lam3",{"type":18,"tag":614,"props":1478,"children":1479},{"class":621},[1480],{"type":24,"value":1177},{"type":18,"tag":614,"props":1482,"children":1483},{"class":671},[1484],{"type":24,"value":1353},{"type":18,"tag":614,"props":1486,"children":1487},{"class":621},[1488],{"type":24,"value":1056},{"type":18,"tag":614,"props":1490,"children":1491},{"class":627},[1492],{"type":24,"value":1493},"mu2",{"type":18,"tag":614,"props":1495,"children":1496},{"class":621},[1497],{"type":24,"value":1056},{"type":18,"tag":614,"props":1499,"children":1500},{"class":627},[1501],{"type":24,"value":1458},{"type":18,"tag":614,"props":1503,"children":1504},{"class":621},[1505],{"type":24,"value":1177},{"type":18,"tag":614,"props":1507,"children":1508},{"class":627},[1509],{"type":24,"value":1387},{"type":18,"tag":614,"props":1511,"children":1512},{"class":671},[1513],{"type":24,"value":701},{"type":18,"tag":614,"props":1515,"children":1516},{"class":627},[1517],{"type":24,"value":1518},".u2_max",{"type":18,"tag":614,"props":1520,"children":1521},{"class":621},[1522],{"type":24,"value":1177},{"type":18,"tag":614,"props":1524,"children":1525},{"class":671},[1526],{"type":24,"value":701},{"type":18,"tag":614,"props":1528,"children":1529},{"class":627},[1530],{"type":24,"value":1531},".u2_min)",{"type":18,"tag":614,"props":1533,"children":1534},{"class":621},[1535],{"type":24,"value":1414},{"type":18,"tag":614,"props":1537,"children":1538},{"class":671},[1539],{"type":24,"value":1353},{"type":18,"tag":614,"props":1541,"children":1542},{"class":627},[1543],{"type":24,"value":1423},{"type":18,"tag":614,"props":1545,"children":1547},{"class":616,"line":1546},30,[1548],{"type":18,"tag":614,"props":1549,"children":1550},{},[1551],{"type":24,"value":650},{"type":18,"tag":614,"props":1553,"children":1555},{"class":616,"line":1554},31,[1556,1560,1564],{"type":18,"tag":614,"props":1557,"children":1558},{"class":627},[1559],{"type":24,"value":696},{"type":18,"tag":614,"props":1561,"children":1562},{"class":621},[1563],{"type":24,"value":1220},{"type":18,"tag":614,"props":1565,"children":1566},{"class":627},[1567],{"type":24,"value":1568}," dhdu1, dhdu2\n",{"type":18,"tag":614,"props":1570,"children":1572},{"class":616,"line":1571},32,[1573],{"type":18,"tag":614,"props":1574,"children":1575},{},[1576],{"type":24,"value":650},{"type":18,"tag":614,"props":1578,"children":1580},{"class":616,"line":1579},33,[1581,1585,1589,1593,1598],{"type":18,"tag":614,"props":1582,"children":1583},{"class":627},[1584],{"type":24,"value":659},{"type":18,"tag":614,"props":1586,"children":1587},{"class":621},[1588],{"type":24,"value":664},{"type":18,"tag":614,"props":1590,"children":1591},{"class":627},[1592],{"type":24,"value":630},{"type":18,"tag":614,"props":1594,"children":1595},{"class":633},[1596],{"type":24,"value":1597},"dphidx",{"type":18,"tag":614,"props":1599,"children":1600},{"class":627},[1601],{"type":24,"value":1602},"(self, x, y, yaw, x_r, y_r, yaw_r):\n",{"type":18,"tag":614,"props":1604,"children":1606},{"class":616,"line":1605},34,[1607,1612,1616,1620,1624,1629,1633,1638,1642],{"type":18,"tag":614,"props":1608,"children":1609},{"class":627},[1610],{"type":24,"value":1611},"        dphidx1 ",{"type":18,"tag":614,"props":1613,"children":1614},{"class":621},[1615],{"type":24,"value":711},{"type":18,"tag":614,"props":1617,"children":1618},{"class":627},[1619],{"type":24,"value":630},{"type":18,"tag":614,"props":1621,"children":1622},{"class":671},[1623],{"type":24,"value":701},{"type":18,"tag":614,"props":1625,"children":1626},{"class":627},[1627],{"type":24,"value":1628},".q1",{"type":18,"tag":614,"props":1630,"children":1631},{"class":621},[1632],{"type":24,"value":1056},{"type":18,"tag":614,"props":1634,"children":1635},{"class":627},[1636],{"type":24,"value":1637},"(x",{"type":18,"tag":614,"props":1639,"children":1640},{"class":621},[1641],{"type":24,"value":1046},{"type":18,"tag":614,"props":1643,"children":1644},{"class":627},[1645],{"type":24,"value":1646},"x_r)\n",{"type":18,"tag":614,"props":1648,"children":1650},{"class":616,"line":1649},35,[1651,1656,1660,1664,1668,1673,1677,1682,1686],{"type":18,"tag":614,"props":1652,"children":1653},{"class":627},[1654],{"type":24,"value":1655},"        dphidx2 ",{"type":18,"tag":614,"props":1657,"children":1658},{"class":621},[1659],{"type":24,"value":711},{"type":18,"tag":614,"props":1661,"children":1662},{"class":627},[1663],{"type":24,"value":630},{"type":18,"tag":614,"props":1665,"children":1666},{"class":671},[1667],{"type":24,"value":701},{"type":18,"tag":614,"props":1669,"children":1670},{"class":627},[1671],{"type":24,"value":1672},".q2",{"type":18,"tag":614,"props":1674,"children":1675},{"class":621},[1676],{"type":24,"value":1056},{"type":18,"tag":614,"props":1678,"children":1679},{"class":627},[1680],{"type":24,"value":1681},"(y",{"type":18,"tag":614,"props":1683,"children":1684},{"class":621},[1685],{"type":24,"value":1046},{"type":18,"tag":614,"props":1687,"children":1688},{"class":627},[1689],{"type":24,"value":1690},"y_r)\n",{"type":18,"tag":614,"props":1692,"children":1694},{"class":616,"line":1693},36,[1695,1700,1704,1708,1712,1716,1720,1725,1729],{"type":18,"tag":614,"props":1696,"children":1697},{"class":627},[1698],{"type":24,"value":1699},"        dphidx3 ",{"type":18,"tag":614,"props":1701,"children":1702},{"class":621},[1703],{"type":24,"value":711},{"type":18,"tag":614,"props":1705,"children":1706},{"class":627},[1707],{"type":24,"value":630},{"type":18,"tag":614,"props":1709,"children":1710},{"class":671},[1711],{"type":24,"value":701},{"type":18,"tag":614,"props":1713,"children":1714},{"class":627},[1715],{"type":24,"value":1145},{"type":18,"tag":614,"props":1717,"children":1718},{"class":621},[1719],{"type":24,"value":1056},{"type":18,"tag":614,"props":1721,"children":1722},{"class":627},[1723],{"type":24,"value":1724},"(yaw",{"type":18,"tag":614,"props":1726,"children":1727},{"class":621},[1728],{"type":24,"value":1046},{"type":18,"tag":614,"props":1730,"children":1731},{"class":627},[1732],{"type":24,"value":1733},"yaw_r)\n",{"type":18,"tag":614,"props":1735,"children":1737},{"class":616,"line":1736},37,[1738],{"type":18,"tag":614,"props":1739,"children":1740},{},[1741],{"type":24,"value":650},{"type":18,"tag":614,"props":1743,"children":1745},{"class":616,"line":1744},38,[1746,1750,1754],{"type":18,"tag":614,"props":1747,"children":1748},{"class":627},[1749],{"type":24,"value":696},{"type":18,"tag":614,"props":1751,"children":1752},{"class":621},[1753],{"type":24,"value":1220},{"type":18,"tag":614,"props":1755,"children":1756},{"class":627},[1757],{"type":24,"value":1758}," dphidx1, dphidx2, dphidx3",{"type":18,"tag":27,"props":1760,"children":1761},{},[1762,1764,1769,1770],{"type":24,"value":1763},"Here, I suggest that you should understand the mathematics equations above that I try to explain. It is easy to do it in Python programming language if you already understand its expression. Now I created another class for ",{"type":18,"tag":170,"props":1765,"children":1766},{},[1767],{"type":24,"value":1768}," NMPC with CGMRES ",{"type":24,"value":176},{"type":18,"tag":56,"props":1771,"children":1772},{},[],{"type":18,"tag":599,"props":1774,"children":1777},{"className":1775,"code":1776,"language":604,"meta":8},[602],"class NMPCCGMRES:\n\n    def __init__(self):\n\n        ## NMPC params\n        self.x_dim = 3\n        self.u_dim = 2\n        self.c_dim = 2\n        self.pred_horizons = 10\n\n        ### Continuations Params\n        self.ht = 1e-5\n        self.zeta = 1/self.ht\n        self.alpha = 0.5\n        self.tf = 1.0\n\n        ### Matrix\n\n        self.q1 = 1\n        self.q2 = 6\n        self.q3 = 1\n        self.r1 = 1\n        self.r2 = 0.1\n\n        ### Constraint\n        self.u_min = [ 0,  0]\n        self.u_max = [ 2,  1.57]\n        self.u_dummy = [0.01, 0.01]\n\n        ### Initialize matrix solution\n        self.dU = np.zeros((self.u_dim, self.pred_horizons))\n\n        ### Reference point\n        self.X_r = [3, 2, 0.0]\n        self.U_r = [0, 0]\n",[1778],{"type":18,"tag":607,"props":1779,"children":1780},{},[1781],{"type":18,"tag":599,"props":1782,"children":1783},{"__ignoreMap":8},[1784,1804,1811,1835,1842,1855,1884,1913,1941,1970,1977,1989,2018,2059,2088,2117,2124,2136,2143,2171,2199,2226,2253,2281,2288,2300,2342,2383,2426,2433,2445,2488,2495,2507,2557],{"type":18,"tag":614,"props":1785,"children":1786},{"class":616,"line":617},[1787,1791,1795,1800],{"type":18,"tag":614,"props":1788,"children":1789},{"class":621},[1790],{"type":24,"value":624},{"type":18,"tag":614,"props":1792,"children":1793},{"class":627},[1794],{"type":24,"value":630},{"type":18,"tag":614,"props":1796,"children":1797},{"class":633},[1798],{"type":24,"value":1799},"NMPCCGMRES",{"type":18,"tag":614,"props":1801,"children":1802},{"class":627},[1803],{"type":24,"value":641},{"type":18,"tag":614,"props":1805,"children":1806},{"class":616,"line":644},[1807],{"type":18,"tag":614,"props":1808,"children":1809},{},[1810],{"type":24,"value":650},{"type":18,"tag":614,"props":1812,"children":1813},{"class":616,"line":653},[1814,1818,1822,1826,1830],{"type":18,"tag":614,"props":1815,"children":1816},{"class":627},[1817],{"type":24,"value":659},{"type":18,"tag":614,"props":1819,"children":1820},{"class":621},[1821],{"type":24,"value":664},{"type":18,"tag":614,"props":1823,"children":1824},{"class":627},[1825],{"type":24,"value":630},{"type":18,"tag":614,"props":1827,"children":1828},{"class":671},[1829],{"type":24,"value":674},{"type":18,"tag":614,"props":1831,"children":1832},{"class":627},[1833],{"type":24,"value":1834},"(self):\n",{"type":18,"tag":614,"props":1836,"children":1837},{"class":616,"line":682},[1838],{"type":18,"tag":614,"props":1839,"children":1840},{},[1841],{"type":24,"value":650},{"type":18,"tag":614,"props":1843,"children":1844},{"class":616,"line":690},[1845,1849],{"type":18,"tag":614,"props":1846,"children":1847},{"class":627},[1848],{"type":24,"value":696},{"type":18,"tag":614,"props":1850,"children":1852},{"class":1851},"ct-326375",[1853],{"type":24,"value":1854},"## NMPC params\n",{"type":18,"tag":614,"props":1856,"children":1857},{"class":616,"line":719},[1858,1862,1866,1871,1875,1879],{"type":18,"tag":614,"props":1859,"children":1860},{"class":627},[1861],{"type":24,"value":696},{"type":18,"tag":614,"props":1863,"children":1864},{"class":671},[1865],{"type":24,"value":701},{"type":18,"tag":614,"props":1867,"children":1868},{"class":627},[1869],{"type":24,"value":1870},".x_dim ",{"type":18,"tag":614,"props":1872,"children":1873},{"class":621},[1874],{"type":24,"value":711},{"type":18,"tag":614,"props":1876,"children":1877},{"class":627},[1878],{"type":24,"value":630},{"type":18,"tag":614,"props":1880,"children":1881},{"class":671},[1882],{"type":24,"value":1883},"3\n",{"type":18,"tag":614,"props":1885,"children":1886},{"class":616,"line":745},[1887,1891,1895,1900,1904,1908],{"type":18,"tag":614,"props":1888,"children":1889},{"class":627},[1890],{"type":24,"value":696},{"type":18,"tag":614,"props":1892,"children":1893},{"class":671},[1894],{"type":24,"value":701},{"type":18,"tag":614,"props":1896,"children":1897},{"class":627},[1898],{"type":24,"value":1899},".u_dim ",{"type":18,"tag":614,"props":1901,"children":1902},{"class":621},[1903],{"type":24,"value":711},{"type":18,"tag":614,"props":1905,"children":1906},{"class":627},[1907],{"type":24,"value":630},{"type":18,"tag":614,"props":1909,"children":1910},{"class":671},[1911],{"type":24,"value":1912},"2\n",{"type":18,"tag":614,"props":1914,"children":1915},{"class":616,"line":771},[1916,1920,1924,1929,1933,1937],{"type":18,"tag":614,"props":1917,"children":1918},{"class":627},[1919],{"type":24,"value":696},{"type":18,"tag":614,"props":1921,"children":1922},{"class":671},[1923],{"type":24,"value":701},{"type":18,"tag":614,"props":1925,"children":1926},{"class":627},[1927],{"type":24,"value":1928},".c_dim ",{"type":18,"tag":614,"props":1930,"children":1931},{"class":621},[1932],{"type":24,"value":711},{"type":18,"tag":614,"props":1934,"children":1935},{"class":627},[1936],{"type":24,"value":630},{"type":18,"tag":614,"props":1938,"children":1939},{"class":671},[1940],{"type":24,"value":1912},{"type":18,"tag":614,"props":1942,"children":1943},{"class":616,"line":779},[1944,1948,1952,1957,1961,1965],{"type":18,"tag":614,"props":1945,"children":1946},{"class":627},[1947],{"type":24,"value":696},{"type":18,"tag":614,"props":1949,"children":1950},{"class":671},[1951],{"type":24,"value":701},{"type":18,"tag":614,"props":1953,"children":1954},{"class":627},[1955],{"type":24,"value":1956},".pred_horizons ",{"type":18,"tag":614,"props":1958,"children":1959},{"class":621},[1960],{"type":24,"value":711},{"type":18,"tag":614,"props":1962,"children":1963},{"class":627},[1964],{"type":24,"value":630},{"type":18,"tag":614,"props":1966,"children":1967},{"class":671},[1968],{"type":24,"value":1969},"10\n",{"type":18,"tag":614,"props":1971,"children":1972},{"class":616,"line":805},[1973],{"type":18,"tag":614,"props":1974,"children":1975},{},[1976],{"type":24,"value":650},{"type":18,"tag":614,"props":1978,"children":1979},{"class":616,"line":831},[1980,1984],{"type":18,"tag":614,"props":1981,"children":1982},{"class":627},[1983],{"type":24,"value":696},{"type":18,"tag":614,"props":1985,"children":1986},{"class":1851},[1987],{"type":24,"value":1988},"### Continuations Params\n",{"type":18,"tag":614,"props":1990,"children":1991},{"class":616,"line":839},[1992,1996,2000,2005,2009,2013],{"type":18,"tag":614,"props":1993,"children":1994},{"class":627},[1995],{"type":24,"value":696},{"type":18,"tag":614,"props":1997,"children":1998},{"class":671},[1999],{"type":24,"value":701},{"type":18,"tag":614,"props":2001,"children":2002},{"class":627},[2003],{"type":24,"value":2004},".ht ",{"type":18,"tag":614,"props":2006,"children":2007},{"class":621},[2008],{"type":24,"value":711},{"type":18,"tag":614,"props":2010,"children":2011},{"class":627},[2012],{"type":24,"value":630},{"type":18,"tag":614,"props":2014,"children":2015},{"class":671},[2016],{"type":24,"value":2017},"1e-5\n",{"type":18,"tag":614,"props":2019,"children":2020},{"class":616,"line":875},[2021,2025,2029,2034,2038,2042,2046,2050,2054],{"type":18,"tag":614,"props":2022,"children":2023},{"class":627},[2024],{"type":24,"value":696},{"type":18,"tag":614,"props":2026,"children":2027},{"class":671},[2028],{"type":24,"value":701},{"type":18,"tag":614,"props":2030,"children":2031},{"class":627},[2032],{"type":24,"value":2033},".zeta ",{"type":18,"tag":614,"props":2035,"children":2036},{"class":621},[2037],{"type":24,"value":711},{"type":18,"tag":614,"props":2039,"children":2040},{"class":627},[2041],{"type":24,"value":630},{"type":18,"tag":614,"props":2043,"children":2044},{"class":671},[2045],{"type":24,"value":977},{"type":18,"tag":614,"props":2047,"children":2048},{"class":621},[2049],{"type":24,"value":1414},{"type":18,"tag":614,"props":2051,"children":2052},{"class":671},[2053],{"type":24,"value":701},{"type":18,"tag":614,"props":2055,"children":2056},{"class":627},[2057],{"type":24,"value":2058},".ht\n",{"type":18,"tag":614,"props":2060,"children":2061},{"class":616,"line":908},[2062,2066,2070,2075,2079,2083],{"type":18,"tag":614,"props":2063,"children":2064},{"class":627},[2065],{"type":24,"value":696},{"type":18,"tag":614,"props":2067,"children":2068},{"class":671},[2069],{"type":24,"value":701},{"type":18,"tag":614,"props":2071,"children":2072},{"class":627},[2073],{"type":24,"value":2074},".alpha ",{"type":18,"tag":614,"props":2076,"children":2077},{"class":621},[2078],{"type":24,"value":711},{"type":18,"tag":614,"props":2080,"children":2081},{"class":627},[2082],{"type":24,"value":630},{"type":18,"tag":614,"props":2084,"children":2085},{"class":671},[2086],{"type":24,"value":2087},"0.5\n",{"type":18,"tag":614,"props":2089,"children":2090},{"class":616,"line":916},[2091,2095,2099,2104,2108,2112],{"type":18,"tag":614,"props":2092,"children":2093},{"class":627},[2094],{"type":24,"value":696},{"type":18,"tag":614,"props":2096,"children":2097},{"class":671},[2098],{"type":24,"value":701},{"type":18,"tag":614,"props":2100,"children":2101},{"class":627},[2102],{"type":24,"value":2103},".tf ",{"type":18,"tag":614,"props":2105,"children":2106},{"class":621},[2107],{"type":24,"value":711},{"type":18,"tag":614,"props":2109,"children":2110},{"class":627},[2111],{"type":24,"value":630},{"type":18,"tag":614,"props":2113,"children":2114},{"class":671},[2115],{"type":24,"value":2116},"1.0\n",{"type":18,"tag":614,"props":2118,"children":2119},{"class":616,"line":950},[2120],{"type":18,"tag":614,"props":2121,"children":2122},{},[2123],{"type":24,"value":650},{"type":18,"tag":614,"props":2125,"children":2126},{"class":616,"line":984},[2127,2131],{"type":18,"tag":614,"props":2128,"children":2129},{"class":627},[2130],{"type":24,"value":696},{"type":18,"tag":614,"props":2132,"children":2133},{"class":1851},[2134],{"type":24,"value":2135},"### Matrix\n",{"type":18,"tag":614,"props":2137,"children":2138},{"class":616,"line":992},[2139],{"type":18,"tag":614,"props":2140,"children":2141},{},[2142],{"type":24,"value":650},{"type":18,"tag":614,"props":2144,"children":2145},{"class":616,"line":1018},[2146,2150,2154,2158,2162,2166],{"type":18,"tag":614,"props":2147,"children":2148},{"class":627},[2149],{"type":24,"value":696},{"type":18,"tag":614,"props":2151,"children":2152},{"class":671},[2153],{"type":24,"value":701},{"type":18,"tag":614,"props":2155,"children":2156},{"class":627},[2157],{"type":24,"value":706},{"type":18,"tag":614,"props":2159,"children":2160},{"class":621},[2161],{"type":24,"value":711},{"type":18,"tag":614,"props":2163,"children":2164},{"class":627},[2165],{"type":24,"value":630},{"type":18,"tag":614,"props":2167,"children":2168},{"class":671},[2169],{"type":24,"value":2170},"1\n",{"type":18,"tag":614,"props":2172,"children":2173},{"class":616,"line":1026},[2174,2178,2182,2186,2190,2194],{"type":18,"tag":614,"props":2175,"children":2176},{"class":627},[2177],{"type":24,"value":696},{"type":18,"tag":614,"props":2179,"children":2180},{"class":671},[2181],{"type":24,"value":701},{"type":18,"tag":614,"props":2183,"children":2184},{"class":627},[2185],{"type":24,"value":733},{"type":18,"tag":614,"props":2187,"children":2188},{"class":621},[2189],{"type":24,"value":711},{"type":18,"tag":614,"props":2191,"children":2192},{"class":627},[2193],{"type":24,"value":630},{"type":18,"tag":614,"props":2195,"children":2196},{"class":671},[2197],{"type":24,"value":2198},"6\n",{"type":18,"tag":614,"props":2200,"children":2201},{"class":616,"line":1068},[2202,2206,2210,2214,2218,2222],{"type":18,"tag":614,"props":2203,"children":2204},{"class":627},[2205],{"type":24,"value":696},{"type":18,"tag":614,"props":2207,"children":2208},{"class":671},[2209],{"type":24,"value":701},{"type":18,"tag":614,"props":2211,"children":2212},{"class":627},[2213],{"type":24,"value":759},{"type":18,"tag":614,"props":2215,"children":2216},{"class":621},[2217],{"type":24,"value":711},{"type":18,"tag":614,"props":2219,"children":2220},{"class":627},[2221],{"type":24,"value":630},{"type":18,"tag":614,"props":2223,"children":2224},{"class":671},[2225],{"type":24,"value":2170},{"type":18,"tag":614,"props":2227,"children":2228},{"class":616,"line":1108},[2229,2233,2237,2241,2245,2249],{"type":18,"tag":614,"props":2230,"children":2231},{"class":627},[2232],{"type":24,"value":696},{"type":18,"tag":614,"props":2234,"children":2235},{"class":671},[2236],{"type":24,"value":701},{"type":18,"tag":614,"props":2238,"children":2239},{"class":627},[2240],{"type":24,"value":793},{"type":18,"tag":614,"props":2242,"children":2243},{"class":621},[2244],{"type":24,"value":711},{"type":18,"tag":614,"props":2246,"children":2247},{"class":627},[2248],{"type":24,"value":630},{"type":18,"tag":614,"props":2250,"children":2251},{"class":671},[2252],{"type":24,"value":2170},{"type":18,"tag":614,"props":2254,"children":2255},{"class":616,"line":1202},[2256,2260,2264,2268,2272,2276],{"type":18,"tag":614,"props":2257,"children":2258},{"class":627},[2259],{"type":24,"value":696},{"type":18,"tag":614,"props":2261,"children":2262},{"class":671},[2263],{"type":24,"value":701},{"type":18,"tag":614,"props":2265,"children":2266},{"class":627},[2267],{"type":24,"value":819},{"type":18,"tag":614,"props":2269,"children":2270},{"class":621},[2271],{"type":24,"value":711},{"type":18,"tag":614,"props":2273,"children":2274},{"class":627},[2275],{"type":24,"value":630},{"type":18,"tag":614,"props":2277,"children":2278},{"class":671},[2279],{"type":24,"value":2280},"0.1\n",{"type":18,"tag":614,"props":2282,"children":2283},{"class":616,"line":1210},[2284],{"type":18,"tag":614,"props":2285,"children":2286},{},[2287],{"type":24,"value":650},{"type":18,"tag":614,"props":2289,"children":2290},{"class":616,"line":1228},[2291,2295],{"type":18,"tag":614,"props":2292,"children":2293},{"class":627},[2294],{"type":24,"value":696},{"type":18,"tag":614,"props":2296,"children":2297},{"class":1851},[2298],{"type":24,"value":2299},"### Constraint\n",{"type":18,"tag":614,"props":2301,"children":2302},{"class":616,"line":1236},[2303,2307,2311,2316,2320,2325,2329,2334,2338],{"type":18,"tag":614,"props":2304,"children":2305},{"class":627},[2306],{"type":24,"value":696},{"type":18,"tag":614,"props":2308,"children":2309},{"class":671},[2310],{"type":24,"value":701},{"type":18,"tag":614,"props":2312,"children":2313},{"class":627},[2314],{"type":24,"value":2315},".u_min ",{"type":18,"tag":614,"props":2317,"children":2318},{"class":621},[2319],{"type":24,"value":711},{"type":18,"tag":614,"props":2321,"children":2322},{"class":627},[2323],{"type":24,"value":2324}," [ ",{"type":18,"tag":614,"props":2326,"children":2327},{"class":671},[2328],{"type":24,"value":867},{"type":18,"tag":614,"props":2330,"children":2331},{"class":627},[2332],{"type":24,"value":2333},",  ",{"type":18,"tag":614,"props":2335,"children":2336},{"class":671},[2337],{"type":24,"value":867},{"type":18,"tag":614,"props":2339,"children":2340},{"class":627},[2341],{"type":24,"value":872},{"type":18,"tag":614,"props":2343,"children":2344},{"class":616,"line":1262},[2345,2349,2353,2358,2362,2366,2370,2374,2379],{"type":18,"tag":614,"props":2346,"children":2347},{"class":627},[2348],{"type":24,"value":696},{"type":18,"tag":614,"props":2350,"children":2351},{"class":671},[2352],{"type":24,"value":701},{"type":18,"tag":614,"props":2354,"children":2355},{"class":627},[2356],{"type":24,"value":2357},".u_max ",{"type":18,"tag":614,"props":2359,"children":2360},{"class":621},[2361],{"type":24,"value":711},{"type":18,"tag":614,"props":2363,"children":2364},{"class":627},[2365],{"type":24,"value":2324},{"type":18,"tag":614,"props":2367,"children":2368},{"class":671},[2369],{"type":24,"value":1353},{"type":18,"tag":614,"props":2371,"children":2372},{"class":627},[2373],{"type":24,"value":2333},{"type":18,"tag":614,"props":2375,"children":2376},{"class":671},[2377],{"type":24,"value":2378},"1.57",{"type":18,"tag":614,"props":2380,"children":2381},{"class":627},[2382],{"type":24,"value":872},{"type":18,"tag":614,"props":2384,"children":2385},{"class":616,"line":1270},[2386,2390,2394,2399,2403,2408,2413,2418,2422],{"type":18,"tag":614,"props":2387,"children":2388},{"class":627},[2389],{"type":24,"value":696},{"type":18,"tag":614,"props":2391,"children":2392},{"class":671},[2393],{"type":24,"value":701},{"type":18,"tag":614,"props":2395,"children":2396},{"class":627},[2397],{"type":24,"value":2398},".u_dummy ",{"type":18,"tag":614,"props":2400,"children":2401},{"class":621},[2402],{"type":24,"value":711},{"type":18,"tag":614,"props":2404,"children":2405},{"class":627},[2406],{"type":24,"value":2407}," [",{"type":18,"tag":614,"props":2409,"children":2410},{"class":671},[2411],{"type":24,"value":2412},"0.01",{"type":18,"tag":614,"props":2414,"children":2415},{"class":627},[2416],{"type":24,"value":2417},", ",{"type":18,"tag":614,"props":2419,"children":2420},{"class":671},[2421],{"type":24,"value":2412},{"type":18,"tag":614,"props":2423,"children":2424},{"class":627},[2425],{"type":24,"value":872},{"type":18,"tag":614,"props":2427,"children":2428},{"class":616,"line":1426},[2429],{"type":18,"tag":614,"props":2430,"children":2431},{},[2432],{"type":24,"value":650},{"type":18,"tag":614,"props":2434,"children":2435},{"class":616,"line":1546},[2436,2440],{"type":18,"tag":614,"props":2437,"children":2438},{"class":627},[2439],{"type":24,"value":696},{"type":18,"tag":614,"props":2441,"children":2442},{"class":1851},[2443],{"type":24,"value":2444},"### Initialize matrix solution\n",{"type":18,"tag":614,"props":2446,"children":2447},{"class":616,"line":1554},[2448,2452,2456,2461,2465,2470,2474,2479,2483],{"type":18,"tag":614,"props":2449,"children":2450},{"class":627},[2451],{"type":24,"value":696},{"type":18,"tag":614,"props":2453,"children":2454},{"class":671},[2455],{"type":24,"value":701},{"type":18,"tag":614,"props":2457,"children":2458},{"class":627},[2459],{"type":24,"value":2460},".dU ",{"type":18,"tag":614,"props":2462,"children":2463},{"class":621},[2464],{"type":24,"value":711},{"type":18,"tag":614,"props":2466,"children":2467},{"class":627},[2468],{"type":24,"value":2469}," np.zeros((",{"type":18,"tag":614,"props":2471,"children":2472},{"class":671},[2473],{"type":24,"value":701},{"type":18,"tag":614,"props":2475,"children":2476},{"class":627},[2477],{"type":24,"value":2478},".u_dim, ",{"type":18,"tag":614,"props":2480,"children":2481},{"class":671},[2482],{"type":24,"value":701},{"type":18,"tag":614,"props":2484,"children":2485},{"class":627},[2486],{"type":24,"value":2487},".pred_horizons))\n",{"type":18,"tag":614,"props":2489,"children":2490},{"class":616,"line":1571},[2491],{"type":18,"tag":614,"props":2492,"children":2493},{},[2494],{"type":24,"value":650},{"type":18,"tag":614,"props":2496,"children":2497},{"class":616,"line":1579},[2498,2502],{"type":18,"tag":614,"props":2499,"children":2500},{"class":627},[2501],{"type":24,"value":696},{"type":18,"tag":614,"props":2503,"children":2504},{"class":1851},[2505],{"type":24,"value":2506},"### Reference point\n",{"type":18,"tag":614,"props":2508,"children":2509},{"class":616,"line":1605},[2510,2514,2518,2523,2527,2531,2536,2540,2544,2548,2553],{"type":18,"tag":614,"props":2511,"children":2512},{"class":627},[2513],{"type":24,"value":696},{"type":18,"tag":614,"props":2515,"children":2516},{"class":671},[2517],{"type":24,"value":701},{"type":18,"tag":614,"props":2519,"children":2520},{"class":627},[2521],{"type":24,"value":2522},".X_r ",{"type":18,"tag":614,"props":2524,"children":2525},{"class":621},[2526],{"type":24,"value":711},{"type":18,"tag":614,"props":2528,"children":2529},{"class":627},[2530],{"type":24,"value":2407},{"type":18,"tag":614,"props":2532,"children":2533},{"class":671},[2534],{"type":24,"value":2535},"3",{"type":18,"tag":614,"props":2537,"children":2538},{"class":627},[2539],{"type":24,"value":2417},{"type":18,"tag":614,"props":2541,"children":2542},{"class":671},[2543],{"type":24,"value":1353},{"type":18,"tag":614,"props":2545,"children":2546},{"class":627},[2547],{"type":24,"value":2417},{"type":18,"tag":614,"props":2549,"children":2550},{"class":671},[2551],{"type":24,"value":2552},"0.0",{"type":18,"tag":614,"props":2554,"children":2555},{"class":627},[2556],{"type":24,"value":872},{"type":18,"tag":614,"props":2558,"children":2559},{"class":616,"line":1649},[2560,2564,2568,2573,2577,2581,2585,2589,2593],{"type":18,"tag":614,"props":2561,"children":2562},{"class":627},[2563],{"type":24,"value":696},{"type":18,"tag":614,"props":2565,"children":2566},{"class":671},[2567],{"type":24,"value":701},{"type":18,"tag":614,"props":2569,"children":2570},{"class":627},[2571],{"type":24,"value":2572},".U_r ",{"type":18,"tag":614,"props":2574,"children":2575},{"class":621},[2576],{"type":24,"value":711},{"type":18,"tag":614,"props":2578,"children":2579},{"class":627},[2580],{"type":24,"value":2407},{"type":18,"tag":614,"props":2582,"children":2583},{"class":671},[2584],{"type":24,"value":867},{"type":18,"tag":614,"props":2586,"children":2587},{"class":627},[2588],{"type":24,"value":2417},{"type":18,"tag":614,"props":2590,"children":2591},{"class":671},[2592],{"type":24,"value":867},{"type":18,"tag":614,"props":2594,"children":2595},{"class":627},[2596],{"type":24,"value":2597},"]",{"type":18,"tag":27,"props":2599,"children":2600},{},[2601],{"type":24,"value":2602},"These are just for tuning parameters and initialize parameters, let's focus on CGMRES method. As the expression above at equation (1).\nLet's denote that",{"type":18,"tag":599,"props":2604,"children":2607},{"className":2605,"code":2606,"language":604,"meta":8},[602],"X = np.zeros((x_dim, pred_horizons+1))      ## State for N-prediction+1\nU = np.zeros((u_dim, pred_horizons))        ## Input Control for N-prediction\nLambda = np.zeros((x_dim, pred_horizons+1)) ## Costate vector for N-prediction+1\ndt = 0.01                                   ## Sampling Time\n",[2608],{"type":18,"tag":607,"props":2609,"children":2610},{},[2611],{"type":18,"tag":599,"props":2612,"children":2613},{"__ignoreMap":8},[2614,2649,2671,2705],{"type":18,"tag":614,"props":2615,"children":2616},{"class":616,"line":617},[2617,2622,2626,2631,2635,2639,2644],{"type":18,"tag":614,"props":2618,"children":2619},{"class":627},[2620],{"type":24,"value":2621},"X ",{"type":18,"tag":614,"props":2623,"children":2624},{"class":621},[2625],{"type":24,"value":711},{"type":18,"tag":614,"props":2627,"children":2628},{"class":627},[2629],{"type":24,"value":2630}," np.zeros((x_dim, pred_horizons",{"type":18,"tag":614,"props":2632,"children":2633},{"class":621},[2634],{"type":24,"value":1177},{"type":18,"tag":614,"props":2636,"children":2637},{"class":671},[2638],{"type":24,"value":977},{"type":18,"tag":614,"props":2640,"children":2641},{"class":627},[2642],{"type":24,"value":2643},"))      ",{"type":18,"tag":614,"props":2645,"children":2646},{"class":1851},[2647],{"type":24,"value":2648},"## State for N-prediction+1\n",{"type":18,"tag":614,"props":2650,"children":2651},{"class":616,"line":644},[2652,2657,2661,2666],{"type":18,"tag":614,"props":2653,"children":2654},{"class":627},[2655],{"type":24,"value":2656},"U ",{"type":18,"tag":614,"props":2658,"children":2659},{"class":621},[2660],{"type":24,"value":711},{"type":18,"tag":614,"props":2662,"children":2663},{"class":627},[2664],{"type":24,"value":2665}," np.zeros((u_dim, pred_horizons))        ",{"type":18,"tag":614,"props":2667,"children":2668},{"class":1851},[2669],{"type":24,"value":2670},"## Input Control for N-prediction\n",{"type":18,"tag":614,"props":2672,"children":2673},{"class":616,"line":653},[2674,2679,2683,2687,2691,2695,2700],{"type":18,"tag":614,"props":2675,"children":2676},{"class":627},[2677],{"type":24,"value":2678},"Lambda ",{"type":18,"tag":614,"props":2680,"children":2681},{"class":621},[2682],{"type":24,"value":711},{"type":18,"tag":614,"props":2684,"children":2685},{"class":627},[2686],{"type":24,"value":2630},{"type":18,"tag":614,"props":2688,"children":2689},{"class":621},[2690],{"type":24,"value":1177},{"type":18,"tag":614,"props":2692,"children":2693},{"class":671},[2694],{"type":24,"value":977},{"type":18,"tag":614,"props":2696,"children":2697},{"class":627},[2698],{"type":24,"value":2699},")) ",{"type":18,"tag":614,"props":2701,"children":2702},{"class":1851},[2703],{"type":24,"value":2704},"## Costate vector for N-prediction+1\n",{"type":18,"tag":614,"props":2706,"children":2707},{"class":616,"line":682},[2708,2713,2717,2721,2725,2730],{"type":18,"tag":614,"props":2709,"children":2710},{"class":627},[2711],{"type":24,"value":2712},"dt ",{"type":18,"tag":614,"props":2714,"children":2715},{"class":621},[2716],{"type":24,"value":711},{"type":18,"tag":614,"props":2718,"children":2719},{"class":627},[2720],{"type":24,"value":630},{"type":18,"tag":614,"props":2722,"children":2723},{"class":671},[2724],{"type":24,"value":2412},{"type":18,"tag":614,"props":2726,"children":2727},{"class":627},[2728],{"type":24,"value":2729},"                                   ",{"type":18,"tag":614,"props":2731,"children":2732},{"class":1851},[2733],{"type":24,"value":2734},"## Sampling Time",{"type":18,"tag":27,"props":2736,"children":2737},{},[2738],{"type":24,"value":2739},"Then, we can perform equation (1) as",{"type":18,"tag":599,"props":2741,"children":2744},{"className":2742,"code":2743,"language":604,"meta":8},[602],"def calc_state(self, X, U, dt):\n\n        for i in range(self.pred_horizons):\n            x_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, i], U[0, i], U[1, i])\n            \n            X[0, i+1] = X[0, i] + x_dot * dt\n            X[1, i+1] = X[1, i] + y_dot * dt\n            X[2, i+1] = X[2, i] + yaw_dot * dt\n\n        return X\n",[2745],{"type":18,"tag":607,"props":2746,"children":2747},{},[2748],{"type":18,"tag":599,"props":2749,"children":2750},{"__ignoreMap":8},[2751,2772,2779,2823,2874,2882,2948,3008,3068,3075],{"type":18,"tag":614,"props":2752,"children":2753},{"class":616,"line":617},[2754,2758,2762,2767],{"type":18,"tag":614,"props":2755,"children":2756},{"class":621},[2757],{"type":24,"value":664},{"type":18,"tag":614,"props":2759,"children":2760},{"class":627},[2761],{"type":24,"value":630},{"type":18,"tag":614,"props":2763,"children":2764},{"class":633},[2765],{"type":24,"value":2766},"calc_state",{"type":18,"tag":614,"props":2768,"children":2769},{"class":627},[2770],{"type":24,"value":2771},"(self, X, U, dt):\n",{"type":18,"tag":614,"props":2773,"children":2774},{"class":616,"line":644},[2775],{"type":18,"tag":614,"props":2776,"children":2777},{},[2778],{"type":24,"value":650},{"type":18,"tag":614,"props":2780,"children":2781},{"class":616,"line":653},[2782,2786,2791,2796,2801,2805,2810,2814,2818],{"type":18,"tag":614,"props":2783,"children":2784},{"class":627},[2785],{"type":24,"value":696},{"type":18,"tag":614,"props":2787,"children":2788},{"class":621},[2789],{"type":24,"value":2790},"for",{"type":18,"tag":614,"props":2792,"children":2793},{"class":627},[2794],{"type":24,"value":2795}," i ",{"type":18,"tag":614,"props":2797,"children":2798},{"class":621},[2799],{"type":24,"value":2800},"in",{"type":18,"tag":614,"props":2802,"children":2803},{"class":627},[2804],{"type":24,"value":630},{"type":18,"tag":614,"props":2806,"children":2807},{"class":671},[2808],{"type":24,"value":2809},"range",{"type":18,"tag":614,"props":2811,"children":2812},{"class":627},[2813],{"type":24,"value":1387},{"type":18,"tag":614,"props":2815,"children":2816},{"class":671},[2817],{"type":24,"value":701},{"type":18,"tag":614,"props":2819,"children":2820},{"class":627},[2821],{"type":24,"value":2822},".pred_horizons):\n",{"type":18,"tag":614,"props":2824,"children":2825},{"class":616,"line":682},[2826,2831,2835,2839,2843,2848,2852,2857,2861,2865,2869],{"type":18,"tag":614,"props":2827,"children":2828},{"class":627},[2829],{"type":24,"value":2830},"            x_dot, y_dot, yaw_dot ",{"type":18,"tag":614,"props":2832,"children":2833},{"class":621},[2834],{"type":24,"value":711},{"type":18,"tag":614,"props":2836,"children":2837},{"class":627},[2838],{"type":24,"value":630},{"type":18,"tag":614,"props":2840,"children":2841},{"class":671},[2842],{"type":24,"value":701},{"type":18,"tag":614,"props":2844,"children":2845},{"class":627},[2846],{"type":24,"value":2847},".robot_model.forward_kinematic(X[",{"type":18,"tag":614,"props":2849,"children":2850},{"class":671},[2851],{"type":24,"value":1353},{"type":18,"tag":614,"props":2853,"children":2854},{"class":627},[2855],{"type":24,"value":2856},", i], U[",{"type":18,"tag":614,"props":2858,"children":2859},{"class":671},[2860],{"type":24,"value":867},{"type":18,"tag":614,"props":2862,"children":2863},{"class":627},[2864],{"type":24,"value":2856},{"type":18,"tag":614,"props":2866,"children":2867},{"class":671},[2868],{"type":24,"value":977},{"type":18,"tag":614,"props":2870,"children":2871},{"class":627},[2872],{"type":24,"value":2873},", i])\n",{"type":18,"tag":614,"props":2875,"children":2876},{"class":616,"line":690},[2877],{"type":18,"tag":614,"props":2878,"children":2879},{"class":627},[2880],{"type":24,"value":2881},"            \n",{"type":18,"tag":614,"props":2883,"children":2884},{"class":616,"line":719},[2885,2890,2894,2899,2903,2907,2912,2916,2921,2925,2930,2934,2939,2943],{"type":18,"tag":614,"props":2886,"children":2887},{"class":627},[2888],{"type":24,"value":2889},"            X[",{"type":18,"tag":614,"props":2891,"children":2892},{"class":671},[2893],{"type":24,"value":867},{"type":18,"tag":614,"props":2895,"children":2896},{"class":627},[2897],{"type":24,"value":2898},", i",{"type":18,"tag":614,"props":2900,"children":2901},{"class":621},[2902],{"type":24,"value":1177},{"type":18,"tag":614,"props":2904,"children":2905},{"class":671},[2906],{"type":24,"value":977},{"type":18,"tag":614,"props":2908,"children":2909},{"class":627},[2910],{"type":24,"value":2911},"] ",{"type":18,"tag":614,"props":2913,"children":2914},{"class":621},[2915],{"type":24,"value":711},{"type":18,"tag":614,"props":2917,"children":2918},{"class":627},[2919],{"type":24,"value":2920}," X[",{"type":18,"tag":614,"props":2922,"children":2923},{"class":671},[2924],{"type":24,"value":867},{"type":18,"tag":614,"props":2926,"children":2927},{"class":627},[2928],{"type":24,"value":2929},", i] ",{"type":18,"tag":614,"props":2931,"children":2932},{"class":621},[2933],{"type":24,"value":1177},{"type":18,"tag":614,"props":2935,"children":2936},{"class":627},[2937],{"type":24,"value":2938}," x_dot ",{"type":18,"tag":614,"props":2940,"children":2941},{"class":621},[2942],{"type":24,"value":1056},{"type":18,"tag":614,"props":2944,"children":2945},{"class":627},[2946],{"type":24,"value":2947}," dt\n",{"type":18,"tag":614,"props":2949,"children":2950},{"class":616,"line":745},[2951,2955,2959,2963,2967,2971,2975,2979,2983,2987,2991,2995,3000,3004],{"type":18,"tag":614,"props":2952,"children":2953},{"class":627},[2954],{"type":24,"value":2889},{"type":18,"tag":614,"props":2956,"children":2957},{"class":671},[2958],{"type":24,"value":977},{"type":18,"tag":614,"props":2960,"children":2961},{"class":627},[2962],{"type":24,"value":2898},{"type":18,"tag":614,"props":2964,"children":2965},{"class":621},[2966],{"type":24,"value":1177},{"type":18,"tag":614,"props":2968,"children":2969},{"class":671},[2970],{"type":24,"value":977},{"type":18,"tag":614,"props":2972,"children":2973},{"class":627},[2974],{"type":24,"value":2911},{"type":18,"tag":614,"props":2976,"children":2977},{"class":621},[2978],{"type":24,"value":711},{"type":18,"tag":614,"props":2980,"children":2981},{"class":627},[2982],{"type":24,"value":2920},{"type":18,"tag":614,"props":2984,"children":2985},{"class":671},[2986],{"type":24,"value":977},{"type":18,"tag":614,"props":2988,"children":2989},{"class":627},[2990],{"type":24,"value":2929},{"type":18,"tag":614,"props":2992,"children":2993},{"class":621},[2994],{"type":24,"value":1177},{"type":18,"tag":614,"props":2996,"children":2997},{"class":627},[2998],{"type":24,"value":2999}," y_dot ",{"type":18,"tag":614,"props":3001,"children":3002},{"class":621},[3003],{"type":24,"value":1056},{"type":18,"tag":614,"props":3005,"children":3006},{"class":627},[3007],{"type":24,"value":2947},{"type":18,"tag":614,"props":3009,"children":3010},{"class":616,"line":771},[3011,3015,3019,3023,3027,3031,3035,3039,3043,3047,3051,3055,3060,3064],{"type":18,"tag":614,"props":3012,"children":3013},{"class":627},[3014],{"type":24,"value":2889},{"type":18,"tag":614,"props":3016,"children":3017},{"class":671},[3018],{"type":24,"value":1353},{"type":18,"tag":614,"props":3020,"children":3021},{"class":627},[3022],{"type":24,"value":2898},{"type":18,"tag":614,"props":3024,"children":3025},{"class":621},[3026],{"type":24,"value":1177},{"type":18,"tag":614,"props":3028,"children":3029},{"class":671},[3030],{"type":24,"value":977},{"type":18,"tag":614,"props":3032,"children":3033},{"class":627},[3034],{"type":24,"value":2911},{"type":18,"tag":614,"props":3036,"children":3037},{"class":621},[3038],{"type":24,"value":711},{"type":18,"tag":614,"props":3040,"children":3041},{"class":627},[3042],{"type":24,"value":2920},{"type":18,"tag":614,"props":3044,"children":3045},{"class":671},[3046],{"type":24,"value":1353},{"type":18,"tag":614,"props":3048,"children":3049},{"class":627},[3050],{"type":24,"value":2929},{"type":18,"tag":614,"props":3052,"children":3053},{"class":621},[3054],{"type":24,"value":1177},{"type":18,"tag":614,"props":3056,"children":3057},{"class":627},[3058],{"type":24,"value":3059}," yaw_dot ",{"type":18,"tag":614,"props":3061,"children":3062},{"class":621},[3063],{"type":24,"value":1056},{"type":18,"tag":614,"props":3065,"children":3066},{"class":627},[3067],{"type":24,"value":2947},{"type":18,"tag":614,"props":3069,"children":3070},{"class":616,"line":779},[3071],{"type":18,"tag":614,"props":3072,"children":3073},{},[3074],{"type":24,"value":650},{"type":18,"tag":614,"props":3076,"children":3077},{"class":616,"line":805},[3078,3082,3086],{"type":18,"tag":614,"props":3079,"children":3080},{"class":627},[3081],{"type":24,"value":696},{"type":18,"tag":614,"props":3083,"children":3084},{"class":621},[3085],{"type":24,"value":1220},{"type":18,"tag":614,"props":3087,"children":3088},{"class":627},[3089],{"type":24,"value":3090}," X",{"type":18,"tag":27,"props":3092,"children":3093},{},[3094],{"type":24,"value":3095},"Next we calculating costate, we are going in backward direction",{"type":18,"tag":599,"props":3097,"children":3100},{"className":3098,"code":3099,"language":604,"meta":8},[602],"def calc_costate(self, X, U, Lambda, dt):\n\n        x_N, y_N, yaw_N = self.hjb_equation.dphidx(X[0, -1], X[1, -1], X[2, -1],\n                                                   self.X_r[0], self.X_r[1], self.X_r[2])\n        Lambda[0, -1] = x_N\n        Lambda[1, -1] = y_N\n        Lambda[2, -1] = yaw_N\n\n\n        for i in reversed(range(1, self.pred_horizons)):\n\n            dhdx1, dhdx2, dhdx3 = self.hjb_equation.dhdx(\n                X[0, i], X[1, i], X[2, i],\n                self.X_r[0], self.X_r[1], self.X_r[2],\n                U[0, i], Lambda[0, i+1], Lambda[1, i+1]\n            )\n\n            Lambda[0, i] = Lambda[0, i+1] + dhdx1 * dt\n            Lambda[1, i] = Lambda[1, i+1] + dhdx2 * dt\n            Lambda[2, i] = Lambda[2, i+1] + dhdx3 * dt\n    \n\n        return Lambda\n",[3101],{"type":18,"tag":607,"props":3102,"children":3103},{},[3104],{"type":18,"tag":599,"props":3105,"children":3106},{"__ignoreMap":8},[3107,3128,3135,3222,3281,3318,3354,3390,3397,3404,3461,3468,3493,3527,3583,3641,3649,3656,3718,3778,3838,3846,3853],{"type":18,"tag":614,"props":3108,"children":3109},{"class":616,"line":617},[3110,3114,3118,3123],{"type":18,"tag":614,"props":3111,"children":3112},{"class":621},[3113],{"type":24,"value":664},{"type":18,"tag":614,"props":3115,"children":3116},{"class":627},[3117],{"type":24,"value":630},{"type":18,"tag":614,"props":3119,"children":3120},{"class":633},[3121],{"type":24,"value":3122},"calc_costate",{"type":18,"tag":614,"props":3124,"children":3125},{"class":627},[3126],{"type":24,"value":3127},"(self, X, U, Lambda, dt):\n",{"type":18,"tag":614,"props":3129,"children":3130},{"class":616,"line":644},[3131],{"type":18,"tag":614,"props":3132,"children":3133},{},[3134],{"type":24,"value":650},{"type":18,"tag":614,"props":3136,"children":3137},{"class":616,"line":653},[3138,3143,3147,3151,3155,3160,3164,3168,3172,3176,3181,3185,3189,3193,3197,3201,3205,3209,3213,3217],{"type":18,"tag":614,"props":3139,"children":3140},{"class":627},[3141],{"type":24,"value":3142},"        x_N, y_N, yaw_N ",{"type":18,"tag":614,"props":3144,"children":3145},{"class":621},[3146],{"type":24,"value":711},{"type":18,"tag":614,"props":3148,"children":3149},{"class":627},[3150],{"type":24,"value":630},{"type":18,"tag":614,"props":3152,"children":3153},{"class":671},[3154],{"type":24,"value":701},{"type":18,"tag":614,"props":3156,"children":3157},{"class":627},[3158],{"type":24,"value":3159},".hjb_equation.dphidx(X[",{"type":18,"tag":614,"props":3161,"children":3162},{"class":671},[3163],{"type":24,"value":867},{"type":18,"tag":614,"props":3165,"children":3166},{"class":627},[3167],{"type":24,"value":2417},{"type":18,"tag":614,"props":3169,"children":3170},{"class":621},[3171],{"type":24,"value":1046},{"type":18,"tag":614,"props":3173,"children":3174},{"class":671},[3175],{"type":24,"value":977},{"type":18,"tag":614,"props":3177,"children":3178},{"class":627},[3179],{"type":24,"value":3180},"], X[",{"type":18,"tag":614,"props":3182,"children":3183},{"class":671},[3184],{"type":24,"value":977},{"type":18,"tag":614,"props":3186,"children":3187},{"class":627},[3188],{"type":24,"value":2417},{"type":18,"tag":614,"props":3190,"children":3191},{"class":621},[3192],{"type":24,"value":1046},{"type":18,"tag":614,"props":3194,"children":3195},{"class":671},[3196],{"type":24,"value":977},{"type":18,"tag":614,"props":3198,"children":3199},{"class":627},[3200],{"type":24,"value":3180},{"type":18,"tag":614,"props":3202,"children":3203},{"class":671},[3204],{"type":24,"value":1353},{"type":18,"tag":614,"props":3206,"children":3207},{"class":627},[3208],{"type":24,"value":2417},{"type":18,"tag":614,"props":3210,"children":3211},{"class":621},[3212],{"type":24,"value":1046},{"type":18,"tag":614,"props":3214,"children":3215},{"class":671},[3216],{"type":24,"value":977},{"type":18,"tag":614,"props":3218,"children":3219},{"class":627},[3220],{"type":24,"value":3221},"],\n",{"type":18,"tag":614,"props":3223,"children":3224},{"class":616,"line":682},[3225,3230,3234,3239,3243,3248,3252,3256,3260,3264,3268,3272,3276],{"type":18,"tag":614,"props":3226,"children":3227},{"class":627},[3228],{"type":24,"value":3229},"                                                   ",{"type":18,"tag":614,"props":3231,"children":3232},{"class":671},[3233],{"type":24,"value":701},{"type":18,"tag":614,"props":3235,"children":3236},{"class":627},[3237],{"type":24,"value":3238},".X_r[",{"type":18,"tag":614,"props":3240,"children":3241},{"class":671},[3242],{"type":24,"value":867},{"type":18,"tag":614,"props":3244,"children":3245},{"class":627},[3246],{"type":24,"value":3247},"], ",{"type":18,"tag":614,"props":3249,"children":3250},{"class":671},[3251],{"type":24,"value":701},{"type":18,"tag":614,"props":3253,"children":3254},{"class":627},[3255],{"type":24,"value":3238},{"type":18,"tag":614,"props":3257,"children":3258},{"class":671},[3259],{"type":24,"value":977},{"type":18,"tag":614,"props":3261,"children":3262},{"class":627},[3263],{"type":24,"value":3247},{"type":18,"tag":614,"props":3265,"children":3266},{"class":671},[3267],{"type":24,"value":701},{"type":18,"tag":614,"props":3269,"children":3270},{"class":627},[3271],{"type":24,"value":3238},{"type":18,"tag":614,"props":3273,"children":3274},{"class":671},[3275],{"type":24,"value":1353},{"type":18,"tag":614,"props":3277,"children":3278},{"class":627},[3279],{"type":24,"value":3280},"])\n",{"type":18,"tag":614,"props":3282,"children":3283},{"class":616,"line":690},[3284,3289,3293,3297,3301,3305,3309,3313],{"type":18,"tag":614,"props":3285,"children":3286},{"class":627},[3287],{"type":24,"value":3288},"        Lambda[",{"type":18,"tag":614,"props":3290,"children":3291},{"class":671},[3292],{"type":24,"value":867},{"type":18,"tag":614,"props":3294,"children":3295},{"class":627},[3296],{"type":24,"value":2417},{"type":18,"tag":614,"props":3298,"children":3299},{"class":621},[3300],{"type":24,"value":1046},{"type":18,"tag":614,"props":3302,"children":3303},{"class":671},[3304],{"type":24,"value":977},{"type":18,"tag":614,"props":3306,"children":3307},{"class":627},[3308],{"type":24,"value":2911},{"type":18,"tag":614,"props":3310,"children":3311},{"class":621},[3312],{"type":24,"value":711},{"type":18,"tag":614,"props":3314,"children":3315},{"class":627},[3316],{"type":24,"value":3317}," x_N\n",{"type":18,"tag":614,"props":3319,"children":3320},{"class":616,"line":719},[3321,3325,3329,3333,3337,3341,3345,3349],{"type":18,"tag":614,"props":3322,"children":3323},{"class":627},[3324],{"type":24,"value":3288},{"type":18,"tag":614,"props":3326,"children":3327},{"class":671},[3328],{"type":24,"value":977},{"type":18,"tag":614,"props":3330,"children":3331},{"class":627},[3332],{"type":24,"value":2417},{"type":18,"tag":614,"props":3334,"children":3335},{"class":621},[3336],{"type":24,"value":1046},{"type":18,"tag":614,"props":3338,"children":3339},{"class":671},[3340],{"type":24,"value":977},{"type":18,"tag":614,"props":3342,"children":3343},{"class":627},[3344],{"type":24,"value":2911},{"type":18,"tag":614,"props":3346,"children":3347},{"class":621},[3348],{"type":24,"value":711},{"type":18,"tag":614,"props":3350,"children":3351},{"class":627},[3352],{"type":24,"value":3353}," y_N\n",{"type":18,"tag":614,"props":3355,"children":3356},{"class":616,"line":745},[3357,3361,3365,3369,3373,3377,3381,3385],{"type":18,"tag":614,"props":3358,"children":3359},{"class":627},[3360],{"type":24,"value":3288},{"type":18,"tag":614,"props":3362,"children":3363},{"class":671},[3364],{"type":24,"value":1353},{"type":18,"tag":614,"props":3366,"children":3367},{"class":627},[3368],{"type":24,"value":2417},{"type":18,"tag":614,"props":3370,"children":3371},{"class":621},[3372],{"type":24,"value":1046},{"type":18,"tag":614,"props":3374,"children":3375},{"class":671},[3376],{"type":24,"value":977},{"type":18,"tag":614,"props":3378,"children":3379},{"class":627},[3380],{"type":24,"value":2911},{"type":18,"tag":614,"props":3382,"children":3383},{"class":621},[3384],{"type":24,"value":711},{"type":18,"tag":614,"props":3386,"children":3387},{"class":627},[3388],{"type":24,"value":3389}," yaw_N\n",{"type":18,"tag":614,"props":3391,"children":3392},{"class":616,"line":771},[3393],{"type":18,"tag":614,"props":3394,"children":3395},{},[3396],{"type":24,"value":650},{"type":18,"tag":614,"props":3398,"children":3399},{"class":616,"line":779},[3400],{"type":18,"tag":614,"props":3401,"children":3402},{},[3403],{"type":24,"value":650},{"type":18,"tag":614,"props":3405,"children":3406},{"class":616,"line":805},[3407,3411,3415,3419,3423,3427,3432,3436,3440,3444,3448,3452,3456],{"type":18,"tag":614,"props":3408,"children":3409},{"class":627},[3410],{"type":24,"value":696},{"type":18,"tag":614,"props":3412,"children":3413},{"class":621},[3414],{"type":24,"value":2790},{"type":18,"tag":614,"props":3416,"children":3417},{"class":627},[3418],{"type":24,"value":2795},{"type":18,"tag":614,"props":3420,"children":3421},{"class":621},[3422],{"type":24,"value":2800},{"type":18,"tag":614,"props":3424,"children":3425},{"class":627},[3426],{"type":24,"value":630},{"type":18,"tag":614,"props":3428,"children":3429},{"class":671},[3430],{"type":24,"value":3431},"reversed",{"type":18,"tag":614,"props":3433,"children":3434},{"class":627},[3435],{"type":24,"value":1387},{"type":18,"tag":614,"props":3437,"children":3438},{"class":671},[3439],{"type":24,"value":2809},{"type":18,"tag":614,"props":3441,"children":3442},{"class":627},[3443],{"type":24,"value":1387},{"type":18,"tag":614,"props":3445,"children":3446},{"class":671},[3447],{"type":24,"value":977},{"type":18,"tag":614,"props":3449,"children":3450},{"class":627},[3451],{"type":24,"value":2417},{"type":18,"tag":614,"props":3453,"children":3454},{"class":671},[3455],{"type":24,"value":701},{"type":18,"tag":614,"props":3457,"children":3458},{"class":627},[3459],{"type":24,"value":3460},".pred_horizons)):\n",{"type":18,"tag":614,"props":3462,"children":3463},{"class":616,"line":831},[3464],{"type":18,"tag":614,"props":3465,"children":3466},{},[3467],{"type":24,"value":650},{"type":18,"tag":614,"props":3469,"children":3470},{"class":616,"line":839},[3471,3476,3480,3484,3488],{"type":18,"tag":614,"props":3472,"children":3473},{"class":627},[3474],{"type":24,"value":3475},"            dhdx1, dhdx2, dhdx3 ",{"type":18,"tag":614,"props":3477,"children":3478},{"class":621},[3479],{"type":24,"value":711},{"type":18,"tag":614,"props":3481,"children":3482},{"class":627},[3483],{"type":24,"value":630},{"type":18,"tag":614,"props":3485,"children":3486},{"class":671},[3487],{"type":24,"value":701},{"type":18,"tag":614,"props":3489,"children":3490},{"class":627},[3491],{"type":24,"value":3492},".hjb_equation.dhdx(\n",{"type":18,"tag":614,"props":3494,"children":3495},{"class":616,"line":875},[3496,3501,3505,3510,3514,3518,3522],{"type":18,"tag":614,"props":3497,"children":3498},{"class":627},[3499],{"type":24,"value":3500},"                X[",{"type":18,"tag":614,"props":3502,"children":3503},{"class":671},[3504],{"type":24,"value":867},{"type":18,"tag":614,"props":3506,"children":3507},{"class":627},[3508],{"type":24,"value":3509},", i], X[",{"type":18,"tag":614,"props":3511,"children":3512},{"class":671},[3513],{"type":24,"value":977},{"type":18,"tag":614,"props":3515,"children":3516},{"class":627},[3517],{"type":24,"value":3509},{"type":18,"tag":614,"props":3519,"children":3520},{"class":671},[3521],{"type":24,"value":1353},{"type":18,"tag":614,"props":3523,"children":3524},{"class":627},[3525],{"type":24,"value":3526},", i],\n",{"type":18,"tag":614,"props":3528,"children":3529},{"class":616,"line":908},[3530,3535,3539,3543,3547,3551,3555,3559,3563,3567,3571,3575,3579],{"type":18,"tag":614,"props":3531,"children":3532},{"class":627},[3533],{"type":24,"value":3534},"                ",{"type":18,"tag":614,"props":3536,"children":3537},{"class":671},[3538],{"type":24,"value":701},{"type":18,"tag":614,"props":3540,"children":3541},{"class":627},[3542],{"type":24,"value":3238},{"type":18,"tag":614,"props":3544,"children":3545},{"class":671},[3546],{"type":24,"value":867},{"type":18,"tag":614,"props":3548,"children":3549},{"class":627},[3550],{"type":24,"value":3247},{"type":18,"tag":614,"props":3552,"children":3553},{"class":671},[3554],{"type":24,"value":701},{"type":18,"tag":614,"props":3556,"children":3557},{"class":627},[3558],{"type":24,"value":3238},{"type":18,"tag":614,"props":3560,"children":3561},{"class":671},[3562],{"type":24,"value":977},{"type":18,"tag":614,"props":3564,"children":3565},{"class":627},[3566],{"type":24,"value":3247},{"type":18,"tag":614,"props":3568,"children":3569},{"class":671},[3570],{"type":24,"value":701},{"type":18,"tag":614,"props":3572,"children":3573},{"class":627},[3574],{"type":24,"value":3238},{"type":18,"tag":614,"props":3576,"children":3577},{"class":671},[3578],{"type":24,"value":1353},{"type":18,"tag":614,"props":3580,"children":3581},{"class":627},[3582],{"type":24,"value":3221},{"type":18,"tag":614,"props":3584,"children":3585},{"class":616,"line":916},[3586,3591,3595,3600,3604,3608,3612,3616,3621,3625,3629,3633,3637],{"type":18,"tag":614,"props":3587,"children":3588},{"class":627},[3589],{"type":24,"value":3590},"                U[",{"type":18,"tag":614,"props":3592,"children":3593},{"class":671},[3594],{"type":24,"value":867},{"type":18,"tag":614,"props":3596,"children":3597},{"class":627},[3598],{"type":24,"value":3599},", i], Lambda[",{"type":18,"tag":614,"props":3601,"children":3602},{"class":671},[3603],{"type":24,"value":867},{"type":18,"tag":614,"props":3605,"children":3606},{"class":627},[3607],{"type":24,"value":2898},{"type":18,"tag":614,"props":3609,"children":3610},{"class":621},[3611],{"type":24,"value":1177},{"type":18,"tag":614,"props":3613,"children":3614},{"class":671},[3615],{"type":24,"value":977},{"type":18,"tag":614,"props":3617,"children":3618},{"class":627},[3619],{"type":24,"value":3620},"], Lambda[",{"type":18,"tag":614,"props":3622,"children":3623},{"class":671},[3624],{"type":24,"value":977},{"type":18,"tag":614,"props":3626,"children":3627},{"class":627},[3628],{"type":24,"value":2898},{"type":18,"tag":614,"props":3630,"children":3631},{"class":621},[3632],{"type":24,"value":1177},{"type":18,"tag":614,"props":3634,"children":3635},{"class":671},[3636],{"type":24,"value":977},{"type":18,"tag":614,"props":3638,"children":3639},{"class":627},[3640],{"type":24,"value":872},{"type":18,"tag":614,"props":3642,"children":3643},{"class":616,"line":950},[3644],{"type":18,"tag":614,"props":3645,"children":3646},{"class":627},[3647],{"type":24,"value":3648},"            )\n",{"type":18,"tag":614,"props":3650,"children":3651},{"class":616,"line":984},[3652],{"type":18,"tag":614,"props":3653,"children":3654},{},[3655],{"type":24,"value":650},{"type":18,"tag":614,"props":3657,"children":3658},{"class":616,"line":992},[3659,3664,3668,3672,3676,3681,3685,3689,3693,3697,3701,3705,3710,3714],{"type":18,"tag":614,"props":3660,"children":3661},{"class":627},[3662],{"type":24,"value":3663},"            Lambda[",{"type":18,"tag":614,"props":3665,"children":3666},{"class":671},[3667],{"type":24,"value":867},{"type":18,"tag":614,"props":3669,"children":3670},{"class":627},[3671],{"type":24,"value":2929},{"type":18,"tag":614,"props":3673,"children":3674},{"class":621},[3675],{"type":24,"value":711},{"type":18,"tag":614,"props":3677,"children":3678},{"class":627},[3679],{"type":24,"value":3680}," Lambda[",{"type":18,"tag":614,"props":3682,"children":3683},{"class":671},[3684],{"type":24,"value":867},{"type":18,"tag":614,"props":3686,"children":3687},{"class":627},[3688],{"type":24,"value":2898},{"type":18,"tag":614,"props":3690,"children":3691},{"class":621},[3692],{"type":24,"value":1177},{"type":18,"tag":614,"props":3694,"children":3695},{"class":671},[3696],{"type":24,"value":977},{"type":18,"tag":614,"props":3698,"children":3699},{"class":627},[3700],{"type":24,"value":2911},{"type":18,"tag":614,"props":3702,"children":3703},{"class":621},[3704],{"type":24,"value":1177},{"type":18,"tag":614,"props":3706,"children":3707},{"class":627},[3708],{"type":24,"value":3709}," dhdx1 ",{"type":18,"tag":614,"props":3711,"children":3712},{"class":621},[3713],{"type":24,"value":1056},{"type":18,"tag":614,"props":3715,"children":3716},{"class":627},[3717],{"type":24,"value":2947},{"type":18,"tag":614,"props":3719,"children":3720},{"class":616,"line":1018},[3721,3725,3729,3733,3737,3741,3745,3749,3753,3757,3761,3765,3770,3774],{"type":18,"tag":614,"props":3722,"children":3723},{"class":627},[3724],{"type":24,"value":3663},{"type":18,"tag":614,"props":3726,"children":3727},{"class":671},[3728],{"type":24,"value":977},{"type":18,"tag":614,"props":3730,"children":3731},{"class":627},[3732],{"type":24,"value":2929},{"type":18,"tag":614,"props":3734,"children":3735},{"class":621},[3736],{"type":24,"value":711},{"type":18,"tag":614,"props":3738,"children":3739},{"class":627},[3740],{"type":24,"value":3680},{"type":18,"tag":614,"props":3742,"children":3743},{"class":671},[3744],{"type":24,"value":977},{"type":18,"tag":614,"props":3746,"children":3747},{"class":627},[3748],{"type":24,"value":2898},{"type":18,"tag":614,"props":3750,"children":3751},{"class":621},[3752],{"type":24,"value":1177},{"type":18,"tag":614,"props":3754,"children":3755},{"class":671},[3756],{"type":24,"value":977},{"type":18,"tag":614,"props":3758,"children":3759},{"class":627},[3760],{"type":24,"value":2911},{"type":18,"tag":614,"props":3762,"children":3763},{"class":621},[3764],{"type":24,"value":1177},{"type":18,"tag":614,"props":3766,"children":3767},{"class":627},[3768],{"type":24,"value":3769}," dhdx2 ",{"type":18,"tag":614,"props":3771,"children":3772},{"class":621},[3773],{"type":24,"value":1056},{"type":18,"tag":614,"props":3775,"children":3776},{"class":627},[3777],{"type":24,"value":2947},{"type":18,"tag":614,"props":3779,"children":3780},{"class":616,"line":1026},[3781,3785,3789,3793,3797,3801,3805,3809,3813,3817,3821,3825,3830,3834],{"type":18,"tag":614,"props":3782,"children":3783},{"class":627},[3784],{"type":24,"value":3663},{"type":18,"tag":614,"props":3786,"children":3787},{"class":671},[3788],{"type":24,"value":1353},{"type":18,"tag":614,"props":3790,"children":3791},{"class":627},[3792],{"type":24,"value":2929},{"type":18,"tag":614,"props":3794,"children":3795},{"class":621},[3796],{"type":24,"value":711},{"type":18,"tag":614,"props":3798,"children":3799},{"class":627},[3800],{"type":24,"value":3680},{"type":18,"tag":614,"props":3802,"children":3803},{"class":671},[3804],{"type":24,"value":1353},{"type":18,"tag":614,"props":3806,"children":3807},{"class":627},[3808],{"type":24,"value":2898},{"type":18,"tag":614,"props":3810,"children":3811},{"class":621},[3812],{"type":24,"value":1177},{"type":18,"tag":614,"props":3814,"children":3815},{"class":671},[3816],{"type":24,"value":977},{"type":18,"tag":614,"props":3818,"children":3819},{"class":627},[3820],{"type":24,"value":2911},{"type":18,"tag":614,"props":3822,"children":3823},{"class":621},[3824],{"type":24,"value":1177},{"type":18,"tag":614,"props":3826,"children":3827},{"class":627},[3828],{"type":24,"value":3829}," dhdx3 ",{"type":18,"tag":614,"props":3831,"children":3832},{"class":621},[3833],{"type":24,"value":1056},{"type":18,"tag":614,"props":3835,"children":3836},{"class":627},[3837],{"type":24,"value":2947},{"type":18,"tag":614,"props":3839,"children":3840},{"class":616,"line":1068},[3841],{"type":18,"tag":614,"props":3842,"children":3843},{"class":627},[3844],{"type":24,"value":3845},"    \n",{"type":18,"tag":614,"props":3847,"children":3848},{"class":616,"line":1108},[3849],{"type":18,"tag":614,"props":3850,"children":3851},{},[3852],{"type":24,"value":650},{"type":18,"tag":614,"props":3854,"children":3855},{"class":616,"line":1202},[3856,3860,3864],{"type":18,"tag":614,"props":3857,"children":3858},{"class":627},[3859],{"type":24,"value":696},{"type":18,"tag":614,"props":3861,"children":3862},{"class":621},[3863],{"type":24,"value":1220},{"type":18,"tag":614,"props":3865,"children":3866},{"class":627},[3867],{"type":24,"value":3868}," Lambda",{"type":18,"tag":27,"props":3870,"children":3871},{},[3872],{"type":24,"value":3873},"And finally, calculating Newton F Function",{"type":18,"tag":599,"props":3875,"children":3878},{"className":3876,"code":3877,"language":604,"meta":8},[602],"def calc_f(self, X, U, Lambda, Mu, dt):\n\n        X_new = self.calc_state(X, U, dt)\n\n        Lambda_new = self.calc_costate(X_new, U, Lambda, dt)\n\n        F = np.zeros((self.u_dim, self.pred_horizons))\n\n        for i in range(self.pred_horizons):\n            dhdu1, dhdu2 = self.hjb_equation.dhdu(X_new[2, i], U[0, i], U[1, i],\n                                                  self.U_r[0], self.U_r[1],\n                                                  Lambda_new[0, i+1], Lambda_new[1, i+1], Lambda_new[2, i+1],\n                                                  Mu[0, i], Mu[1, i])\n            F[0, i] = dhdu1\n            F[1, i] = dhdu2\n            \n        F = F.T.ravel().reshape(-1, 1)\n\n        return F\n",[3879],{"type":18,"tag":607,"props":3880,"children":3881},{},[3882],{"type":18,"tag":599,"props":3883,"children":3884},{"__ignoreMap":8},[3885,3906,3913,3938,3945,3970,3977,4009,4016,4055,4104,4145,4214,4239,4264,4288,4295,4331,4338],{"type":18,"tag":614,"props":3886,"children":3887},{"class":616,"line":617},[3888,3892,3896,3901],{"type":18,"tag":614,"props":3889,"children":3890},{"class":621},[3891],{"type":24,"value":664},{"type":18,"tag":614,"props":3893,"children":3894},{"class":627},[3895],{"type":24,"value":630},{"type":18,"tag":614,"props":3897,"children":3898},{"class":633},[3899],{"type":24,"value":3900},"calc_f",{"type":18,"tag":614,"props":3902,"children":3903},{"class":627},[3904],{"type":24,"value":3905},"(self, X, U, Lambda, Mu, dt):\n",{"type":18,"tag":614,"props":3907,"children":3908},{"class":616,"line":644},[3909],{"type":18,"tag":614,"props":3910,"children":3911},{},[3912],{"type":24,"value":650},{"type":18,"tag":614,"props":3914,"children":3915},{"class":616,"line":653},[3916,3921,3925,3929,3933],{"type":18,"tag":614,"props":3917,"children":3918},{"class":627},[3919],{"type":24,"value":3920},"        X_new ",{"type":18,"tag":614,"props":3922,"children":3923},{"class":621},[3924],{"type":24,"value":711},{"type":18,"tag":614,"props":3926,"children":3927},{"class":627},[3928],{"type":24,"value":630},{"type":18,"tag":614,"props":3930,"children":3931},{"class":671},[3932],{"type":24,"value":701},{"type":18,"tag":614,"props":3934,"children":3935},{"class":627},[3936],{"type":24,"value":3937},".calc_state(X, U, dt)\n",{"type":18,"tag":614,"props":3939,"children":3940},{"class":616,"line":682},[3941],{"type":18,"tag":614,"props":3942,"children":3943},{},[3944],{"type":24,"value":650},{"type":18,"tag":614,"props":3946,"children":3947},{"class":616,"line":690},[3948,3953,3957,3961,3965],{"type":18,"tag":614,"props":3949,"children":3950},{"class":627},[3951],{"type":24,"value":3952},"        Lambda_new ",{"type":18,"tag":614,"props":3954,"children":3955},{"class":621},[3956],{"type":24,"value":711},{"type":18,"tag":614,"props":3958,"children":3959},{"class":627},[3960],{"type":24,"value":630},{"type":18,"tag":614,"props":3962,"children":3963},{"class":671},[3964],{"type":24,"value":701},{"type":18,"tag":614,"props":3966,"children":3967},{"class":627},[3968],{"type":24,"value":3969},".calc_costate(X_new, U, Lambda, dt)\n",{"type":18,"tag":614,"props":3971,"children":3972},{"class":616,"line":719},[3973],{"type":18,"tag":614,"props":3974,"children":3975},{},[3976],{"type":24,"value":650},{"type":18,"tag":614,"props":3978,"children":3979},{"class":616,"line":745},[3980,3985,3989,3993,3997,4001,4005],{"type":18,"tag":614,"props":3981,"children":3982},{"class":627},[3983],{"type":24,"value":3984},"        F ",{"type":18,"tag":614,"props":3986,"children":3987},{"class":621},[3988],{"type":24,"value":711},{"type":18,"tag":614,"props":3990,"children":3991},{"class":627},[3992],{"type":24,"value":2469},{"type":18,"tag":614,"props":3994,"children":3995},{"class":671},[3996],{"type":24,"value":701},{"type":18,"tag":614,"props":3998,"children":3999},{"class":627},[4000],{"type":24,"value":2478},{"type":18,"tag":614,"props":4002,"children":4003},{"class":671},[4004],{"type":24,"value":701},{"type":18,"tag":614,"props":4006,"children":4007},{"class":627},[4008],{"type":24,"value":2487},{"type":18,"tag":614,"props":4010,"children":4011},{"class":616,"line":771},[4012],{"type":18,"tag":614,"props":4013,"children":4014},{},[4015],{"type":24,"value":650},{"type":18,"tag":614,"props":4017,"children":4018},{"class":616,"line":779},[4019,4023,4027,4031,4035,4039,4043,4047,4051],{"type":18,"tag":614,"props":4020,"children":4021},{"class":627},[4022],{"type":24,"value":696},{"type":18,"tag":614,"props":4024,"children":4025},{"class":621},[4026],{"type":24,"value":2790},{"type":18,"tag":614,"props":4028,"children":4029},{"class":627},[4030],{"type":24,"value":2795},{"type":18,"tag":614,"props":4032,"children":4033},{"class":621},[4034],{"type":24,"value":2800},{"type":18,"tag":614,"props":4036,"children":4037},{"class":627},[4038],{"type":24,"value":630},{"type":18,"tag":614,"props":4040,"children":4041},{"class":671},[4042],{"type":24,"value":2809},{"type":18,"tag":614,"props":4044,"children":4045},{"class":627},[4046],{"type":24,"value":1387},{"type":18,"tag":614,"props":4048,"children":4049},{"class":671},[4050],{"type":24,"value":701},{"type":18,"tag":614,"props":4052,"children":4053},{"class":627},[4054],{"type":24,"value":2822},{"type":18,"tag":614,"props":4056,"children":4057},{"class":616,"line":805},[4058,4063,4067,4071,4075,4080,4084,4088,4092,4096,4100],{"type":18,"tag":614,"props":4059,"children":4060},{"class":627},[4061],{"type":24,"value":4062},"            dhdu1, dhdu2 ",{"type":18,"tag":614,"props":4064,"children":4065},{"class":621},[4066],{"type":24,"value":711},{"type":18,"tag":614,"props":4068,"children":4069},{"class":627},[4070],{"type":24,"value":630},{"type":18,"tag":614,"props":4072,"children":4073},{"class":671},[4074],{"type":24,"value":701},{"type":18,"tag":614,"props":4076,"children":4077},{"class":627},[4078],{"type":24,"value":4079},".hjb_equation.dhdu(X_new[",{"type":18,"tag":614,"props":4081,"children":4082},{"class":671},[4083],{"type":24,"value":1353},{"type":18,"tag":614,"props":4085,"children":4086},{"class":627},[4087],{"type":24,"value":2856},{"type":18,"tag":614,"props":4089,"children":4090},{"class":671},[4091],{"type":24,"value":867},{"type":18,"tag":614,"props":4093,"children":4094},{"class":627},[4095],{"type":24,"value":2856},{"type":18,"tag":614,"props":4097,"children":4098},{"class":671},[4099],{"type":24,"value":977},{"type":18,"tag":614,"props":4101,"children":4102},{"class":627},[4103],{"type":24,"value":3526},{"type":18,"tag":614,"props":4105,"children":4106},{"class":616,"line":831},[4107,4112,4116,4121,4125,4129,4133,4137,4141],{"type":18,"tag":614,"props":4108,"children":4109},{"class":627},[4110],{"type":24,"value":4111},"                                                  ",{"type":18,"tag":614,"props":4113,"children":4114},{"class":671},[4115],{"type":24,"value":701},{"type":18,"tag":614,"props":4117,"children":4118},{"class":627},[4119],{"type":24,"value":4120},".U_r[",{"type":18,"tag":614,"props":4122,"children":4123},{"class":671},[4124],{"type":24,"value":867},{"type":18,"tag":614,"props":4126,"children":4127},{"class":627},[4128],{"type":24,"value":3247},{"type":18,"tag":614,"props":4130,"children":4131},{"class":671},[4132],{"type":24,"value":701},{"type":18,"tag":614,"props":4134,"children":4135},{"class":627},[4136],{"type":24,"value":4120},{"type":18,"tag":614,"props":4138,"children":4139},{"class":671},[4140],{"type":24,"value":977},{"type":18,"tag":614,"props":4142,"children":4143},{"class":627},[4144],{"type":24,"value":3221},{"type":18,"tag":614,"props":4146,"children":4147},{"class":616,"line":839},[4148,4153,4157,4161,4165,4169,4174,4178,4182,4186,4190,4194,4198,4202,4206,4210],{"type":18,"tag":614,"props":4149,"children":4150},{"class":627},[4151],{"type":24,"value":4152},"                                                  Lambda_new[",{"type":18,"tag":614,"props":4154,"children":4155},{"class":671},[4156],{"type":24,"value":867},{"type":18,"tag":614,"props":4158,"children":4159},{"class":627},[4160],{"type":24,"value":2898},{"type":18,"tag":614,"props":4162,"children":4163},{"class":621},[4164],{"type":24,"value":1177},{"type":18,"tag":614,"props":4166,"children":4167},{"class":671},[4168],{"type":24,"value":977},{"type":18,"tag":614,"props":4170,"children":4171},{"class":627},[4172],{"type":24,"value":4173},"], Lambda_new[",{"type":18,"tag":614,"props":4175,"children":4176},{"class":671},[4177],{"type":24,"value":977},{"type":18,"tag":614,"props":4179,"children":4180},{"class":627},[4181],{"type":24,"value":2898},{"type":18,"tag":614,"props":4183,"children":4184},{"class":621},[4185],{"type":24,"value":1177},{"type":18,"tag":614,"props":4187,"children":4188},{"class":671},[4189],{"type":24,"value":977},{"type":18,"tag":614,"props":4191,"children":4192},{"class":627},[4193],{"type":24,"value":4173},{"type":18,"tag":614,"props":4195,"children":4196},{"class":671},[4197],{"type":24,"value":1353},{"type":18,"tag":614,"props":4199,"children":4200},{"class":627},[4201],{"type":24,"value":2898},{"type":18,"tag":614,"props":4203,"children":4204},{"class":621},[4205],{"type":24,"value":1177},{"type":18,"tag":614,"props":4207,"children":4208},{"class":671},[4209],{"type":24,"value":977},{"type":18,"tag":614,"props":4211,"children":4212},{"class":627},[4213],{"type":24,"value":3221},{"type":18,"tag":614,"props":4215,"children":4216},{"class":616,"line":875},[4217,4222,4226,4231,4235],{"type":18,"tag":614,"props":4218,"children":4219},{"class":627},[4220],{"type":24,"value":4221},"                                                  Mu[",{"type":18,"tag":614,"props":4223,"children":4224},{"class":671},[4225],{"type":24,"value":867},{"type":18,"tag":614,"props":4227,"children":4228},{"class":627},[4229],{"type":24,"value":4230},", i], Mu[",{"type":18,"tag":614,"props":4232,"children":4233},{"class":671},[4234],{"type":24,"value":977},{"type":18,"tag":614,"props":4236,"children":4237},{"class":627},[4238],{"type":24,"value":2873},{"type":18,"tag":614,"props":4240,"children":4241},{"class":616,"line":908},[4242,4247,4251,4255,4259],{"type":18,"tag":614,"props":4243,"children":4244},{"class":627},[4245],{"type":24,"value":4246},"            F[",{"type":18,"tag":614,"props":4248,"children":4249},{"class":671},[4250],{"type":24,"value":867},{"type":18,"tag":614,"props":4252,"children":4253},{"class":627},[4254],{"type":24,"value":2929},{"type":18,"tag":614,"props":4256,"children":4257},{"class":621},[4258],{"type":24,"value":711},{"type":18,"tag":614,"props":4260,"children":4261},{"class":627},[4262],{"type":24,"value":4263}," dhdu1\n",{"type":18,"tag":614,"props":4265,"children":4266},{"class":616,"line":916},[4267,4271,4275,4279,4283],{"type":18,"tag":614,"props":4268,"children":4269},{"class":627},[4270],{"type":24,"value":4246},{"type":18,"tag":614,"props":4272,"children":4273},{"class":671},[4274],{"type":24,"value":977},{"type":18,"tag":614,"props":4276,"children":4277},{"class":627},[4278],{"type":24,"value":2929},{"type":18,"tag":614,"props":4280,"children":4281},{"class":621},[4282],{"type":24,"value":711},{"type":18,"tag":614,"props":4284,"children":4285},{"class":627},[4286],{"type":24,"value":4287}," dhdu2\n",{"type":18,"tag":614,"props":4289,"children":4290},{"class":616,"line":950},[4291],{"type":18,"tag":614,"props":4292,"children":4293},{"class":627},[4294],{"type":24,"value":2881},{"type":18,"tag":614,"props":4296,"children":4297},{"class":616,"line":984},[4298,4302,4306,4311,4315,4319,4323,4327],{"type":18,"tag":614,"props":4299,"children":4300},{"class":627},[4301],{"type":24,"value":3984},{"type":18,"tag":614,"props":4303,"children":4304},{"class":621},[4305],{"type":24,"value":711},{"type":18,"tag":614,"props":4307,"children":4308},{"class":627},[4309],{"type":24,"value":4310}," F.T.ravel().reshape(",{"type":18,"tag":614,"props":4312,"children":4313},{"class":621},[4314],{"type":24,"value":1046},{"type":18,"tag":614,"props":4316,"children":4317},{"class":671},[4318],{"type":24,"value":977},{"type":18,"tag":614,"props":4320,"children":4321},{"class":627},[4322],{"type":24,"value":2417},{"type":18,"tag":614,"props":4324,"children":4325},{"class":671},[4326],{"type":24,"value":977},{"type":18,"tag":614,"props":4328,"children":4329},{"class":627},[4330],{"type":24,"value":1423},{"type":18,"tag":614,"props":4332,"children":4333},{"class":616,"line":992},[4334],{"type":18,"tag":614,"props":4335,"children":4336},{},[4337],{"type":24,"value":650},{"type":18,"tag":614,"props":4339,"children":4340},{"class":616,"line":1018},[4341,4345,4349],{"type":18,"tag":614,"props":4342,"children":4343},{"class":627},[4344],{"type":24,"value":696},{"type":18,"tag":614,"props":4346,"children":4347},{"class":621},[4348],{"type":24,"value":1220},{"type":18,"tag":614,"props":4350,"children":4351},{"class":627},[4352],{"type":24,"value":4353}," F",{"type":18,"tag":27,"props":4355,"children":4356},{},[4357,4359,4365,4367,4372],{"type":24,"value":4358},"Now let's introduce Continuation method for Function ",{"type":18,"tag":4360,"props":4361,"children":4362},"code-inline",{},[4363],{"type":24,"value":4364},"F",{"type":24,"value":4366},", you can look at the ",{"type":18,"tag":170,"props":4368,"children":4369},{},[4370],{"type":24,"value":4371}," Continuation ",{"type":24,"value":4373}," part.",{"type":18,"tag":599,"props":4375,"children":4378},{"className":4376,"code":4377,"language":604,"meta":8},[602],"# Time step horizons\ndt = self.tf * (1-np.exp(-self.alpha*time)) / self.pred_horizons\n# F(x,u,t+h)\nF = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u,t+h)\nx_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, 0], U[0, 0], U[1, 0])\nX[:, 0] = X[:, 0] + np.array([x_dot, y_dot, yaw_dot]) * self.ht\nFxt = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u+hdx,t+h)\nFuxt = self.calc_f(X, U + self.dU*self.ht, Lambda, Mu , dt)\n\n# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n",[4379],{"type":18,"tag":607,"props":4380,"children":4381},{},[4382],{"type":18,"tag":599,"props":4383,"children":4384},{"__ignoreMap":8},[4385,4393,4477,4485,4510,4518,4591,4649,4673,4681,4736,4743,4751,4793],{"type":18,"tag":614,"props":4386,"children":4387},{"class":616,"line":617},[4388],{"type":18,"tag":614,"props":4389,"children":4390},{"class":1851},[4391],{"type":24,"value":4392},"# Time step horizons\n",{"type":18,"tag":614,"props":4394,"children":4395},{"class":616,"line":644},[4396,4400,4404,4408,4412,4416,4420,4425,4429,4433,4438,4442,4446,4451,4455,4460,4464,4468,4472],{"type":18,"tag":614,"props":4397,"children":4398},{"class":627},[4399],{"type":24,"value":2712},{"type":18,"tag":614,"props":4401,"children":4402},{"class":621},[4403],{"type":24,"value":711},{"type":18,"tag":614,"props":4405,"children":4406},{"class":627},[4407],{"type":24,"value":630},{"type":18,"tag":614,"props":4409,"children":4410},{"class":671},[4411],{"type":24,"value":701},{"type":18,"tag":614,"props":4413,"children":4414},{"class":627},[4415],{"type":24,"value":2103},{"type":18,"tag":614,"props":4417,"children":4418},{"class":621},[4419],{"type":24,"value":1056},{"type":18,"tag":614,"props":4421,"children":4422},{"class":627},[4423],{"type":24,"value":4424}," (",{"type":18,"tag":614,"props":4426,"children":4427},{"class":671},[4428],{"type":24,"value":977},{"type":18,"tag":614,"props":4430,"children":4431},{"class":621},[4432],{"type":24,"value":1046},{"type":18,"tag":614,"props":4434,"children":4435},{"class":627},[4436],{"type":24,"value":4437},"np.exp(",{"type":18,"tag":614,"props":4439,"children":4440},{"class":621},[4441],{"type":24,"value":1046},{"type":18,"tag":614,"props":4443,"children":4444},{"class":671},[4445],{"type":24,"value":701},{"type":18,"tag":614,"props":4447,"children":4448},{"class":627},[4449],{"type":24,"value":4450},".alpha",{"type":18,"tag":614,"props":4452,"children":4453},{"class":621},[4454],{"type":24,"value":1056},{"type":18,"tag":614,"props":4456,"children":4457},{"class":627},[4458],{"type":24,"value":4459},"time)) ",{"type":18,"tag":614,"props":4461,"children":4462},{"class":621},[4463],{"type":24,"value":1414},{"type":18,"tag":614,"props":4465,"children":4466},{"class":627},[4467],{"type":24,"value":630},{"type":18,"tag":614,"props":4469,"children":4470},{"class":671},[4471],{"type":24,"value":701},{"type":18,"tag":614,"props":4473,"children":4474},{"class":627},[4475],{"type":24,"value":4476},".pred_horizons\n",{"type":18,"tag":614,"props":4478,"children":4479},{"class":616,"line":653},[4480],{"type":18,"tag":614,"props":4481,"children":4482},{"class":1851},[4483],{"type":24,"value":4484},"# F(x,u,t+h)\n",{"type":18,"tag":614,"props":4486,"children":4487},{"class":616,"line":682},[4488,4493,4497,4501,4505],{"type":18,"tag":614,"props":4489,"children":4490},{"class":627},[4491],{"type":24,"value":4492},"F ",{"type":18,"tag":614,"props":4494,"children":4495},{"class":621},[4496],{"type":24,"value":711},{"type":18,"tag":614,"props":4498,"children":4499},{"class":627},[4500],{"type":24,"value":630},{"type":18,"tag":614,"props":4502,"children":4503},{"class":671},[4504],{"type":24,"value":701},{"type":18,"tag":614,"props":4506,"children":4507},{"class":627},[4508],{"type":24,"value":4509},".calc_f(X, U, Lambda, Mu, dt)\n",{"type":18,"tag":614,"props":4511,"children":4512},{"class":616,"line":690},[4513],{"type":18,"tag":614,"props":4514,"children":4515},{"class":1851},[4516],{"type":24,"value":4517},"# F(x+hdx,u,t+h)\n",{"type":18,"tag":614,"props":4519,"children":4520},{"class":616,"line":719},[4521,4526,4530,4534,4538,4542,4546,4550,4554,4559,4563,4567,4571,4575,4579,4583,4587],{"type":18,"tag":614,"props":4522,"children":4523},{"class":627},[4524],{"type":24,"value":4525},"x_dot, y_dot, yaw_dot ",{"type":18,"tag":614,"props":4527,"children":4528},{"class":621},[4529],{"type":24,"value":711},{"type":18,"tag":614,"props":4531,"children":4532},{"class":627},[4533],{"type":24,"value":630},{"type":18,"tag":614,"props":4535,"children":4536},{"class":671},[4537],{"type":24,"value":701},{"type":18,"tag":614,"props":4539,"children":4540},{"class":627},[4541],{"type":24,"value":2847},{"type":18,"tag":614,"props":4543,"children":4544},{"class":671},[4545],{"type":24,"value":1353},{"type":18,"tag":614,"props":4547,"children":4548},{"class":627},[4549],{"type":24,"value":2417},{"type":18,"tag":614,"props":4551,"children":4552},{"class":671},[4553],{"type":24,"value":867},{"type":18,"tag":614,"props":4555,"children":4556},{"class":627},[4557],{"type":24,"value":4558},"], U[",{"type":18,"tag":614,"props":4560,"children":4561},{"class":671},[4562],{"type":24,"value":867},{"type":18,"tag":614,"props":4564,"children":4565},{"class":627},[4566],{"type":24,"value":2417},{"type":18,"tag":614,"props":4568,"children":4569},{"class":671},[4570],{"type":24,"value":867},{"type":18,"tag":614,"props":4572,"children":4573},{"class":627},[4574],{"type":24,"value":4558},{"type":18,"tag":614,"props":4576,"children":4577},{"class":671},[4578],{"type":24,"value":977},{"type":18,"tag":614,"props":4580,"children":4581},{"class":627},[4582],{"type":24,"value":2417},{"type":18,"tag":614,"props":4584,"children":4585},{"class":671},[4586],{"type":24,"value":867},{"type":18,"tag":614,"props":4588,"children":4589},{"class":627},[4590],{"type":24,"value":3280},{"type":18,"tag":614,"props":4592,"children":4593},{"class":616,"line":745},[4594,4599,4603,4607,4611,4616,4620,4624,4628,4633,4637,4641,4645],{"type":18,"tag":614,"props":4595,"children":4596},{"class":627},[4597],{"type":24,"value":4598},"X[:, ",{"type":18,"tag":614,"props":4600,"children":4601},{"class":671},[4602],{"type":24,"value":867},{"type":18,"tag":614,"props":4604,"children":4605},{"class":627},[4606],{"type":24,"value":2911},{"type":18,"tag":614,"props":4608,"children":4609},{"class":621},[4610],{"type":24,"value":711},{"type":18,"tag":614,"props":4612,"children":4613},{"class":627},[4614],{"type":24,"value":4615}," X[:, ",{"type":18,"tag":614,"props":4617,"children":4618},{"class":671},[4619],{"type":24,"value":867},{"type":18,"tag":614,"props":4621,"children":4622},{"class":627},[4623],{"type":24,"value":2911},{"type":18,"tag":614,"props":4625,"children":4626},{"class":621},[4627],{"type":24,"value":1177},{"type":18,"tag":614,"props":4629,"children":4630},{"class":627},[4631],{"type":24,"value":4632}," np.array([x_dot, y_dot, yaw_dot]) ",{"type":18,"tag":614,"props":4634,"children":4635},{"class":621},[4636],{"type":24,"value":1056},{"type":18,"tag":614,"props":4638,"children":4639},{"class":627},[4640],{"type":24,"value":630},{"type":18,"tag":614,"props":4642,"children":4643},{"class":671},[4644],{"type":24,"value":701},{"type":18,"tag":614,"props":4646,"children":4647},{"class":627},[4648],{"type":24,"value":2058},{"type":18,"tag":614,"props":4650,"children":4651},{"class":616,"line":771},[4652,4657,4661,4665,4669],{"type":18,"tag":614,"props":4653,"children":4654},{"class":627},[4655],{"type":24,"value":4656},"Fxt ",{"type":18,"tag":614,"props":4658,"children":4659},{"class":621},[4660],{"type":24,"value":711},{"type":18,"tag":614,"props":4662,"children":4663},{"class":627},[4664],{"type":24,"value":630},{"type":18,"tag":614,"props":4666,"children":4667},{"class":671},[4668],{"type":24,"value":701},{"type":18,"tag":614,"props":4670,"children":4671},{"class":627},[4672],{"type":24,"value":4509},{"type":18,"tag":614,"props":4674,"children":4675},{"class":616,"line":779},[4676],{"type":18,"tag":614,"props":4677,"children":4678},{"class":1851},[4679],{"type":24,"value":4680},"# F(x+hdx,u+hdx,t+h)\n",{"type":18,"tag":614,"props":4682,"children":4683},{"class":616,"line":805},[4684,4689,4693,4697,4701,4706,4710,4714,4718,4723,4727,4731],{"type":18,"tag":614,"props":4685,"children":4686},{"class":627},[4687],{"type":24,"value":4688},"Fuxt ",{"type":18,"tag":614,"props":4690,"children":4691},{"class":621},[4692],{"type":24,"value":711},{"type":18,"tag":614,"props":4694,"children":4695},{"class":627},[4696],{"type":24,"value":630},{"type":18,"tag":614,"props":4698,"children":4699},{"class":671},[4700],{"type":24,"value":701},{"type":18,"tag":614,"props":4702,"children":4703},{"class":627},[4704],{"type":24,"value":4705},".calc_f(X, U ",{"type":18,"tag":614,"props":4707,"children":4708},{"class":621},[4709],{"type":24,"value":1177},{"type":18,"tag":614,"props":4711,"children":4712},{"class":627},[4713],{"type":24,"value":630},{"type":18,"tag":614,"props":4715,"children":4716},{"class":671},[4717],{"type":24,"value":701},{"type":18,"tag":614,"props":4719,"children":4720},{"class":627},[4721],{"type":24,"value":4722},".dU",{"type":18,"tag":614,"props":4724,"children":4725},{"class":621},[4726],{"type":24,"value":1056},{"type":18,"tag":614,"props":4728,"children":4729},{"class":671},[4730],{"type":24,"value":701},{"type":18,"tag":614,"props":4732,"children":4733},{"class":627},[4734],{"type":24,"value":4735},".ht, Lambda, Mu , dt)\n",{"type":18,"tag":614,"props":4737,"children":4738},{"class":616,"line":831},[4739],{"type":18,"tag":614,"props":4740,"children":4741},{},[4742],{"type":24,"value":650},{"type":18,"tag":614,"props":4744,"children":4745},{"class":616,"line":839},[4746],{"type":18,"tag":614,"props":4747,"children":4748},{"class":1851},[4749],{"type":24,"value":4750},"# Define right-left handside equation\n",{"type":18,"tag":614,"props":4752,"children":4753},{"class":616,"line":875},[4754,4759,4763,4768,4772,4777,4781,4785,4789],{"type":18,"tag":614,"props":4755,"children":4756},{"class":627},[4757],{"type":24,"value":4758},"left ",{"type":18,"tag":614,"props":4760,"children":4761},{"class":621},[4762],{"type":24,"value":711},{"type":18,"tag":614,"props":4764,"children":4765},{"class":627},[4766],{"type":24,"value":4767}," (Fuxt ",{"type":18,"tag":614,"props":4769,"children":4770},{"class":621},[4771],{"type":24,"value":1046},{"type":18,"tag":614,"props":4773,"children":4774},{"class":627},[4775],{"type":24,"value":4776}," Fxt) ",{"type":18,"tag":614,"props":4778,"children":4779},{"class":621},[4780],{"type":24,"value":1414},{"type":18,"tag":614,"props":4782,"children":4783},{"class":627},[4784],{"type":24,"value":630},{"type":18,"tag":614,"props":4786,"children":4787},{"class":671},[4788],{"type":24,"value":701},{"type":18,"tag":614,"props":4790,"children":4791},{"class":627},[4792],{"type":24,"value":2058},{"type":18,"tag":614,"props":4794,"children":4795},{"class":616,"line":908},[4796,4801,4805,4809,4813,4817,4821,4825,4830,4834,4839,4843,4848,4852,4856],{"type":18,"tag":614,"props":4797,"children":4798},{"class":627},[4799],{"type":24,"value":4800},"right ",{"type":18,"tag":614,"props":4802,"children":4803},{"class":621},[4804],{"type":24,"value":711},{"type":18,"tag":614,"props":4806,"children":4807},{"class":627},[4808],{"type":24,"value":630},{"type":18,"tag":614,"props":4810,"children":4811},{"class":621},[4812],{"type":24,"value":1046},{"type":18,"tag":614,"props":4814,"children":4815},{"class":671},[4816],{"type":24,"value":701},{"type":18,"tag":614,"props":4818,"children":4819},{"class":627},[4820],{"type":24,"value":2033},{"type":18,"tag":614,"props":4822,"children":4823},{"class":621},[4824],{"type":24,"value":1056},{"type":18,"tag":614,"props":4826,"children":4827},{"class":627},[4828],{"type":24,"value":4829}," F ",{"type":18,"tag":614,"props":4831,"children":4832},{"class":621},[4833],{"type":24,"value":1046},{"type":18,"tag":614,"props":4835,"children":4836},{"class":627},[4837],{"type":24,"value":4838}," (Fxt ",{"type":18,"tag":614,"props":4840,"children":4841},{"class":621},[4842],{"type":24,"value":1046},{"type":18,"tag":614,"props":4844,"children":4845},{"class":627},[4846],{"type":24,"value":4847}," F)",{"type":18,"tag":614,"props":4849,"children":4850},{"class":621},[4851],{"type":24,"value":1414},{"type":18,"tag":614,"props":4853,"children":4854},{"class":671},[4855],{"type":24,"value":701},{"type":18,"tag":614,"props":4857,"children":4858},{"class":627},[4859],{"type":24,"value":4860},".ht",{"type":18,"tag":27,"props":4862,"children":4863},{},[4864,4866,4870],{"type":24,"value":4865},"Here is the crucial part, we need to implement GMRES solver for our ",{"type":18,"tag":4360,"props":4867,"children":4868},{},[4869],{"type":24,"value":4364},{"type":24,"value":4871}," function to obtain solution vector.",{"type":18,"tag":599,"props":4873,"children":4876},{"className":4874,"code":4875,"language":604,"meta":8},[602],"# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n\n# Define iterations\nm = (self.u_dim ) * self.pred_horizons\n# Define r0\nr0 = right - left\n# print(r0)\n\n# GMRES\nVm = np.zeros((m, m+1))\nVm[:, 0:1] = r0 / np.linalg.norm(r0)\n# print(\"Vm\", Vm[:, 0])\nHm = np.zeros((m+1, m))\n# print(Vm[:, 0])\n\n\nfor i in range(m):\n    Fuxt = self.calc_f(\n        X, U + Vm[:, i:i+1].reshape(self.u_dim, self.pred_horizons, order='F') * self.ht,\n        Lambda, Mu,\n        dt\n    )\n\n    Av = (Fuxt - Fxt) / self.ht\n\n    for k in range(i+1):\n        Hm[k, i] = np.dot(Av.T, Vm[:, k:k+1])\n\n    temp_vec = np.zeros((m, 1))\n\n    for k in range(i+1):\n        temp_vec = temp_vec + np.dot(Hm[k, i], Vm[:, k:k+1])\n\n    v_hat = Av - temp_vec\n\n    Hm[i+1, i] = np.linalg.norm(v_hat)\n\n    Vm[:,i+1:i+2] = v_hat/Hm[i+1, i]\n\ne = np.zeros((m+1, 1))\ne[0, 0] = 1.0\ngm = np.linalg.norm(r0) * e\n# print(gm)\n\nUTMat, gm = self.ToUTMat(Hm, gm, m)\n\nmin_y = np.zeros((m, 1))\n\nfor i in range(m):\n    min_y[i][0] = (gm[i, 0] - np.dot(UTMat[i:i+1 ,:] ,min_y))/UTMat[i, i]\n\ndU_new = self.dU + np.dot(Vm[:, 0:m], min_y).reshape(self.u_dim, self.pred_horizons, order='F')\n\nself.dU = dU_new\n\nU = U + self.dU * self.ht\n",[4877],{"type":18,"tag":607,"props":4878,"children":4879},{},[4880],{"type":18,"tag":599,"props":4881,"children":4882},{"__ignoreMap":8},[4883,4890,4929,4992,4999,5007,5048,5056,5082,5090,5097,5105,5135,5177,5185,5215,5223,5230,5237,5265,5290,5375,5383,5391,5399,5406,5446,5453,5499,5528,5535,5560,5567,5610,5648,5655,5681,5688,5717,5725,5790,5798,5835,5872,5899,5908,5916,5942,5950,5975,5983,6011,6076,6084,6159,6167,6188,6196],{"type":18,"tag":614,"props":4884,"children":4885},{"class":616,"line":617},[4886],{"type":18,"tag":614,"props":4887,"children":4888},{"class":1851},[4889],{"type":24,"value":4750},{"type":18,"tag":614,"props":4891,"children":4892},{"class":616,"line":644},[4893,4897,4901,4905,4909,4913,4917,4921,4925],{"type":18,"tag":614,"props":4894,"children":4895},{"class":627},[4896],{"type":24,"value":4758},{"type":18,"tag":614,"props":4898,"children":4899},{"class":621},[4900],{"type":24,"value":711},{"type":18,"tag":614,"props":4902,"children":4903},{"class":627},[4904],{"type":24,"value":4767},{"type":18,"tag":614,"props":4906,"children":4907},{"class":621},[4908],{"type":24,"value":1046},{"type":18,"tag":614,"props":4910,"children":4911},{"class":627},[4912],{"type":24,"value":4776},{"type":18,"tag":614,"props":4914,"children":4915},{"class":621},[4916],{"type":24,"value":1414},{"type":18,"tag":614,"props":4918,"children":4919},{"class":627},[4920],{"type":24,"value":630},{"type":18,"tag":614,"props":4922,"children":4923},{"class":671},[4924],{"type":24,"value":701},{"type":18,"tag":614,"props":4926,"children":4927},{"class":627},[4928],{"type":24,"value":2058},{"type":18,"tag":614,"props":4930,"children":4931},{"class":616,"line":653},[4932,4936,4940,4944,4948,4952,4956,4960,4964,4968,4972,4976,4980,4984,4988],{"type":18,"tag":614,"props":4933,"children":4934},{"class":627},[4935],{"type":24,"value":4800},{"type":18,"tag":614,"props":4937,"children":4938},{"class":621},[4939],{"type":24,"value":711},{"type":18,"tag":614,"props":4941,"children":4942},{"class":627},[4943],{"type":24,"value":630},{"type":18,"tag":614,"props":4945,"children":4946},{"class":621},[4947],{"type":24,"value":1046},{"type":18,"tag":614,"props":4949,"children":4950},{"class":671},[4951],{"type":24,"value":701},{"type":18,"tag":614,"props":4953,"children":4954},{"class":627},[4955],{"type":24,"value":2033},{"type":18,"tag":614,"props":4957,"children":4958},{"class":621},[4959],{"type":24,"value":1056},{"type":18,"tag":614,"props":4961,"children":4962},{"class":627},[4963],{"type":24,"value":4829},{"type":18,"tag":614,"props":4965,"children":4966},{"class":621},[4967],{"type":24,"value":1046},{"type":18,"tag":614,"props":4969,"children":4970},{"class":627},[4971],{"type":24,"value":4838},{"type":18,"tag":614,"props":4973,"children":4974},{"class":621},[4975],{"type":24,"value":1046},{"type":18,"tag":614,"props":4977,"children":4978},{"class":627},[4979],{"type":24,"value":4847},{"type":18,"tag":614,"props":4981,"children":4982},{"class":621},[4983],{"type":24,"value":1414},{"type":18,"tag":614,"props":4985,"children":4986},{"class":671},[4987],{"type":24,"value":701},{"type":18,"tag":614,"props":4989,"children":4990},{"class":627},[4991],{"type":24,"value":2058},{"type":18,"tag":614,"props":4993,"children":4994},{"class":616,"line":682},[4995],{"type":18,"tag":614,"props":4996,"children":4997},{},[4998],{"type":24,"value":650},{"type":18,"tag":614,"props":5000,"children":5001},{"class":616,"line":690},[5002],{"type":18,"tag":614,"props":5003,"children":5004},{"class":1851},[5005],{"type":24,"value":5006},"# Define iterations\n",{"type":18,"tag":614,"props":5008,"children":5009},{"class":616,"line":719},[5010,5015,5019,5023,5027,5032,5036,5040,5044],{"type":18,"tag":614,"props":5011,"children":5012},{"class":627},[5013],{"type":24,"value":5014},"m ",{"type":18,"tag":614,"props":5016,"children":5017},{"class":621},[5018],{"type":24,"value":711},{"type":18,"tag":614,"props":5020,"children":5021},{"class":627},[5022],{"type":24,"value":4424},{"type":18,"tag":614,"props":5024,"children":5025},{"class":671},[5026],{"type":24,"value":701},{"type":18,"tag":614,"props":5028,"children":5029},{"class":627},[5030],{"type":24,"value":5031},".u_dim ) ",{"type":18,"tag":614,"props":5033,"children":5034},{"class":621},[5035],{"type":24,"value":1056},{"type":18,"tag":614,"props":5037,"children":5038},{"class":627},[5039],{"type":24,"value":630},{"type":18,"tag":614,"props":5041,"children":5042},{"class":671},[5043],{"type":24,"value":701},{"type":18,"tag":614,"props":5045,"children":5046},{"class":627},[5047],{"type":24,"value":4476},{"type":18,"tag":614,"props":5049,"children":5050},{"class":616,"line":745},[5051],{"type":18,"tag":614,"props":5052,"children":5053},{"class":1851},[5054],{"type":24,"value":5055},"# Define r0\n",{"type":18,"tag":614,"props":5057,"children":5058},{"class":616,"line":771},[5059,5064,5068,5073,5077],{"type":18,"tag":614,"props":5060,"children":5061},{"class":627},[5062],{"type":24,"value":5063},"r0 ",{"type":18,"tag":614,"props":5065,"children":5066},{"class":621},[5067],{"type":24,"value":711},{"type":18,"tag":614,"props":5069,"children":5070},{"class":627},[5071],{"type":24,"value":5072}," right ",{"type":18,"tag":614,"props":5074,"children":5075},{"class":621},[5076],{"type":24,"value":1046},{"type":18,"tag":614,"props":5078,"children":5079},{"class":627},[5080],{"type":24,"value":5081}," left\n",{"type":18,"tag":614,"props":5083,"children":5084},{"class":616,"line":779},[5085],{"type":18,"tag":614,"props":5086,"children":5087},{"class":1851},[5088],{"type":24,"value":5089},"# print(r0)\n",{"type":18,"tag":614,"props":5091,"children":5092},{"class":616,"line":805},[5093],{"type":18,"tag":614,"props":5094,"children":5095},{},[5096],{"type":24,"value":650},{"type":18,"tag":614,"props":5098,"children":5099},{"class":616,"line":831},[5100],{"type":18,"tag":614,"props":5101,"children":5102},{"class":1851},[5103],{"type":24,"value":5104},"# GMRES\n",{"type":18,"tag":614,"props":5106,"children":5107},{"class":616,"line":839},[5108,5113,5117,5122,5126,5130],{"type":18,"tag":614,"props":5109,"children":5110},{"class":627},[5111],{"type":24,"value":5112},"Vm ",{"type":18,"tag":614,"props":5114,"children":5115},{"class":621},[5116],{"type":24,"value":711},{"type":18,"tag":614,"props":5118,"children":5119},{"class":627},[5120],{"type":24,"value":5121}," np.zeros((m, m",{"type":18,"tag":614,"props":5123,"children":5124},{"class":621},[5125],{"type":24,"value":1177},{"type":18,"tag":614,"props":5127,"children":5128},{"class":671},[5129],{"type":24,"value":977},{"type":18,"tag":614,"props":5131,"children":5132},{"class":627},[5133],{"type":24,"value":5134},"))\n",{"type":18,"tag":614,"props":5136,"children":5137},{"class":616,"line":875},[5138,5143,5147,5151,5155,5159,5163,5168,5172],{"type":18,"tag":614,"props":5139,"children":5140},{"class":627},[5141],{"type":24,"value":5142},"Vm[:, ",{"type":18,"tag":614,"props":5144,"children":5145},{"class":671},[5146],{"type":24,"value":867},{"type":18,"tag":614,"props":5148,"children":5149},{"class":627},[5150],{"type":24,"value":296},{"type":18,"tag":614,"props":5152,"children":5153},{"class":671},[5154],{"type":24,"value":977},{"type":18,"tag":614,"props":5156,"children":5157},{"class":627},[5158],{"type":24,"value":2911},{"type":18,"tag":614,"props":5160,"children":5161},{"class":621},[5162],{"type":24,"value":711},{"type":18,"tag":614,"props":5164,"children":5165},{"class":627},[5166],{"type":24,"value":5167}," r0 ",{"type":18,"tag":614,"props":5169,"children":5170},{"class":621},[5171],{"type":24,"value":1414},{"type":18,"tag":614,"props":5173,"children":5174},{"class":627},[5175],{"type":24,"value":5176}," np.linalg.norm(r0)\n",{"type":18,"tag":614,"props":5178,"children":5179},{"class":616,"line":908},[5180],{"type":18,"tag":614,"props":5181,"children":5182},{"class":1851},[5183],{"type":24,"value":5184},"# print(\"Vm\", Vm[:, 0])\n",{"type":18,"tag":614,"props":5186,"children":5187},{"class":616,"line":916},[5188,5193,5197,5202,5206,5210],{"type":18,"tag":614,"props":5189,"children":5190},{"class":627},[5191],{"type":24,"value":5192},"Hm ",{"type":18,"tag":614,"props":5194,"children":5195},{"class":621},[5196],{"type":24,"value":711},{"type":18,"tag":614,"props":5198,"children":5199},{"class":627},[5200],{"type":24,"value":5201}," np.zeros((m",{"type":18,"tag":614,"props":5203,"children":5204},{"class":621},[5205],{"type":24,"value":1177},{"type":18,"tag":614,"props":5207,"children":5208},{"class":671},[5209],{"type":24,"value":977},{"type":18,"tag":614,"props":5211,"children":5212},{"class":627},[5213],{"type":24,"value":5214},", m))\n",{"type":18,"tag":614,"props":5216,"children":5217},{"class":616,"line":950},[5218],{"type":18,"tag":614,"props":5219,"children":5220},{"class":1851},[5221],{"type":24,"value":5222},"# print(Vm[:, 0])\n",{"type":18,"tag":614,"props":5224,"children":5225},{"class":616,"line":984},[5226],{"type":18,"tag":614,"props":5227,"children":5228},{},[5229],{"type":24,"value":650},{"type":18,"tag":614,"props":5231,"children":5232},{"class":616,"line":992},[5233],{"type":18,"tag":614,"props":5234,"children":5235},{},[5236],{"type":24,"value":650},{"type":18,"tag":614,"props":5238,"children":5239},{"class":616,"line":1018},[5240,5244,5248,5252,5256,5260],{"type":18,"tag":614,"props":5241,"children":5242},{"class":621},[5243],{"type":24,"value":2790},{"type":18,"tag":614,"props":5245,"children":5246},{"class":627},[5247],{"type":24,"value":2795},{"type":18,"tag":614,"props":5249,"children":5250},{"class":621},[5251],{"type":24,"value":2800},{"type":18,"tag":614,"props":5253,"children":5254},{"class":627},[5255],{"type":24,"value":630},{"type":18,"tag":614,"props":5257,"children":5258},{"class":671},[5259],{"type":24,"value":2809},{"type":18,"tag":614,"props":5261,"children":5262},{"class":627},[5263],{"type":24,"value":5264},"(m):\n",{"type":18,"tag":614,"props":5266,"children":5267},{"class":616,"line":1026},[5268,5273,5277,5281,5285],{"type":18,"tag":614,"props":5269,"children":5270},{"class":627},[5271],{"type":24,"value":5272},"    Fuxt ",{"type":18,"tag":614,"props":5274,"children":5275},{"class":621},[5276],{"type":24,"value":711},{"type":18,"tag":614,"props":5278,"children":5279},{"class":627},[5280],{"type":24,"value":630},{"type":18,"tag":614,"props":5282,"children":5283},{"class":671},[5284],{"type":24,"value":701},{"type":18,"tag":614,"props":5286,"children":5287},{"class":627},[5288],{"type":24,"value":5289},".calc_f(\n",{"type":18,"tag":614,"props":5291,"children":5292},{"class":616,"line":1068},[5293,5298,5302,5307,5311,5315,5320,5324,5328,5332,5337,5343,5347,5353,5358,5362,5366,5370],{"type":18,"tag":614,"props":5294,"children":5295},{"class":627},[5296],{"type":24,"value":5297},"        X, U ",{"type":18,"tag":614,"props":5299,"children":5300},{"class":621},[5301],{"type":24,"value":1177},{"type":18,"tag":614,"props":5303,"children":5304},{"class":627},[5305],{"type":24,"value":5306}," Vm[:, i:i",{"type":18,"tag":614,"props":5308,"children":5309},{"class":621},[5310],{"type":24,"value":1177},{"type":18,"tag":614,"props":5312,"children":5313},{"class":671},[5314],{"type":24,"value":977},{"type":18,"tag":614,"props":5316,"children":5317},{"class":627},[5318],{"type":24,"value":5319},"].reshape(",{"type":18,"tag":614,"props":5321,"children":5322},{"class":671},[5323],{"type":24,"value":701},{"type":18,"tag":614,"props":5325,"children":5326},{"class":627},[5327],{"type":24,"value":2478},{"type":18,"tag":614,"props":5329,"children":5330},{"class":671},[5331],{"type":24,"value":701},{"type":18,"tag":614,"props":5333,"children":5334},{"class":627},[5335],{"type":24,"value":5336},".pred_horizons, ",{"type":18,"tag":614,"props":5338,"children":5340},{"class":5339},"ct-657843",[5341],{"type":24,"value":5342},"order",{"type":18,"tag":614,"props":5344,"children":5345},{"class":621},[5346],{"type":24,"value":711},{"type":18,"tag":614,"props":5348,"children":5350},{"class":5349},"ct-244866",[5351],{"type":24,"value":5352},"'F'",{"type":18,"tag":614,"props":5354,"children":5355},{"class":627},[5356],{"type":24,"value":5357},") ",{"type":18,"tag":614,"props":5359,"children":5360},{"class":621},[5361],{"type":24,"value":1056},{"type":18,"tag":614,"props":5363,"children":5364},{"class":627},[5365],{"type":24,"value":630},{"type":18,"tag":614,"props":5367,"children":5368},{"class":671},[5369],{"type":24,"value":701},{"type":18,"tag":614,"props":5371,"children":5372},{"class":627},[5373],{"type":24,"value":5374},".ht,\n",{"type":18,"tag":614,"props":5376,"children":5377},{"class":616,"line":1108},[5378],{"type":18,"tag":614,"props":5379,"children":5380},{"class":627},[5381],{"type":24,"value":5382},"        Lambda, Mu,\n",{"type":18,"tag":614,"props":5384,"children":5385},{"class":616,"line":1202},[5386],{"type":18,"tag":614,"props":5387,"children":5388},{"class":627},[5389],{"type":24,"value":5390},"        dt\n",{"type":18,"tag":614,"props":5392,"children":5393},{"class":616,"line":1210},[5394],{"type":18,"tag":614,"props":5395,"children":5396},{"class":627},[5397],{"type":24,"value":5398},"    )\n",{"type":18,"tag":614,"props":5400,"children":5401},{"class":616,"line":1228},[5402],{"type":18,"tag":614,"props":5403,"children":5404},{},[5405],{"type":24,"value":650},{"type":18,"tag":614,"props":5407,"children":5408},{"class":616,"line":1236},[5409,5414,5418,5422,5426,5430,5434,5438,5442],{"type":18,"tag":614,"props":5410,"children":5411},{"class":627},[5412],{"type":24,"value":5413},"    Av ",{"type":18,"tag":614,"props":5415,"children":5416},{"class":621},[5417],{"type":24,"value":711},{"type":18,"tag":614,"props":5419,"children":5420},{"class":627},[5421],{"type":24,"value":4767},{"type":18,"tag":614,"props":5423,"children":5424},{"class":621},[5425],{"type":24,"value":1046},{"type":18,"tag":614,"props":5427,"children":5428},{"class":627},[5429],{"type":24,"value":4776},{"type":18,"tag":614,"props":5431,"children":5432},{"class":621},[5433],{"type":24,"value":1414},{"type":18,"tag":614,"props":5435,"children":5436},{"class":627},[5437],{"type":24,"value":630},{"type":18,"tag":614,"props":5439,"children":5440},{"class":671},[5441],{"type":24,"value":701},{"type":18,"tag":614,"props":5443,"children":5444},{"class":627},[5445],{"type":24,"value":2058},{"type":18,"tag":614,"props":5447,"children":5448},{"class":616,"line":1262},[5449],{"type":18,"tag":614,"props":5450,"children":5451},{},[5452],{"type":24,"value":650},{"type":18,"tag":614,"props":5454,"children":5455},{"class":616,"line":1270},[5456,5460,5464,5469,5473,5477,5481,5486,5490,5494],{"type":18,"tag":614,"props":5457,"children":5458},{"class":627},[5459],{"type":24,"value":659},{"type":18,"tag":614,"props":5461,"children":5462},{"class":621},[5463],{"type":24,"value":2790},{"type":18,"tag":614,"props":5465,"children":5466},{"class":627},[5467],{"type":24,"value":5468}," k ",{"type":18,"tag":614,"props":5470,"children":5471},{"class":621},[5472],{"type":24,"value":2800},{"type":18,"tag":614,"props":5474,"children":5475},{"class":627},[5476],{"type":24,"value":630},{"type":18,"tag":614,"props":5478,"children":5479},{"class":671},[5480],{"type":24,"value":2809},{"type":18,"tag":614,"props":5482,"children":5483},{"class":627},[5484],{"type":24,"value":5485},"(i",{"type":18,"tag":614,"props":5487,"children":5488},{"class":621},[5489],{"type":24,"value":1177},{"type":18,"tag":614,"props":5491,"children":5492},{"class":671},[5493],{"type":24,"value":977},{"type":18,"tag":614,"props":5495,"children":5496},{"class":627},[5497],{"type":24,"value":5498},"):\n",{"type":18,"tag":614,"props":5500,"children":5501},{"class":616,"line":1426},[5502,5507,5511,5516,5520,5524],{"type":18,"tag":614,"props":5503,"children":5504},{"class":627},[5505],{"type":24,"value":5506},"        Hm[k, i] ",{"type":18,"tag":614,"props":5508,"children":5509},{"class":621},[5510],{"type":24,"value":711},{"type":18,"tag":614,"props":5512,"children":5513},{"class":627},[5514],{"type":24,"value":5515}," np.dot(Av.T, Vm[:, k:k",{"type":18,"tag":614,"props":5517,"children":5518},{"class":621},[5519],{"type":24,"value":1177},{"type":18,"tag":614,"props":5521,"children":5522},{"class":671},[5523],{"type":24,"value":977},{"type":18,"tag":614,"props":5525,"children":5526},{"class":627},[5527],{"type":24,"value":3280},{"type":18,"tag":614,"props":5529,"children":5530},{"class":616,"line":1546},[5531],{"type":18,"tag":614,"props":5532,"children":5533},{},[5534],{"type":24,"value":650},{"type":18,"tag":614,"props":5536,"children":5537},{"class":616,"line":1554},[5538,5543,5547,5552,5556],{"type":18,"tag":614,"props":5539,"children":5540},{"class":627},[5541],{"type":24,"value":5542},"    temp_vec ",{"type":18,"tag":614,"props":5544,"children":5545},{"class":621},[5546],{"type":24,"value":711},{"type":18,"tag":614,"props":5548,"children":5549},{"class":627},[5550],{"type":24,"value":5551}," np.zeros((m, ",{"type":18,"tag":614,"props":5553,"children":5554},{"class":671},[5555],{"type":24,"value":977},{"type":18,"tag":614,"props":5557,"children":5558},{"class":627},[5559],{"type":24,"value":5134},{"type":18,"tag":614,"props":5561,"children":5562},{"class":616,"line":1571},[5563],{"type":18,"tag":614,"props":5564,"children":5565},{},[5566],{"type":24,"value":650},{"type":18,"tag":614,"props":5568,"children":5569},{"class":616,"line":1579},[5570,5574,5578,5582,5586,5590,5594,5598,5602,5606],{"type":18,"tag":614,"props":5571,"children":5572},{"class":627},[5573],{"type":24,"value":659},{"type":18,"tag":614,"props":5575,"children":5576},{"class":621},[5577],{"type":24,"value":2790},{"type":18,"tag":614,"props":5579,"children":5580},{"class":627},[5581],{"type":24,"value":5468},{"type":18,"tag":614,"props":5583,"children":5584},{"class":621},[5585],{"type":24,"value":2800},{"type":18,"tag":614,"props":5587,"children":5588},{"class":627},[5589],{"type":24,"value":630},{"type":18,"tag":614,"props":5591,"children":5592},{"class":671},[5593],{"type":24,"value":2809},{"type":18,"tag":614,"props":5595,"children":5596},{"class":627},[5597],{"type":24,"value":5485},{"type":18,"tag":614,"props":5599,"children":5600},{"class":621},[5601],{"type":24,"value":1177},{"type":18,"tag":614,"props":5603,"children":5604},{"class":671},[5605],{"type":24,"value":977},{"type":18,"tag":614,"props":5607,"children":5608},{"class":627},[5609],{"type":24,"value":5498},{"type":18,"tag":614,"props":5611,"children":5612},{"class":616,"line":1605},[5613,5618,5622,5627,5631,5636,5640,5644],{"type":18,"tag":614,"props":5614,"children":5615},{"class":627},[5616],{"type":24,"value":5617},"        temp_vec ",{"type":18,"tag":614,"props":5619,"children":5620},{"class":621},[5621],{"type":24,"value":711},{"type":18,"tag":614,"props":5623,"children":5624},{"class":627},[5625],{"type":24,"value":5626}," temp_vec ",{"type":18,"tag":614,"props":5628,"children":5629},{"class":621},[5630],{"type":24,"value":1177},{"type":18,"tag":614,"props":5632,"children":5633},{"class":627},[5634],{"type":24,"value":5635}," np.dot(Hm[k, i], Vm[:, k:k",{"type":18,"tag":614,"props":5637,"children":5638},{"class":621},[5639],{"type":24,"value":1177},{"type":18,"tag":614,"props":5641,"children":5642},{"class":671},[5643],{"type":24,"value":977},{"type":18,"tag":614,"props":5645,"children":5646},{"class":627},[5647],{"type":24,"value":3280},{"type":18,"tag":614,"props":5649,"children":5650},{"class":616,"line":1649},[5651],{"type":18,"tag":614,"props":5652,"children":5653},{},[5654],{"type":24,"value":650},{"type":18,"tag":614,"props":5656,"children":5657},{"class":616,"line":1693},[5658,5663,5667,5672,5676],{"type":18,"tag":614,"props":5659,"children":5660},{"class":627},[5661],{"type":24,"value":5662},"    v_hat ",{"type":18,"tag":614,"props":5664,"children":5665},{"class":621},[5666],{"type":24,"value":711},{"type":18,"tag":614,"props":5668,"children":5669},{"class":627},[5670],{"type":24,"value":5671}," Av ",{"type":18,"tag":614,"props":5673,"children":5674},{"class":621},[5675],{"type":24,"value":1046},{"type":18,"tag":614,"props":5677,"children":5678},{"class":627},[5679],{"type":24,"value":5680}," temp_vec\n",{"type":18,"tag":614,"props":5682,"children":5683},{"class":616,"line":1736},[5684],{"type":18,"tag":614,"props":5685,"children":5686},{},[5687],{"type":24,"value":650},{"type":18,"tag":614,"props":5689,"children":5690},{"class":616,"line":1744},[5691,5696,5700,5704,5708,5712],{"type":18,"tag":614,"props":5692,"children":5693},{"class":627},[5694],{"type":24,"value":5695},"    Hm[i",{"type":18,"tag":614,"props":5697,"children":5698},{"class":621},[5699],{"type":24,"value":1177},{"type":18,"tag":614,"props":5701,"children":5702},{"class":671},[5703],{"type":24,"value":977},{"type":18,"tag":614,"props":5705,"children":5706},{"class":627},[5707],{"type":24,"value":2929},{"type":18,"tag":614,"props":5709,"children":5710},{"class":621},[5711],{"type":24,"value":711},{"type":18,"tag":614,"props":5713,"children":5714},{"class":627},[5715],{"type":24,"value":5716}," np.linalg.norm(v_hat)\n",{"type":18,"tag":614,"props":5718,"children":5720},{"class":616,"line":5719},39,[5721],{"type":18,"tag":614,"props":5722,"children":5723},{},[5724],{"type":24,"value":650},{"type":18,"tag":614,"props":5726,"children":5728},{"class":616,"line":5727},40,[5729,5734,5738,5742,5747,5751,5755,5759,5763,5768,5772,5777,5781,5785],{"type":18,"tag":614,"props":5730,"children":5731},{"class":627},[5732],{"type":24,"value":5733},"    Vm[:,i",{"type":18,"tag":614,"props":5735,"children":5736},{"class":621},[5737],{"type":24,"value":1177},{"type":18,"tag":614,"props":5739,"children":5740},{"class":671},[5741],{"type":24,"value":977},{"type":18,"tag":614,"props":5743,"children":5744},{"class":627},[5745],{"type":24,"value":5746},":i",{"type":18,"tag":614,"props":5748,"children":5749},{"class":621},[5750],{"type":24,"value":1177},{"type":18,"tag":614,"props":5752,"children":5753},{"class":671},[5754],{"type":24,"value":1353},{"type":18,"tag":614,"props":5756,"children":5757},{"class":627},[5758],{"type":24,"value":2911},{"type":18,"tag":614,"props":5760,"children":5761},{"class":621},[5762],{"type":24,"value":711},{"type":18,"tag":614,"props":5764,"children":5765},{"class":627},[5766],{"type":24,"value":5767}," v_hat",{"type":18,"tag":614,"props":5769,"children":5770},{"class":621},[5771],{"type":24,"value":1414},{"type":18,"tag":614,"props":5773,"children":5774},{"class":627},[5775],{"type":24,"value":5776},"Hm[i",{"type":18,"tag":614,"props":5778,"children":5779},{"class":621},[5780],{"type":24,"value":1177},{"type":18,"tag":614,"props":5782,"children":5783},{"class":671},[5784],{"type":24,"value":977},{"type":18,"tag":614,"props":5786,"children":5787},{"class":627},[5788],{"type":24,"value":5789},", i]\n",{"type":18,"tag":614,"props":5791,"children":5793},{"class":616,"line":5792},41,[5794],{"type":18,"tag":614,"props":5795,"children":5796},{},[5797],{"type":24,"value":650},{"type":18,"tag":614,"props":5799,"children":5801},{"class":616,"line":5800},42,[5802,5807,5811,5815,5819,5823,5827,5831],{"type":18,"tag":614,"props":5803,"children":5804},{"class":627},[5805],{"type":24,"value":5806},"e ",{"type":18,"tag":614,"props":5808,"children":5809},{"class":621},[5810],{"type":24,"value":711},{"type":18,"tag":614,"props":5812,"children":5813},{"class":627},[5814],{"type":24,"value":5201},{"type":18,"tag":614,"props":5816,"children":5817},{"class":621},[5818],{"type":24,"value":1177},{"type":18,"tag":614,"props":5820,"children":5821},{"class":671},[5822],{"type":24,"value":977},{"type":18,"tag":614,"props":5824,"children":5825},{"class":627},[5826],{"type":24,"value":2417},{"type":18,"tag":614,"props":5828,"children":5829},{"class":671},[5830],{"type":24,"value":977},{"type":18,"tag":614,"props":5832,"children":5833},{"class":627},[5834],{"type":24,"value":5134},{"type":18,"tag":614,"props":5836,"children":5838},{"class":616,"line":5837},43,[5839,5844,5848,5852,5856,5860,5864,5868],{"type":18,"tag":614,"props":5840,"children":5841},{"class":627},[5842],{"type":24,"value":5843},"e[",{"type":18,"tag":614,"props":5845,"children":5846},{"class":671},[5847],{"type":24,"value":867},{"type":18,"tag":614,"props":5849,"children":5850},{"class":627},[5851],{"type":24,"value":2417},{"type":18,"tag":614,"props":5853,"children":5854},{"class":671},[5855],{"type":24,"value":867},{"type":18,"tag":614,"props":5857,"children":5858},{"class":627},[5859],{"type":24,"value":2911},{"type":18,"tag":614,"props":5861,"children":5862},{"class":621},[5863],{"type":24,"value":711},{"type":18,"tag":614,"props":5865,"children":5866},{"class":627},[5867],{"type":24,"value":630},{"type":18,"tag":614,"props":5869,"children":5870},{"class":671},[5871],{"type":24,"value":2116},{"type":18,"tag":614,"props":5873,"children":5875},{"class":616,"line":5874},44,[5876,5881,5885,5890,5894],{"type":18,"tag":614,"props":5877,"children":5878},{"class":627},[5879],{"type":24,"value":5880},"gm ",{"type":18,"tag":614,"props":5882,"children":5883},{"class":621},[5884],{"type":24,"value":711},{"type":18,"tag":614,"props":5886,"children":5887},{"class":627},[5888],{"type":24,"value":5889}," np.linalg.norm(r0) ",{"type":18,"tag":614,"props":5891,"children":5892},{"class":621},[5893],{"type":24,"value":1056},{"type":18,"tag":614,"props":5895,"children":5896},{"class":627},[5897],{"type":24,"value":5898}," e\n",{"type":18,"tag":614,"props":5900,"children":5902},{"class":616,"line":5901},45,[5903],{"type":18,"tag":614,"props":5904,"children":5905},{"class":1851},[5906],{"type":24,"value":5907},"# print(gm)\n",{"type":18,"tag":614,"props":5909,"children":5911},{"class":616,"line":5910},46,[5912],{"type":18,"tag":614,"props":5913,"children":5914},{},[5915],{"type":24,"value":650},{"type":18,"tag":614,"props":5917,"children":5919},{"class":616,"line":5918},47,[5920,5925,5929,5933,5937],{"type":18,"tag":614,"props":5921,"children":5922},{"class":627},[5923],{"type":24,"value":5924},"UTMat, gm ",{"type":18,"tag":614,"props":5926,"children":5927},{"class":621},[5928],{"type":24,"value":711},{"type":18,"tag":614,"props":5930,"children":5931},{"class":627},[5932],{"type":24,"value":630},{"type":18,"tag":614,"props":5934,"children":5935},{"class":671},[5936],{"type":24,"value":701},{"type":18,"tag":614,"props":5938,"children":5939},{"class":627},[5940],{"type":24,"value":5941},".ToUTMat(Hm, gm, m)\n",{"type":18,"tag":614,"props":5943,"children":5945},{"class":616,"line":5944},48,[5946],{"type":18,"tag":614,"props":5947,"children":5948},{},[5949],{"type":24,"value":650},{"type":18,"tag":614,"props":5951,"children":5953},{"class":616,"line":5952},49,[5954,5959,5963,5967,5971],{"type":18,"tag":614,"props":5955,"children":5956},{"class":627},[5957],{"type":24,"value":5958},"min_y ",{"type":18,"tag":614,"props":5960,"children":5961},{"class":621},[5962],{"type":24,"value":711},{"type":18,"tag":614,"props":5964,"children":5965},{"class":627},[5966],{"type":24,"value":5551},{"type":18,"tag":614,"props":5968,"children":5969},{"class":671},[5970],{"type":24,"value":977},{"type":18,"tag":614,"props":5972,"children":5973},{"class":627},[5974],{"type":24,"value":5134},{"type":18,"tag":614,"props":5976,"children":5978},{"class":616,"line":5977},50,[5979],{"type":18,"tag":614,"props":5980,"children":5981},{},[5982],{"type":24,"value":650},{"type":18,"tag":614,"props":5984,"children":5986},{"class":616,"line":5985},51,[5987,5991,5995,5999,6003,6007],{"type":18,"tag":614,"props":5988,"children":5989},{"class":621},[5990],{"type":24,"value":2790},{"type":18,"tag":614,"props":5992,"children":5993},{"class":627},[5994],{"type":24,"value":2795},{"type":18,"tag":614,"props":5996,"children":5997},{"class":621},[5998],{"type":24,"value":2800},{"type":18,"tag":614,"props":6000,"children":6001},{"class":627},[6002],{"type":24,"value":630},{"type":18,"tag":614,"props":6004,"children":6005},{"class":671},[6006],{"type":24,"value":2809},{"type":18,"tag":614,"props":6008,"children":6009},{"class":627},[6010],{"type":24,"value":5264},{"type":18,"tag":614,"props":6012,"children":6014},{"class":616,"line":6013},52,[6015,6020,6024,6028,6032,6037,6041,6045,6049,6054,6058,6062,6067,6071],{"type":18,"tag":614,"props":6016,"children":6017},{"class":627},[6018],{"type":24,"value":6019},"    min_y[i][",{"type":18,"tag":614,"props":6021,"children":6022},{"class":671},[6023],{"type":24,"value":867},{"type":18,"tag":614,"props":6025,"children":6026},{"class":627},[6027],{"type":24,"value":2911},{"type":18,"tag":614,"props":6029,"children":6030},{"class":621},[6031],{"type":24,"value":711},{"type":18,"tag":614,"props":6033,"children":6034},{"class":627},[6035],{"type":24,"value":6036}," (gm[i, ",{"type":18,"tag":614,"props":6038,"children":6039},{"class":671},[6040],{"type":24,"value":867},{"type":18,"tag":614,"props":6042,"children":6043},{"class":627},[6044],{"type":24,"value":2911},{"type":18,"tag":614,"props":6046,"children":6047},{"class":621},[6048],{"type":24,"value":1046},{"type":18,"tag":614,"props":6050,"children":6051},{"class":627},[6052],{"type":24,"value":6053}," np.dot(UTMat[i:i",{"type":18,"tag":614,"props":6055,"children":6056},{"class":621},[6057],{"type":24,"value":1177},{"type":18,"tag":614,"props":6059,"children":6060},{"class":671},[6061],{"type":24,"value":977},{"type":18,"tag":614,"props":6063,"children":6064},{"class":627},[6065],{"type":24,"value":6066}," ,:] ,min_y))",{"type":18,"tag":614,"props":6068,"children":6069},{"class":621},[6070],{"type":24,"value":1414},{"type":18,"tag":614,"props":6072,"children":6073},{"class":627},[6074],{"type":24,"value":6075},"UTMat[i, i]\n",{"type":18,"tag":614,"props":6077,"children":6079},{"class":616,"line":6078},53,[6080],{"type":18,"tag":614,"props":6081,"children":6082},{},[6083],{"type":24,"value":650},{"type":18,"tag":614,"props":6085,"children":6087},{"class":616,"line":6086},54,[6088,6093,6097,6101,6105,6109,6113,6118,6122,6127,6131,6135,6139,6143,6147,6151,6155],{"type":18,"tag":614,"props":6089,"children":6090},{"class":627},[6091],{"type":24,"value":6092},"dU_new ",{"type":18,"tag":614,"props":6094,"children":6095},{"class":621},[6096],{"type":24,"value":711},{"type":18,"tag":614,"props":6098,"children":6099},{"class":627},[6100],{"type":24,"value":630},{"type":18,"tag":614,"props":6102,"children":6103},{"class":671},[6104],{"type":24,"value":701},{"type":18,"tag":614,"props":6106,"children":6107},{"class":627},[6108],{"type":24,"value":2460},{"type":18,"tag":614,"props":6110,"children":6111},{"class":621},[6112],{"type":24,"value":1177},{"type":18,"tag":614,"props":6114,"children":6115},{"class":627},[6116],{"type":24,"value":6117}," np.dot(Vm[:, ",{"type":18,"tag":614,"props":6119,"children":6120},{"class":671},[6121],{"type":24,"value":867},{"type":18,"tag":614,"props":6123,"children":6124},{"class":627},[6125],{"type":24,"value":6126},":m], min_y).reshape(",{"type":18,"tag":614,"props":6128,"children":6129},{"class":671},[6130],{"type":24,"value":701},{"type":18,"tag":614,"props":6132,"children":6133},{"class":627},[6134],{"type":24,"value":2478},{"type":18,"tag":614,"props":6136,"children":6137},{"class":671},[6138],{"type":24,"value":701},{"type":18,"tag":614,"props":6140,"children":6141},{"class":627},[6142],{"type":24,"value":5336},{"type":18,"tag":614,"props":6144,"children":6145},{"class":5339},[6146],{"type":24,"value":5342},{"type":18,"tag":614,"props":6148,"children":6149},{"class":621},[6150],{"type":24,"value":711},{"type":18,"tag":614,"props":6152,"children":6153},{"class":5349},[6154],{"type":24,"value":5352},{"type":18,"tag":614,"props":6156,"children":6157},{"class":627},[6158],{"type":24,"value":1423},{"type":18,"tag":614,"props":6160,"children":6162},{"class":616,"line":6161},55,[6163],{"type":18,"tag":614,"props":6164,"children":6165},{},[6166],{"type":24,"value":650},{"type":18,"tag":614,"props":6168,"children":6170},{"class":616,"line":6169},56,[6171,6175,6179,6183],{"type":18,"tag":614,"props":6172,"children":6173},{"class":671},[6174],{"type":24,"value":701},{"type":18,"tag":614,"props":6176,"children":6177},{"class":627},[6178],{"type":24,"value":2460},{"type":18,"tag":614,"props":6180,"children":6181},{"class":621},[6182],{"type":24,"value":711},{"type":18,"tag":614,"props":6184,"children":6185},{"class":627},[6186],{"type":24,"value":6187}," dU_new\n",{"type":18,"tag":614,"props":6189,"children":6191},{"class":616,"line":6190},57,[6192],{"type":18,"tag":614,"props":6193,"children":6194},{},[6195],{"type":24,"value":650},{"type":18,"tag":614,"props":6197,"children":6199},{"class":616,"line":6198},58,[6200,6204,6208,6213,6217,6221,6225,6229,6233,6237,6241],{"type":18,"tag":614,"props":6201,"children":6202},{"class":627},[6203],{"type":24,"value":2656},{"type":18,"tag":614,"props":6205,"children":6206},{"class":621},[6207],{"type":24,"value":711},{"type":18,"tag":614,"props":6209,"children":6210},{"class":627},[6211],{"type":24,"value":6212}," U ",{"type":18,"tag":614,"props":6214,"children":6215},{"class":621},[6216],{"type":24,"value":1177},{"type":18,"tag":614,"props":6218,"children":6219},{"class":627},[6220],{"type":24,"value":630},{"type":18,"tag":614,"props":6222,"children":6223},{"class":671},[6224],{"type":24,"value":701},{"type":18,"tag":614,"props":6226,"children":6227},{"class":627},[6228],{"type":24,"value":2460},{"type":18,"tag":614,"props":6230,"children":6231},{"class":621},[6232],{"type":24,"value":1056},{"type":18,"tag":614,"props":6234,"children":6235},{"class":627},[6236],{"type":24,"value":630},{"type":18,"tag":614,"props":6238,"children":6239},{"class":671},[6240],{"type":24,"value":701},{"type":18,"tag":614,"props":6242,"children":6243},{"class":627},[6244],{"type":24,"value":4860},{"type":18,"tag":27,"props":6246,"children":6247},{},[6248,6250,6255],{"type":24,"value":6249},"You can look in my code inside function ",{"type":18,"tag":170,"props":6251,"children":6252},{},[6253],{"type":24,"value":6254}," solve_nmpc ",{"type":24,"value":197},{"type":18,"tag":19,"props":6257,"children":6259},{"id":6258},"experiment-in-python",[6260],{"type":24,"value":6261},"Experiment in Python",{"type":18,"tag":27,"props":6263,"children":6264},{},[6265,6267,6270,6272,6275,6277,6281,6283,6287,6289,6293],{"type":24,"value":6266},"GMRES was consider one of the fastest solver for sparse linear algebra problem, so I will include the link for the GMRES algorithms. ",{"type":18,"tag":56,"props":6268,"children":6269},{},[],{"type":24,"value":6271},"\nIn my experiment, I use differential drive robot. ",{"type":18,"tag":56,"props":6273,"children":6274},{},[],{"type":24,"value":6276},"\nConsider as our state representation ",{"type":18,"tag":84,"props":6278,"children":6280},{"latex-express":6279,"styles":87}," x = \\begin{bmatrix} x \\\\ y \\\\ \\phi \\end{bmatrix} ",[],{"type":24,"value":6282}," and of course setting initialization ",{"type":18,"tag":84,"props":6284,"children":6286},{"latex-express":6285,"styles":87}," x_{0} = [0.0, 0.0, 0.0] ",[],{"type":24,"value":6288},", also ",{"type":18,"tag":84,"props":6290,"children":6292},{"latex-express":6291,"styles":87}," u_{0} = [0.0, 0.0] ",[],{"type":24,"value":197},{"type":18,"tag":6295,"props":6296,"children":6301},"figure",{"className":6297},[6298,6299,6300],"mb-4","inline-block","max-w-sm",[6302,6304],{"type":24,"value":6303},"\n  ",{"type":18,"tag":6305,"props":6306,"children":6311},"img",{"className":6307,"src":13,"width":6309,"height":6310},[6308],"mx-auto",700,350,[],{"type":18,"tag":6313,"props":6314,"children":6319},"figcaption",{"className":6315},[68,6316,6317,6318],"text-sm","text-neutral-600","dark:text-neutral-400",[6320],{"type":24,"value":6321},"\n    Animation of Differential Drive robot on optimal trajectory !!!\n",{"type":18,"tag":27,"props":6323,"children":6324},{},[6325],{"type":24,"value":6326},"And here are the optimal data for all state and input control.",{"type":18,"tag":6295,"props":6328,"children":6330},{"className":6329},[6298,6299,6300],[6331,6332],{"type":24,"value":6303},{"type":18,"tag":6305,"props":6333,"children":6338},{"className":6334,"src":6335,"width":6336,"height":6337},[6308],"/topics/robotics/nmpc/cgmreDat1.png",600,300,[],{"type":18,"tag":6313,"props":6340,"children":6342},{"className":6341},[68,6316,6317,6318],[6343],{"type":24,"value":6344},"\n    All data obtained after simulation.\n",{"type":18,"tag":27,"props":6346,"children":6347},{},[6348,6350],{"type":24,"value":6349},"You can find all the code of NMPC even with CasAdi and CGMRES here in my github: ",{"type":18,"tag":6351,"props":6352,"children":6356},"a",{"href":6353,"rel":6354},"https://github.com/SokhengDin/Path-Tracking/tree/main",[6355],"nofollow",[6357],{"type":24,"value":6358},"Path-Tracking",{"type":18,"tag":19,"props":6360,"children":6362},{"id":6361},"in-conclusion",[6363],{"type":24,"value":6364},"In Conclusion",{"type":18,"tag":27,"props":6366,"children":6367},{},[6368],{"type":24,"value":6369},"Nonlinear Model Predictive Control with CGMRES is one of the great NMPC method that you should try, since it provides a very fast numerical calculation thank to the GMRES algorithms with Given Rotation method. Even though compare to another NMPC solver, NMPC with CGMRES sometime is hard for finding the optimal parameters in order to not cause unstable numerical calculation. Next time, I will bring the multiple shooting method which is consider in the promise of more robust numerical stability tha single shooting method.",{"type":18,"tag":19,"props":6371,"children":6373},{"id":6372},"references",[6374],{"type":24,"value":6375},"References",{"type":18,"tag":284,"props":6377,"children":6378},{},[6379,6389,6399,6409,6419],{"type":18,"tag":80,"props":6380,"children":6381},{},[6382],{"type":18,"tag":6351,"props":6383,"children":6386},{"href":6384,"rel":6385},"https://www.researchgate.net/publication/228007717_A_real-time_algorithm_for_nonlinear_receding_horizon_control_using_multiple_shooting_and_continuationKrylov_method",[6355],[6387],{"type":24,"value":6388},"A realtime algorithm for nonlinear receding horizon control using multiple shooting and continuation/Krylov method",{"type":18,"tag":80,"props":6390,"children":6391},{},[6392],{"type":18,"tag":6351,"props":6393,"children":6396},{"href":6394,"rel":6395},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathTracking/cgmres_nmpc",[6355],[6397],{"type":24,"value":6398},"Nonlinear Model Predictive Control with CGMRES of Steering Car ",{"type":18,"tag":80,"props":6400,"children":6401},{},[6402],{"type":18,"tag":6351,"props":6403,"children":6406},{"href":6404,"rel":6405},"https://qiita.com/PozihameBaystar/items/650cc839da5d9c974f5d",[6355],[6407],{"type":24,"value":6408},"C/GMRES3",{"type":18,"tag":80,"props":6410,"children":6411},{},[6412],{"type":18,"tag":6351,"props":6413,"children":6416},{"href":6414,"rel":6415},"https://qiita.com/opticont/items/b3518b470d9e327144be",[6355],[6417],{"type":24,"value":6418},"KrylovGMRES",{"type":18,"tag":80,"props":6420,"children":6421},{},[6422],{"type":18,"tag":6351,"props":6423,"children":6426},{"href":6424,"rel":6425},"https://www.sciencedirect.com/science/article/pii/S2405896318326727",[6355],[6427],{"type":24,"value":6428},"Nonlinear Model Predictive Control of Position and Attitude in a Hexacopter with Three Failed Rotors",{"type":18,"tag":6430,"children":6431},"style",[6432],{"type":24,"value":6433},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-657843{color:#FFAB70;}\n.ct-244866{color:#9ECBFF;}",{"title":8,"searchDepth":644,"depth":644,"links":6435},[6436,6442,6443,6444,6445],{"id":21,"depth":644,"text":25,"children":6437},[6438,6439,6440,6441],{"id":35,"depth":653,"text":38},{"id":46,"depth":653,"text":49},{"id":229,"depth":653,"text":232},{"id":267,"depth":653,"text":270},{"id":574,"depth":644,"text":577},{"id":6258,"depth":644,"text":6261},{"id":6361,"depth":644,"text":6364},{"id":6372,"depth":644,"text":6375},"markdown","content:topics:robotics:nmpc-cgmres.md","content","topics/robotics/nmpc-cgmres.md","md",{"_path":6452,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":6453,"description":6454,"author":11,"slug":6455,"tag":6455,"img":6456,"body":6457,"_type":6446,"_id":10437,"_source":6448,"_file":10438,"_extension":6450},"/topics/robotics/nonlinear-mpc","Nonlinear Model Predictive Control","Introduction to Nonlinear Model Predictive Control","nonlinear-mpc","/topics/robotics/nmpc/predict_horizon.png",{"type":15,"children":6458,"toc":10426},[6459,6463,6467,6488,6494,6500,6513,6518,6523,6528,6532,6537,6576,6581,6585,6590,6638,6644,6656,6660,6665,6670,6675,6680,6684,6688,6693,7876,7882,7887,7891,7895,7900,7904,7910,7915,7919,7935,7939,7943,7947,7953,7965,7997,8002,8531,8536,8712,8721,8976,8981,9994,9999,10347,10353,10358,10368,10374,10379,10384,10390,10422],{"type":18,"tag":19,"props":6460,"children":6461},{"id":35},[6462],{"type":24,"value":38},{"type":18,"tag":27,"props":6464,"children":6465},{},[6466],{"type":24,"value":43},{"type":18,"tag":6468,"props":6469,"children":6476},"div",{"className":6470},[6471,6472,6473,6474,6475],"grid","grid-cols-2","space-x-10","justify-center","items-center",[6477,6478,6482,6483],{"type":24,"value":6303},{"type":18,"tag":6305,"props":6479,"children":6481},{"className":6480,"src":6456,"width":6336,"height":6337},[6308],[],{"type":24,"value":6303},{"type":18,"tag":6305,"props":6484,"children":6487},{"className":6485,"src":6486,"width":6336,"height":6337},[6308],"/topics/robotics/nmpc/set_points.png",[],{"type":18,"tag":6313,"props":6489,"children":6491},{"className":6490},[68,6316,6317,6318],[6492],{"type":24,"value":6493},"\n  A car with finite horizons prediction and set point prediction over finite horizons.\n",{"type":18,"tag":19,"props":6495,"children":6497},{"id":6496},"nonlinear-model-predictive-control",[6498],{"type":24,"value":6499},"Nonlinear Model Predictive Control ?",{"type":18,"tag":27,"props":6501,"children":6502},{},[6503,6505,6508,6510],{"type":24,"value":6504},"Nonlinear Model Predictive Control has the same basic core of its control algorithms. The different is about the mathematical solving over the system. ",{"type":18,"tag":56,"props":6506,"children":6507},{},[],{"type":24,"value":6509},"\nIn the real-life application, most of the system certainly nonlinear and it's more complex than linear model. Linear systems are mostly time-invariant, meaning that the response of the system input is time-independent. Nonlinear systems are time-varying meaning that the response of the system to any input is time-dependent.",{"type":18,"tag":56,"props":6511,"children":6512},{},[],{"type":18,"tag":27,"props":6514,"children":6515},{},[6516],{"type":24,"value":6517},"The system model can be represent as state-space model",{"type":18,"tag":27,"props":6519,"children":6520},{},[6521],{"type":24,"value":6522},"$$ \\dot{X} = f(X,U) $$",{"type":18,"tag":27,"props":6524,"children":6525},{},[6526],{"type":24,"value":6527},"Nonlinear Model Predictive Control also works by solving the quardratic cost subject to the nonlinear function over a future finite horizons. The quadractic cost can be define as",{"type":18,"tag":65,"props":6529,"children":6531},{"latex-express":6530,"styles":68},"J(x,u) = \\displaystyle\\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})",[],{"type":18,"tag":27,"props":6533,"children":6534},{},[6535],{"type":24,"value":6536},"Notation",{"type":18,"tag":76,"props":6538,"children":6539},{},[6540,6549,6558,6567],{"type":18,"tag":80,"props":6541,"children":6542},{},[6543,6547],{"type":18,"tag":84,"props":6544,"children":6546},{"latex-express":6545,"styles":87},"X",[],{"type":24,"value":6548}," is the state of the system. This shall be obtained from the optimiztion problem.",{"type":18,"tag":80,"props":6550,"children":6551},{},[6552,6556],{"type":18,"tag":84,"props":6553,"children":6555},{"latex-express":6554,"styles":87},"X_{ref}",[],{"type":24,"value":6557}," is the reference state of the system or desired input state.",{"type":18,"tag":80,"props":6559,"children":6560},{},[6561,6565],{"type":18,"tag":84,"props":6562,"children":6564},{"latex-express":6563,"styles":87},"U",[],{"type":24,"value":6566}," is the input control of the system. This is a solution obtained from the optimization problem.",{"type":18,"tag":80,"props":6568,"children":6569},{},[6570,6574],{"type":18,"tag":84,"props":6571,"children":6573},{"latex-express":6572,"styles":87},"U_{ref}",[],{"type":24,"value":6575}," is the reference control of the system or desired input control.",{"type":18,"tag":27,"props":6577,"children":6578},{},[6579],{"type":24,"value":6580},"Rewrite the optimization of NMPC problem.",{"type":18,"tag":65,"props":6582,"children":6584},{"latex-express":6583,"styles":68},"\n      \\begin{align*}\n            \\min_{u_{0}, u_{1}, ..., u_{N-1} } \\quad \\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}&Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})\\\\\n            \\text{subject to} \\quad & x_{k+1} = f(x_k, u_k) \\quad \\text{(System dynamics)} \\\\\n            & g(x_k, x_k) \\leq 0 \\quad \\text{(State constraints)} \\\\\n            & h(x_k, x_k) \\leq 0 \\quad \\text{(Input constraints)} \\\\\n            & p(x_k) \\leq 0 \\quad \\text{(Path constraints)} \\\\\n            & x_0=x(0)  \\quad \\text{(Initial condition)}\n      \\end{align*}\n            ",[],{"type":18,"tag":27,"props":6586,"children":6587},{},[6588],{"type":24,"value":6589},"Which,",{"type":18,"tag":76,"props":6591,"children":6592},{},[6593,6602,6611,6620,6628],{"type":18,"tag":80,"props":6594,"children":6595},{},[6596,6600],{"type":18,"tag":84,"props":6597,"children":6599},{"latex-express":6598,"styles":87},"f",[],{"type":24,"value":6601}," is the system dynamics model.",{"type":18,"tag":80,"props":6603,"children":6604},{},[6605,6609],{"type":18,"tag":84,"props":6606,"children":6608},{"latex-express":6607,"styles":87},"g",[],{"type":24,"value":6610}," is the state constraints of the system.",{"type":18,"tag":80,"props":6612,"children":6613},{},[6614,6618],{"type":18,"tag":84,"props":6615,"children":6617},{"latex-express":6616,"styles":87},"h",[],{"type":24,"value":6619}," is the input constraints of the system.",{"type":18,"tag":80,"props":6621,"children":6622},{},[6623,6626],{"type":18,"tag":84,"props":6624,"children":6625},{"latex-express":27,"styles":87},[],{"type":24,"value":6627}," is the path constraint, it help to ensure the safety following path of our system.",{"type":18,"tag":80,"props":6629,"children":6630},{},[6631,6636],{"type":18,"tag":84,"props":6632,"children":6635},{"latex-express":6633,"styles":87,"dist-cond":6634},"\\phi(X_{N})","false",[],{"type":24,"value":6637}," is the terminal cost of the system.",{"type":18,"tag":19,"props":6639,"children":6641},{"id":6640},"discretize-the-system-model-with-runge-kutta-4th-order",[6642],{"type":24,"value":6643},"Discretize the system model with Runge-Kutta 4th order",{"type":18,"tag":27,"props":6645,"children":6646},{},[6647,6649,6654],{"type":24,"value":6648},"I will choose a simple system mode robot ",{"type":18,"tag":170,"props":6650,"children":6651},{},[6652],{"type":24,"value":6653}," DifferentialDrive ",{"type":24,"value":6655},".\nThe forward kinematic equation",{"type":18,"tag":65,"props":6657,"children":6659},{"latex-express":6658,"styles":68},"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix}\n ",[],{"type":18,"tag":27,"props":6661,"children":6662},{},[6663],{"type":24,"value":6664},"State constraints are the restriction imposed on the state variable of the system. It helps our optimizer not to obtain the solution that is outside the boundary region and also ensure the system to always perform the minimal action control in any critical condition.",{"type":18,"tag":27,"props":6666,"children":6667},{},[6668],{"type":24,"value":6669},"We, then can do the approximation",{"type":18,"tag":65,"props":6671,"children":6674},{"latex-express":6672,"styles":68,"dist-cond":6673},"\n    \\begin{align*}\n        k_{1} &= f(x^{*}, u^{*}) \\\\\n        k_{2} &= f(x^{*}+k_{1}\\frac{dt}{2}, u^{*}) \\\\ \n        k_{3} &= f(x^{*}+k_{2}\\frac{dt}{2}, u^{*}) \\\\\n        k_{4} &= f(x^{*}+k_{3}dt, u^{*}) \\\\ \n        \\Rightarrow{x_{k+1} } &= x_{k} + (k_{1}+2k_{2}+2k_{3}+k_{4})\\frac{dt}{6}\n    \\end{align*}\n","true",[],{"type":18,"tag":27,"props":6676,"children":6677},{},[6678],{"type":24,"value":6679},"Let's evaluate it with our model.",{"type":18,"tag":65,"props":6681,"children":6683},{"latex-express":6682,"styles":68},"\n      \\begin{align*}\n        k_{1} &= \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n        k_{2} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{3} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{4} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n    \\end{align*}\n      ",[],{"type":18,"tag":65,"props":6685,"children":6687},{"latex-express":6686,"styles":68},"\n      \\Rightarrow{x_{k+1} } = x_{k} + \\left( \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} + \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix}   \\right) \\frac{dt}{6}\n",[],{"type":18,"tag":27,"props":6689,"children":6690},{},[6691],{"type":24,"value":6692},"How to implement it in Python ???",{"type":18,"tag":599,"props":6694,"children":6697},{"className":6695,"code":6696,"language":604,"meta":8},[602],"import numpy as np\n\n## Define sampling time dt 100Hz\ndt = 0.01\n## Define the num steps for function approximation \nnum_steps = 100\n## Define initial states\nx = 0.0\ny = 0.0\nyaw = 0.0\n## Define input control\nv = 1.5 #m/s\nomega = 1.57 #rad/s\n## Define state represent model\n### define lambda function take variable x\nf = lambda x, u :  np.array([\n      [u[0]*np.cos(x[2])],\n      [u[0]*np.sin(x[2])],\n      [u[1]]\n])\n\nfor _ in range(num_steps):\n    k1 = f([x, y, yaw], [v, omega])\n    k2 = f([x + (dt / 2) * k1[0], y + (dt / 2) * k1[1], yaw + (dt / 2) * k1[2]], [v, omega])\n    k3 = f([x + (dt / 2) * k2[0], y + (dt / 2) * k2[1], yaw + (dt / 2) * k2[2]], [v, omega])\n    k4 = f([x + dt * k3[0], y + dt * k3[1], yaw + dt * k3[2]], [v, omega])\n\n    # Update state of the robot\n    x += (k1[0] + 2 * k2[0] + 2 * k3[0] + k4[0]) * dt / 6\n    y += (k1[1] + 2 * k2[1] + 2 * k3[1] + k4[1]) * dt / 6\n    yaw += (k1[2] + 2 * k2[2] + 2 * k3[2] + k4[2]) * dt / 6\n",[6698],{"type":18,"tag":607,"props":6699,"children":6700},{},[6701],{"type":18,"tag":599,"props":6702,"children":6703},{"__ignoreMap":8},[6704,6727,6734,6742,6762,6770,6791,6799,6820,6840,6860,6868,6898,6927,6935,6943,6969,7003,7035,7051,7058,7065,7094,7111,7253,7390,7480,7487,7499,7627,7751],{"type":18,"tag":614,"props":6705,"children":6706},{"class":616,"line":617},[6707,6712,6717,6722],{"type":18,"tag":614,"props":6708,"children":6709},{"class":621},[6710],{"type":24,"value":6711},"import",{"type":18,"tag":614,"props":6713,"children":6714},{"class":627},[6715],{"type":24,"value":6716}," numpy ",{"type":18,"tag":614,"props":6718,"children":6719},{"class":621},[6720],{"type":24,"value":6721},"as",{"type":18,"tag":614,"props":6723,"children":6724},{"class":627},[6725],{"type":24,"value":6726}," np\n",{"type":18,"tag":614,"props":6728,"children":6729},{"class":616,"line":644},[6730],{"type":18,"tag":614,"props":6731,"children":6732},{},[6733],{"type":24,"value":650},{"type":18,"tag":614,"props":6735,"children":6736},{"class":616,"line":653},[6737],{"type":18,"tag":614,"props":6738,"children":6739},{"class":1851},[6740],{"type":24,"value":6741},"## Define sampling time dt 100Hz\n",{"type":18,"tag":614,"props":6743,"children":6744},{"class":616,"line":682},[6745,6749,6753,6757],{"type":18,"tag":614,"props":6746,"children":6747},{"class":627},[6748],{"type":24,"value":2712},{"type":18,"tag":614,"props":6750,"children":6751},{"class":621},[6752],{"type":24,"value":711},{"type":18,"tag":614,"props":6754,"children":6755},{"class":627},[6756],{"type":24,"value":630},{"type":18,"tag":614,"props":6758,"children":6759},{"class":671},[6760],{"type":24,"value":6761},"0.01\n",{"type":18,"tag":614,"props":6763,"children":6764},{"class":616,"line":690},[6765],{"type":18,"tag":614,"props":6766,"children":6767},{"class":1851},[6768],{"type":24,"value":6769},"## Define the num steps for function approximation \n",{"type":18,"tag":614,"props":6771,"children":6772},{"class":616,"line":719},[6773,6778,6782,6786],{"type":18,"tag":614,"props":6774,"children":6775},{"class":627},[6776],{"type":24,"value":6777},"num_steps ",{"type":18,"tag":614,"props":6779,"children":6780},{"class":621},[6781],{"type":24,"value":711},{"type":18,"tag":614,"props":6783,"children":6784},{"class":627},[6785],{"type":24,"value":630},{"type":18,"tag":614,"props":6787,"children":6788},{"class":671},[6789],{"type":24,"value":6790},"100\n",{"type":18,"tag":614,"props":6792,"children":6793},{"class":616,"line":745},[6794],{"type":18,"tag":614,"props":6795,"children":6796},{"class":1851},[6797],{"type":24,"value":6798},"## Define initial states\n",{"type":18,"tag":614,"props":6800,"children":6801},{"class":616,"line":771},[6802,6807,6811,6815],{"type":18,"tag":614,"props":6803,"children":6804},{"class":627},[6805],{"type":24,"value":6806},"x ",{"type":18,"tag":614,"props":6808,"children":6809},{"class":621},[6810],{"type":24,"value":711},{"type":18,"tag":614,"props":6812,"children":6813},{"class":627},[6814],{"type":24,"value":630},{"type":18,"tag":614,"props":6816,"children":6817},{"class":671},[6818],{"type":24,"value":6819},"0.0\n",{"type":18,"tag":614,"props":6821,"children":6822},{"class":616,"line":779},[6823,6828,6832,6836],{"type":18,"tag":614,"props":6824,"children":6825},{"class":627},[6826],{"type":24,"value":6827},"y ",{"type":18,"tag":614,"props":6829,"children":6830},{"class":621},[6831],{"type":24,"value":711},{"type":18,"tag":614,"props":6833,"children":6834},{"class":627},[6835],{"type":24,"value":630},{"type":18,"tag":614,"props":6837,"children":6838},{"class":671},[6839],{"type":24,"value":6819},{"type":18,"tag":614,"props":6841,"children":6842},{"class":616,"line":805},[6843,6848,6852,6856],{"type":18,"tag":614,"props":6844,"children":6845},{"class":627},[6846],{"type":24,"value":6847},"yaw ",{"type":18,"tag":614,"props":6849,"children":6850},{"class":621},[6851],{"type":24,"value":711},{"type":18,"tag":614,"props":6853,"children":6854},{"class":627},[6855],{"type":24,"value":630},{"type":18,"tag":614,"props":6857,"children":6858},{"class":671},[6859],{"type":24,"value":6819},{"type":18,"tag":614,"props":6861,"children":6862},{"class":616,"line":831},[6863],{"type":18,"tag":614,"props":6864,"children":6865},{"class":1851},[6866],{"type":24,"value":6867},"## Define input control\n",{"type":18,"tag":614,"props":6869,"children":6870},{"class":616,"line":839},[6871,6876,6880,6884,6889,6893],{"type":18,"tag":614,"props":6872,"children":6873},{"class":627},[6874],{"type":24,"value":6875},"v ",{"type":18,"tag":614,"props":6877,"children":6878},{"class":621},[6879],{"type":24,"value":711},{"type":18,"tag":614,"props":6881,"children":6882},{"class":627},[6883],{"type":24,"value":630},{"type":18,"tag":614,"props":6885,"children":6886},{"class":671},[6887],{"type":24,"value":6888},"1.5",{"type":18,"tag":614,"props":6890,"children":6891},{"class":627},[6892],{"type":24,"value":630},{"type":18,"tag":614,"props":6894,"children":6895},{"class":1851},[6896],{"type":24,"value":6897},"#m/s\n",{"type":18,"tag":614,"props":6899,"children":6900},{"class":616,"line":875},[6901,6906,6910,6914,6918,6922],{"type":18,"tag":614,"props":6902,"children":6903},{"class":627},[6904],{"type":24,"value":6905},"omega ",{"type":18,"tag":614,"props":6907,"children":6908},{"class":621},[6909],{"type":24,"value":711},{"type":18,"tag":614,"props":6911,"children":6912},{"class":627},[6913],{"type":24,"value":630},{"type":18,"tag":614,"props":6915,"children":6916},{"class":671},[6917],{"type":24,"value":2378},{"type":18,"tag":614,"props":6919,"children":6920},{"class":627},[6921],{"type":24,"value":630},{"type":18,"tag":614,"props":6923,"children":6924},{"class":1851},[6925],{"type":24,"value":6926},"#rad/s\n",{"type":18,"tag":614,"props":6928,"children":6929},{"class":616,"line":908},[6930],{"type":18,"tag":614,"props":6931,"children":6932},{"class":1851},[6933],{"type":24,"value":6934},"## Define state represent model\n",{"type":18,"tag":614,"props":6936,"children":6937},{"class":616,"line":916},[6938],{"type":18,"tag":614,"props":6939,"children":6940},{"class":1851},[6941],{"type":24,"value":6942},"### define lambda function take variable x\n",{"type":18,"tag":614,"props":6944,"children":6945},{"class":616,"line":950},[6946,6951,6955,6959,6964],{"type":18,"tag":614,"props":6947,"children":6948},{"class":627},[6949],{"type":24,"value":6950},"f ",{"type":18,"tag":614,"props":6952,"children":6953},{"class":621},[6954],{"type":24,"value":711},{"type":18,"tag":614,"props":6956,"children":6957},{"class":627},[6958],{"type":24,"value":630},{"type":18,"tag":614,"props":6960,"children":6961},{"class":621},[6962],{"type":24,"value":6963},"lambda",{"type":18,"tag":614,"props":6965,"children":6966},{"class":627},[6967],{"type":24,"value":6968}," x, u :  np.array([\n",{"type":18,"tag":614,"props":6970,"children":6971},{"class":616,"line":984},[6972,6977,6981,6985,6989,6994,6998],{"type":18,"tag":614,"props":6973,"children":6974},{"class":627},[6975],{"type":24,"value":6976},"      [u[",{"type":18,"tag":614,"props":6978,"children":6979},{"class":671},[6980],{"type":24,"value":867},{"type":18,"tag":614,"props":6982,"children":6983},{"class":627},[6984],{"type":24,"value":2597},{"type":18,"tag":614,"props":6986,"children":6987},{"class":621},[6988],{"type":24,"value":1056},{"type":18,"tag":614,"props":6990,"children":6991},{"class":627},[6992],{"type":24,"value":6993},"np.cos(x[",{"type":18,"tag":614,"props":6995,"children":6996},{"class":671},[6997],{"type":24,"value":1353},{"type":18,"tag":614,"props":6999,"children":7000},{"class":627},[7001],{"type":24,"value":7002},"])],\n",{"type":18,"tag":614,"props":7004,"children":7005},{"class":616,"line":992},[7006,7010,7014,7018,7022,7027,7031],{"type":18,"tag":614,"props":7007,"children":7008},{"class":627},[7009],{"type":24,"value":6976},{"type":18,"tag":614,"props":7011,"children":7012},{"class":671},[7013],{"type":24,"value":867},{"type":18,"tag":614,"props":7015,"children":7016},{"class":627},[7017],{"type":24,"value":2597},{"type":18,"tag":614,"props":7019,"children":7020},{"class":621},[7021],{"type":24,"value":1056},{"type":18,"tag":614,"props":7023,"children":7024},{"class":627},[7025],{"type":24,"value":7026},"np.sin(x[",{"type":18,"tag":614,"props":7028,"children":7029},{"class":671},[7030],{"type":24,"value":1353},{"type":18,"tag":614,"props":7032,"children":7033},{"class":627},[7034],{"type":24,"value":7002},{"type":18,"tag":614,"props":7036,"children":7037},{"class":616,"line":1018},[7038,7042,7046],{"type":18,"tag":614,"props":7039,"children":7040},{"class":627},[7041],{"type":24,"value":6976},{"type":18,"tag":614,"props":7043,"children":7044},{"class":671},[7045],{"type":24,"value":977},{"type":18,"tag":614,"props":7047,"children":7048},{"class":627},[7049],{"type":24,"value":7050},"]]\n",{"type":18,"tag":614,"props":7052,"children":7053},{"class":616,"line":1026},[7054],{"type":18,"tag":614,"props":7055,"children":7056},{"class":627},[7057],{"type":24,"value":3280},{"type":18,"tag":614,"props":7059,"children":7060},{"class":616,"line":1068},[7061],{"type":18,"tag":614,"props":7062,"children":7063},{},[7064],{"type":24,"value":650},{"type":18,"tag":614,"props":7066,"children":7067},{"class":616,"line":1108},[7068,7072,7077,7081,7085,7089],{"type":18,"tag":614,"props":7069,"children":7070},{"class":621},[7071],{"type":24,"value":2790},{"type":18,"tag":614,"props":7073,"children":7074},{"class":627},[7075],{"type":24,"value":7076}," _ ",{"type":18,"tag":614,"props":7078,"children":7079},{"class":621},[7080],{"type":24,"value":2800},{"type":18,"tag":614,"props":7082,"children":7083},{"class":627},[7084],{"type":24,"value":630},{"type":18,"tag":614,"props":7086,"children":7087},{"class":671},[7088],{"type":24,"value":2809},{"type":18,"tag":614,"props":7090,"children":7091},{"class":627},[7092],{"type":24,"value":7093},"(num_steps):\n",{"type":18,"tag":614,"props":7095,"children":7096},{"class":616,"line":1202},[7097,7102,7106],{"type":18,"tag":614,"props":7098,"children":7099},{"class":627},[7100],{"type":24,"value":7101},"    k1 ",{"type":18,"tag":614,"props":7103,"children":7104},{"class":621},[7105],{"type":24,"value":711},{"type":18,"tag":614,"props":7107,"children":7108},{"class":627},[7109],{"type":24,"value":7110}," f([x, y, yaw], [v, omega])\n",{"type":18,"tag":614,"props":7112,"children":7113},{"class":616,"line":1210},[7114,7119,7123,7128,7132,7137,7141,7145,7149,7153,7157,7162,7166,7171,7175,7179,7183,7187,7191,7195,7199,7203,7207,7212,7216,7220,7224,7228,7232,7236,7240,7244,7248],{"type":18,"tag":614,"props":7115,"children":7116},{"class":627},[7117],{"type":24,"value":7118},"    k2 ",{"type":18,"tag":614,"props":7120,"children":7121},{"class":621},[7122],{"type":24,"value":711},{"type":18,"tag":614,"props":7124,"children":7125},{"class":627},[7126],{"type":24,"value":7127}," f([x ",{"type":18,"tag":614,"props":7129,"children":7130},{"class":621},[7131],{"type":24,"value":1177},{"type":18,"tag":614,"props":7133,"children":7134},{"class":627},[7135],{"type":24,"value":7136}," (dt ",{"type":18,"tag":614,"props":7138,"children":7139},{"class":621},[7140],{"type":24,"value":1414},{"type":18,"tag":614,"props":7142,"children":7143},{"class":627},[7144],{"type":24,"value":630},{"type":18,"tag":614,"props":7146,"children":7147},{"class":671},[7148],{"type":24,"value":1353},{"type":18,"tag":614,"props":7150,"children":7151},{"class":627},[7152],{"type":24,"value":5357},{"type":18,"tag":614,"props":7154,"children":7155},{"class":621},[7156],{"type":24,"value":1056},{"type":18,"tag":614,"props":7158,"children":7159},{"class":627},[7160],{"type":24,"value":7161}," k1[",{"type":18,"tag":614,"props":7163,"children":7164},{"class":671},[7165],{"type":24,"value":867},{"type":18,"tag":614,"props":7167,"children":7168},{"class":627},[7169],{"type":24,"value":7170},"], y ",{"type":18,"tag":614,"props":7172,"children":7173},{"class":621},[7174],{"type":24,"value":1177},{"type":18,"tag":614,"props":7176,"children":7177},{"class":627},[7178],{"type":24,"value":7136},{"type":18,"tag":614,"props":7180,"children":7181},{"class":621},[7182],{"type":24,"value":1414},{"type":18,"tag":614,"props":7184,"children":7185},{"class":627},[7186],{"type":24,"value":630},{"type":18,"tag":614,"props":7188,"children":7189},{"class":671},[7190],{"type":24,"value":1353},{"type":18,"tag":614,"props":7192,"children":7193},{"class":627},[7194],{"type":24,"value":5357},{"type":18,"tag":614,"props":7196,"children":7197},{"class":621},[7198],{"type":24,"value":1056},{"type":18,"tag":614,"props":7200,"children":7201},{"class":627},[7202],{"type":24,"value":7161},{"type":18,"tag":614,"props":7204,"children":7205},{"class":671},[7206],{"type":24,"value":977},{"type":18,"tag":614,"props":7208,"children":7209},{"class":627},[7210],{"type":24,"value":7211},"], yaw ",{"type":18,"tag":614,"props":7213,"children":7214},{"class":621},[7215],{"type":24,"value":1177},{"type":18,"tag":614,"props":7217,"children":7218},{"class":627},[7219],{"type":24,"value":7136},{"type":18,"tag":614,"props":7221,"children":7222},{"class":621},[7223],{"type":24,"value":1414},{"type":18,"tag":614,"props":7225,"children":7226},{"class":627},[7227],{"type":24,"value":630},{"type":18,"tag":614,"props":7229,"children":7230},{"class":671},[7231],{"type":24,"value":1353},{"type":18,"tag":614,"props":7233,"children":7234},{"class":627},[7235],{"type":24,"value":5357},{"type":18,"tag":614,"props":7237,"children":7238},{"class":621},[7239],{"type":24,"value":1056},{"type":18,"tag":614,"props":7241,"children":7242},{"class":627},[7243],{"type":24,"value":7161},{"type":18,"tag":614,"props":7245,"children":7246},{"class":671},[7247],{"type":24,"value":1353},{"type":18,"tag":614,"props":7249,"children":7250},{"class":627},[7251],{"type":24,"value":7252},"]], [v, omega])\n",{"type":18,"tag":614,"props":7254,"children":7255},{"class":616,"line":1228},[7256,7261,7265,7269,7273,7277,7281,7285,7289,7293,7297,7302,7306,7310,7314,7318,7322,7326,7330,7334,7338,7342,7346,7350,7354,7358,7362,7366,7370,7374,7378,7382,7386],{"type":18,"tag":614,"props":7257,"children":7258},{"class":627},[7259],{"type":24,"value":7260},"    k3 ",{"type":18,"tag":614,"props":7262,"children":7263},{"class":621},[7264],{"type":24,"value":711},{"type":18,"tag":614,"props":7266,"children":7267},{"class":627},[7268],{"type":24,"value":7127},{"type":18,"tag":614,"props":7270,"children":7271},{"class":621},[7272],{"type":24,"value":1177},{"type":18,"tag":614,"props":7274,"children":7275},{"class":627},[7276],{"type":24,"value":7136},{"type":18,"tag":614,"props":7278,"children":7279},{"class":621},[7280],{"type":24,"value":1414},{"type":18,"tag":614,"props":7282,"children":7283},{"class":627},[7284],{"type":24,"value":630},{"type":18,"tag":614,"props":7286,"children":7287},{"class":671},[7288],{"type":24,"value":1353},{"type":18,"tag":614,"props":7290,"children":7291},{"class":627},[7292],{"type":24,"value":5357},{"type":18,"tag":614,"props":7294,"children":7295},{"class":621},[7296],{"type":24,"value":1056},{"type":18,"tag":614,"props":7298,"children":7299},{"class":627},[7300],{"type":24,"value":7301}," k2[",{"type":18,"tag":614,"props":7303,"children":7304},{"class":671},[7305],{"type":24,"value":867},{"type":18,"tag":614,"props":7307,"children":7308},{"class":627},[7309],{"type":24,"value":7170},{"type":18,"tag":614,"props":7311,"children":7312},{"class":621},[7313],{"type":24,"value":1177},{"type":18,"tag":614,"props":7315,"children":7316},{"class":627},[7317],{"type":24,"value":7136},{"type":18,"tag":614,"props":7319,"children":7320},{"class":621},[7321],{"type":24,"value":1414},{"type":18,"tag":614,"props":7323,"children":7324},{"class":627},[7325],{"type":24,"value":630},{"type":18,"tag":614,"props":7327,"children":7328},{"class":671},[7329],{"type":24,"value":1353},{"type":18,"tag":614,"props":7331,"children":7332},{"class":627},[7333],{"type":24,"value":5357},{"type":18,"tag":614,"props":7335,"children":7336},{"class":621},[7337],{"type":24,"value":1056},{"type":18,"tag":614,"props":7339,"children":7340},{"class":627},[7341],{"type":24,"value":7301},{"type":18,"tag":614,"props":7343,"children":7344},{"class":671},[7345],{"type":24,"value":977},{"type":18,"tag":614,"props":7347,"children":7348},{"class":627},[7349],{"type":24,"value":7211},{"type":18,"tag":614,"props":7351,"children":7352},{"class":621},[7353],{"type":24,"value":1177},{"type":18,"tag":614,"props":7355,"children":7356},{"class":627},[7357],{"type":24,"value":7136},{"type":18,"tag":614,"props":7359,"children":7360},{"class":621},[7361],{"type":24,"value":1414},{"type":18,"tag":614,"props":7363,"children":7364},{"class":627},[7365],{"type":24,"value":630},{"type":18,"tag":614,"props":7367,"children":7368},{"class":671},[7369],{"type":24,"value":1353},{"type":18,"tag":614,"props":7371,"children":7372},{"class":627},[7373],{"type":24,"value":5357},{"type":18,"tag":614,"props":7375,"children":7376},{"class":621},[7377],{"type":24,"value":1056},{"type":18,"tag":614,"props":7379,"children":7380},{"class":627},[7381],{"type":24,"value":7301},{"type":18,"tag":614,"props":7383,"children":7384},{"class":671},[7385],{"type":24,"value":1353},{"type":18,"tag":614,"props":7387,"children":7388},{"class":627},[7389],{"type":24,"value":7252},{"type":18,"tag":614,"props":7391,"children":7392},{"class":616,"line":1236},[7393,7398,7402,7406,7410,7415,7419,7424,7428,7432,7436,7440,7444,7448,7452,7456,7460,7464,7468,7472,7476],{"type":18,"tag":614,"props":7394,"children":7395},{"class":627},[7396],{"type":24,"value":7397},"    k4 ",{"type":18,"tag":614,"props":7399,"children":7400},{"class":621},[7401],{"type":24,"value":711},{"type":18,"tag":614,"props":7403,"children":7404},{"class":627},[7405],{"type":24,"value":7127},{"type":18,"tag":614,"props":7407,"children":7408},{"class":621},[7409],{"type":24,"value":1177},{"type":18,"tag":614,"props":7411,"children":7412},{"class":627},[7413],{"type":24,"value":7414}," dt ",{"type":18,"tag":614,"props":7416,"children":7417},{"class":621},[7418],{"type":24,"value":1056},{"type":18,"tag":614,"props":7420,"children":7421},{"class":627},[7422],{"type":24,"value":7423}," k3[",{"type":18,"tag":614,"props":7425,"children":7426},{"class":671},[7427],{"type":24,"value":867},{"type":18,"tag":614,"props":7429,"children":7430},{"class":627},[7431],{"type":24,"value":7170},{"type":18,"tag":614,"props":7433,"children":7434},{"class":621},[7435],{"type":24,"value":1177},{"type":18,"tag":614,"props":7437,"children":7438},{"class":627},[7439],{"type":24,"value":7414},{"type":18,"tag":614,"props":7441,"children":7442},{"class":621},[7443],{"type":24,"value":1056},{"type":18,"tag":614,"props":7445,"children":7446},{"class":627},[7447],{"type":24,"value":7423},{"type":18,"tag":614,"props":7449,"children":7450},{"class":671},[7451],{"type":24,"value":977},{"type":18,"tag":614,"props":7453,"children":7454},{"class":627},[7455],{"type":24,"value":7211},{"type":18,"tag":614,"props":7457,"children":7458},{"class":621},[7459],{"type":24,"value":1177},{"type":18,"tag":614,"props":7461,"children":7462},{"class":627},[7463],{"type":24,"value":7414},{"type":18,"tag":614,"props":7465,"children":7466},{"class":621},[7467],{"type":24,"value":1056},{"type":18,"tag":614,"props":7469,"children":7470},{"class":627},[7471],{"type":24,"value":7423},{"type":18,"tag":614,"props":7473,"children":7474},{"class":671},[7475],{"type":24,"value":1353},{"type":18,"tag":614,"props":7477,"children":7478},{"class":627},[7479],{"type":24,"value":7252},{"type":18,"tag":614,"props":7481,"children":7482},{"class":616,"line":1262},[7483],{"type":18,"tag":614,"props":7484,"children":7485},{},[7486],{"type":24,"value":650},{"type":18,"tag":614,"props":7488,"children":7489},{"class":616,"line":1270},[7490,7494],{"type":18,"tag":614,"props":7491,"children":7492},{"class":627},[7493],{"type":24,"value":659},{"type":18,"tag":614,"props":7495,"children":7496},{"class":1851},[7497],{"type":24,"value":7498},"# Update state of the robot\n",{"type":18,"tag":614,"props":7500,"children":7501},{"class":616,"line":1426},[7502,7507,7512,7517,7521,7525,7529,7533,7537,7541,7545,7549,7553,7557,7561,7565,7569,7573,7577,7581,7585,7589,7593,7598,7602,7607,7611,7615,7619,7623],{"type":18,"tag":614,"props":7503,"children":7504},{"class":627},[7505],{"type":24,"value":7506},"    x ",{"type":18,"tag":614,"props":7508,"children":7509},{"class":621},[7510],{"type":24,"value":7511},"+=",{"type":18,"tag":614,"props":7513,"children":7514},{"class":627},[7515],{"type":24,"value":7516}," (k1[",{"type":18,"tag":614,"props":7518,"children":7519},{"class":671},[7520],{"type":24,"value":867},{"type":18,"tag":614,"props":7522,"children":7523},{"class":627},[7524],{"type":24,"value":2911},{"type":18,"tag":614,"props":7526,"children":7527},{"class":621},[7528],{"type":24,"value":1177},{"type":18,"tag":614,"props":7530,"children":7531},{"class":627},[7532],{"type":24,"value":630},{"type":18,"tag":614,"props":7534,"children":7535},{"class":671},[7536],{"type":24,"value":1353},{"type":18,"tag":614,"props":7538,"children":7539},{"class":627},[7540],{"type":24,"value":630},{"type":18,"tag":614,"props":7542,"children":7543},{"class":621},[7544],{"type":24,"value":1056},{"type":18,"tag":614,"props":7546,"children":7547},{"class":627},[7548],{"type":24,"value":7301},{"type":18,"tag":614,"props":7550,"children":7551},{"class":671},[7552],{"type":24,"value":867},{"type":18,"tag":614,"props":7554,"children":7555},{"class":627},[7556],{"type":24,"value":2911},{"type":18,"tag":614,"props":7558,"children":7559},{"class":621},[7560],{"type":24,"value":1177},{"type":18,"tag":614,"props":7562,"children":7563},{"class":627},[7564],{"type":24,"value":630},{"type":18,"tag":614,"props":7566,"children":7567},{"class":671},[7568],{"type":24,"value":1353},{"type":18,"tag":614,"props":7570,"children":7571},{"class":627},[7572],{"type":24,"value":630},{"type":18,"tag":614,"props":7574,"children":7575},{"class":621},[7576],{"type":24,"value":1056},{"type":18,"tag":614,"props":7578,"children":7579},{"class":627},[7580],{"type":24,"value":7423},{"type":18,"tag":614,"props":7582,"children":7583},{"class":671},[7584],{"type":24,"value":867},{"type":18,"tag":614,"props":7586,"children":7587},{"class":627},[7588],{"type":24,"value":2911},{"type":18,"tag":614,"props":7590,"children":7591},{"class":621},[7592],{"type":24,"value":1177},{"type":18,"tag":614,"props":7594,"children":7595},{"class":627},[7596],{"type":24,"value":7597}," k4[",{"type":18,"tag":614,"props":7599,"children":7600},{"class":671},[7601],{"type":24,"value":867},{"type":18,"tag":614,"props":7603,"children":7604},{"class":627},[7605],{"type":24,"value":7606},"]) ",{"type":18,"tag":614,"props":7608,"children":7609},{"class":621},[7610],{"type":24,"value":1056},{"type":18,"tag":614,"props":7612,"children":7613},{"class":627},[7614],{"type":24,"value":7414},{"type":18,"tag":614,"props":7616,"children":7617},{"class":621},[7618],{"type":24,"value":1414},{"type":18,"tag":614,"props":7620,"children":7621},{"class":627},[7622],{"type":24,"value":630},{"type":18,"tag":614,"props":7624,"children":7625},{"class":671},[7626],{"type":24,"value":2198},{"type":18,"tag":614,"props":7628,"children":7629},{"class":616,"line":1546},[7630,7635,7639,7643,7647,7651,7655,7659,7663,7667,7671,7675,7679,7683,7687,7691,7695,7699,7703,7707,7711,7715,7719,7723,7727,7731,7735,7739,7743,7747],{"type":18,"tag":614,"props":7631,"children":7632},{"class":627},[7633],{"type":24,"value":7634},"    y ",{"type":18,"tag":614,"props":7636,"children":7637},{"class":621},[7638],{"type":24,"value":7511},{"type":18,"tag":614,"props":7640,"children":7641},{"class":627},[7642],{"type":24,"value":7516},{"type":18,"tag":614,"props":7644,"children":7645},{"class":671},[7646],{"type":24,"value":977},{"type":18,"tag":614,"props":7648,"children":7649},{"class":627},[7650],{"type":24,"value":2911},{"type":18,"tag":614,"props":7652,"children":7653},{"class":621},[7654],{"type":24,"value":1177},{"type":18,"tag":614,"props":7656,"children":7657},{"class":627},[7658],{"type":24,"value":630},{"type":18,"tag":614,"props":7660,"children":7661},{"class":671},[7662],{"type":24,"value":1353},{"type":18,"tag":614,"props":7664,"children":7665},{"class":627},[7666],{"type":24,"value":630},{"type":18,"tag":614,"props":7668,"children":7669},{"class":621},[7670],{"type":24,"value":1056},{"type":18,"tag":614,"props":7672,"children":7673},{"class":627},[7674],{"type":24,"value":7301},{"type":18,"tag":614,"props":7676,"children":7677},{"class":671},[7678],{"type":24,"value":977},{"type":18,"tag":614,"props":7680,"children":7681},{"class":627},[7682],{"type":24,"value":2911},{"type":18,"tag":614,"props":7684,"children":7685},{"class":621},[7686],{"type":24,"value":1177},{"type":18,"tag":614,"props":7688,"children":7689},{"class":627},[7690],{"type":24,"value":630},{"type":18,"tag":614,"props":7692,"children":7693},{"class":671},[7694],{"type":24,"value":1353},{"type":18,"tag":614,"props":7696,"children":7697},{"class":627},[7698],{"type":24,"value":630},{"type":18,"tag":614,"props":7700,"children":7701},{"class":621},[7702],{"type":24,"value":1056},{"type":18,"tag":614,"props":7704,"children":7705},{"class":627},[7706],{"type":24,"value":7423},{"type":18,"tag":614,"props":7708,"children":7709},{"class":671},[7710],{"type":24,"value":977},{"type":18,"tag":614,"props":7712,"children":7713},{"class":627},[7714],{"type":24,"value":2911},{"type":18,"tag":614,"props":7716,"children":7717},{"class":621},[7718],{"type":24,"value":1177},{"type":18,"tag":614,"props":7720,"children":7721},{"class":627},[7722],{"type":24,"value":7597},{"type":18,"tag":614,"props":7724,"children":7725},{"class":671},[7726],{"type":24,"value":977},{"type":18,"tag":614,"props":7728,"children":7729},{"class":627},[7730],{"type":24,"value":7606},{"type":18,"tag":614,"props":7732,"children":7733},{"class":621},[7734],{"type":24,"value":1056},{"type":18,"tag":614,"props":7736,"children":7737},{"class":627},[7738],{"type":24,"value":7414},{"type":18,"tag":614,"props":7740,"children":7741},{"class":621},[7742],{"type":24,"value":1414},{"type":18,"tag":614,"props":7744,"children":7745},{"class":627},[7746],{"type":24,"value":630},{"type":18,"tag":614,"props":7748,"children":7749},{"class":671},[7750],{"type":24,"value":2198},{"type":18,"tag":614,"props":7752,"children":7753},{"class":616,"line":1554},[7754,7759,7763,7767,7771,7775,7779,7783,7787,7791,7795,7799,7803,7807,7811,7815,7819,7823,7827,7831,7835,7839,7843,7847,7851,7855,7859,7863,7867,7871],{"type":18,"tag":614,"props":7755,"children":7756},{"class":627},[7757],{"type":24,"value":7758},"    yaw ",{"type":18,"tag":614,"props":7760,"children":7761},{"class":621},[7762],{"type":24,"value":7511},{"type":18,"tag":614,"props":7764,"children":7765},{"class":627},[7766],{"type":24,"value":7516},{"type":18,"tag":614,"props":7768,"children":7769},{"class":671},[7770],{"type":24,"value":1353},{"type":18,"tag":614,"props":7772,"children":7773},{"class":627},[7774],{"type":24,"value":2911},{"type":18,"tag":614,"props":7776,"children":7777},{"class":621},[7778],{"type":24,"value":1177},{"type":18,"tag":614,"props":7780,"children":7781},{"class":627},[7782],{"type":24,"value":630},{"type":18,"tag":614,"props":7784,"children":7785},{"class":671},[7786],{"type":24,"value":1353},{"type":18,"tag":614,"props":7788,"children":7789},{"class":627},[7790],{"type":24,"value":630},{"type":18,"tag":614,"props":7792,"children":7793},{"class":621},[7794],{"type":24,"value":1056},{"type":18,"tag":614,"props":7796,"children":7797},{"class":627},[7798],{"type":24,"value":7301},{"type":18,"tag":614,"props":7800,"children":7801},{"class":671},[7802],{"type":24,"value":1353},{"type":18,"tag":614,"props":7804,"children":7805},{"class":627},[7806],{"type":24,"value":2911},{"type":18,"tag":614,"props":7808,"children":7809},{"class":621},[7810],{"type":24,"value":1177},{"type":18,"tag":614,"props":7812,"children":7813},{"class":627},[7814],{"type":24,"value":630},{"type":18,"tag":614,"props":7816,"children":7817},{"class":671},[7818],{"type":24,"value":1353},{"type":18,"tag":614,"props":7820,"children":7821},{"class":627},[7822],{"type":24,"value":630},{"type":18,"tag":614,"props":7824,"children":7825},{"class":621},[7826],{"type":24,"value":1056},{"type":18,"tag":614,"props":7828,"children":7829},{"class":627},[7830],{"type":24,"value":7423},{"type":18,"tag":614,"props":7832,"children":7833},{"class":671},[7834],{"type":24,"value":1353},{"type":18,"tag":614,"props":7836,"children":7837},{"class":627},[7838],{"type":24,"value":2911},{"type":18,"tag":614,"props":7840,"children":7841},{"class":621},[7842],{"type":24,"value":1177},{"type":18,"tag":614,"props":7844,"children":7845},{"class":627},[7846],{"type":24,"value":7597},{"type":18,"tag":614,"props":7848,"children":7849},{"class":671},[7850],{"type":24,"value":1353},{"type":18,"tag":614,"props":7852,"children":7853},{"class":627},[7854],{"type":24,"value":7606},{"type":18,"tag":614,"props":7856,"children":7857},{"class":621},[7858],{"type":24,"value":1056},{"type":18,"tag":614,"props":7860,"children":7861},{"class":627},[7862],{"type":24,"value":7414},{"type":18,"tag":614,"props":7864,"children":7865},{"class":621},[7866],{"type":24,"value":1414},{"type":18,"tag":614,"props":7868,"children":7869},{"class":627},[7870],{"type":24,"value":630},{"type":18,"tag":614,"props":7872,"children":7873},{"class":671},[7874],{"type":24,"value":7875},"6",{"type":18,"tag":19,"props":7877,"children":7879},{"id":7878},"single-shooting-method",[7880],{"type":24,"value":7881},"Single Shooting Method",{"type":18,"tag":27,"props":7883,"children":7884},{},[7885],{"type":24,"value":7886},"Single Shooting Method is a method that we transform the optimal control problem to the nonlinear programming problem with just one decision variable.",{"type":18,"tag":65,"props":7888,"children":7890},{"latex-express":7889,"styles":68},"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}\\right]\n        \\end{align*}\n",[],{"type":18,"tag":65,"props":7892,"children":7894},{"latex-express":7893,"styles":68},"\n      \\begin{align*}\n            x_{u} &= F(w,x_{0},t_{k}) \\\\\n            F(w,x_{0},t_{0}) &= x_{0} \\\\\n        \\end{align*}\n",[],{"type":18,"tag":27,"props":7896,"children":7897},{},[7898],{"type":24,"value":7899},"Then solve the NLP",{"type":18,"tag":65,"props":7901,"children":7903},{"latex-express":7902,"styles":68},"\n      \\begin{align*}\n            \\min_{w}\\Phi(F(w,x_{0},t_{k}), w) \\\\ \n            \\text{Subject to} \\hspace{1cm}  g_{1}(F(w,x_{0},t_{k}),w) \\leq{0}\n        \\end{align*}\n",[],{"type":18,"tag":19,"props":7905,"children":7907},{"id":7906},"multiple-shooting-method",[7908],{"type":24,"value":7909},"Multiple Shooting Method",{"type":18,"tag":27,"props":7911,"children":7912},{},[7913],{"type":24,"value":7914},"Multiple Shooting Method is a method that consist of transforming of optimal control problem to the nonlinear programming problem with multiple decision variables.",{"type":18,"tag":65,"props":7916,"children":7918},{"latex-express":7917,"styles":68},"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}, x_{0}, ..., x_{N}\\right]\n        \\end{align*}\n",[],{"type":18,"tag":76,"props":7920,"children":7921},{},[7922,7930],{"type":18,"tag":80,"props":7923,"children":7924},{},[7925,7928],{"type":18,"tag":84,"props":7926,"children":7927},{"latex-express":6545,"styles":87},[],{"type":24,"value":7929}," becoming decision variable in the opimization problem as well as u",{"type":18,"tag":80,"props":7931,"children":7932},{},[7933],{"type":24,"value":7934},"We apply path constraint at each iteration step",{"type":18,"tag":65,"props":7936,"children":7938},{"latex-express":7937,"styles":68},"\n      \\begin{equation*}\n                x_{k+1}-f(x_{k},u_{k}) = 0\n            \\end{equation*}\n",[],{"type":18,"tag":27,"props":7940,"children":7941},{},[7942],{"type":24,"value":7899},{"type":18,"tag":65,"props":7944,"children":7946},{"latex-express":7945,"styles":68},"\n      \\begin{align*}\n            \\min_{w}  \\Phi(F(w,x_{0},t_{k}),& w) \\\\ \n            \\text{s.t}\\hspace{0.5cm}  g_{1}(F(w,x_{0},t_{k}),w) &\\leq{0} \\\\ \n                               g_{2}(w) = \\begin{bmatrix}\n                                  \\bar{x}_{0}-x_{0} \\\\\n                                  f(x_{0},u_{0})-x_{1} \\\\ \n                                  \\vdots \\\\\n                                  f(x_{N-1}, u_{N-1}-x_{N})\n                              \\end{bmatrix} &= 0\n        \\end{align*}\n",[],{"type":18,"tag":19,"props":7948,"children":7950},{"id":7949},"full-implement-in-python",[7951],{"type":24,"value":7952},"Full Implement in Python",{"type":18,"tag":27,"props":7954,"children":7955},{},[7956,7958,7963],{"type":24,"value":7957},"We will use ",{"type":18,"tag":4360,"props":7959,"children":7960},{},[7961],{"type":24,"value":7962},"Casadi",{"type":24,"value":7964}," as a numerical optimization framework.",{"type":18,"tag":599,"props":7966,"children":7969},{"className":7967,"code":7968,"language":604,"meta":8},[602],"import casadi as ca\n",[7970],{"type":18,"tag":607,"props":7971,"children":7972},{},[7973],{"type":18,"tag":599,"props":7974,"children":7975},{"__ignoreMap":8},[7976],{"type":18,"tag":614,"props":7977,"children":7978},{"class":616,"line":617},[7979,7983,7988,7992],{"type":18,"tag":614,"props":7980,"children":7981},{"class":621},[7982],{"type":24,"value":6711},{"type":18,"tag":614,"props":7984,"children":7985},{"class":627},[7986],{"type":24,"value":7987}," casadi ",{"type":18,"tag":614,"props":7989,"children":7990},{"class":621},[7991],{"type":24,"value":6721},{"type":18,"tag":614,"props":7993,"children":7994},{"class":627},[7995],{"type":24,"value":7996}," ca",{"type":18,"tag":27,"props":7998,"children":7999},{},[8000],{"type":24,"value":8001},"Define state representation and input control of our nonlinear model.",{"type":18,"tag":599,"props":8003,"children":8006},{"className":8004,"code":8005,"language":604,"meta":8},[602],"# Symbolic Variables\n## States\nx = ca.SX.sym(\"x\")\ny = ca.SX.sym(\"y\")\ntheta = ca.SX.sym(\"theta\")\nstates = ca.vertcat(x, y, theta)\nnum_states = states.numel()\n\n## Control\nu1 = ca.SX.sym(\"u1\")\nu2 = ca.SX.sym(\"u2\")\ncontrols = ca.vertcat(u1, u2)\nnum_controls = controls.numel()\n\n# Define Nonlinear model\n## Rotation Matrix\nrot_mat = ca.vertcat(\n    ca.horzcat(ca.cos(theta), ca.sin(theta), 0),\n    ca.horzcat(-ca.sin(theta), ca.cos(theta), 0),\n    ca.horzcat(0, 0, 1)\n)\n\nvx = u1 * ca.cos(theta)\nvy = u1 * ca.sin(theta)\nvyaw = u2\n\nrhs = ca.vertcat(vx, vy, vyaw)\n## Define mapped nonlinear function f(x,u) -> rhs\nf = ca.Function('f', [states, controls], [rhs])\n",[8007],{"type":18,"tag":607,"props":8008,"children":8009},{},[8010],{"type":18,"tag":599,"props":8011,"children":8012},{"__ignoreMap":8},[8013,8021,8029,8064,8096,8129,8146,8163,8170,8178,8211,8244,8261,8278,8285,8293,8301,8318,8335,8360,8391,8398,8405,8431,8456,8473,8480,8497,8505],{"type":18,"tag":614,"props":8014,"children":8015},{"class":616,"line":617},[8016],{"type":18,"tag":614,"props":8017,"children":8018},{"class":1851},[8019],{"type":24,"value":8020},"# Symbolic Variables\n",{"type":18,"tag":614,"props":8022,"children":8023},{"class":616,"line":644},[8024],{"type":18,"tag":614,"props":8025,"children":8026},{"class":1851},[8027],{"type":24,"value":8028},"## States\n",{"type":18,"tag":614,"props":8030,"children":8031},{"class":616,"line":653},[8032,8036,8040,8045,8050,8055,8060],{"type":18,"tag":614,"props":8033,"children":8034},{"class":627},[8035],{"type":24,"value":6806},{"type":18,"tag":614,"props":8037,"children":8038},{"class":621},[8039],{"type":24,"value":711},{"type":18,"tag":614,"props":8041,"children":8042},{"class":627},[8043],{"type":24,"value":8044}," ca.",{"type":18,"tag":614,"props":8046,"children":8047},{"class":671},[8048],{"type":24,"value":8049},"SX",{"type":18,"tag":614,"props":8051,"children":8052},{"class":627},[8053],{"type":24,"value":8054},".sym(",{"type":18,"tag":614,"props":8056,"children":8057},{"class":5349},[8058],{"type":24,"value":8059},"\"x\"",{"type":18,"tag":614,"props":8061,"children":8062},{"class":627},[8063],{"type":24,"value":1423},{"type":18,"tag":614,"props":8065,"children":8066},{"class":616,"line":682},[8067,8071,8075,8079,8083,8087,8092],{"type":18,"tag":614,"props":8068,"children":8069},{"class":627},[8070],{"type":24,"value":6827},{"type":18,"tag":614,"props":8072,"children":8073},{"class":621},[8074],{"type":24,"value":711},{"type":18,"tag":614,"props":8076,"children":8077},{"class":627},[8078],{"type":24,"value":8044},{"type":18,"tag":614,"props":8080,"children":8081},{"class":671},[8082],{"type":24,"value":8049},{"type":18,"tag":614,"props":8084,"children":8085},{"class":627},[8086],{"type":24,"value":8054},{"type":18,"tag":614,"props":8088,"children":8089},{"class":5349},[8090],{"type":24,"value":8091},"\"y\"",{"type":18,"tag":614,"props":8093,"children":8094},{"class":627},[8095],{"type":24,"value":1423},{"type":18,"tag":614,"props":8097,"children":8098},{"class":616,"line":690},[8099,8104,8108,8112,8116,8120,8125],{"type":18,"tag":614,"props":8100,"children":8101},{"class":627},[8102],{"type":24,"value":8103},"theta ",{"type":18,"tag":614,"props":8105,"children":8106},{"class":621},[8107],{"type":24,"value":711},{"type":18,"tag":614,"props":8109,"children":8110},{"class":627},[8111],{"type":24,"value":8044},{"type":18,"tag":614,"props":8113,"children":8114},{"class":671},[8115],{"type":24,"value":8049},{"type":18,"tag":614,"props":8117,"children":8118},{"class":627},[8119],{"type":24,"value":8054},{"type":18,"tag":614,"props":8121,"children":8122},{"class":5349},[8123],{"type":24,"value":8124},"\"theta\"",{"type":18,"tag":614,"props":8126,"children":8127},{"class":627},[8128],{"type":24,"value":1423},{"type":18,"tag":614,"props":8130,"children":8131},{"class":616,"line":719},[8132,8137,8141],{"type":18,"tag":614,"props":8133,"children":8134},{"class":627},[8135],{"type":24,"value":8136},"states ",{"type":18,"tag":614,"props":8138,"children":8139},{"class":621},[8140],{"type":24,"value":711},{"type":18,"tag":614,"props":8142,"children":8143},{"class":627},[8144],{"type":24,"value":8145}," ca.vertcat(x, y, theta)\n",{"type":18,"tag":614,"props":8147,"children":8148},{"class":616,"line":745},[8149,8154,8158],{"type":18,"tag":614,"props":8150,"children":8151},{"class":627},[8152],{"type":24,"value":8153},"num_states ",{"type":18,"tag":614,"props":8155,"children":8156},{"class":621},[8157],{"type":24,"value":711},{"type":18,"tag":614,"props":8159,"children":8160},{"class":627},[8161],{"type":24,"value":8162}," states.numel()\n",{"type":18,"tag":614,"props":8164,"children":8165},{"class":616,"line":771},[8166],{"type":18,"tag":614,"props":8167,"children":8168},{},[8169],{"type":24,"value":650},{"type":18,"tag":614,"props":8171,"children":8172},{"class":616,"line":779},[8173],{"type":18,"tag":614,"props":8174,"children":8175},{"class":1851},[8176],{"type":24,"value":8177},"## Control\n",{"type":18,"tag":614,"props":8179,"children":8180},{"class":616,"line":805},[8181,8186,8190,8194,8198,8202,8207],{"type":18,"tag":614,"props":8182,"children":8183},{"class":627},[8184],{"type":24,"value":8185},"u1 ",{"type":18,"tag":614,"props":8187,"children":8188},{"class":621},[8189],{"type":24,"value":711},{"type":18,"tag":614,"props":8191,"children":8192},{"class":627},[8193],{"type":24,"value":8044},{"type":18,"tag":614,"props":8195,"children":8196},{"class":671},[8197],{"type":24,"value":8049},{"type":18,"tag":614,"props":8199,"children":8200},{"class":627},[8201],{"type":24,"value":8054},{"type":18,"tag":614,"props":8203,"children":8204},{"class":5349},[8205],{"type":24,"value":8206},"\"u1\"",{"type":18,"tag":614,"props":8208,"children":8209},{"class":627},[8210],{"type":24,"value":1423},{"type":18,"tag":614,"props":8212,"children":8213},{"class":616,"line":831},[8214,8219,8223,8227,8231,8235,8240],{"type":18,"tag":614,"props":8215,"children":8216},{"class":627},[8217],{"type":24,"value":8218},"u2 ",{"type":18,"tag":614,"props":8220,"children":8221},{"class":621},[8222],{"type":24,"value":711},{"type":18,"tag":614,"props":8224,"children":8225},{"class":627},[8226],{"type":24,"value":8044},{"type":18,"tag":614,"props":8228,"children":8229},{"class":671},[8230],{"type":24,"value":8049},{"type":18,"tag":614,"props":8232,"children":8233},{"class":627},[8234],{"type":24,"value":8054},{"type":18,"tag":614,"props":8236,"children":8237},{"class":5349},[8238],{"type":24,"value":8239},"\"u2\"",{"type":18,"tag":614,"props":8241,"children":8242},{"class":627},[8243],{"type":24,"value":1423},{"type":18,"tag":614,"props":8245,"children":8246},{"class":616,"line":839},[8247,8252,8256],{"type":18,"tag":614,"props":8248,"children":8249},{"class":627},[8250],{"type":24,"value":8251},"controls ",{"type":18,"tag":614,"props":8253,"children":8254},{"class":621},[8255],{"type":24,"value":711},{"type":18,"tag":614,"props":8257,"children":8258},{"class":627},[8259],{"type":24,"value":8260}," ca.vertcat(u1, u2)\n",{"type":18,"tag":614,"props":8262,"children":8263},{"class":616,"line":875},[8264,8269,8273],{"type":18,"tag":614,"props":8265,"children":8266},{"class":627},[8267],{"type":24,"value":8268},"num_controls ",{"type":18,"tag":614,"props":8270,"children":8271},{"class":621},[8272],{"type":24,"value":711},{"type":18,"tag":614,"props":8274,"children":8275},{"class":627},[8276],{"type":24,"value":8277}," controls.numel()\n",{"type":18,"tag":614,"props":8279,"children":8280},{"class":616,"line":908},[8281],{"type":18,"tag":614,"props":8282,"children":8283},{},[8284],{"type":24,"value":650},{"type":18,"tag":614,"props":8286,"children":8287},{"class":616,"line":916},[8288],{"type":18,"tag":614,"props":8289,"children":8290},{"class":1851},[8291],{"type":24,"value":8292},"# Define Nonlinear model\n",{"type":18,"tag":614,"props":8294,"children":8295},{"class":616,"line":950},[8296],{"type":18,"tag":614,"props":8297,"children":8298},{"class":1851},[8299],{"type":24,"value":8300},"## Rotation Matrix\n",{"type":18,"tag":614,"props":8302,"children":8303},{"class":616,"line":984},[8304,8309,8313],{"type":18,"tag":614,"props":8305,"children":8306},{"class":627},[8307],{"type":24,"value":8308},"rot_mat ",{"type":18,"tag":614,"props":8310,"children":8311},{"class":621},[8312],{"type":24,"value":711},{"type":18,"tag":614,"props":8314,"children":8315},{"class":627},[8316],{"type":24,"value":8317}," ca.vertcat(\n",{"type":18,"tag":614,"props":8319,"children":8320},{"class":616,"line":992},[8321,8326,8330],{"type":18,"tag":614,"props":8322,"children":8323},{"class":627},[8324],{"type":24,"value":8325},"    ca.horzcat(ca.cos(theta), ca.sin(theta), ",{"type":18,"tag":614,"props":8327,"children":8328},{"class":671},[8329],{"type":24,"value":867},{"type":18,"tag":614,"props":8331,"children":8332},{"class":627},[8333],{"type":24,"value":8334},"),\n",{"type":18,"tag":614,"props":8336,"children":8337},{"class":616,"line":1018},[8338,8343,8347,8352,8356],{"type":18,"tag":614,"props":8339,"children":8340},{"class":627},[8341],{"type":24,"value":8342},"    ca.horzcat(",{"type":18,"tag":614,"props":8344,"children":8345},{"class":621},[8346],{"type":24,"value":1046},{"type":18,"tag":614,"props":8348,"children":8349},{"class":627},[8350],{"type":24,"value":8351},"ca.sin(theta), ca.cos(theta), ",{"type":18,"tag":614,"props":8353,"children":8354},{"class":671},[8355],{"type":24,"value":867},{"type":18,"tag":614,"props":8357,"children":8358},{"class":627},[8359],{"type":24,"value":8334},{"type":18,"tag":614,"props":8361,"children":8362},{"class":616,"line":1026},[8363,8367,8371,8375,8379,8383,8387],{"type":18,"tag":614,"props":8364,"children":8365},{"class":627},[8366],{"type":24,"value":8342},{"type":18,"tag":614,"props":8368,"children":8369},{"class":671},[8370],{"type":24,"value":867},{"type":18,"tag":614,"props":8372,"children":8373},{"class":627},[8374],{"type":24,"value":2417},{"type":18,"tag":614,"props":8376,"children":8377},{"class":671},[8378],{"type":24,"value":867},{"type":18,"tag":614,"props":8380,"children":8381},{"class":627},[8382],{"type":24,"value":2417},{"type":18,"tag":614,"props":8384,"children":8385},{"class":671},[8386],{"type":24,"value":977},{"type":18,"tag":614,"props":8388,"children":8389},{"class":627},[8390],{"type":24,"value":1423},{"type":18,"tag":614,"props":8392,"children":8393},{"class":616,"line":1068},[8394],{"type":18,"tag":614,"props":8395,"children":8396},{"class":627},[8397],{"type":24,"value":1423},{"type":18,"tag":614,"props":8399,"children":8400},{"class":616,"line":1108},[8401],{"type":18,"tag":614,"props":8402,"children":8403},{},[8404],{"type":24,"value":650},{"type":18,"tag":614,"props":8406,"children":8407},{"class":616,"line":1202},[8408,8413,8417,8422,8426],{"type":18,"tag":614,"props":8409,"children":8410},{"class":627},[8411],{"type":24,"value":8412},"vx ",{"type":18,"tag":614,"props":8414,"children":8415},{"class":621},[8416],{"type":24,"value":711},{"type":18,"tag":614,"props":8418,"children":8419},{"class":627},[8420],{"type":24,"value":8421}," u1 ",{"type":18,"tag":614,"props":8423,"children":8424},{"class":621},[8425],{"type":24,"value":1056},{"type":18,"tag":614,"props":8427,"children":8428},{"class":627},[8429],{"type":24,"value":8430}," ca.cos(theta)\n",{"type":18,"tag":614,"props":8432,"children":8433},{"class":616,"line":1210},[8434,8439,8443,8447,8451],{"type":18,"tag":614,"props":8435,"children":8436},{"class":627},[8437],{"type":24,"value":8438},"vy ",{"type":18,"tag":614,"props":8440,"children":8441},{"class":621},[8442],{"type":24,"value":711},{"type":18,"tag":614,"props":8444,"children":8445},{"class":627},[8446],{"type":24,"value":8421},{"type":18,"tag":614,"props":8448,"children":8449},{"class":621},[8450],{"type":24,"value":1056},{"type":18,"tag":614,"props":8452,"children":8453},{"class":627},[8454],{"type":24,"value":8455}," ca.sin(theta)\n",{"type":18,"tag":614,"props":8457,"children":8458},{"class":616,"line":1228},[8459,8464,8468],{"type":18,"tag":614,"props":8460,"children":8461},{"class":627},[8462],{"type":24,"value":8463},"vyaw ",{"type":18,"tag":614,"props":8465,"children":8466},{"class":621},[8467],{"type":24,"value":711},{"type":18,"tag":614,"props":8469,"children":8470},{"class":627},[8471],{"type":24,"value":8472}," u2\n",{"type":18,"tag":614,"props":8474,"children":8475},{"class":616,"line":1236},[8476],{"type":18,"tag":614,"props":8477,"children":8478},{},[8479],{"type":24,"value":650},{"type":18,"tag":614,"props":8481,"children":8482},{"class":616,"line":1262},[8483,8488,8492],{"type":18,"tag":614,"props":8484,"children":8485},{"class":627},[8486],{"type":24,"value":8487},"rhs ",{"type":18,"tag":614,"props":8489,"children":8490},{"class":621},[8491],{"type":24,"value":711},{"type":18,"tag":614,"props":8493,"children":8494},{"class":627},[8495],{"type":24,"value":8496}," ca.vertcat(vx, vy, vyaw)\n",{"type":18,"tag":614,"props":8498,"children":8499},{"class":616,"line":1270},[8500],{"type":18,"tag":614,"props":8501,"children":8502},{"class":1851},[8503],{"type":24,"value":8504},"## Define mapped nonlinear function f(x,u) -> rhs\n",{"type":18,"tag":614,"props":8506,"children":8507},{"class":616,"line":1426},[8508,8512,8516,8521,8526],{"type":18,"tag":614,"props":8509,"children":8510},{"class":627},[8511],{"type":24,"value":6950},{"type":18,"tag":614,"props":8513,"children":8514},{"class":621},[8515],{"type":24,"value":711},{"type":18,"tag":614,"props":8517,"children":8518},{"class":627},[8519],{"type":24,"value":8520}," ca.Function(",{"type":18,"tag":614,"props":8522,"children":8523},{"class":5349},[8524],{"type":24,"value":8525},"'f'",{"type":18,"tag":614,"props":8527,"children":8528},{"class":627},[8529],{"type":24,"value":8530},", [states, controls], [rhs])",{"type":18,"tag":27,"props":8532,"children":8533},{},[8534],{"type":24,"value":8535},"Declare symbolic matrix",{"type":18,"tag":599,"props":8537,"children":8540},{"className":8538,"code":8539,"language":604,"meta":8},[602],"X = ca.SX.sym('X', num_states, prediction_horizons + 1)\nX_ref = ca.SX.sym('X_ref', num_states, prediction_horizons + 1)\nU = ca.SX.sym('U', num_controls, prediction_horizons)\nU_ref = ca.SX.sym('U_ref', num_controls, prediction_horizons)\n",[8541],{"type":18,"tag":607,"props":8542,"children":8543},{},[8544],{"type":18,"tag":599,"props":8545,"children":8546},{"__ignoreMap":8},[8547,8596,8645,8678],{"type":18,"tag":614,"props":8548,"children":8549},{"class":616,"line":617},[8550,8554,8558,8562,8566,8570,8575,8580,8584,8588,8592],{"type":18,"tag":614,"props":8551,"children":8552},{"class":627},[8553],{"type":24,"value":2621},{"type":18,"tag":614,"props":8555,"children":8556},{"class":621},[8557],{"type":24,"value":711},{"type":18,"tag":614,"props":8559,"children":8560},{"class":627},[8561],{"type":24,"value":8044},{"type":18,"tag":614,"props":8563,"children":8564},{"class":671},[8565],{"type":24,"value":8049},{"type":18,"tag":614,"props":8567,"children":8568},{"class":627},[8569],{"type":24,"value":8054},{"type":18,"tag":614,"props":8571,"children":8572},{"class":5349},[8573],{"type":24,"value":8574},"'X'",{"type":18,"tag":614,"props":8576,"children":8577},{"class":627},[8578],{"type":24,"value":8579},", num_states, prediction_horizons ",{"type":18,"tag":614,"props":8581,"children":8582},{"class":621},[8583],{"type":24,"value":1177},{"type":18,"tag":614,"props":8585,"children":8586},{"class":627},[8587],{"type":24,"value":630},{"type":18,"tag":614,"props":8589,"children":8590},{"class":671},[8591],{"type":24,"value":977},{"type":18,"tag":614,"props":8593,"children":8594},{"class":627},[8595],{"type":24,"value":1423},{"type":18,"tag":614,"props":8597,"children":8598},{"class":616,"line":644},[8599,8604,8608,8612,8616,8620,8625,8629,8633,8637,8641],{"type":18,"tag":614,"props":8600,"children":8601},{"class":627},[8602],{"type":24,"value":8603},"X_ref ",{"type":18,"tag":614,"props":8605,"children":8606},{"class":621},[8607],{"type":24,"value":711},{"type":18,"tag":614,"props":8609,"children":8610},{"class":627},[8611],{"type":24,"value":8044},{"type":18,"tag":614,"props":8613,"children":8614},{"class":671},[8615],{"type":24,"value":8049},{"type":18,"tag":614,"props":8617,"children":8618},{"class":627},[8619],{"type":24,"value":8054},{"type":18,"tag":614,"props":8621,"children":8622},{"class":5349},[8623],{"type":24,"value":8624},"'X_ref'",{"type":18,"tag":614,"props":8626,"children":8627},{"class":627},[8628],{"type":24,"value":8579},{"type":18,"tag":614,"props":8630,"children":8631},{"class":621},[8632],{"type":24,"value":1177},{"type":18,"tag":614,"props":8634,"children":8635},{"class":627},[8636],{"type":24,"value":630},{"type":18,"tag":614,"props":8638,"children":8639},{"class":671},[8640],{"type":24,"value":977},{"type":18,"tag":614,"props":8642,"children":8643},{"class":627},[8644],{"type":24,"value":1423},{"type":18,"tag":614,"props":8646,"children":8647},{"class":616,"line":653},[8648,8652,8656,8660,8664,8668,8673],{"type":18,"tag":614,"props":8649,"children":8650},{"class":627},[8651],{"type":24,"value":2656},{"type":18,"tag":614,"props":8653,"children":8654},{"class":621},[8655],{"type":24,"value":711},{"type":18,"tag":614,"props":8657,"children":8658},{"class":627},[8659],{"type":24,"value":8044},{"type":18,"tag":614,"props":8661,"children":8662},{"class":671},[8663],{"type":24,"value":8049},{"type":18,"tag":614,"props":8665,"children":8666},{"class":627},[8667],{"type":24,"value":8054},{"type":18,"tag":614,"props":8669,"children":8670},{"class":5349},[8671],{"type":24,"value":8672},"'U'",{"type":18,"tag":614,"props":8674,"children":8675},{"class":627},[8676],{"type":24,"value":8677},", num_controls, prediction_horizons)\n",{"type":18,"tag":614,"props":8679,"children":8680},{"class":616,"line":682},[8681,8686,8690,8694,8698,8702,8707],{"type":18,"tag":614,"props":8682,"children":8683},{"class":627},[8684],{"type":24,"value":8685},"U_ref ",{"type":18,"tag":614,"props":8687,"children":8688},{"class":621},[8689],{"type":24,"value":711},{"type":18,"tag":614,"props":8691,"children":8692},{"class":627},[8693],{"type":24,"value":8044},{"type":18,"tag":614,"props":8695,"children":8696},{"class":671},[8697],{"type":24,"value":8049},{"type":18,"tag":614,"props":8699,"children":8700},{"class":627},[8701],{"type":24,"value":8054},{"type":18,"tag":614,"props":8703,"children":8704},{"class":5349},[8705],{"type":24,"value":8706},"'U_ref'",{"type":18,"tag":614,"props":8708,"children":8709},{"class":627},[8710],{"type":24,"value":8711},", num_controls, prediction_horizons)",{"type":18,"tag":27,"props":8713,"children":8714},{},[8715,8717],{"type":24,"value":8716},"Define nonlinear programming and options for ",{"type":18,"tag":4360,"props":8718,"children":8719},{},[8720],{"type":24,"value":7962},{"type":18,"tag":599,"props":8722,"children":8725},{"className":8723,"code":8724,"language":604,"meta":8},[602],"nlp_prob = {\n    'f': cost_fn,\n    'x': opt_var,\n    'p': opt_dec,\n    'g': g\n}\n\nnlp_opts = {\n    'ipopt.max_iter': 5000,\n    'ipopt.print_level': 0,\n    'ipopt.acceptable_tol': 1e-6,\n    'ipopt.acceptable_obj_change_tol': 1e-4,\n    'print_time': 0\n}\n",[8726],{"type":18,"tag":607,"props":8727,"children":8728},{},[8729],{"type":18,"tag":599,"props":8730,"children":8731},{"__ignoreMap":8},[8732,8749,8765,8782,8799,8816,8824,8831,8847,8873,8897,8922,8947,8968],{"type":18,"tag":614,"props":8733,"children":8734},{"class":616,"line":617},[8735,8740,8744],{"type":18,"tag":614,"props":8736,"children":8737},{"class":627},[8738],{"type":24,"value":8739},"nlp_prob ",{"type":18,"tag":614,"props":8741,"children":8742},{"class":621},[8743],{"type":24,"value":711},{"type":18,"tag":614,"props":8745,"children":8746},{"class":627},[8747],{"type":24,"value":8748}," {\n",{"type":18,"tag":614,"props":8750,"children":8751},{"class":616,"line":644},[8752,8756,8760],{"type":18,"tag":614,"props":8753,"children":8754},{"class":627},[8755],{"type":24,"value":659},{"type":18,"tag":614,"props":8757,"children":8758},{"class":5349},[8759],{"type":24,"value":8525},{"type":18,"tag":614,"props":8761,"children":8762},{"class":627},[8763],{"type":24,"value":8764},": cost_fn,\n",{"type":18,"tag":614,"props":8766,"children":8767},{"class":616,"line":653},[8768,8772,8777],{"type":18,"tag":614,"props":8769,"children":8770},{"class":627},[8771],{"type":24,"value":659},{"type":18,"tag":614,"props":8773,"children":8774},{"class":5349},[8775],{"type":24,"value":8776},"'x'",{"type":18,"tag":614,"props":8778,"children":8779},{"class":627},[8780],{"type":24,"value":8781},": opt_var,\n",{"type":18,"tag":614,"props":8783,"children":8784},{"class":616,"line":682},[8785,8789,8794],{"type":18,"tag":614,"props":8786,"children":8787},{"class":627},[8788],{"type":24,"value":659},{"type":18,"tag":614,"props":8790,"children":8791},{"class":5349},[8792],{"type":24,"value":8793},"'p'",{"type":18,"tag":614,"props":8795,"children":8796},{"class":627},[8797],{"type":24,"value":8798},": opt_dec,\n",{"type":18,"tag":614,"props":8800,"children":8801},{"class":616,"line":690},[8802,8806,8811],{"type":18,"tag":614,"props":8803,"children":8804},{"class":627},[8805],{"type":24,"value":659},{"type":18,"tag":614,"props":8807,"children":8808},{"class":5349},[8809],{"type":24,"value":8810},"'g'",{"type":18,"tag":614,"props":8812,"children":8813},{"class":627},[8814],{"type":24,"value":8815},": g\n",{"type":18,"tag":614,"props":8817,"children":8818},{"class":616,"line":719},[8819],{"type":18,"tag":614,"props":8820,"children":8821},{"class":627},[8822],{"type":24,"value":8823},"}\n",{"type":18,"tag":614,"props":8825,"children":8826},{"class":616,"line":745},[8827],{"type":18,"tag":614,"props":8828,"children":8829},{},[8830],{"type":24,"value":650},{"type":18,"tag":614,"props":8832,"children":8833},{"class":616,"line":771},[8834,8839,8843],{"type":18,"tag":614,"props":8835,"children":8836},{"class":627},[8837],{"type":24,"value":8838},"nlp_opts ",{"type":18,"tag":614,"props":8840,"children":8841},{"class":621},[8842],{"type":24,"value":711},{"type":18,"tag":614,"props":8844,"children":8845},{"class":627},[8846],{"type":24,"value":8748},{"type":18,"tag":614,"props":8848,"children":8849},{"class":616,"line":779},[8850,8854,8859,8863,8868],{"type":18,"tag":614,"props":8851,"children":8852},{"class":627},[8853],{"type":24,"value":659},{"type":18,"tag":614,"props":8855,"children":8856},{"class":5349},[8857],{"type":24,"value":8858},"'ipopt.max_iter'",{"type":18,"tag":614,"props":8860,"children":8861},{"class":627},[8862],{"type":24,"value":477},{"type":18,"tag":614,"props":8864,"children":8865},{"class":671},[8866],{"type":24,"value":8867},"5000",{"type":18,"tag":614,"props":8869,"children":8870},{"class":627},[8871],{"type":24,"value":8872},",\n",{"type":18,"tag":614,"props":8874,"children":8875},{"class":616,"line":805},[8876,8880,8885,8889,8893],{"type":18,"tag":614,"props":8877,"children":8878},{"class":627},[8879],{"type":24,"value":659},{"type":18,"tag":614,"props":8881,"children":8882},{"class":5349},[8883],{"type":24,"value":8884},"'ipopt.print_level'",{"type":18,"tag":614,"props":8886,"children":8887},{"class":627},[8888],{"type":24,"value":477},{"type":18,"tag":614,"props":8890,"children":8891},{"class":671},[8892],{"type":24,"value":867},{"type":18,"tag":614,"props":8894,"children":8895},{"class":627},[8896],{"type":24,"value":8872},{"type":18,"tag":614,"props":8898,"children":8899},{"class":616,"line":831},[8900,8904,8909,8913,8918],{"type":18,"tag":614,"props":8901,"children":8902},{"class":627},[8903],{"type":24,"value":659},{"type":18,"tag":614,"props":8905,"children":8906},{"class":5349},[8907],{"type":24,"value":8908},"'ipopt.acceptable_tol'",{"type":18,"tag":614,"props":8910,"children":8911},{"class":627},[8912],{"type":24,"value":477},{"type":18,"tag":614,"props":8914,"children":8915},{"class":671},[8916],{"type":24,"value":8917},"1e-6",{"type":18,"tag":614,"props":8919,"children":8920},{"class":627},[8921],{"type":24,"value":8872},{"type":18,"tag":614,"props":8923,"children":8924},{"class":616,"line":839},[8925,8929,8934,8938,8943],{"type":18,"tag":614,"props":8926,"children":8927},{"class":627},[8928],{"type":24,"value":659},{"type":18,"tag":614,"props":8930,"children":8931},{"class":5349},[8932],{"type":24,"value":8933},"'ipopt.acceptable_obj_change_tol'",{"type":18,"tag":614,"props":8935,"children":8936},{"class":627},[8937],{"type":24,"value":477},{"type":18,"tag":614,"props":8939,"children":8940},{"class":671},[8941],{"type":24,"value":8942},"1e-4",{"type":18,"tag":614,"props":8944,"children":8945},{"class":627},[8946],{"type":24,"value":8872},{"type":18,"tag":614,"props":8948,"children":8949},{"class":616,"line":875},[8950,8954,8959,8963],{"type":18,"tag":614,"props":8951,"children":8952},{"class":627},[8953],{"type":24,"value":659},{"type":18,"tag":614,"props":8955,"children":8956},{"class":5349},[8957],{"type":24,"value":8958},"'print_time'",{"type":18,"tag":614,"props":8960,"children":8961},{"class":627},[8962],{"type":24,"value":477},{"type":18,"tag":614,"props":8964,"children":8965},{"class":671},[8966],{"type":24,"value":8967},"0\n",{"type":18,"tag":614,"props":8969,"children":8970},{"class":616,"line":908},[8971],{"type":18,"tag":614,"props":8972,"children":8973},{"class":627},[8974],{"type":24,"value":8975},"}",{"type":18,"tag":27,"props":8977,"children":8978},{},[8979],{"type":24,"value":8980},"Determine boundary and constraint for our optimizer",{"type":18,"tag":599,"props":8982,"children":8985},{"className":8983,"code":8984,"language":604,"meta":8},[602],"lbx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\nubx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\n\nlbx[0: num_states * (prediction_horizons + 1): num_states] = x_min\nlbx[1: num_states * (prediction_horizons + 1): num_states] = y_min\nlbx[2: num_states * (prediction_horizons + 1): num_states] = theta_min\n\nubx[0: num_states * (prediction_horizons + 1): num_states] = x_max\nubx[1: num_states * (prediction_horizons + 1): num_states] = y_max\nubx[2: num_states * (prediction_horizons + 1): num_states] = theta_max\n\nlbx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\nlbx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\n\nubx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\nubx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\n\nargs = {\n    'lbg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'ubg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'lbx': lbx,\n    'ubx': ubx\n}\n",[8986],{"type":18,"tag":607,"props":8987,"children":8988},{},[8989],{"type":18,"tag":599,"props":8990,"children":8991},{"__ignoreMap":8},[8992,9069,9141,9148,9199,9247,9295,9302,9351,9399,9447,9454,9537,9632,9639,9720,9815,9822,9838,9897,9953,9970,9987],{"type":18,"tag":614,"props":8993,"children":8994},{"class":616,"line":617},[8995,9000,9004,9008,9013,9018,9022,9027,9031,9035,9039,9043,9047,9052,9056,9061,9065],{"type":18,"tag":614,"props":8996,"children":8997},{"class":627},[8998],{"type":24,"value":8999},"lbx ",{"type":18,"tag":614,"props":9001,"children":9002},{"class":621},[9003],{"type":24,"value":711},{"type":18,"tag":614,"props":9005,"children":9006},{"class":627},[9007],{"type":24,"value":8044},{"type":18,"tag":614,"props":9009,"children":9010},{"class":671},[9011],{"type":24,"value":9012},"DM",{"type":18,"tag":614,"props":9014,"children":9015},{"class":627},[9016],{"type":24,"value":9017},".zeros((num_states ",{"type":18,"tag":614,"props":9019,"children":9020},{"class":621},[9021],{"type":24,"value":1056},{"type":18,"tag":614,"props":9023,"children":9024},{"class":627},[9025],{"type":24,"value":9026}," (prediction_horizons ",{"type":18,"tag":614,"props":9028,"children":9029},{"class":621},[9030],{"type":24,"value":1177},{"type":18,"tag":614,"props":9032,"children":9033},{"class":627},[9034],{"type":24,"value":630},{"type":18,"tag":614,"props":9036,"children":9037},{"class":671},[9038],{"type":24,"value":977},{"type":18,"tag":614,"props":9040,"children":9041},{"class":627},[9042],{"type":24,"value":5357},{"type":18,"tag":614,"props":9044,"children":9045},{"class":621},[9046],{"type":24,"value":1177},{"type":18,"tag":614,"props":9048,"children":9049},{"class":627},[9050],{"type":24,"value":9051}," num_controls ",{"type":18,"tag":614,"props":9053,"children":9054},{"class":621},[9055],{"type":24,"value":1056},{"type":18,"tag":614,"props":9057,"children":9058},{"class":627},[9059],{"type":24,"value":9060}," prediction_horizons, ",{"type":18,"tag":614,"props":9062,"children":9063},{"class":671},[9064],{"type":24,"value":977},{"type":18,"tag":614,"props":9066,"children":9067},{"class":627},[9068],{"type":24,"value":5134},{"type":18,"tag":614,"props":9070,"children":9071},{"class":616,"line":644},[9072,9077,9081,9085,9089,9093,9097,9101,9105,9109,9113,9117,9121,9125,9129,9133,9137],{"type":18,"tag":614,"props":9073,"children":9074},{"class":627},[9075],{"type":24,"value":9076},"ubx ",{"type":18,"tag":614,"props":9078,"children":9079},{"class":621},[9080],{"type":24,"value":711},{"type":18,"tag":614,"props":9082,"children":9083},{"class":627},[9084],{"type":24,"value":8044},{"type":18,"tag":614,"props":9086,"children":9087},{"class":671},[9088],{"type":24,"value":9012},{"type":18,"tag":614,"props":9090,"children":9091},{"class":627},[9092],{"type":24,"value":9017},{"type":18,"tag":614,"props":9094,"children":9095},{"class":621},[9096],{"type":24,"value":1056},{"type":18,"tag":614,"props":9098,"children":9099},{"class":627},[9100],{"type":24,"value":9026},{"type":18,"tag":614,"props":9102,"children":9103},{"class":621},[9104],{"type":24,"value":1177},{"type":18,"tag":614,"props":9106,"children":9107},{"class":627},[9108],{"type":24,"value":630},{"type":18,"tag":614,"props":9110,"children":9111},{"class":671},[9112],{"type":24,"value":977},{"type":18,"tag":614,"props":9114,"children":9115},{"class":627},[9116],{"type":24,"value":5357},{"type":18,"tag":614,"props":9118,"children":9119},{"class":621},[9120],{"type":24,"value":1177},{"type":18,"tag":614,"props":9122,"children":9123},{"class":627},[9124],{"type":24,"value":9051},{"type":18,"tag":614,"props":9126,"children":9127},{"class":621},[9128],{"type":24,"value":1056},{"type":18,"tag":614,"props":9130,"children":9131},{"class":627},[9132],{"type":24,"value":9060},{"type":18,"tag":614,"props":9134,"children":9135},{"class":671},[9136],{"type":24,"value":977},{"type":18,"tag":614,"props":9138,"children":9139},{"class":627},[9140],{"type":24,"value":5134},{"type":18,"tag":614,"props":9142,"children":9143},{"class":616,"line":653},[9144],{"type":18,"tag":614,"props":9145,"children":9146},{},[9147],{"type":24,"value":650},{"type":18,"tag":614,"props":9149,"children":9150},{"class":616,"line":682},[9151,9156,9160,9165,9169,9173,9177,9181,9185,9190,9194],{"type":18,"tag":614,"props":9152,"children":9153},{"class":627},[9154],{"type":24,"value":9155},"lbx[",{"type":18,"tag":614,"props":9157,"children":9158},{"class":671},[9159],{"type":24,"value":867},{"type":18,"tag":614,"props":9161,"children":9162},{"class":627},[9163],{"type":24,"value":9164},": num_states ",{"type":18,"tag":614,"props":9166,"children":9167},{"class":621},[9168],{"type":24,"value":1056},{"type":18,"tag":614,"props":9170,"children":9171},{"class":627},[9172],{"type":24,"value":9026},{"type":18,"tag":614,"props":9174,"children":9175},{"class":621},[9176],{"type":24,"value":1177},{"type":18,"tag":614,"props":9178,"children":9179},{"class":627},[9180],{"type":24,"value":630},{"type":18,"tag":614,"props":9182,"children":9183},{"class":671},[9184],{"type":24,"value":977},{"type":18,"tag":614,"props":9186,"children":9187},{"class":627},[9188],{"type":24,"value":9189},"): num_states] ",{"type":18,"tag":614,"props":9191,"children":9192},{"class":621},[9193],{"type":24,"value":711},{"type":18,"tag":614,"props":9195,"children":9196},{"class":627},[9197],{"type":24,"value":9198}," x_min\n",{"type":18,"tag":614,"props":9200,"children":9201},{"class":616,"line":690},[9202,9206,9210,9214,9218,9222,9226,9230,9234,9238,9242],{"type":18,"tag":614,"props":9203,"children":9204},{"class":627},[9205],{"type":24,"value":9155},{"type":18,"tag":614,"props":9207,"children":9208},{"class":671},[9209],{"type":24,"value":977},{"type":18,"tag":614,"props":9211,"children":9212},{"class":627},[9213],{"type":24,"value":9164},{"type":18,"tag":614,"props":9215,"children":9216},{"class":621},[9217],{"type":24,"value":1056},{"type":18,"tag":614,"props":9219,"children":9220},{"class":627},[9221],{"type":24,"value":9026},{"type":18,"tag":614,"props":9223,"children":9224},{"class":621},[9225],{"type":24,"value":1177},{"type":18,"tag":614,"props":9227,"children":9228},{"class":627},[9229],{"type":24,"value":630},{"type":18,"tag":614,"props":9231,"children":9232},{"class":671},[9233],{"type":24,"value":977},{"type":18,"tag":614,"props":9235,"children":9236},{"class":627},[9237],{"type":24,"value":9189},{"type":18,"tag":614,"props":9239,"children":9240},{"class":621},[9241],{"type":24,"value":711},{"type":18,"tag":614,"props":9243,"children":9244},{"class":627},[9245],{"type":24,"value":9246}," y_min\n",{"type":18,"tag":614,"props":9248,"children":9249},{"class":616,"line":719},[9250,9254,9258,9262,9266,9270,9274,9278,9282,9286,9290],{"type":18,"tag":614,"props":9251,"children":9252},{"class":627},[9253],{"type":24,"value":9155},{"type":18,"tag":614,"props":9255,"children":9256},{"class":671},[9257],{"type":24,"value":1353},{"type":18,"tag":614,"props":9259,"children":9260},{"class":627},[9261],{"type":24,"value":9164},{"type":18,"tag":614,"props":9263,"children":9264},{"class":621},[9265],{"type":24,"value":1056},{"type":18,"tag":614,"props":9267,"children":9268},{"class":627},[9269],{"type":24,"value":9026},{"type":18,"tag":614,"props":9271,"children":9272},{"class":621},[9273],{"type":24,"value":1177},{"type":18,"tag":614,"props":9275,"children":9276},{"class":627},[9277],{"type":24,"value":630},{"type":18,"tag":614,"props":9279,"children":9280},{"class":671},[9281],{"type":24,"value":977},{"type":18,"tag":614,"props":9283,"children":9284},{"class":627},[9285],{"type":24,"value":9189},{"type":18,"tag":614,"props":9287,"children":9288},{"class":621},[9289],{"type":24,"value":711},{"type":18,"tag":614,"props":9291,"children":9292},{"class":627},[9293],{"type":24,"value":9294}," theta_min\n",{"type":18,"tag":614,"props":9296,"children":9297},{"class":616,"line":745},[9298],{"type":18,"tag":614,"props":9299,"children":9300},{},[9301],{"type":24,"value":650},{"type":18,"tag":614,"props":9303,"children":9304},{"class":616,"line":771},[9305,9310,9314,9318,9322,9326,9330,9334,9338,9342,9346],{"type":18,"tag":614,"props":9306,"children":9307},{"class":627},[9308],{"type":24,"value":9309},"ubx[",{"type":18,"tag":614,"props":9311,"children":9312},{"class":671},[9313],{"type":24,"value":867},{"type":18,"tag":614,"props":9315,"children":9316},{"class":627},[9317],{"type":24,"value":9164},{"type":18,"tag":614,"props":9319,"children":9320},{"class":621},[9321],{"type":24,"value":1056},{"type":18,"tag":614,"props":9323,"children":9324},{"class":627},[9325],{"type":24,"value":9026},{"type":18,"tag":614,"props":9327,"children":9328},{"class":621},[9329],{"type":24,"value":1177},{"type":18,"tag":614,"props":9331,"children":9332},{"class":627},[9333],{"type":24,"value":630},{"type":18,"tag":614,"props":9335,"children":9336},{"class":671},[9337],{"type":24,"value":977},{"type":18,"tag":614,"props":9339,"children":9340},{"class":627},[9341],{"type":24,"value":9189},{"type":18,"tag":614,"props":9343,"children":9344},{"class":621},[9345],{"type":24,"value":711},{"type":18,"tag":614,"props":9347,"children":9348},{"class":627},[9349],{"type":24,"value":9350}," x_max\n",{"type":18,"tag":614,"props":9352,"children":9353},{"class":616,"line":779},[9354,9358,9362,9366,9370,9374,9378,9382,9386,9390,9394],{"type":18,"tag":614,"props":9355,"children":9356},{"class":627},[9357],{"type":24,"value":9309},{"type":18,"tag":614,"props":9359,"children":9360},{"class":671},[9361],{"type":24,"value":977},{"type":18,"tag":614,"props":9363,"children":9364},{"class":627},[9365],{"type":24,"value":9164},{"type":18,"tag":614,"props":9367,"children":9368},{"class":621},[9369],{"type":24,"value":1056},{"type":18,"tag":614,"props":9371,"children":9372},{"class":627},[9373],{"type":24,"value":9026},{"type":18,"tag":614,"props":9375,"children":9376},{"class":621},[9377],{"type":24,"value":1177},{"type":18,"tag":614,"props":9379,"children":9380},{"class":627},[9381],{"type":24,"value":630},{"type":18,"tag":614,"props":9383,"children":9384},{"class":671},[9385],{"type":24,"value":977},{"type":18,"tag":614,"props":9387,"children":9388},{"class":627},[9389],{"type":24,"value":9189},{"type":18,"tag":614,"props":9391,"children":9392},{"class":621},[9393],{"type":24,"value":711},{"type":18,"tag":614,"props":9395,"children":9396},{"class":627},[9397],{"type":24,"value":9398}," y_max\n",{"type":18,"tag":614,"props":9400,"children":9401},{"class":616,"line":805},[9402,9406,9410,9414,9418,9422,9426,9430,9434,9438,9442],{"type":18,"tag":614,"props":9403,"children":9404},{"class":627},[9405],{"type":24,"value":9309},{"type":18,"tag":614,"props":9407,"children":9408},{"class":671},[9409],{"type":24,"value":1353},{"type":18,"tag":614,"props":9411,"children":9412},{"class":627},[9413],{"type":24,"value":9164},{"type":18,"tag":614,"props":9415,"children":9416},{"class":621},[9417],{"type":24,"value":1056},{"type":18,"tag":614,"props":9419,"children":9420},{"class":627},[9421],{"type":24,"value":9026},{"type":18,"tag":614,"props":9423,"children":9424},{"class":621},[9425],{"type":24,"value":1177},{"type":18,"tag":614,"props":9427,"children":9428},{"class":627},[9429],{"type":24,"value":630},{"type":18,"tag":614,"props":9431,"children":9432},{"class":671},[9433],{"type":24,"value":977},{"type":18,"tag":614,"props":9435,"children":9436},{"class":627},[9437],{"type":24,"value":9189},{"type":18,"tag":614,"props":9439,"children":9440},{"class":621},[9441],{"type":24,"value":711},{"type":18,"tag":614,"props":9443,"children":9444},{"class":627},[9445],{"type":24,"value":9446}," theta_max\n",{"type":18,"tag":614,"props":9448,"children":9449},{"class":616,"line":831},[9450],{"type":18,"tag":614,"props":9451,"children":9452},{},[9453],{"type":24,"value":650},{"type":18,"tag":614,"props":9455,"children":9456},{"class":616,"line":839},[9457,9462,9466,9470,9474,9478,9482,9487,9491,9495,9499,9503,9507,9511,9515,9519,9523,9528,9532],{"type":18,"tag":614,"props":9458,"children":9459},{"class":627},[9460],{"type":24,"value":9461},"lbx[num_states ",{"type":18,"tag":614,"props":9463,"children":9464},{"class":621},[9465],{"type":24,"value":1056},{"type":18,"tag":614,"props":9467,"children":9468},{"class":627},[9469],{"type":24,"value":9026},{"type":18,"tag":614,"props":9471,"children":9472},{"class":621},[9473],{"type":24,"value":1177},{"type":18,"tag":614,"props":9475,"children":9476},{"class":627},[9477],{"type":24,"value":630},{"type":18,"tag":614,"props":9479,"children":9480},{"class":671},[9481],{"type":24,"value":977},{"type":18,"tag":614,"props":9483,"children":9484},{"class":627},[9485],{"type":24,"value":9486},"): num_states ",{"type":18,"tag":614,"props":9488,"children":9489},{"class":621},[9490],{"type":24,"value":1056},{"type":18,"tag":614,"props":9492,"children":9493},{"class":627},[9494],{"type":24,"value":9026},{"type":18,"tag":614,"props":9496,"children":9497},{"class":621},[9498],{"type":24,"value":1177},{"type":18,"tag":614,"props":9500,"children":9501},{"class":627},[9502],{"type":24,"value":630},{"type":18,"tag":614,"props":9504,"children":9505},{"class":671},[9506],{"type":24,"value":977},{"type":18,"tag":614,"props":9508,"children":9509},{"class":627},[9510],{"type":24,"value":5357},{"type":18,"tag":614,"props":9512,"children":9513},{"class":621},[9514],{"type":24,"value":1177},{"type":18,"tag":614,"props":9516,"children":9517},{"class":627},[9518],{"type":24,"value":9051},{"type":18,"tag":614,"props":9520,"children":9521},{"class":621},[9522],{"type":24,"value":1056},{"type":18,"tag":614,"props":9524,"children":9525},{"class":627},[9526],{"type":24,"value":9527}," prediction_horizons: num_controls] ",{"type":18,"tag":614,"props":9529,"children":9530},{"class":621},[9531],{"type":24,"value":711},{"type":18,"tag":614,"props":9533,"children":9534},{"class":627},[9535],{"type":24,"value":9536}," u_min\n",{"type":18,"tag":614,"props":9538,"children":9539},{"class":616,"line":875},[9540,9544,9548,9552,9556,9560,9564,9568,9572,9576,9580,9584,9588,9592,9596,9600,9604,9608,9612,9616,9620,9624,9628],{"type":18,"tag":614,"props":9541,"children":9542},{"class":627},[9543],{"type":24,"value":9461},{"type":18,"tag":614,"props":9545,"children":9546},{"class":621},[9547],{"type":24,"value":1056},{"type":18,"tag":614,"props":9549,"children":9550},{"class":627},[9551],{"type":24,"value":9026},{"type":18,"tag":614,"props":9553,"children":9554},{"class":621},[9555],{"type":24,"value":1177},{"type":18,"tag":614,"props":9557,"children":9558},{"class":627},[9559],{"type":24,"value":630},{"type":18,"tag":614,"props":9561,"children":9562},{"class":671},[9563],{"type":24,"value":977},{"type":18,"tag":614,"props":9565,"children":9566},{"class":627},[9567],{"type":24,"value":5357},{"type":18,"tag":614,"props":9569,"children":9570},{"class":621},[9571],{"type":24,"value":1177},{"type":18,"tag":614,"props":9573,"children":9574},{"class":627},[9575],{"type":24,"value":630},{"type":18,"tag":614,"props":9577,"children":9578},{"class":671},[9579],{"type":24,"value":977},{"type":18,"tag":614,"props":9581,"children":9582},{"class":627},[9583],{"type":24,"value":9164},{"type":18,"tag":614,"props":9585,"children":9586},{"class":621},[9587],{"type":24,"value":1056},{"type":18,"tag":614,"props":9589,"children":9590},{"class":627},[9591],{"type":24,"value":9026},{"type":18,"tag":614,"props":9593,"children":9594},{"class":621},[9595],{"type":24,"value":1177},{"type":18,"tag":614,"props":9597,"children":9598},{"class":627},[9599],{"type":24,"value":630},{"type":18,"tag":614,"props":9601,"children":9602},{"class":671},[9603],{"type":24,"value":977},{"type":18,"tag":614,"props":9605,"children":9606},{"class":627},[9607],{"type":24,"value":5357},{"type":18,"tag":614,"props":9609,"children":9610},{"class":621},[9611],{"type":24,"value":1177},{"type":18,"tag":614,"props":9613,"children":9614},{"class":627},[9615],{"type":24,"value":9051},{"type":18,"tag":614,"props":9617,"children":9618},{"class":621},[9619],{"type":24,"value":1056},{"type":18,"tag":614,"props":9621,"children":9622},{"class":627},[9623],{"type":24,"value":9527},{"type":18,"tag":614,"props":9625,"children":9626},{"class":621},[9627],{"type":24,"value":711},{"type":18,"tag":614,"props":9629,"children":9630},{"class":627},[9631],{"type":24,"value":9536},{"type":18,"tag":614,"props":9633,"children":9634},{"class":616,"line":908},[9635],{"type":18,"tag":614,"props":9636,"children":9637},{},[9638],{"type":24,"value":650},{"type":18,"tag":614,"props":9640,"children":9641},{"class":616,"line":916},[9642,9647,9651,9655,9659,9663,9667,9671,9675,9679,9683,9687,9691,9695,9699,9703,9707,9711,9715],{"type":18,"tag":614,"props":9643,"children":9644},{"class":627},[9645],{"type":24,"value":9646},"ubx[num_states ",{"type":18,"tag":614,"props":9648,"children":9649},{"class":621},[9650],{"type":24,"value":1056},{"type":18,"tag":614,"props":9652,"children":9653},{"class":627},[9654],{"type":24,"value":9026},{"type":18,"tag":614,"props":9656,"children":9657},{"class":621},[9658],{"type":24,"value":1177},{"type":18,"tag":614,"props":9660,"children":9661},{"class":627},[9662],{"type":24,"value":630},{"type":18,"tag":614,"props":9664,"children":9665},{"class":671},[9666],{"type":24,"value":977},{"type":18,"tag":614,"props":9668,"children":9669},{"class":627},[9670],{"type":24,"value":9486},{"type":18,"tag":614,"props":9672,"children":9673},{"class":621},[9674],{"type":24,"value":1056},{"type":18,"tag":614,"props":9676,"children":9677},{"class":627},[9678],{"type":24,"value":9026},{"type":18,"tag":614,"props":9680,"children":9681},{"class":621},[9682],{"type":24,"value":1177},{"type":18,"tag":614,"props":9684,"children":9685},{"class":627},[9686],{"type":24,"value":630},{"type":18,"tag":614,"props":9688,"children":9689},{"class":671},[9690],{"type":24,"value":977},{"type":18,"tag":614,"props":9692,"children":9693},{"class":627},[9694],{"type":24,"value":5357},{"type":18,"tag":614,"props":9696,"children":9697},{"class":621},[9698],{"type":24,"value":1177},{"type":18,"tag":614,"props":9700,"children":9701},{"class":627},[9702],{"type":24,"value":9051},{"type":18,"tag":614,"props":9704,"children":9705},{"class":621},[9706],{"type":24,"value":1056},{"type":18,"tag":614,"props":9708,"children":9709},{"class":627},[9710],{"type":24,"value":9527},{"type":18,"tag":614,"props":9712,"children":9713},{"class":621},[9714],{"type":24,"value":711},{"type":18,"tag":614,"props":9716,"children":9717},{"class":627},[9718],{"type":24,"value":9719}," u_max\n",{"type":18,"tag":614,"props":9721,"children":9722},{"class":616,"line":950},[9723,9727,9731,9735,9739,9743,9747,9751,9755,9759,9763,9767,9771,9775,9779,9783,9787,9791,9795,9799,9803,9807,9811],{"type":18,"tag":614,"props":9724,"children":9725},{"class":627},[9726],{"type":24,"value":9646},{"type":18,"tag":614,"props":9728,"children":9729},{"class":621},[9730],{"type":24,"value":1056},{"type":18,"tag":614,"props":9732,"children":9733},{"class":627},[9734],{"type":24,"value":9026},{"type":18,"tag":614,"props":9736,"children":9737},{"class":621},[9738],{"type":24,"value":1177},{"type":18,"tag":614,"props":9740,"children":9741},{"class":627},[9742],{"type":24,"value":630},{"type":18,"tag":614,"props":9744,"children":9745},{"class":671},[9746],{"type":24,"value":977},{"type":18,"tag":614,"props":9748,"children":9749},{"class":627},[9750],{"type":24,"value":5357},{"type":18,"tag":614,"props":9752,"children":9753},{"class":621},[9754],{"type":24,"value":1177},{"type":18,"tag":614,"props":9756,"children":9757},{"class":627},[9758],{"type":24,"value":630},{"type":18,"tag":614,"props":9760,"children":9761},{"class":671},[9762],{"type":24,"value":977},{"type":18,"tag":614,"props":9764,"children":9765},{"class":627},[9766],{"type":24,"value":9164},{"type":18,"tag":614,"props":9768,"children":9769},{"class":621},[9770],{"type":24,"value":1056},{"type":18,"tag":614,"props":9772,"children":9773},{"class":627},[9774],{"type":24,"value":9026},{"type":18,"tag":614,"props":9776,"children":9777},{"class":621},[9778],{"type":24,"value":1177},{"type":18,"tag":614,"props":9780,"children":9781},{"class":627},[9782],{"type":24,"value":630},{"type":18,"tag":614,"props":9784,"children":9785},{"class":671},[9786],{"type":24,"value":977},{"type":18,"tag":614,"props":9788,"children":9789},{"class":627},[9790],{"type":24,"value":5357},{"type":18,"tag":614,"props":9792,"children":9793},{"class":621},[9794],{"type":24,"value":1177},{"type":18,"tag":614,"props":9796,"children":9797},{"class":627},[9798],{"type":24,"value":9051},{"type":18,"tag":614,"props":9800,"children":9801},{"class":621},[9802],{"type":24,"value":1056},{"type":18,"tag":614,"props":9804,"children":9805},{"class":627},[9806],{"type":24,"value":9527},{"type":18,"tag":614,"props":9808,"children":9809},{"class":621},[9810],{"type":24,"value":711},{"type":18,"tag":614,"props":9812,"children":9813},{"class":627},[9814],{"type":24,"value":9719},{"type":18,"tag":614,"props":9816,"children":9817},{"class":616,"line":984},[9818],{"type":18,"tag":614,"props":9819,"children":9820},{},[9821],{"type":24,"value":650},{"type":18,"tag":614,"props":9823,"children":9824},{"class":616,"line":992},[9825,9830,9834],{"type":18,"tag":614,"props":9826,"children":9827},{"class":627},[9828],{"type":24,"value":9829},"args ",{"type":18,"tag":614,"props":9831,"children":9832},{"class":621},[9833],{"type":24,"value":711},{"type":18,"tag":614,"props":9835,"children":9836},{"class":627},[9837],{"type":24,"value":8748},{"type":18,"tag":614,"props":9839,"children":9840},{"class":616,"line":1018},[9841,9845,9850,9855,9859,9863,9867,9871,9875,9879,9883,9888,9892],{"type":18,"tag":614,"props":9842,"children":9843},{"class":627},[9844],{"type":24,"value":659},{"type":18,"tag":614,"props":9846,"children":9847},{"class":5349},[9848],{"type":24,"value":9849},"'lbg'",{"type":18,"tag":614,"props":9851,"children":9852},{"class":627},[9853],{"type":24,"value":9854},": ca.",{"type":18,"tag":614,"props":9856,"children":9857},{"class":671},[9858],{"type":24,"value":9012},{"type":18,"tag":614,"props":9860,"children":9861},{"class":627},[9862],{"type":24,"value":9017},{"type":18,"tag":614,"props":9864,"children":9865},{"class":621},[9866],{"type":24,"value":1056},{"type":18,"tag":614,"props":9868,"children":9869},{"class":627},[9870],{"type":24,"value":9026},{"type":18,"tag":614,"props":9872,"children":9873},{"class":621},[9874],{"type":24,"value":1177},{"type":18,"tag":614,"props":9876,"children":9877},{"class":627},[9878],{"type":24,"value":630},{"type":18,"tag":614,"props":9880,"children":9881},{"class":671},[9882],{"type":24,"value":977},{"type":18,"tag":614,"props":9884,"children":9885},{"class":627},[9886],{"type":24,"value":9887},"), ",{"type":18,"tag":614,"props":9889,"children":9890},{"class":671},[9891],{"type":24,"value":977},{"type":18,"tag":614,"props":9893,"children":9894},{"class":627},[9895],{"type":24,"value":9896},")),\n",{"type":18,"tag":614,"props":9898,"children":9899},{"class":616,"line":1026},[9900,9904,9909,9913,9917,9921,9925,9929,9933,9937,9941,9945,9949],{"type":18,"tag":614,"props":9901,"children":9902},{"class":627},[9903],{"type":24,"value":659},{"type":18,"tag":614,"props":9905,"children":9906},{"class":5349},[9907],{"type":24,"value":9908},"'ubg'",{"type":18,"tag":614,"props":9910,"children":9911},{"class":627},[9912],{"type":24,"value":9854},{"type":18,"tag":614,"props":9914,"children":9915},{"class":671},[9916],{"type":24,"value":9012},{"type":18,"tag":614,"props":9918,"children":9919},{"class":627},[9920],{"type":24,"value":9017},{"type":18,"tag":614,"props":9922,"children":9923},{"class":621},[9924],{"type":24,"value":1056},{"type":18,"tag":614,"props":9926,"children":9927},{"class":627},[9928],{"type":24,"value":9026},{"type":18,"tag":614,"props":9930,"children":9931},{"class":621},[9932],{"type":24,"value":1177},{"type":18,"tag":614,"props":9934,"children":9935},{"class":627},[9936],{"type":24,"value":630},{"type":18,"tag":614,"props":9938,"children":9939},{"class":671},[9940],{"type":24,"value":977},{"type":18,"tag":614,"props":9942,"children":9943},{"class":627},[9944],{"type":24,"value":9887},{"type":18,"tag":614,"props":9946,"children":9947},{"class":671},[9948],{"type":24,"value":977},{"type":18,"tag":614,"props":9950,"children":9951},{"class":627},[9952],{"type":24,"value":9896},{"type":18,"tag":614,"props":9954,"children":9955},{"class":616,"line":1068},[9956,9960,9965],{"type":18,"tag":614,"props":9957,"children":9958},{"class":627},[9959],{"type":24,"value":659},{"type":18,"tag":614,"props":9961,"children":9962},{"class":5349},[9963],{"type":24,"value":9964},"'lbx'",{"type":18,"tag":614,"props":9966,"children":9967},{"class":627},[9968],{"type":24,"value":9969},": lbx,\n",{"type":18,"tag":614,"props":9971,"children":9972},{"class":616,"line":1108},[9973,9977,9982],{"type":18,"tag":614,"props":9974,"children":9975},{"class":627},[9976],{"type":24,"value":659},{"type":18,"tag":614,"props":9978,"children":9979},{"class":5349},[9980],{"type":24,"value":9981},"'ubx'",{"type":18,"tag":614,"props":9983,"children":9984},{"class":627},[9985],{"type":24,"value":9986},": ubx\n",{"type":18,"tag":614,"props":9988,"children":9989},{"class":616,"line":1202},[9990],{"type":18,"tag":614,"props":9991,"children":9992},{"class":627},[9993],{"type":24,"value":8975},{"type":18,"tag":27,"props":9995,"children":9996},{},[9997],{"type":24,"value":9998},"Obtain the solution from the solver at each iteration",{"type":18,"tag":599,"props":10000,"children":10003},{"className":10001,"code":10002,"language":604,"meta":8},[602],"sol = solver(\n            x0=args['x0'],\n            p=args['p'],\n            lbx=args['lbx'],\n            ubx=args['ubx'],\n            lbg=args['lbg'],\n            ubg=args['ubg'],\n        )\n\n        sol_x = ca.reshape(sol['x'][:num_states * (prediction_horizons + 1)], 3, prediction_horizons + 1)\n        sol_u = ca.reshape(sol['x'][num_states * (prediction_horizons + 1):], 2, prediction_horizons)\n",[10004],{"type":18,"tag":607,"props":10005,"children":10006},{},[10007],{"type":18,"tag":599,"props":10008,"children":10009},{"__ignoreMap":8},[10010,10027,10058,10085,10113,10141,10169,10197,10205,10212,10288],{"type":18,"tag":614,"props":10011,"children":10012},{"class":616,"line":617},[10013,10018,10022],{"type":18,"tag":614,"props":10014,"children":10015},{"class":627},[10016],{"type":24,"value":10017},"sol ",{"type":18,"tag":614,"props":10019,"children":10020},{"class":621},[10021],{"type":24,"value":711},{"type":18,"tag":614,"props":10023,"children":10024},{"class":627},[10025],{"type":24,"value":10026}," solver(\n",{"type":18,"tag":614,"props":10028,"children":10029},{"class":616,"line":644},[10030,10035,10040,10044,10049,10054],{"type":18,"tag":614,"props":10031,"children":10032},{"class":627},[10033],{"type":24,"value":10034},"            ",{"type":18,"tag":614,"props":10036,"children":10037},{"class":5339},[10038],{"type":24,"value":10039},"x0",{"type":18,"tag":614,"props":10041,"children":10042},{"class":621},[10043],{"type":24,"value":711},{"type":18,"tag":614,"props":10045,"children":10046},{"class":627},[10047],{"type":24,"value":10048},"args[",{"type":18,"tag":614,"props":10050,"children":10051},{"class":5349},[10052],{"type":24,"value":10053},"'x0'",{"type":18,"tag":614,"props":10055,"children":10056},{"class":627},[10057],{"type":24,"value":3221},{"type":18,"tag":614,"props":10059,"children":10060},{"class":616,"line":653},[10061,10065,10069,10073,10077,10081],{"type":18,"tag":614,"props":10062,"children":10063},{"class":627},[10064],{"type":24,"value":10034},{"type":18,"tag":614,"props":10066,"children":10067},{"class":5339},[10068],{"type":24,"value":27},{"type":18,"tag":614,"props":10070,"children":10071},{"class":621},[10072],{"type":24,"value":711},{"type":18,"tag":614,"props":10074,"children":10075},{"class":627},[10076],{"type":24,"value":10048},{"type":18,"tag":614,"props":10078,"children":10079},{"class":5349},[10080],{"type":24,"value":8793},{"type":18,"tag":614,"props":10082,"children":10083},{"class":627},[10084],{"type":24,"value":3221},{"type":18,"tag":614,"props":10086,"children":10087},{"class":616,"line":682},[10088,10092,10097,10101,10105,10109],{"type":18,"tag":614,"props":10089,"children":10090},{"class":627},[10091],{"type":24,"value":10034},{"type":18,"tag":614,"props":10093,"children":10094},{"class":5339},[10095],{"type":24,"value":10096},"lbx",{"type":18,"tag":614,"props":10098,"children":10099},{"class":621},[10100],{"type":24,"value":711},{"type":18,"tag":614,"props":10102,"children":10103},{"class":627},[10104],{"type":24,"value":10048},{"type":18,"tag":614,"props":10106,"children":10107},{"class":5349},[10108],{"type":24,"value":9964},{"type":18,"tag":614,"props":10110,"children":10111},{"class":627},[10112],{"type":24,"value":3221},{"type":18,"tag":614,"props":10114,"children":10115},{"class":616,"line":690},[10116,10120,10125,10129,10133,10137],{"type":18,"tag":614,"props":10117,"children":10118},{"class":627},[10119],{"type":24,"value":10034},{"type":18,"tag":614,"props":10121,"children":10122},{"class":5339},[10123],{"type":24,"value":10124},"ubx",{"type":18,"tag":614,"props":10126,"children":10127},{"class":621},[10128],{"type":24,"value":711},{"type":18,"tag":614,"props":10130,"children":10131},{"class":627},[10132],{"type":24,"value":10048},{"type":18,"tag":614,"props":10134,"children":10135},{"class":5349},[10136],{"type":24,"value":9981},{"type":18,"tag":614,"props":10138,"children":10139},{"class":627},[10140],{"type":24,"value":3221},{"type":18,"tag":614,"props":10142,"children":10143},{"class":616,"line":719},[10144,10148,10153,10157,10161,10165],{"type":18,"tag":614,"props":10145,"children":10146},{"class":627},[10147],{"type":24,"value":10034},{"type":18,"tag":614,"props":10149,"children":10150},{"class":5339},[10151],{"type":24,"value":10152},"lbg",{"type":18,"tag":614,"props":10154,"children":10155},{"class":621},[10156],{"type":24,"value":711},{"type":18,"tag":614,"props":10158,"children":10159},{"class":627},[10160],{"type":24,"value":10048},{"type":18,"tag":614,"props":10162,"children":10163},{"class":5349},[10164],{"type":24,"value":9849},{"type":18,"tag":614,"props":10166,"children":10167},{"class":627},[10168],{"type":24,"value":3221},{"type":18,"tag":614,"props":10170,"children":10171},{"class":616,"line":745},[10172,10176,10181,10185,10189,10193],{"type":18,"tag":614,"props":10173,"children":10174},{"class":627},[10175],{"type":24,"value":10034},{"type":18,"tag":614,"props":10177,"children":10178},{"class":5339},[10179],{"type":24,"value":10180},"ubg",{"type":18,"tag":614,"props":10182,"children":10183},{"class":621},[10184],{"type":24,"value":711},{"type":18,"tag":614,"props":10186,"children":10187},{"class":627},[10188],{"type":24,"value":10048},{"type":18,"tag":614,"props":10190,"children":10191},{"class":5349},[10192],{"type":24,"value":9908},{"type":18,"tag":614,"props":10194,"children":10195},{"class":627},[10196],{"type":24,"value":3221},{"type":18,"tag":614,"props":10198,"children":10199},{"class":616,"line":771},[10200],{"type":18,"tag":614,"props":10201,"children":10202},{"class":627},[10203],{"type":24,"value":10204},"        )\n",{"type":18,"tag":614,"props":10206,"children":10207},{"class":616,"line":779},[10208],{"type":18,"tag":614,"props":10209,"children":10210},{},[10211],{"type":24,"value":650},{"type":18,"tag":614,"props":10213,"children":10214},{"class":616,"line":805},[10215,10220,10224,10229,10233,10238,10242,10246,10250,10254,10258,10263,10267,10272,10276,10280,10284],{"type":18,"tag":614,"props":10216,"children":10217},{"class":627},[10218],{"type":24,"value":10219},"        sol_x ",{"type":18,"tag":614,"props":10221,"children":10222},{"class":621},[10223],{"type":24,"value":711},{"type":18,"tag":614,"props":10225,"children":10226},{"class":627},[10227],{"type":24,"value":10228}," ca.reshape(sol[",{"type":18,"tag":614,"props":10230,"children":10231},{"class":5349},[10232],{"type":24,"value":8776},{"type":18,"tag":614,"props":10234,"children":10235},{"class":627},[10236],{"type":24,"value":10237},"][:num_states ",{"type":18,"tag":614,"props":10239,"children":10240},{"class":621},[10241],{"type":24,"value":1056},{"type":18,"tag":614,"props":10243,"children":10244},{"class":627},[10245],{"type":24,"value":9026},{"type":18,"tag":614,"props":10247,"children":10248},{"class":621},[10249],{"type":24,"value":1177},{"type":18,"tag":614,"props":10251,"children":10252},{"class":627},[10253],{"type":24,"value":630},{"type":18,"tag":614,"props":10255,"children":10256},{"class":671},[10257],{"type":24,"value":977},{"type":18,"tag":614,"props":10259,"children":10260},{"class":627},[10261],{"type":24,"value":10262},")], ",{"type":18,"tag":614,"props":10264,"children":10265},{"class":671},[10266],{"type":24,"value":2535},{"type":18,"tag":614,"props":10268,"children":10269},{"class":627},[10270],{"type":24,"value":10271},", prediction_horizons ",{"type":18,"tag":614,"props":10273,"children":10274},{"class":621},[10275],{"type":24,"value":1177},{"type":18,"tag":614,"props":10277,"children":10278},{"class":627},[10279],{"type":24,"value":630},{"type":18,"tag":614,"props":10281,"children":10282},{"class":671},[10283],{"type":24,"value":977},{"type":18,"tag":614,"props":10285,"children":10286},{"class":627},[10287],{"type":24,"value":1423},{"type":18,"tag":614,"props":10289,"children":10290},{"class":616,"line":831},[10291,10296,10300,10304,10308,10313,10317,10321,10325,10329,10333,10338,10342],{"type":18,"tag":614,"props":10292,"children":10293},{"class":627},[10294],{"type":24,"value":10295},"        sol_u ",{"type":18,"tag":614,"props":10297,"children":10298},{"class":621},[10299],{"type":24,"value":711},{"type":18,"tag":614,"props":10301,"children":10302},{"class":627},[10303],{"type":24,"value":10228},{"type":18,"tag":614,"props":10305,"children":10306},{"class":5349},[10307],{"type":24,"value":8776},{"type":18,"tag":614,"props":10309,"children":10310},{"class":627},[10311],{"type":24,"value":10312},"][num_states ",{"type":18,"tag":614,"props":10314,"children":10315},{"class":621},[10316],{"type":24,"value":1056},{"type":18,"tag":614,"props":10318,"children":10319},{"class":627},[10320],{"type":24,"value":9026},{"type":18,"tag":614,"props":10322,"children":10323},{"class":621},[10324],{"type":24,"value":1177},{"type":18,"tag":614,"props":10326,"children":10327},{"class":627},[10328],{"type":24,"value":630},{"type":18,"tag":614,"props":10330,"children":10331},{"class":671},[10332],{"type":24,"value":977},{"type":18,"tag":614,"props":10334,"children":10335},{"class":627},[10336],{"type":24,"value":10337},"):], ",{"type":18,"tag":614,"props":10339,"children":10340},{"class":671},[10341],{"type":24,"value":1353},{"type":18,"tag":614,"props":10343,"children":10344},{"class":627},[10345],{"type":24,"value":10346},", prediction_horizons)",{"type":18,"tag":19,"props":10348,"children":10350},{"id":10349},"result",[10351],{"type":24,"value":10352},"Result",{"type":18,"tag":27,"props":10354,"children":10355},{},[10356],{"type":24,"value":10357},"I use MPC to control the differential drive robot to move from it zero position the the desired postion that I want to follow !.\nI generate a circle trajectory and I fit this curve into my beautiful and robustness cost and then volia !!!.",{"type":18,"tag":6295,"props":10359,"children":10361},{"className":10360},[6298,6299,6300],[10362,10363],{"type":24,"value":6303},{"type":18,"tag":6305,"props":10364,"children":10367},{"className":10365,"src":10366,"width":6336,"height":6337},[6308],"/topics/robotics/nmpc/diff_mpc.png",[],{"type":18,"tag":6313,"props":10369,"children":10371},{"className":10370},[68,6316,6317,6318],[10372],{"type":24,"value":10373},"\n    Plot of differential drive robot follow the circle trajectory !!!.\n",{"type":18,"tag":19,"props":10375,"children":10376},{"id":6361},[10377],{"type":24,"value":10378},"In conclusion",{"type":18,"tag":27,"props":10380,"children":10381},{},[10382],{"type":24,"value":10383},"In my opinion, I think MPC is suitable for the control system, since it can provide the significant control input that was predicted over the finite future of time. This can ensure the safety of the system and also can provide a quick look or reaction to the control action of the system too.",{"type":18,"tag":19,"props":10385,"children":10387},{"id":10386},"reference",[10388],{"type":24,"value":10389},"Reference",{"type":18,"tag":284,"props":10391,"children":10392},{},[10393,10403,10413],{"type":18,"tag":80,"props":10394,"children":10395},{},[10396],{"type":18,"tag":6351,"props":10397,"children":10400},{"href":10398,"rel":10399},"https://github.com/MMehrez/MPC-and-MHE-implementation-in-MATLAB-using-Casadi",[6355],[10401],{"type":24,"value":10402},"MPC-and-MHE-implementation-in-MATLAB-using-Casadi",{"type":18,"tag":80,"props":10404,"children":10405},{},[10406],{"type":18,"tag":6351,"props":10407,"children":10410},{"href":10408,"rel":10409},"https://web.casadi.org",[6355],[10411],{"type":24,"value":10412},"CasAdi",{"type":18,"tag":80,"props":10414,"children":10415},{},[10416],{"type":18,"tag":6351,"props":10417,"children":10420},{"href":10418,"rel":10419},"https://github.com/SokhengDin/PathTracking",[6355],[10421],{"type":24,"value":6358},{"type":18,"tag":6430,"children":10423},[10424],{"type":24,"value":10425},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-326375{color:#6A737D;}\n.ct-533739{color:#79B8FF;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":644,"depth":644,"links":10427},[10428,10429,10430,10431,10432,10433,10434,10435,10436],{"id":35,"depth":644,"text":38},{"id":6496,"depth":644,"text":6499},{"id":6640,"depth":644,"text":6643},{"id":7878,"depth":644,"text":7881},{"id":7906,"depth":644,"text":7909},{"id":7949,"depth":644,"text":7952},{"id":10349,"depth":644,"text":10352},{"id":6361,"depth":644,"text":10378},{"id":10386,"depth":644,"text":10389},"content:topics:robotics:nonlinear-mpc.md","topics/robotics/nonlinear-mpc.md",{"_path":10440,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":10441,"description":10442,"author":10443,"slug":10444,"tag":10444,"img":10445,"body":10446,"_type":6446,"_id":12338,"_source":6448,"_file":12339,"_extension":6450},"/topics/robotics/pid-controller","Introduction to PID Controller in Python","PID Control is a feedback control","DIN SOKHENG","pid","/topics/robotics/nmpc/PID.png",{"type":15,"children":10447,"toc":12324},[10448,10454,10464,10470,10475,10481,10485,10524,10533,10539,10545,10555,10561,10566,10600,10606,10611,10616,10626,10632,10637,10641,10646,10650,10655,11057,11074,11620,11625,11631,11637,11655,11741,11746,11808,11813,11897,11909,12195,12201,12220,12234,12238,12248,12254,12264,12270,12274,12279,12283,12320],{"type":18,"tag":19,"props":10449,"children":10451},{"id":10450},"what-is-pid-controller",[10452],{"type":24,"value":10453},"What is PID Controller ?",{"type":18,"tag":27,"props":10455,"children":10456},{},[10457,10459,10463],{"type":24,"value":10458},"The Proportional Integral Derivative (PID) controller is a traditional method in control systems that has found widespread use in control system engineering and industrial applications since its emergence in the 1940s. A PID controller is considered a feedback controller, aiming to minimize the error between the system's feedback and the desired setpoint by manually or automatically fine-tuning the coefficients ",{"type":18,"tag":84,"props":10460,"children":10462},{"latex-express":10461,"styles":87},"K_{P}, K_{I}, K_{D}",[],{"type":24,"value":197},{"type":18,"tag":19,"props":10465,"children":10467},{"id":10466},"how-it-works",[10468],{"type":24,"value":10469},"How it works ?",{"type":18,"tag":27,"props":10471,"children":10472},{},[10473],{"type":24,"value":10474},"Imagine you want to control the speed of a DC motor to reach 300 RPM, but due to the natural response of the DC motor, it cannot reach the desired angular speed. PID offers a solution to this natural response by adjusting the system's time response using its three components, as shown in the formula below.",{"type":18,"tag":19,"props":10476,"children":10478},{"id":10477},"formulation",[10479],{"type":24,"value":10480},"Formulation",{"type":18,"tag":65,"props":10482,"children":10484},{"latex-express":10483,"styles":68},"u(t) = K_{p}e(t) + K_{I} \\int_{0}^{t} e(t) dt + K_{D} \\frac{d e(t)}{dt} ",[],{"type":18,"tag":76,"props":10486,"children":10487},{},[10488,10497,10506,10515],{"type":18,"tag":80,"props":10489,"children":10490},{},[10491,10495],{"type":18,"tag":84,"props":10492,"children":10494},{"latex-express":10493,"styles":87},"K_{P}",[],{"type":24,"value":10496}," represents the proportional gain.",{"type":18,"tag":80,"props":10498,"children":10499},{},[10500,10504],{"type":18,"tag":84,"props":10501,"children":10503},{"latex-express":10502,"styles":87},"K_{I}",[],{"type":24,"value":10505}," represents the integral gain.",{"type":18,"tag":80,"props":10507,"children":10508},{},[10509,10513],{"type":18,"tag":84,"props":10510,"children":10512},{"latex-express":10511,"styles":87},"K_{D}",[],{"type":24,"value":10514}," represents the derivative gain.",{"type":18,"tag":80,"props":10516,"children":10517},{},[10518,10522],{"type":18,"tag":84,"props":10519,"children":10521},{"latex-express":10520,"styles":87},"e(t)=target-feedback",[],{"type":24,"value":10523}," is the error between target point and feedback of the system",{"type":18,"tag":6295,"props":10525,"children":10527},{"className":10526},[6298,6299,6300],[10528,10529],{"type":24,"value":6303},{"type":18,"tag":6305,"props":10530,"children":10532},{"className":10531,"src":10445},[6308],[],{"type":18,"tag":6313,"props":10534,"children":10536},{"className":10535},[68,6316,6317,6318],[10537],{"type":24,"value":10538},"\n    The Block diagram of PID Controller\n",{"type":18,"tag":19,"props":10540,"children":10542},{"id":10541},"response-time",[10543],{"type":24,"value":10544},"Response Time",{"type":18,"tag":6295,"props":10546,"children":10548},{"className":10547},[6298,6299,6300],[10549,10550],{"type":24,"value":6303},{"type":18,"tag":6305,"props":10551,"children":10554},{"className":10552,"src":10553},[6308],"/topics/robotics/nmpc/response_timepid.png",[],{"type":18,"tag":6313,"props":10556,"children":10558},{"className":10557},[68,6316,6317,6318],[10559],{"type":24,"value":10560},"\n    The response time of the system with each K_P, K_I, K_D\n",{"type":18,"tag":27,"props":10562,"children":10563},{},[10564],{"type":24,"value":10565},"As you can see in the figure above, the response time of the system is difference.",{"type":18,"tag":76,"props":10567,"children":10568},{},[10569,10580,10590],{"type":18,"tag":80,"props":10570,"children":10571},{},[10572,10574,10578],{"type":24,"value":10573},"The response time with ",{"type":18,"tag":84,"props":10575,"children":10577},{"latex-express":10576,"styles":87},"K_{I}=2",[],{"type":24,"value":10579}," the system is likely to overshoot before reaching the steady-state, which may not be suitable for applications like controlling a DC motor.",{"type":18,"tag":80,"props":10581,"children":10582},{},[10583,10584,10588],{"type":24,"value":10573},{"type":18,"tag":84,"props":10585,"children":10587},{"latex-express":10586,"styles":87},"K_{i}=0.5, ",[],{"type":24,"value":10589},"  the response does not overshoot but has a slower response to reach the steady-state.",{"type":18,"tag":80,"props":10591,"children":10592},{},[10593,10594,10598],{"type":24,"value":10573},{"type":18,"tag":84,"props":10595,"children":10597},{"latex-express":10596,"styles":87},"K_{p}=1, K_{i}=1, K_{d}=1",[],{"type":24,"value":10599},"  there is a slight overshoot, but the steady-state is reached faster.",{"type":18,"tag":19,"props":10601,"children":10603},{"id":10602},"how-can-we-write-pid-code-in-python",[10604],{"type":24,"value":10605},"How can we write PID code in Python ?",{"type":18,"tag":27,"props":10607,"children":10608},{},[10609],{"type":24,"value":10610},"Let's use a differential drive robot as a case study system. A differential drive robot is commonly used in robotics and automation, making it an ideal choice for a demonstration.",{"type":18,"tag":27,"props":10612,"children":10613},{},[10614],{"type":24,"value":10615},"The configuration of Differential Drive Robot in axes OXY.",{"type":18,"tag":6295,"props":10617,"children":10619},{"className":10618},[6298,6299,6300],[10620,10621],{"type":24,"value":6303},{"type":18,"tag":6305,"props":10622,"children":10625},{"className":10623,"src":10624},[6308],"/topics/robotics/nmpc/diff_drive.png",[],{"type":18,"tag":6313,"props":10627,"children":10629},{"className":10628},[68,6316,6317,6318],[10630],{"type":24,"value":10631},"\n    The configuration of Differential Drive Robot in axes OXY.\n",{"type":18,"tag":27,"props":10633,"children":10634},{},[10635],{"type":24,"value":10636},"The forward kinematic equation",{"type":18,"tag":65,"props":10638,"children":10640},{"latex-express":10639,"styles":68},"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{\\theta} \\\\ \\omega \\end{bmatrix}\n ",[],{"type":18,"tag":27,"props":10642,"children":10643},{},[10644],{"type":24,"value":10645},"So, if we discretize the forward kinematic with a certain sampling time, we will get",{"type":18,"tag":84,"props":10647,"children":10649},{"latex-express":10648,"styles":68},"\n\\begin{bmatrix} x_{t+1} \\\\ y_{t+1} \\\\ \\theta_{t+1} \\end{bmatrix} = \\begin{bmatrix} x_{t} \\\\ y_{t} \\\\ \\theta_{t} \\end{bmatrix} +\\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix} \\times \\Delta t\n ",[],{"type":18,"tag":27,"props":10651,"children":10652},{},[10653],{"type":24,"value":10654},"In Python,",{"type":18,"tag":599,"props":10656,"children":10659},{"className":10657,"code":10658,"language":604,"meta":8},[602],"class DifferentialDrive:\n    def __init__(self):\n        self.r = 0.05\n        self.L = 0.25\n    def forward_kinematic(self, v, omega, yaw):\n        vx = v*np.cos(yaw)\n        vy = v*np.sin(yaw)\n        vyaw = omega\n\n        return vx, vy, vyaw\n    def discrete_state(self, x, y, yaw, v, omega, dt):\n        dx, dy, dyaw = self.forward_kinematic(v, omega, yaw)\n        x_next = x + dx * dt\n        y_next = y + dy * dt\n        yaw_next = yaw + dyaw * dt\n\n        return x_next, y_next, yaw_next\n",[10660],{"type":18,"tag":607,"props":10661,"children":10662},{},[10663],{"type":18,"tag":599,"props":10664,"children":10665},{"__ignoreMap":8},[10666,10686,10709,10738,10767,10792,10817,10842,10859,10866,10882,10907,10932,10966,11000,11034,11041],{"type":18,"tag":614,"props":10667,"children":10668},{"class":616,"line":617},[10669,10673,10677,10682],{"type":18,"tag":614,"props":10670,"children":10671},{"class":621},[10672],{"type":24,"value":624},{"type":18,"tag":614,"props":10674,"children":10675},{"class":627},[10676],{"type":24,"value":630},{"type":18,"tag":614,"props":10678,"children":10679},{"class":633},[10680],{"type":24,"value":10681},"DifferentialDrive",{"type":18,"tag":614,"props":10683,"children":10684},{"class":627},[10685],{"type":24,"value":641},{"type":18,"tag":614,"props":10687,"children":10688},{"class":616,"line":644},[10689,10693,10697,10701,10705],{"type":18,"tag":614,"props":10690,"children":10691},{"class":627},[10692],{"type":24,"value":659},{"type":18,"tag":614,"props":10694,"children":10695},{"class":621},[10696],{"type":24,"value":664},{"type":18,"tag":614,"props":10698,"children":10699},{"class":627},[10700],{"type":24,"value":630},{"type":18,"tag":614,"props":10702,"children":10703},{"class":671},[10704],{"type":24,"value":674},{"type":18,"tag":614,"props":10706,"children":10707},{"class":627},[10708],{"type":24,"value":1834},{"type":18,"tag":614,"props":10710,"children":10711},{"class":616,"line":653},[10712,10716,10720,10725,10729,10733],{"type":18,"tag":614,"props":10713,"children":10714},{"class":627},[10715],{"type":24,"value":696},{"type":18,"tag":614,"props":10717,"children":10718},{"class":671},[10719],{"type":24,"value":701},{"type":18,"tag":614,"props":10721,"children":10722},{"class":627},[10723],{"type":24,"value":10724},".r ",{"type":18,"tag":614,"props":10726,"children":10727},{"class":621},[10728],{"type":24,"value":711},{"type":18,"tag":614,"props":10730,"children":10731},{"class":627},[10732],{"type":24,"value":630},{"type":18,"tag":614,"props":10734,"children":10735},{"class":671},[10736],{"type":24,"value":10737},"0.05\n",{"type":18,"tag":614,"props":10739,"children":10740},{"class":616,"line":682},[10741,10745,10749,10754,10758,10762],{"type":18,"tag":614,"props":10742,"children":10743},{"class":627},[10744],{"type":24,"value":696},{"type":18,"tag":614,"props":10746,"children":10747},{"class":671},[10748],{"type":24,"value":701},{"type":18,"tag":614,"props":10750,"children":10751},{"class":627},[10752],{"type":24,"value":10753},".L ",{"type":18,"tag":614,"props":10755,"children":10756},{"class":621},[10757],{"type":24,"value":711},{"type":18,"tag":614,"props":10759,"children":10760},{"class":627},[10761],{"type":24,"value":630},{"type":18,"tag":614,"props":10763,"children":10764},{"class":671},[10765],{"type":24,"value":10766},"0.25\n",{"type":18,"tag":614,"props":10768,"children":10769},{"class":616,"line":690},[10770,10774,10778,10782,10787],{"type":18,"tag":614,"props":10771,"children":10772},{"class":627},[10773],{"type":24,"value":659},{"type":18,"tag":614,"props":10775,"children":10776},{"class":621},[10777],{"type":24,"value":664},{"type":18,"tag":614,"props":10779,"children":10780},{"class":627},[10781],{"type":24,"value":630},{"type":18,"tag":614,"props":10783,"children":10784},{"class":633},[10785],{"type":24,"value":10786},"forward_kinematic",{"type":18,"tag":614,"props":10788,"children":10789},{"class":627},[10790],{"type":24,"value":10791},"(self, v, omega, yaw):\n",{"type":18,"tag":614,"props":10793,"children":10794},{"class":616,"line":719},[10795,10800,10804,10809,10813],{"type":18,"tag":614,"props":10796,"children":10797},{"class":627},[10798],{"type":24,"value":10799},"        vx ",{"type":18,"tag":614,"props":10801,"children":10802},{"class":621},[10803],{"type":24,"value":711},{"type":18,"tag":614,"props":10805,"children":10806},{"class":627},[10807],{"type":24,"value":10808}," v",{"type":18,"tag":614,"props":10810,"children":10811},{"class":621},[10812],{"type":24,"value":1056},{"type":18,"tag":614,"props":10814,"children":10815},{"class":627},[10816],{"type":24,"value":1199},{"type":18,"tag":614,"props":10818,"children":10819},{"class":616,"line":745},[10820,10825,10829,10833,10837],{"type":18,"tag":614,"props":10821,"children":10822},{"class":627},[10823],{"type":24,"value":10824},"        vy ",{"type":18,"tag":614,"props":10826,"children":10827},{"class":621},[10828],{"type":24,"value":711},{"type":18,"tag":614,"props":10830,"children":10831},{"class":627},[10832],{"type":24,"value":10808},{"type":18,"tag":614,"props":10834,"children":10835},{"class":621},[10836],{"type":24,"value":1056},{"type":18,"tag":614,"props":10838,"children":10839},{"class":627},[10840],{"type":24,"value":10841},"np.sin(yaw)\n",{"type":18,"tag":614,"props":10843,"children":10844},{"class":616,"line":771},[10845,10850,10854],{"type":18,"tag":614,"props":10846,"children":10847},{"class":627},[10848],{"type":24,"value":10849},"        vyaw ",{"type":18,"tag":614,"props":10851,"children":10852},{"class":621},[10853],{"type":24,"value":711},{"type":18,"tag":614,"props":10855,"children":10856},{"class":627},[10857],{"type":24,"value":10858}," omega\n",{"type":18,"tag":614,"props":10860,"children":10861},{"class":616,"line":779},[10862],{"type":18,"tag":614,"props":10863,"children":10864},{},[10865],{"type":24,"value":650},{"type":18,"tag":614,"props":10867,"children":10868},{"class":616,"line":805},[10869,10873,10877],{"type":18,"tag":614,"props":10870,"children":10871},{"class":627},[10872],{"type":24,"value":696},{"type":18,"tag":614,"props":10874,"children":10875},{"class":621},[10876],{"type":24,"value":1220},{"type":18,"tag":614,"props":10878,"children":10879},{"class":627},[10880],{"type":24,"value":10881}," vx, vy, vyaw\n",{"type":18,"tag":614,"props":10883,"children":10884},{"class":616,"line":831},[10885,10889,10893,10897,10902],{"type":18,"tag":614,"props":10886,"children":10887},{"class":627},[10888],{"type":24,"value":659},{"type":18,"tag":614,"props":10890,"children":10891},{"class":621},[10892],{"type":24,"value":664},{"type":18,"tag":614,"props":10894,"children":10895},{"class":627},[10896],{"type":24,"value":630},{"type":18,"tag":614,"props":10898,"children":10899},{"class":633},[10900],{"type":24,"value":10901},"discrete_state",{"type":18,"tag":614,"props":10903,"children":10904},{"class":627},[10905],{"type":24,"value":10906},"(self, x, y, yaw, v, omega, dt):\n",{"type":18,"tag":614,"props":10908,"children":10909},{"class":616,"line":839},[10910,10915,10919,10923,10927],{"type":18,"tag":614,"props":10911,"children":10912},{"class":627},[10913],{"type":24,"value":10914},"        dx, dy, dyaw ",{"type":18,"tag":614,"props":10916,"children":10917},{"class":621},[10918],{"type":24,"value":711},{"type":18,"tag":614,"props":10920,"children":10921},{"class":627},[10922],{"type":24,"value":630},{"type":18,"tag":614,"props":10924,"children":10925},{"class":671},[10926],{"type":24,"value":701},{"type":18,"tag":614,"props":10928,"children":10929},{"class":627},[10930],{"type":24,"value":10931},".forward_kinematic(v, omega, yaw)\n",{"type":18,"tag":614,"props":10933,"children":10934},{"class":616,"line":875},[10935,10940,10944,10949,10953,10958,10962],{"type":18,"tag":614,"props":10936,"children":10937},{"class":627},[10938],{"type":24,"value":10939},"        x_next ",{"type":18,"tag":614,"props":10941,"children":10942},{"class":621},[10943],{"type":24,"value":711},{"type":18,"tag":614,"props":10945,"children":10946},{"class":627},[10947],{"type":24,"value":10948}," x ",{"type":18,"tag":614,"props":10950,"children":10951},{"class":621},[10952],{"type":24,"value":1177},{"type":18,"tag":614,"props":10954,"children":10955},{"class":627},[10956],{"type":24,"value":10957}," dx ",{"type":18,"tag":614,"props":10959,"children":10960},{"class":621},[10961],{"type":24,"value":1056},{"type":18,"tag":614,"props":10963,"children":10964},{"class":627},[10965],{"type":24,"value":2947},{"type":18,"tag":614,"props":10967,"children":10968},{"class":616,"line":908},[10969,10974,10978,10983,10987,10992,10996],{"type":18,"tag":614,"props":10970,"children":10971},{"class":627},[10972],{"type":24,"value":10973},"        y_next ",{"type":18,"tag":614,"props":10975,"children":10976},{"class":621},[10977],{"type":24,"value":711},{"type":18,"tag":614,"props":10979,"children":10980},{"class":627},[10981],{"type":24,"value":10982}," y ",{"type":18,"tag":614,"props":10984,"children":10985},{"class":621},[10986],{"type":24,"value":1177},{"type":18,"tag":614,"props":10988,"children":10989},{"class":627},[10990],{"type":24,"value":10991}," dy ",{"type":18,"tag":614,"props":10993,"children":10994},{"class":621},[10995],{"type":24,"value":1056},{"type":18,"tag":614,"props":10997,"children":10998},{"class":627},[10999],{"type":24,"value":2947},{"type":18,"tag":614,"props":11001,"children":11002},{"class":616,"line":916},[11003,11008,11012,11017,11021,11026,11030],{"type":18,"tag":614,"props":11004,"children":11005},{"class":627},[11006],{"type":24,"value":11007},"        yaw_next ",{"type":18,"tag":614,"props":11009,"children":11010},{"class":621},[11011],{"type":24,"value":711},{"type":18,"tag":614,"props":11013,"children":11014},{"class":627},[11015],{"type":24,"value":11016}," yaw ",{"type":18,"tag":614,"props":11018,"children":11019},{"class":621},[11020],{"type":24,"value":1177},{"type":18,"tag":614,"props":11022,"children":11023},{"class":627},[11024],{"type":24,"value":11025}," dyaw ",{"type":18,"tag":614,"props":11027,"children":11028},{"class":621},[11029],{"type":24,"value":1056},{"type":18,"tag":614,"props":11031,"children":11032},{"class":627},[11033],{"type":24,"value":2947},{"type":18,"tag":614,"props":11035,"children":11036},{"class":616,"line":950},[11037],{"type":18,"tag":614,"props":11038,"children":11039},{},[11040],{"type":24,"value":650},{"type":18,"tag":614,"props":11042,"children":11043},{"class":616,"line":984},[11044,11048,11052],{"type":18,"tag":614,"props":11045,"children":11046},{"class":627},[11047],{"type":24,"value":696},{"type":18,"tag":614,"props":11049,"children":11050},{"class":621},[11051],{"type":24,"value":1220},{"type":18,"tag":614,"props":11053,"children":11054},{"class":627},[11055],{"type":24,"value":11056}," x_next, y_next, yaw_next",{"type":18,"tag":27,"props":11058,"children":11059},{},[11060,11062,11066,11068,11073],{"type":24,"value":11061},"The ",{"type":18,"tag":170,"props":11063,"children":11064},{},[11065],{"type":24,"value":6653},{"type":24,"value":11067}," class that we defined, has all the need attribute to use for PID control !!. We just need to write another class for our ",{"type":18,"tag":170,"props":11069,"children":11070},{},[11071],{"type":24,"value":11072}," PID Controller ",{"type":24,"value":197},{"type":18,"tag":599,"props":11075,"children":11078},{"className":11076,"code":11077,"language":604,"meta":8},[602],"class PIDController:\n    def __init__(self, kp, ki, kd, dt):\n\n        self.kp = kp\n        self.ki = ki\n        self.kd = kd\n        self.dt = dt\n        self.integral = 0\n\n    def calculate_pid(self, errors):\n        # Calculate proportional error\n        proportional = self.kp * errors[-1]\n        # Calculate integration error\n        integral = self.integral + self.ki * (errors[-1]) * self.dt\n        self.integral = integral\n        # Calculate derivative error\n        derivative = self.kd * (errors[-1] - errors[-2])/self.dt\n\n        output = proportional + integral + derivative\n\n        return output\n",[11079],{"type":18,"tag":607,"props":11080,"children":11081},{},[11082],{"type":18,"tag":599,"props":11083,"children":11084},{"__ignoreMap":8},[11085,11105,11129,11136,11161,11186,11211,11235,11263,11270,11295,11307,11352,11364,11442,11466,11478,11555,11562,11597,11604],{"type":18,"tag":614,"props":11086,"children":11087},{"class":616,"line":617},[11088,11092,11096,11101],{"type":18,"tag":614,"props":11089,"children":11090},{"class":621},[11091],{"type":24,"value":624},{"type":18,"tag":614,"props":11093,"children":11094},{"class":627},[11095],{"type":24,"value":630},{"type":18,"tag":614,"props":11097,"children":11098},{"class":633},[11099],{"type":24,"value":11100},"PIDController",{"type":18,"tag":614,"props":11102,"children":11103},{"class":627},[11104],{"type":24,"value":641},{"type":18,"tag":614,"props":11106,"children":11107},{"class":616,"line":644},[11108,11112,11116,11120,11124],{"type":18,"tag":614,"props":11109,"children":11110},{"class":627},[11111],{"type":24,"value":659},{"type":18,"tag":614,"props":11113,"children":11114},{"class":621},[11115],{"type":24,"value":664},{"type":18,"tag":614,"props":11117,"children":11118},{"class":627},[11119],{"type":24,"value":630},{"type":18,"tag":614,"props":11121,"children":11122},{"class":671},[11123],{"type":24,"value":674},{"type":18,"tag":614,"props":11125,"children":11126},{"class":627},[11127],{"type":24,"value":11128},"(self, kp, ki, kd, dt):\n",{"type":18,"tag":614,"props":11130,"children":11131},{"class":616,"line":653},[11132],{"type":18,"tag":614,"props":11133,"children":11134},{},[11135],{"type":24,"value":650},{"type":18,"tag":614,"props":11137,"children":11138},{"class":616,"line":682},[11139,11143,11147,11152,11156],{"type":18,"tag":614,"props":11140,"children":11141},{"class":627},[11142],{"type":24,"value":696},{"type":18,"tag":614,"props":11144,"children":11145},{"class":671},[11146],{"type":24,"value":701},{"type":18,"tag":614,"props":11148,"children":11149},{"class":627},[11150],{"type":24,"value":11151},".kp ",{"type":18,"tag":614,"props":11153,"children":11154},{"class":621},[11155],{"type":24,"value":711},{"type":18,"tag":614,"props":11157,"children":11158},{"class":627},[11159],{"type":24,"value":11160}," kp\n",{"type":18,"tag":614,"props":11162,"children":11163},{"class":616,"line":690},[11164,11168,11172,11177,11181],{"type":18,"tag":614,"props":11165,"children":11166},{"class":627},[11167],{"type":24,"value":696},{"type":18,"tag":614,"props":11169,"children":11170},{"class":671},[11171],{"type":24,"value":701},{"type":18,"tag":614,"props":11173,"children":11174},{"class":627},[11175],{"type":24,"value":11176},".ki ",{"type":18,"tag":614,"props":11178,"children":11179},{"class":621},[11180],{"type":24,"value":711},{"type":18,"tag":614,"props":11182,"children":11183},{"class":627},[11184],{"type":24,"value":11185}," ki\n",{"type":18,"tag":614,"props":11187,"children":11188},{"class":616,"line":719},[11189,11193,11197,11202,11206],{"type":18,"tag":614,"props":11190,"children":11191},{"class":627},[11192],{"type":24,"value":696},{"type":18,"tag":614,"props":11194,"children":11195},{"class":671},[11196],{"type":24,"value":701},{"type":18,"tag":614,"props":11198,"children":11199},{"class":627},[11200],{"type":24,"value":11201},".kd ",{"type":18,"tag":614,"props":11203,"children":11204},{"class":621},[11205],{"type":24,"value":711},{"type":18,"tag":614,"props":11207,"children":11208},{"class":627},[11209],{"type":24,"value":11210}," kd\n",{"type":18,"tag":614,"props":11212,"children":11213},{"class":616,"line":745},[11214,11218,11222,11227,11231],{"type":18,"tag":614,"props":11215,"children":11216},{"class":627},[11217],{"type":24,"value":696},{"type":18,"tag":614,"props":11219,"children":11220},{"class":671},[11221],{"type":24,"value":701},{"type":18,"tag":614,"props":11223,"children":11224},{"class":627},[11225],{"type":24,"value":11226},".dt ",{"type":18,"tag":614,"props":11228,"children":11229},{"class":621},[11230],{"type":24,"value":711},{"type":18,"tag":614,"props":11232,"children":11233},{"class":627},[11234],{"type":24,"value":2947},{"type":18,"tag":614,"props":11236,"children":11237},{"class":616,"line":771},[11238,11242,11246,11251,11255,11259],{"type":18,"tag":614,"props":11239,"children":11240},{"class":627},[11241],{"type":24,"value":696},{"type":18,"tag":614,"props":11243,"children":11244},{"class":671},[11245],{"type":24,"value":701},{"type":18,"tag":614,"props":11247,"children":11248},{"class":627},[11249],{"type":24,"value":11250},".integral ",{"type":18,"tag":614,"props":11252,"children":11253},{"class":621},[11254],{"type":24,"value":711},{"type":18,"tag":614,"props":11256,"children":11257},{"class":627},[11258],{"type":24,"value":630},{"type":18,"tag":614,"props":11260,"children":11261},{"class":671},[11262],{"type":24,"value":8967},{"type":18,"tag":614,"props":11264,"children":11265},{"class":616,"line":779},[11266],{"type":18,"tag":614,"props":11267,"children":11268},{},[11269],{"type":24,"value":650},{"type":18,"tag":614,"props":11271,"children":11272},{"class":616,"line":805},[11273,11277,11281,11285,11290],{"type":18,"tag":614,"props":11274,"children":11275},{"class":627},[11276],{"type":24,"value":659},{"type":18,"tag":614,"props":11278,"children":11279},{"class":621},[11280],{"type":24,"value":664},{"type":18,"tag":614,"props":11282,"children":11283},{"class":627},[11284],{"type":24,"value":630},{"type":18,"tag":614,"props":11286,"children":11287},{"class":633},[11288],{"type":24,"value":11289},"calculate_pid",{"type":18,"tag":614,"props":11291,"children":11292},{"class":627},[11293],{"type":24,"value":11294},"(self, errors):\n",{"type":18,"tag":614,"props":11296,"children":11297},{"class":616,"line":831},[11298,11302],{"type":18,"tag":614,"props":11299,"children":11300},{"class":627},[11301],{"type":24,"value":696},{"type":18,"tag":614,"props":11303,"children":11304},{"class":1851},[11305],{"type":24,"value":11306},"# Calculate proportional error\n",{"type":18,"tag":614,"props":11308,"children":11309},{"class":616,"line":839},[11310,11315,11319,11323,11327,11331,11335,11340,11344,11348],{"type":18,"tag":614,"props":11311,"children":11312},{"class":627},[11313],{"type":24,"value":11314},"        proportional ",{"type":18,"tag":614,"props":11316,"children":11317},{"class":621},[11318],{"type":24,"value":711},{"type":18,"tag":614,"props":11320,"children":11321},{"class":627},[11322],{"type":24,"value":630},{"type":18,"tag":614,"props":11324,"children":11325},{"class":671},[11326],{"type":24,"value":701},{"type":18,"tag":614,"props":11328,"children":11329},{"class":627},[11330],{"type":24,"value":11151},{"type":18,"tag":614,"props":11332,"children":11333},{"class":621},[11334],{"type":24,"value":1056},{"type":18,"tag":614,"props":11336,"children":11337},{"class":627},[11338],{"type":24,"value":11339}," errors[",{"type":18,"tag":614,"props":11341,"children":11342},{"class":621},[11343],{"type":24,"value":1046},{"type":18,"tag":614,"props":11345,"children":11346},{"class":671},[11347],{"type":24,"value":977},{"type":18,"tag":614,"props":11349,"children":11350},{"class":627},[11351],{"type":24,"value":872},{"type":18,"tag":614,"props":11353,"children":11354},{"class":616,"line":875},[11355,11359],{"type":18,"tag":614,"props":11356,"children":11357},{"class":627},[11358],{"type":24,"value":696},{"type":18,"tag":614,"props":11360,"children":11361},{"class":1851},[11362],{"type":24,"value":11363},"# Calculate integration error\n",{"type":18,"tag":614,"props":11365,"children":11366},{"class":616,"line":908},[11367,11372,11376,11380,11384,11388,11392,11396,11400,11404,11408,11413,11417,11421,11425,11429,11433,11437],{"type":18,"tag":614,"props":11368,"children":11369},{"class":627},[11370],{"type":24,"value":11371},"        integral ",{"type":18,"tag":614,"props":11373,"children":11374},{"class":621},[11375],{"type":24,"value":711},{"type":18,"tag":614,"props":11377,"children":11378},{"class":627},[11379],{"type":24,"value":630},{"type":18,"tag":614,"props":11381,"children":11382},{"class":671},[11383],{"type":24,"value":701},{"type":18,"tag":614,"props":11385,"children":11386},{"class":627},[11387],{"type":24,"value":11250},{"type":18,"tag":614,"props":11389,"children":11390},{"class":621},[11391],{"type":24,"value":1177},{"type":18,"tag":614,"props":11393,"children":11394},{"class":627},[11395],{"type":24,"value":630},{"type":18,"tag":614,"props":11397,"children":11398},{"class":671},[11399],{"type":24,"value":701},{"type":18,"tag":614,"props":11401,"children":11402},{"class":627},[11403],{"type":24,"value":11176},{"type":18,"tag":614,"props":11405,"children":11406},{"class":621},[11407],{"type":24,"value":1056},{"type":18,"tag":614,"props":11409,"children":11410},{"class":627},[11411],{"type":24,"value":11412}," (errors[",{"type":18,"tag":614,"props":11414,"children":11415},{"class":621},[11416],{"type":24,"value":1046},{"type":18,"tag":614,"props":11418,"children":11419},{"class":671},[11420],{"type":24,"value":977},{"type":18,"tag":614,"props":11422,"children":11423},{"class":627},[11424],{"type":24,"value":7606},{"type":18,"tag":614,"props":11426,"children":11427},{"class":621},[11428],{"type":24,"value":1056},{"type":18,"tag":614,"props":11430,"children":11431},{"class":627},[11432],{"type":24,"value":630},{"type":18,"tag":614,"props":11434,"children":11435},{"class":671},[11436],{"type":24,"value":701},{"type":18,"tag":614,"props":11438,"children":11439},{"class":627},[11440],{"type":24,"value":11441},".dt\n",{"type":18,"tag":614,"props":11443,"children":11444},{"class":616,"line":916},[11445,11449,11453,11457,11461],{"type":18,"tag":614,"props":11446,"children":11447},{"class":627},[11448],{"type":24,"value":696},{"type":18,"tag":614,"props":11450,"children":11451},{"class":671},[11452],{"type":24,"value":701},{"type":18,"tag":614,"props":11454,"children":11455},{"class":627},[11456],{"type":24,"value":11250},{"type":18,"tag":614,"props":11458,"children":11459},{"class":621},[11460],{"type":24,"value":711},{"type":18,"tag":614,"props":11462,"children":11463},{"class":627},[11464],{"type":24,"value":11465}," integral\n",{"type":18,"tag":614,"props":11467,"children":11468},{"class":616,"line":950},[11469,11473],{"type":18,"tag":614,"props":11470,"children":11471},{"class":627},[11472],{"type":24,"value":696},{"type":18,"tag":614,"props":11474,"children":11475},{"class":1851},[11476],{"type":24,"value":11477},"# Calculate derivative error\n",{"type":18,"tag":614,"props":11479,"children":11480},{"class":616,"line":984},[11481,11486,11490,11494,11498,11502,11506,11510,11514,11518,11522,11526,11530,11534,11538,11543,11547,11551],{"type":18,"tag":614,"props":11482,"children":11483},{"class":627},[11484],{"type":24,"value":11485},"        derivative ",{"type":18,"tag":614,"props":11487,"children":11488},{"class":621},[11489],{"type":24,"value":711},{"type":18,"tag":614,"props":11491,"children":11492},{"class":627},[11493],{"type":24,"value":630},{"type":18,"tag":614,"props":11495,"children":11496},{"class":671},[11497],{"type":24,"value":701},{"type":18,"tag":614,"props":11499,"children":11500},{"class":627},[11501],{"type":24,"value":11201},{"type":18,"tag":614,"props":11503,"children":11504},{"class":621},[11505],{"type":24,"value":1056},{"type":18,"tag":614,"props":11507,"children":11508},{"class":627},[11509],{"type":24,"value":11412},{"type":18,"tag":614,"props":11511,"children":11512},{"class":621},[11513],{"type":24,"value":1046},{"type":18,"tag":614,"props":11515,"children":11516},{"class":671},[11517],{"type":24,"value":977},{"type":18,"tag":614,"props":11519,"children":11520},{"class":627},[11521],{"type":24,"value":2911},{"type":18,"tag":614,"props":11523,"children":11524},{"class":621},[11525],{"type":24,"value":1046},{"type":18,"tag":614,"props":11527,"children":11528},{"class":627},[11529],{"type":24,"value":11339},{"type":18,"tag":614,"props":11531,"children":11532},{"class":621},[11533],{"type":24,"value":1046},{"type":18,"tag":614,"props":11535,"children":11536},{"class":671},[11537],{"type":24,"value":1353},{"type":18,"tag":614,"props":11539,"children":11540},{"class":627},[11541],{"type":24,"value":11542},"])",{"type":18,"tag":614,"props":11544,"children":11545},{"class":621},[11546],{"type":24,"value":1414},{"type":18,"tag":614,"props":11548,"children":11549},{"class":671},[11550],{"type":24,"value":701},{"type":18,"tag":614,"props":11552,"children":11553},{"class":627},[11554],{"type":24,"value":11441},{"type":18,"tag":614,"props":11556,"children":11557},{"class":616,"line":992},[11558],{"type":18,"tag":614,"props":11559,"children":11560},{},[11561],{"type":24,"value":650},{"type":18,"tag":614,"props":11563,"children":11564},{"class":616,"line":1018},[11565,11570,11574,11579,11583,11588,11592],{"type":18,"tag":614,"props":11566,"children":11567},{"class":627},[11568],{"type":24,"value":11569},"        output ",{"type":18,"tag":614,"props":11571,"children":11572},{"class":621},[11573],{"type":24,"value":711},{"type":18,"tag":614,"props":11575,"children":11576},{"class":627},[11577],{"type":24,"value":11578}," proportional ",{"type":18,"tag":614,"props":11580,"children":11581},{"class":621},[11582],{"type":24,"value":1177},{"type":18,"tag":614,"props":11584,"children":11585},{"class":627},[11586],{"type":24,"value":11587}," integral ",{"type":18,"tag":614,"props":11589,"children":11590},{"class":621},[11591],{"type":24,"value":1177},{"type":18,"tag":614,"props":11593,"children":11594},{"class":627},[11595],{"type":24,"value":11596}," derivative\n",{"type":18,"tag":614,"props":11598,"children":11599},{"class":616,"line":1026},[11600],{"type":18,"tag":614,"props":11601,"children":11602},{},[11603],{"type":24,"value":650},{"type":18,"tag":614,"props":11605,"children":11606},{"class":616,"line":1068},[11607,11611,11615],{"type":18,"tag":614,"props":11608,"children":11609},{"class":627},[11610],{"type":24,"value":696},{"type":18,"tag":614,"props":11612,"children":11613},{"class":621},[11614],{"type":24,"value":1220},{"type":18,"tag":614,"props":11616,"children":11617},{"class":627},[11618],{"type":24,"value":11619}," output",{"type":18,"tag":27,"props":11621,"children":11622},{},[11623],{"type":24,"value":11624},"Don't worry, this class just defined as the PID formula. So, by doing this, we will be able to use all the characteristic of our PID controller.",{"type":18,"tag":19,"props":11626,"children":11628},{"id":11627},"experiment",[11629],{"type":24,"value":11630},"Experiment",{"type":18,"tag":33,"props":11632,"children":11634},{"id":11633},"pid-for-point-control",[11635],{"type":24,"value":11636},"PID for point control",{"type":18,"tag":27,"props":11638,"children":11639},{},[11640,11642,11646,11648,11653],{"type":24,"value":11641},"If I want my DifferentialDrive robot go to point ",{"type":18,"tag":84,"props":11643,"children":11645},{"latex-express":11644,"styles":87},"x_{ref}, y_{ref}, \\theta_{ref}",[],{"type":24,"value":11647},", Then I can calculate the error between the reference point and the feedback position of the robot. I simulated my robot in the  ",{"type":18,"tag":4360,"props":11649,"children":11650},{},[11651],{"type":24,"value":11652},"for loop",{"type":24,"value":11654}," and calculate this error recursively.",{"type":18,"tag":599,"props":11656,"children":11659},{"className":11657,"code":11658,"language":604,"meta":8},[602],"error_x.append(ref_path[0]-current_x)\nerror_y.append(ref_path[1]-current_y)\nerror_yaw.append(ref_path[2]-current_yaw)\n",[11660],{"type":18,"tag":607,"props":11661,"children":11662},{},[11663],{"type":18,"tag":599,"props":11664,"children":11665},{"__ignoreMap":8},[11666,11691,11716],{"type":18,"tag":614,"props":11667,"children":11668},{"class":616,"line":617},[11669,11674,11678,11682,11686],{"type":18,"tag":614,"props":11670,"children":11671},{"class":627},[11672],{"type":24,"value":11673},"error_x.append(ref_path[",{"type":18,"tag":614,"props":11675,"children":11676},{"class":671},[11677],{"type":24,"value":867},{"type":18,"tag":614,"props":11679,"children":11680},{"class":627},[11681],{"type":24,"value":2597},{"type":18,"tag":614,"props":11683,"children":11684},{"class":621},[11685],{"type":24,"value":1046},{"type":18,"tag":614,"props":11687,"children":11688},{"class":627},[11689],{"type":24,"value":11690},"current_x)\n",{"type":18,"tag":614,"props":11692,"children":11693},{"class":616,"line":644},[11694,11699,11703,11707,11711],{"type":18,"tag":614,"props":11695,"children":11696},{"class":627},[11697],{"type":24,"value":11698},"error_y.append(ref_path[",{"type":18,"tag":614,"props":11700,"children":11701},{"class":671},[11702],{"type":24,"value":977},{"type":18,"tag":614,"props":11704,"children":11705},{"class":627},[11706],{"type":24,"value":2597},{"type":18,"tag":614,"props":11708,"children":11709},{"class":621},[11710],{"type":24,"value":1046},{"type":18,"tag":614,"props":11712,"children":11713},{"class":627},[11714],{"type":24,"value":11715},"current_y)\n",{"type":18,"tag":614,"props":11717,"children":11718},{"class":616,"line":653},[11719,11724,11728,11732,11736],{"type":18,"tag":614,"props":11720,"children":11721},{"class":627},[11722],{"type":24,"value":11723},"error_yaw.append(ref_path[",{"type":18,"tag":614,"props":11725,"children":11726},{"class":671},[11727],{"type":24,"value":1353},{"type":18,"tag":614,"props":11729,"children":11730},{"class":627},[11731],{"type":24,"value":2597},{"type":18,"tag":614,"props":11733,"children":11734},{"class":621},[11735],{"type":24,"value":1046},{"type":18,"tag":614,"props":11737,"children":11738},{"class":627},[11739],{"type":24,"value":11740},"current_yaw)",{"type":18,"tag":27,"props":11742,"children":11743},{},[11744],{"type":24,"value":11745},"Then, let's apply PID",{"type":18,"tag":599,"props":11747,"children":11750},{"className":11748,"code":11749,"language":604,"meta":8},[602],"output_vx = pid_controller_x.calculate_pid(error_x)\noutput_vy = pid_controller_y.calculate_pid(error_y)\noutput_omega = pid_controller_yaw.calculate_pid(error_yaw)\n",[11751],{"type":18,"tag":607,"props":11752,"children":11753},{},[11754],{"type":18,"tag":599,"props":11755,"children":11756},{"__ignoreMap":8},[11757,11774,11791],{"type":18,"tag":614,"props":11758,"children":11759},{"class":616,"line":617},[11760,11765,11769],{"type":18,"tag":614,"props":11761,"children":11762},{"class":627},[11763],{"type":24,"value":11764},"output_vx ",{"type":18,"tag":614,"props":11766,"children":11767},{"class":621},[11768],{"type":24,"value":711},{"type":18,"tag":614,"props":11770,"children":11771},{"class":627},[11772],{"type":24,"value":11773}," pid_controller_x.calculate_pid(error_x)\n",{"type":18,"tag":614,"props":11775,"children":11776},{"class":616,"line":644},[11777,11782,11786],{"type":18,"tag":614,"props":11778,"children":11779},{"class":627},[11780],{"type":24,"value":11781},"output_vy ",{"type":18,"tag":614,"props":11783,"children":11784},{"class":621},[11785],{"type":24,"value":711},{"type":18,"tag":614,"props":11787,"children":11788},{"class":627},[11789],{"type":24,"value":11790}," pid_controller_y.calculate_pid(error_y)\n",{"type":18,"tag":614,"props":11792,"children":11793},{"class":616,"line":653},[11794,11799,11803],{"type":18,"tag":614,"props":11795,"children":11796},{"class":627},[11797],{"type":24,"value":11798},"output_omega ",{"type":18,"tag":614,"props":11800,"children":11801},{"class":621},[11802],{"type":24,"value":711},{"type":18,"tag":614,"props":11804,"children":11805},{"class":627},[11806],{"type":24,"value":11807}," pid_controller_yaw.calculate_pid(error_yaw)",{"type":18,"tag":27,"props":11809,"children":11810},{},[11811],{"type":24,"value":11812},"We will also need to update current position of the robot with the given optimal value from the PID controller.",{"type":18,"tag":599,"props":11814,"children":11817},{"className":11815,"code":11816,"language":604,"meta":8},[602],"x_next, y_next, yaw_next = diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) # Skip for omega we only look for x, y\ncurrent_x = x_next\ncurrent_y = y_next\ncurrent_yaw = yaw_next\n",[11818],{"type":18,"tag":607,"props":11819,"children":11820},{},[11821],{"type":18,"tag":599,"props":11822,"children":11823},{"__ignoreMap":8},[11824,11846,11863,11880],{"type":18,"tag":614,"props":11825,"children":11826},{"class":616,"line":617},[11827,11832,11836,11841],{"type":18,"tag":614,"props":11828,"children":11829},{"class":627},[11830],{"type":24,"value":11831},"x_next, y_next, yaw_next ",{"type":18,"tag":614,"props":11833,"children":11834},{"class":621},[11835],{"type":24,"value":711},{"type":18,"tag":614,"props":11837,"children":11838},{"class":627},[11839],{"type":24,"value":11840}," diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) ",{"type":18,"tag":614,"props":11842,"children":11843},{"class":1851},[11844],{"type":24,"value":11845},"# Skip for omega we only look for x, y\n",{"type":18,"tag":614,"props":11847,"children":11848},{"class":616,"line":644},[11849,11854,11858],{"type":18,"tag":614,"props":11850,"children":11851},{"class":627},[11852],{"type":24,"value":11853},"current_x ",{"type":18,"tag":614,"props":11855,"children":11856},{"class":621},[11857],{"type":24,"value":711},{"type":18,"tag":614,"props":11859,"children":11860},{"class":627},[11861],{"type":24,"value":11862}," x_next\n",{"type":18,"tag":614,"props":11864,"children":11865},{"class":616,"line":653},[11866,11871,11875],{"type":18,"tag":614,"props":11867,"children":11868},{"class":627},[11869],{"type":24,"value":11870},"current_y ",{"type":18,"tag":614,"props":11872,"children":11873},{"class":621},[11874],{"type":24,"value":711},{"type":18,"tag":614,"props":11876,"children":11877},{"class":627},[11878],{"type":24,"value":11879}," y_next\n",{"type":18,"tag":614,"props":11881,"children":11882},{"class":616,"line":682},[11883,11888,11892],{"type":18,"tag":614,"props":11884,"children":11885},{"class":627},[11886],{"type":24,"value":11887},"current_yaw ",{"type":18,"tag":614,"props":11889,"children":11890},{"class":621},[11891],{"type":24,"value":711},{"type":18,"tag":614,"props":11893,"children":11894},{"class":627},[11895],{"type":24,"value":11896}," yaw_next",{"type":18,"tag":27,"props":11898,"children":11899},{},[11900,11902,11907],{"type":24,"value":11901},"I use ",{"type":18,"tag":4360,"props":11903,"children":11904},{},[11905],{"type":24,"value":11906},"matplotlib",{"type":24,"value":11908}," library to simulate my robot.",{"type":18,"tag":599,"props":11910,"children":11913},{"className":11911,"code":11912,"language":604,"meta":8},[602],"plt.clf()\nplt.gcf().canvas.mpl_connect('key_release_event',\n            lambda event: [exit(0) if event.key == 'escape' else None])\nplot_arrow(current_x, current_y, current_yaw)\nplt.plot(5, 5)\nplt.plot(ref_path[0], ref_path[1], marker=\"x\", color=\"blue\", label=\"Input Trajectory\")\nplt.axis(\"equal\")\nplt.grid(True)\nplt.legend()\nplt.pause(0.0001)\n",[11914],{"type":18,"tag":607,"props":11915,"children":11916},{},[11917],{"type":18,"tag":599,"props":11918,"children":11919},{"__ignoreMap":8},[11920,11928,11945,12024,12032,12057,12135,12152,12169,12177],{"type":18,"tag":614,"props":11921,"children":11922},{"class":616,"line":617},[11923],{"type":18,"tag":614,"props":11924,"children":11925},{"class":627},[11926],{"type":24,"value":11927},"plt.clf()\n",{"type":18,"tag":614,"props":11929,"children":11930},{"class":616,"line":644},[11931,11936,11941],{"type":18,"tag":614,"props":11932,"children":11933},{"class":627},[11934],{"type":24,"value":11935},"plt.gcf().canvas.mpl_connect(",{"type":18,"tag":614,"props":11937,"children":11938},{"class":5349},[11939],{"type":24,"value":11940},"'key_release_event'",{"type":18,"tag":614,"props":11942,"children":11943},{"class":627},[11944],{"type":24,"value":8872},{"type":18,"tag":614,"props":11946,"children":11947},{"class":616,"line":653},[11948,11952,11956,11961,11966,11970,11974,11978,11983,11988,11993,11997,12002,12006,12011,12015,12020],{"type":18,"tag":614,"props":11949,"children":11950},{"class":627},[11951],{"type":24,"value":10034},{"type":18,"tag":614,"props":11953,"children":11954},{"class":621},[11955],{"type":24,"value":6963},{"type":18,"tag":614,"props":11957,"children":11958},{"class":627},[11959],{"type":24,"value":11960}," event: [",{"type":18,"tag":614,"props":11962,"children":11963},{"class":671},[11964],{"type":24,"value":11965},"exit",{"type":18,"tag":614,"props":11967,"children":11968},{"class":627},[11969],{"type":24,"value":1387},{"type":18,"tag":614,"props":11971,"children":11972},{"class":671},[11973],{"type":24,"value":867},{"type":18,"tag":614,"props":11975,"children":11976},{"class":627},[11977],{"type":24,"value":5357},{"type":18,"tag":614,"props":11979,"children":11980},{"class":621},[11981],{"type":24,"value":11982},"if",{"type":18,"tag":614,"props":11984,"children":11985},{"class":627},[11986],{"type":24,"value":11987}," event.key ",{"type":18,"tag":614,"props":11989,"children":11990},{"class":621},[11991],{"type":24,"value":11992},"==",{"type":18,"tag":614,"props":11994,"children":11995},{"class":627},[11996],{"type":24,"value":630},{"type":18,"tag":614,"props":11998,"children":11999},{"class":5349},[12000],{"type":24,"value":12001},"'escape'",{"type":18,"tag":614,"props":12003,"children":12004},{"class":627},[12005],{"type":24,"value":630},{"type":18,"tag":614,"props":12007,"children":12008},{"class":621},[12009],{"type":24,"value":12010},"else",{"type":18,"tag":614,"props":12012,"children":12013},{"class":627},[12014],{"type":24,"value":630},{"type":18,"tag":614,"props":12016,"children":12017},{"class":671},[12018],{"type":24,"value":12019},"None",{"type":18,"tag":614,"props":12021,"children":12022},{"class":627},[12023],{"type":24,"value":3280},{"type":18,"tag":614,"props":12025,"children":12026},{"class":616,"line":682},[12027],{"type":18,"tag":614,"props":12028,"children":12029},{"class":627},[12030],{"type":24,"value":12031},"plot_arrow(current_x, current_y, current_yaw)\n",{"type":18,"tag":614,"props":12033,"children":12034},{"class":616,"line":690},[12035,12040,12045,12049,12053],{"type":18,"tag":614,"props":12036,"children":12037},{"class":627},[12038],{"type":24,"value":12039},"plt.plot(",{"type":18,"tag":614,"props":12041,"children":12042},{"class":671},[12043],{"type":24,"value":12044},"5",{"type":18,"tag":614,"props":12046,"children":12047},{"class":627},[12048],{"type":24,"value":2417},{"type":18,"tag":614,"props":12050,"children":12051},{"class":671},[12052],{"type":24,"value":12044},{"type":18,"tag":614,"props":12054,"children":12055},{"class":627},[12056],{"type":24,"value":1423},{"type":18,"tag":614,"props":12058,"children":12059},{"class":616,"line":719},[12060,12065,12069,12074,12078,12082,12087,12091,12095,12099,12104,12108,12113,12117,12122,12126,12131],{"type":18,"tag":614,"props":12061,"children":12062},{"class":627},[12063],{"type":24,"value":12064},"plt.plot(ref_path[",{"type":18,"tag":614,"props":12066,"children":12067},{"class":671},[12068],{"type":24,"value":867},{"type":18,"tag":614,"props":12070,"children":12071},{"class":627},[12072],{"type":24,"value":12073},"], ref_path[",{"type":18,"tag":614,"props":12075,"children":12076},{"class":671},[12077],{"type":24,"value":977},{"type":18,"tag":614,"props":12079,"children":12080},{"class":627},[12081],{"type":24,"value":3247},{"type":18,"tag":614,"props":12083,"children":12084},{"class":5339},[12085],{"type":24,"value":12086},"marker",{"type":18,"tag":614,"props":12088,"children":12089},{"class":621},[12090],{"type":24,"value":711},{"type":18,"tag":614,"props":12092,"children":12093},{"class":5349},[12094],{"type":24,"value":8059},{"type":18,"tag":614,"props":12096,"children":12097},{"class":627},[12098],{"type":24,"value":2417},{"type":18,"tag":614,"props":12100,"children":12101},{"class":5339},[12102],{"type":24,"value":12103},"color",{"type":18,"tag":614,"props":12105,"children":12106},{"class":621},[12107],{"type":24,"value":711},{"type":18,"tag":614,"props":12109,"children":12110},{"class":5349},[12111],{"type":24,"value":12112},"\"blue\"",{"type":18,"tag":614,"props":12114,"children":12115},{"class":627},[12116],{"type":24,"value":2417},{"type":18,"tag":614,"props":12118,"children":12119},{"class":5339},[12120],{"type":24,"value":12121},"label",{"type":18,"tag":614,"props":12123,"children":12124},{"class":621},[12125],{"type":24,"value":711},{"type":18,"tag":614,"props":12127,"children":12128},{"class":5349},[12129],{"type":24,"value":12130},"\"Input Trajectory\"",{"type":18,"tag":614,"props":12132,"children":12133},{"class":627},[12134],{"type":24,"value":1423},{"type":18,"tag":614,"props":12136,"children":12137},{"class":616,"line":745},[12138,12143,12148],{"type":18,"tag":614,"props":12139,"children":12140},{"class":627},[12141],{"type":24,"value":12142},"plt.axis(",{"type":18,"tag":614,"props":12144,"children":12145},{"class":5349},[12146],{"type":24,"value":12147},"\"equal\"",{"type":18,"tag":614,"props":12149,"children":12150},{"class":627},[12151],{"type":24,"value":1423},{"type":18,"tag":614,"props":12153,"children":12154},{"class":616,"line":771},[12155,12160,12165],{"type":18,"tag":614,"props":12156,"children":12157},{"class":627},[12158],{"type":24,"value":12159},"plt.grid(",{"type":18,"tag":614,"props":12161,"children":12162},{"class":671},[12163],{"type":24,"value":12164},"True",{"type":18,"tag":614,"props":12166,"children":12167},{"class":627},[12168],{"type":24,"value":1423},{"type":18,"tag":614,"props":12170,"children":12171},{"class":616,"line":779},[12172],{"type":18,"tag":614,"props":12173,"children":12174},{"class":627},[12175],{"type":24,"value":12176},"plt.legend()\n",{"type":18,"tag":614,"props":12178,"children":12179},{"class":616,"line":805},[12180,12185,12190],{"type":18,"tag":614,"props":12181,"children":12182},{"class":627},[12183],{"type":24,"value":12184},"plt.pause(",{"type":18,"tag":614,"props":12186,"children":12187},{"class":671},[12188],{"type":24,"value":12189},"0.0001",{"type":18,"tag":614,"props":12191,"children":12192},{"class":627},[12193],{"type":24,"value":12194},")",{"type":18,"tag":33,"props":12196,"children":12198},{"id":12197},"path-tracking",[12199],{"type":24,"value":12200},"Path Tracking",{"type":18,"tag":27,"props":12202,"children":12203},{},[12204,12206,12211,12213,12218],{"type":24,"value":12205},"The code is all way the same. The different is that, I fit the continuous point into the robot instead of fixed goal point. I use ",{"type":18,"tag":4360,"props":12207,"children":12208},{},[12209],{"type":24,"value":12210},"BeizerCurve",{"type":24,"value":12212}," function to generate ",{"type":18,"tag":170,"props":12214,"children":12215},{},[12216],{"type":24,"value":12217}," Spline Trajectory ",{"type":24,"value":12219}," for the robot.",{"type":18,"tag":27,"props":12221,"children":12222},{},[12223,12225,12232],{"type":24,"value":12224},"The full code is published open-source on my Github. Link here ",{"type":18,"tag":6351,"props":12226,"children":12229},{"href":12227,"rel":12228},"https://github.com/SokhengDin/PathTracking/tree/main/PID",[6355],[12230],{"type":24,"value":12231},"Github",{"type":24,"value":12233},". Hit the star for me if you like my work .",{"type":18,"tag":33,"props":12235,"children":12236},{"id":10349},[12237],{"type":24,"value":10352},{"type":18,"tag":6295,"props":12239,"children":12241},{"className":12240},[6298,6299,6300],[12242,12243],{"type":24,"value":6303},{"type":18,"tag":6305,"props":12244,"children":12247},{"className":12245,"src":12246},[6308],"/topics/robotics/nmpc/Figure_pid_p.png",[],{"type":18,"tag":6313,"props":12249,"children":12251},{"className":12250},[68,6316,6317,6318],[12252],{"type":24,"value":12253},"\n    PID Controller with position control on Differential Drive Robot\n",{"type":18,"tag":6295,"props":12255,"children":12257},{"className":12256},[6298,6299,6300],[12258,12259],{"type":24,"value":6303},{"type":18,"tag":6305,"props":12260,"children":12263},{"className":12261,"src":12262},[6308],"/topics/robotics/nmpc/Figure_pid_t.png",[],{"type":18,"tag":6313,"props":12265,"children":12267},{"className":12266},[68,6316,6317,6318],[12268],{"type":24,"value":12269},"\n    PID Controller with path tracking control on Differential Drive Robot\n",{"type":18,"tag":19,"props":12271,"children":12272},{"id":6361},[12273],{"type":24,"value":6364},{"type":18,"tag":27,"props":12275,"children":12276},{},[12277],{"type":24,"value":12278},"In my opinion, the PID Controller is an excellent choice for most control system applications due to its simplicity and powerful capabilities in handling complex control challenges arising from various systems.",{"type":18,"tag":19,"props":12280,"children":12281},{"id":6372},[12282],{"type":24,"value":6375},{"type":18,"tag":284,"props":12284,"children":12285},{},[12286,12295,12300,12310],{"type":18,"tag":80,"props":12287,"children":12288},{},[12289],{"type":18,"tag":6351,"props":12290,"children":12293},{"href":12291,"rel":12292},"https://en.wikipedia.org/wiki/B%C3%A9zier_curve",[6355],[12294],{"type":24,"value":12210},{"type":18,"tag":80,"props":12296,"children":12297},{},[12298],{"type":24,"value":12299},"PID Controller: Control Systems Engineering by Normal S. Nise.",{"type":18,"tag":80,"props":12301,"children":12302},{},[12303],{"type":18,"tag":6351,"props":12304,"children":12307},{"href":12305,"rel":12306},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathPlanning/BezierPath",[6355],[12308],{"type":24,"value":12309},"Beizer Path",{"type":18,"tag":80,"props":12311,"children":12312},{},[12313],{"type":18,"tag":6351,"props":12314,"children":12317},{"href":12315,"rel":12316},"https://www.cds.caltech.edu/~murray/courses/cds101/fa02/caltech/astrom-ch6.pdf",[6355],[12318],{"type":24,"value":12319},"PID Lecture",{"type":18,"tag":6430,"children":12321},[12322],{"type":24,"value":12323},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":644,"depth":644,"links":12325},[12326,12327,12328,12329,12330,12331,12336,12337],{"id":10450,"depth":644,"text":10453},{"id":10466,"depth":644,"text":10469},{"id":10477,"depth":644,"text":10480},{"id":10541,"depth":644,"text":10544},{"id":10602,"depth":644,"text":10605},{"id":11627,"depth":644,"text":11630,"children":12332},[12333,12334,12335],{"id":11633,"depth":653,"text":11636},{"id":12197,"depth":653,"text":12200},{"id":10349,"depth":653,"text":10352},{"id":6361,"depth":644,"text":6364},{"id":6372,"depth":644,"text":6375},"content:topics:robotics:pid-controller.md","topics/robotics/pid-controller.md",{"_path":12341,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12342,"description":12343,"slug":12344,"tag":12344,"img":12345,"body":12346,"_type":6446,"_id":12578,"_source":6448,"_file":12579,"_extension":6450},"/topics/robotics/pure-pursuit","Pure Pursuit Controller","Introduction to Pure Pursuit Controller","pure-pursuit","/topics/robotics/nmpc/pure_pursuit.png",{"type":15,"children":12347,"toc":12571},[12348,12353,12363,12369,12374,12426,12432,12437,12489,12495,12500,12523,12528,12567],{"type":18,"tag":19,"props":12349,"children":12351},{"id":12350},"pure-pursuit-controller",[12352],{"type":24,"value":12342},{"type":18,"tag":27,"props":12354,"children":12355},{},[12356,12357,12361],{"type":24,"value":11061},{"type":18,"tag":170,"props":12358,"children":12359},{},[12360],{"type":24,"value":12342},{"type":24,"value":12362}," is a widely-used path-tracking algorithm in robotics and autonomous vehicle navigation. Its primary objective is to guide a vehicle or robot along a predefined path while ensuring precise path-following.",{"type":18,"tag":33,"props":12364,"children":12366},{"id":12365},"principle-of-operation",[12367],{"type":24,"value":12368},"Principle of Operation",{"type":18,"tag":27,"props":12370,"children":12371},{},[12372],{"type":24,"value":12373},"The operation of the Pure Pursuit Controller is based on a straightforward concept:",{"type":18,"tag":284,"props":12375,"children":12376},{},[12377,12387,12397,12407,12417],{"type":18,"tag":80,"props":12378,"children":12379},{},[12380,12385],{"type":18,"tag":170,"props":12381,"children":12382},{},[12383],{"type":24,"value":12384},"Path Definition",{"type":24,"value":12386},": The controller works with a defined path, often represented as a series of waypoints or a continuous curve, each associated with specific coordinates (x, y) and curvature information.",{"type":18,"tag":80,"props":12388,"children":12389},{},[12390,12395],{"type":18,"tag":170,"props":12391,"children":12392},{},[12393],{"type":24,"value":12394},"Target Point Selection",{"type":24,"value":12396},": The controller continuously selects a target point ahead of the vehicle. This target point is typically chosen as the point on the path that is a certain fixed distance (known as the \"lookahead distance\") in front of the vehicle.",{"type":18,"tag":80,"props":12398,"children":12399},{},[12400,12405],{"type":18,"tag":170,"props":12401,"children":12402},{},[12403],{"type":24,"value":12404},"Steering Command Calculation",{"type":24,"value":12406},": To navigate toward the target point, the controller calculates the steering command, often represented as the desired steering angle or curvature, required to reach the target point. Commonly, this involves computing the angle between the vehicle's current heading and the vector pointing from the current position to the target point.",{"type":18,"tag":80,"props":12408,"children":12409},{},[12410,12415],{"type":18,"tag":170,"props":12411,"children":12412},{},[12413],{"type":24,"value":12414},"Vehicle Control",{"type":24,"value":12416},": The calculated steering command is used to control the vehicle's steering mechanism (e.g., steering wheel or wheel angles) to guide it toward the target point.",{"type":18,"tag":80,"props":12418,"children":12419},{},[12420,12424],{"type":18,"tag":170,"props":12421,"children":12422},{},[12423],{"type":24,"value":349},{"type":24,"value":12425},": The process is iterative, with the controller continuously selecting new target points ahead as the vehicle advances along the path and adjusting its steering to reach them.",{"type":18,"tag":33,"props":12427,"children":12429},{"id":12428},"advantages",[12430],{"type":24,"value":12431},"Advantages",{"type":18,"tag":27,"props":12433,"children":12434},{},[12435],{"type":24,"value":12436},"The Pure Pursuit Controller offers several advantages:",{"type":18,"tag":76,"props":12438,"children":12439},{},[12440,12450,12459,12469,12479],{"type":18,"tag":80,"props":12441,"children":12442},{},[12443,12448],{"type":18,"tag":170,"props":12444,"children":12445},{},[12446],{"type":24,"value":12447},"Simplicity",{"type":24,"value":12449},": It is conceptually simple and easy to implement, making it suitable for a wide range of robotic and vehicle navigation applications.",{"type":18,"tag":80,"props":12451,"children":12452},{},[12453,12457],{"type":18,"tag":170,"props":12454,"children":12455},{},[12456],{"type":24,"value":12200},{"type":24,"value":12458},": The controller excels at accurate path tracking, even in complex environments with curves and turns.",{"type":18,"tag":80,"props":12460,"children":12461},{},[12462,12467],{"type":18,"tag":170,"props":12463,"children":12464},{},[12465],{"type":24,"value":12466},"Real-Time Operation",{"type":24,"value":12468},": It can operate in real-time, making it well-suited for dynamic environments where quick decision-making is crucial.",{"type":18,"tag":80,"props":12470,"children":12471},{},[12472,12477],{"type":18,"tag":170,"props":12473,"children":12474},{},[12475],{"type":24,"value":12476},"Adaptability",{"type":24,"value":12478},": The controller can adapt to changes in the path, such as deviations caused by obstacles or unexpected conditions, by continuously updating the target point.",{"type":18,"tag":80,"props":12480,"children":12481},{},[12482,12487],{"type":18,"tag":170,"props":12483,"children":12484},{},[12485],{"type":24,"value":12486},"Low Computational Overhead",{"type":24,"value":12488},": Compared to some other control algorithms, the Pure Pursuit Controller often has low computational requirements, which is advantageous for resource-constrained systems.",{"type":18,"tag":33,"props":12490,"children":12492},{"id":12491},"limitations",[12493],{"type":24,"value":12494},"Limitations",{"type":18,"tag":27,"props":12496,"children":12497},{},[12498],{"type":24,"value":12499},"Despite its advantages, the Pure Pursuit Controller has some limitations:",{"type":18,"tag":76,"props":12501,"children":12502},{},[12503,12513],{"type":18,"tag":80,"props":12504,"children":12505},{},[12506,12511],{"type":18,"tag":170,"props":12507,"children":12508},{},[12509],{"type":24,"value":12510},"Lookahead Distance Sensitivity",{"type":24,"value":12512},": Its performance can be sensitive to the choice of the lookahead distance, which requires careful tuning for optimal path tracking.",{"type":18,"tag":80,"props":12514,"children":12515},{},[12516,12521],{"type":18,"tag":170,"props":12517,"children":12518},{},[12519],{"type":24,"value":12520},"Non-Holonomic Assumption",{"type":24,"value":12522},": The controller assumes that the vehicle is non-holonomic, meaning it cannot move sideways. This assumption may not hold for certain types of vehicles, such as omnidirectional robots.",{"type":18,"tag":27,"props":12524,"children":12525},{},[12526],{"type":24,"value":12527},"In summary, the Pure Pursuit Controller is a straightforward yet effective algorithm for path tracking and navigation. Its ability to calculate a steering command based on a selected target point ahead of the vehicle makes it a valuable tool for applications ranging from autonomous cars to mobile robots.",{"type":18,"tag":599,"props":12529,"children":12534},{"className":12530,"code":12532,"language":12533,"meta":8},[12531],"language-js","console.log(\"Hello world\")\n\n","js",[12535],{"type":18,"tag":607,"props":12536,"children":12537},{},[12538],{"type":18,"tag":599,"props":12539,"children":12540},{"__ignoreMap":8},[12541],{"type":18,"tag":614,"props":12542,"children":12543},{"class":616,"line":617},[12544,12549,12554,12558,12563],{"type":18,"tag":614,"props":12545,"children":12546},{"class":627},[12547],{"type":24,"value":12548},"console.",{"type":18,"tag":614,"props":12550,"children":12551},{"class":633},[12552],{"type":24,"value":12553},"log",{"type":18,"tag":614,"props":12555,"children":12556},{"class":627},[12557],{"type":24,"value":1387},{"type":18,"tag":614,"props":12559,"children":12560},{"class":5349},[12561],{"type":24,"value":12562},"\"Hello world\"",{"type":18,"tag":614,"props":12564,"children":12565},{"class":627},[12566],{"type":24,"value":12194},{"type":18,"tag":6430,"children":12568},[12569],{"type":24,"value":12570},".ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-244866{color:#9ECBFF;}",{"title":8,"searchDepth":644,"depth":644,"links":12572},[12573],{"id":12350,"depth":644,"text":12342,"children":12574},[12575,12576,12577],{"id":12365,"depth":653,"text":12368},{"id":12428,"depth":653,"text":12431},{"id":12491,"depth":653,"text":12494},"content:topics:robotics:pure-pursuit.md","topics/robotics/pure-pursuit.md",{"_path":12581,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12582,"description":12583,"slug":12584,"tag":12584,"body":12585,"_type":6446,"_id":12786,"_source":6448,"_file":12787,"_extension":6450},"/topics/robotics/stanley-controller","Stanley Controller","Introduction to Stanley Controller","stanley",{"type":15,"children":12586,"toc":12779},[12587,12592,12602,12606,12611,12672,12676,12681,12732,12736,12741,12774],{"type":18,"tag":19,"props":12588,"children":12590},{"id":12589},"stanley-controller",[12591],{"type":24,"value":12582},{"type":18,"tag":27,"props":12593,"children":12594},{},[12595,12596,12600],{"type":24,"value":11061},{"type":18,"tag":170,"props":12597,"children":12598},{},[12599],{"type":24,"value":12582},{"type":24,"value":12601}," is an advanced path-tracking algorithm primarily used in the field of autonomous vehicle navigation. It is named after its creator, Professor John K. Hedrick, who developed it at Stanford University. The Stanley Controller is designed to enable a vehicle to follow a predefined path with high accuracy and stability.",{"type":18,"tag":33,"props":12603,"children":12604},{"id":12365},[12605],{"type":24,"value":12368},{"type":18,"tag":27,"props":12607,"children":12608},{},[12609],{"type":24,"value":12610},"The Stanley Controller operates based on a combination of control and feedback mechanisms:",{"type":18,"tag":284,"props":12612,"children":12613},{},[12614,12623,12633,12643,12653,12662],{"type":18,"tag":80,"props":12615,"children":12616},{},[12617,12621],{"type":18,"tag":170,"props":12618,"children":12619},{},[12620],{"type":24,"value":12384},{"type":24,"value":12622},": A predefined path is represented as a series of waypoints or a continuous curve. Each waypoint is associated with specific coordinates (x, y) and often includes additional information like desired speed and curvature.",{"type":18,"tag":80,"props":12624,"children":12625},{},[12626,12631],{"type":18,"tag":170,"props":12627,"children":12628},{},[12629],{"type":24,"value":12630},"Cross-Track Error (CTE) Calculation",{"type":24,"value":12632},": The controller calculates the cross-track error, which is the perpendicular distance between the vehicle's current position and the desired path. This error represents how far the vehicle has deviated from the path.",{"type":18,"tag":80,"props":12634,"children":12635},{},[12636,12641],{"type":18,"tag":170,"props":12637,"children":12638},{},[12639],{"type":24,"value":12640},"Heading Error Calculation",{"type":24,"value":12642},": The heading error, which is the difference between the vehicle's current heading (yaw angle) and the desired path's tangent angle at the nearest waypoint, is also computed.",{"type":18,"tag":80,"props":12644,"children":12645},{},[12646,12651],{"type":18,"tag":170,"props":12647,"children":12648},{},[12649],{"type":24,"value":12650},"Control Command Generation",{"type":24,"value":12652},": Using the calculated cross-track error and heading error, the Stanley Controller generates control commands. These commands typically include steering angle adjustments and throttle/brake control to minimize both errors.",{"type":18,"tag":80,"props":12654,"children":12655},{},[12656,12660],{"type":18,"tag":170,"props":12657,"children":12658},{},[12659],{"type":24,"value":12414},{"type":24,"value":12661},": The generated control commands are applied to the vehicle's steering and throttle/brake systems to guide it back to the desired path.",{"type":18,"tag":80,"props":12663,"children":12664},{},[12665,12670],{"type":18,"tag":170,"props":12666,"children":12667},{},[12668],{"type":24,"value":12669},"Iterative Feedback",{"type":24,"value":12671},": The process is iterative, with the controller continuously recalculating the cross-track and heading errors and adjusting the control commands to keep the vehicle on track.",{"type":18,"tag":33,"props":12673,"children":12674},{"id":12428},[12675],{"type":24,"value":12431},{"type":18,"tag":27,"props":12677,"children":12678},{},[12679],{"type":24,"value":12680},"The Stanley Controller offers several advantages:",{"type":18,"tag":76,"props":12682,"children":12683},{},[12684,12694,12704,12713,12722],{"type":18,"tag":80,"props":12685,"children":12686},{},[12687,12692],{"type":18,"tag":170,"props":12688,"children":12689},{},[12690],{"type":24,"value":12691},"High Accuracy",{"type":24,"value":12693},": It is known for its ability to achieve precise path-following, even in challenging conditions and complex road geometries.",{"type":18,"tag":80,"props":12695,"children":12696},{},[12697,12702],{"type":18,"tag":170,"props":12698,"children":12699},{},[12700],{"type":24,"value":12701},"Stability",{"type":24,"value":12703},": The controller's feedback mechanisms contribute to stable and smooth vehicle motion, reducing the risk of overshooting or oscillations.",{"type":18,"tag":80,"props":12705,"children":12706},{},[12707,12711],{"type":18,"tag":170,"props":12708,"children":12709},{},[12710],{"type":24,"value":12476},{"type":24,"value":12712},": The Stanley Controller can adapt to changes in the path, such as deviations caused by obstacles or dynamic road conditions.",{"type":18,"tag":80,"props":12714,"children":12715},{},[12716,12720],{"type":18,"tag":170,"props":12717,"children":12718},{},[12719],{"type":24,"value":12466},{"type":24,"value":12721},": It can operate in real-time, making it suitable for autonomous vehicle navigation in dynamic environments.",{"type":18,"tag":80,"props":12723,"children":12724},{},[12725,12730],{"type":18,"tag":170,"props":12726,"children":12727},{},[12728],{"type":24,"value":12729},"Versatility",{"type":24,"value":12731},": While primarily used in autonomous vehicles, the Stanley Controller's principles can be applied to various path-tracking tasks.",{"type":18,"tag":33,"props":12733,"children":12734},{"id":12491},[12735],{"type":24,"value":12494},{"type":18,"tag":27,"props":12737,"children":12738},{},[12739],{"type":24,"value":12740},"Despite its advantages, the Stanley Controller has some limitations:",{"type":18,"tag":76,"props":12742,"children":12743},{},[12744,12754,12764],{"type":18,"tag":80,"props":12745,"children":12746},{},[12747,12752],{"type":18,"tag":170,"props":12748,"children":12749},{},[12750],{"type":24,"value":12751},"Complexity",{"type":24,"value":12753},": Implementing the Stanley Controller can be more complex than some other control algorithms due to its mathematical calculations and tuning requirements.",{"type":18,"tag":80,"props":12755,"children":12756},{},[12757,12762],{"type":18,"tag":170,"props":12758,"children":12759},{},[12760],{"type":24,"value":12761},"Initialization",{"type":24,"value":12763},": It relies on accurate initialization, including knowledge of the vehicle's initial position and heading relative to the path.",{"type":18,"tag":80,"props":12765,"children":12766},{},[12767,12772],{"type":18,"tag":170,"props":12768,"children":12769},{},[12770],{"type":24,"value":12771},"Sensitivity to Noise",{"type":24,"value":12773},": Like many feedback-based controllers, the Stanley Controller can be sensitive to noisy sensor data and require robust sensor fusion techniques.",{"type":18,"tag":27,"props":12775,"children":12776},{},[12777],{"type":24,"value":12778},"In summary, the Stanley Controller is an advanced path-tracking algorithm known for its accuracy and stability, making it a valuable tool in the field of autonomous vehicle navigation. Proper implementation and tuning are essential to harness its full potential.",{"title":8,"searchDepth":644,"depth":644,"links":12780},[12781],{"id":12589,"depth":644,"text":12582,"children":12782},[12783,12784,12785],{"id":12365,"depth":653,"text":12368},{"id":12428,"depth":653,"text":12431},{"id":12491,"depth":653,"text":12494},"content:topics:robotics:stanley-controller.md","topics/robotics/stanley-controller.md",1697041340376]