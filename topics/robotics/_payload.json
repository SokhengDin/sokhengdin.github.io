[{"data":1,"prerenderedAt":12808},["Reactive",2],{"topics/robotics":3},[4,6471,10459,12360,12600],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":9,"description":10,"author":11,"slug":12,"tag":12,"img":13,"body":14,"_type":6466,"_id":6467,"_source":6468,"_file":6469,"_extension":6470},"/topics/robotics/nmpc-cgmres","robotics",false,"","Nonlinear Model Predictive Control with C/GMRES","Optimal Control theory","Din Sokheng","nmpc-cgmres","/topics/robotics/nmpc/nmpc_cgmres.png",{"type":15,"children":16,"toc":6454},"root",[17,26,32,39,44,50,59,64,70,75,164,180,198,203,212,216,227,233,242,246,250,265,271,276,283,483,494,499,503,507,545,550,554,559,569,573,582,586,591,597,605,617,1778,1792,2617,2622,2754,2759,3110,3115,3888,3893,4373,4393,4880,4891,6264,6275,6281,6313,6332,6342,6347,6359,6365,6379,6385,6390,6396,6449],{"type":18,"tag":19,"props":20,"children":22},"element","h2",{"id":21},"the-optimal-control-theory-in-control-system",[23],{"type":24,"value":25},"text","The Optimal Control Theory in Control System",{"type":18,"tag":27,"props":28,"children":29},"p",{},[30],{"type":24,"value":31},"Optimal Control is a branch of control theory in control system, the theory works by solving the optimization problem of the dynamical system in order to find the optimal solution for the system",{"type":18,"tag":33,"props":34,"children":36},"h3",{"id":35},"what-is-model-predictive-control",[37],{"type":24,"value":38},"What is Model Predictive Control ?",{"type":18,"tag":27,"props":40,"children":41},{},[42],{"type":24,"value":43},"Model Predictive Control (MPC) is the optimal control method that use optimization algorithms to solve the cost function the occurs from the desired input and obtain back the optimal input control over the finite and infinite horizons. Recently, MPC is hyping up among the control system researcher, since it is fast, efficiency and robustness for any high complex system.",{"type":18,"tag":33,"props":45,"children":47},{"id":46},"hamilton-jacobian-bellman-equation-hjbe",[48],{"type":24,"value":49},"Hamilton Jacobian Bellman Equation (HJBE)",{"type":18,"tag":27,"props":51,"children":52},{},[53,55],{"type":24,"value":54},"Actually, the HJBE is a nonlinear partial differential equation that it consists necessary conditions for optimality of control by minimizing the loss function of the system. ",{"type":18,"tag":56,"props":57,"children":58},"br",{},[],{"type":18,"tag":27,"props":60,"children":61},{},[62],{"type":24,"value":63},"We have the Hamiltonian Jacobian Bellman Equation",{"type":18,"tag":65,"props":66,"children":69},"math-render-b",{"latex-express":67,"styles":68},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T} Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}","text-center",[],{"type":18,"tag":27,"props":71,"children":72},{},[73],{"type":24,"value":74},"Which",{"type":18,"tag":76,"props":77,"children":78},"ul",{},[79,91,106,119,128,137,146,155],{"type":18,"tag":80,"props":81,"children":82},"li",{},[83,89],{"type":18,"tag":84,"props":85,"children":88},"math-render",{"latex-express":86,"styles":87},"N","inline-flex",[],{"type":24,"value":90}," is the number of prediction future horizons or shooting node.",{"type":18,"tag":80,"props":92,"children":93},{},[94,98,100,104],{"type":18,"tag":84,"props":95,"children":97},{"latex-express":96,"styles":87},"x_{k}",[],{"type":24,"value":99}," is the state of the system at shooting node ",{"type":18,"tag":84,"props":101,"children":103},{"latex-express":102,"styles":87},"k",[],{"type":24,"value":105}," .",{"type":18,"tag":80,"props":107,"children":108},{},[109,113,115,118],{"type":18,"tag":84,"props":110,"children":112},{"latex-express":111,"styles":87},"u_{k}",[],{"type":24,"value":114}," is the input control of the system at shooting node ",{"type":18,"tag":84,"props":116,"children":117},{"latex-express":102,"styles":87},[],{"type":24,"value":105},{"type":18,"tag":80,"props":120,"children":121},{},[122,126],{"type":18,"tag":84,"props":123,"children":125},{"latex-express":124,"styles":87},"Q, R",[],{"type":24,"value":127}," are diagonal matrix which helps the optimization solving the nlp problem.",{"type":18,"tag":80,"props":129,"children":130},{},[131,135],{"type":18,"tag":84,"props":132,"children":134},{"latex-express":133,"styles":87},"f(x,u)",[],{"type":24,"value":136}," is the state representation of the system.",{"type":18,"tag":80,"props":138,"children":139},{},[140,144],{"type":18,"tag":84,"props":141,"children":143},{"latex-express":142,"styles":87},"C(x,u)",[],{"type":24,"value":145},"  is the constraint of the system.",{"type":18,"tag":80,"props":147,"children":148},{},[149,153],{"type":18,"tag":84,"props":150,"children":152},{"latex-express":151,"styles":87},"\\lambda",[],{"type":24,"value":154},"  is the costate vector for state representation.",{"type":18,"tag":80,"props":156,"children":157},{},[158,162],{"type":18,"tag":84,"props":159,"children":161},{"latex-express":160,"styles":87},"\\mu",[],{"type":24,"value":163},"  is the Lagrange multiplier vector for the equality constraint.",{"type":18,"tag":27,"props":165,"children":166},{},[167,169,175,177],{"type":24,"value":168},"Nonlinear Model Predictive Control has multiples solving method, but in this demonstration I will stick with the Continuation/GMRES method proposed by professor ",{"type":18,"tag":170,"props":171,"children":172},"strong",{},[173],{"type":24,"value":174}," Toshiyuki Ohtsuka ",{"type":24,"value":176},". ",{"type":18,"tag":56,"props":178,"children":179},{},[],{"type":18,"tag":27,"props":181,"children":182},{},[183,185,189,191,196],{"type":24,"value":184},"Supposed we want to obtain solution vector ",{"type":18,"tag":84,"props":186,"children":188},{"latex-express":187,"styles":87},"U(t) = [ u_{0}^{*}, \\mu_{0}^{*}, \\cdots, u_{N-1}^{*}, \\mu_{N-1}^{*} ]",[],{"type":24,"value":190},"   at sampling time $t$, we then define the discretization of ",{"type":18,"tag":170,"props":192,"children":193},{},[194],{"type":24,"value":195}," Euler Lagrangian Equation (ELE) ",{"type":24,"value":197},".",{"type":18,"tag":65,"props":199,"children":202},{"latex-express":200,"style":201},"\n\\begin{align}\n    x_{i+1}^{*}(t) &= x_{i}^{*}(t) + f(x_{i}^{*}(t), u_{i}^{*}(t))  \\\\\n    \\lambda_{i}^{*}(t) &= \\lambda_{i+1}^{*}(t) + \\frac{\\partial H}{\\partial x}\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) \\\\\n    \\lambda_{N}^{*}(t) &= \\frac{\\partial \\phi(x)}{\\partial x} \\\\\n    \\frac{\\partial H}{\\partial u} &\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) = 0 \\\\\n    C&(x_{i}^{*}(t),u_{i}^{*}(t)) = 0\n\\end{align}\n","text-ceneter",[],{"type":18,"tag":27,"props":204,"children":205},{},[206,208],{"type":24,"value":207},"To solve this nonlinear problem iteratively, we use Newton's method ",{"type":18,"tag":84,"props":209,"children":211},{"latex-express":210,"styles":87},"F(x,u)=0",[],{"type":18,"tag":65,"props":213,"children":215},{"latex-express":214,"styles":68},"\n\\begin{equation*}\n    F(x,u) = \\begin{bmatrix}\n        \\frac{\\partial H}{\\partial u} \\left( x_{0}^{*}, u_{0}^{*}(t), \\lambda_{1}^{*}(t), \\mu_{0}^{*}(t) \\right) \\\\\n        C(x_{0}^{*}(t),u_{0}^{*}(t))  \\\\\n        \\vdots \\\\\n        \\frac{\\partial H}{\\partial u} \\left( x_{N-1}^{*}, u_{N-1}^{*}(t), \\lambda_{N}^{*}(t), \\mu_{N-1}^{*}(t) \\right) \\\\\n        C(x_{N-1}^{*}(t),u_{N-1}^{*}(t)) \\\\\n    \\end{bmatrix} = 0\n\\end{equation*}",[],{"type":18,"tag":27,"props":217,"children":218},{},[219,221,225],{"type":24,"value":220},"Solving this problem directly will caused big computational complexity, hence we use Continuation to reduce the complexity of the ",{"type":18,"tag":84,"props":222,"children":224},{"latex-express":223,"styles":87},"F(x,u)",[],{"type":24,"value":226}," function and then solve it by using GMRES method.",{"type":18,"tag":33,"props":228,"children":230},{"id":229},"continuation",[231],{"type":24,"value":232},"Continuation",{"type":18,"tag":27,"props":234,"children":235},{},[236,238],{"type":24,"value":237},"Denote  ",{"type":18,"tag":84,"props":239,"children":241},{"latex-express":240,"styles":87},"\\zeta, \\alpha, h \\in{\\mathbb{R} }",[],{"type":18,"tag":65,"props":243,"children":245},{"latex-express":244,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial F}{\\partial u}(x,u) \\dot{u}(t) = -\\zeta F(x,u)(t)-\\frac{\\partial F}{\\partial x}(x,u)(t)\\dot{x}-\\frac{\\partial F}{\\partial t}(x,u)(t) \n\\end{equation*}",[],{"type":18,"tag":65,"props":247,"children":249},{"latex-express":248,"styles":68},"\n\\begin{equation*}\n    \\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h} = -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}\n\\end{equation*}",[],{"type":18,"tag":27,"props":251,"children":252},{},[253,255,259,261],{"type":24,"value":254},"Let ",{"type":18,"tag":65,"props":256,"children":258},{"latex-express":257,"styles":68},"right=\\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h}",[],{"type":24,"value":260}," and ",{"type":18,"tag":65,"props":262,"children":264},{"latex-express":263,"styles":68},"left =  -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}",[],{"type":18,"tag":33,"props":266,"children":268},{"id":267},"generalized-minimal-residue-method-gmres",[269],{"type":24,"value":270},"Generalized Minimal Residue Method (GMRES)",{"type":18,"tag":27,"props":272,"children":273},{},[274],{"type":24,"value":275},"The Generalized Minimal Residual (GMRES) algorithm is an iterative method for solving linear systems of equations. It is often used for large sparse linear systems.",{"type":18,"tag":277,"props":278,"children":280},"h4",{"id":279},"algorithm-description",[281],{"type":24,"value":282},"Algorithm Description",{"type":18,"tag":284,"props":285,"children":286},"ol",{},[287,342,449,468],{"type":18,"tag":80,"props":288,"children":289},{},[290,295,297],{"type":18,"tag":170,"props":291,"children":292},{},[293],{"type":24,"value":294},"Initialize",{"type":24,"value":296},":",{"type":18,"tag":76,"props":298,"children":299},{},[300,310,320],{"type":18,"tag":80,"props":301,"children":302},{},[303,305,309],{"type":24,"value":304},"Choose an initial guess for the solution, denoted as ",{"type":18,"tag":84,"props":306,"children":308},{"latex-express":307,"styles":87},"x_{0}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":311,"children":312},{},[313,315,319],{"type":24,"value":314},"Set the residual vector ",{"type":18,"tag":84,"props":316,"children":318},{"latex-express":317,"styles":87},"r_{0}=\\left\\| Ax_{0}-b \\right\\|",[],{"type":24,"value":197},{"type":18,"tag":80,"props":321,"children":322},{},[323,325,329,331,335,337,341],{"type":24,"value":324},"Set ",{"type":18,"tag":84,"props":326,"children":328},{"latex-express":327,"styles":87},"v_{1}=\\frac{r_{0} }{\\left\\| r_{0} \\right\\|}",[],{"type":24,"value":330},", where ",{"type":18,"tag":84,"props":332,"children":334},{"latex-express":333,"styles":87},"\\left\\| r_{0} \\right\\|",[],{"type":24,"value":336},"  is the norm of ",{"type":18,"tag":84,"props":338,"children":340},{"latex-express":339,"styles":87},"r_{0}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":343,"children":344},{},[345,350,351],{"type":18,"tag":170,"props":346,"children":347},{},[348],{"type":24,"value":349},"Iterative Process",{"type":24,"value":296},{"type":18,"tag":76,"props":352,"children":353},{},[354,364,438],{"type":18,"tag":80,"props":355,"children":356},{},[357,359,363],{"type":24,"value":358},"Choose a vector ",{"type":18,"tag":84,"props":360,"children":362},{"latex-express":361,"styles":87},"v_{1}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":365,"children":366},{},[367,369,373,375,379,380],{"type":24,"value":368},"For ",{"type":18,"tag":84,"props":370,"children":372},{"latex-express":371,"styles":87},"k=0",[],{"type":24,"value":374}," to ",{"type":18,"tag":84,"props":376,"children":378},{"latex-express":377,"styles":87},"maxiteration",[],{"type":24,"value":296},{"type":18,"tag":76,"props":381,"children":382},{},[383,419],{"type":18,"tag":80,"props":384,"children":385},{},[386,388],{"type":24,"value":387},"Arnoldi process:",{"type":18,"tag":76,"props":389,"children":390},{},[391,398,405,412],{"type":18,"tag":80,"props":392,"children":393},{},[394],{"type":18,"tag":84,"props":395,"children":397},{"latex-express":396,"styles":87},"h_{i,j} = \\left(Av_{j}, v_{i} \\right)",[],{"type":18,"tag":80,"props":399,"children":400},{},[401],{"type":18,"tag":84,"props":402,"children":404},{"latex-express":403,"styles":87},"\\hat{v}_{j+1} = Av_{j} - \\sum_{i=1}^{j}h_{i,j}v_{i}",[],{"type":18,"tag":80,"props":406,"children":407},{},[408],{"type":18,"tag":84,"props":409,"children":411},{"latex-express":410,"styles":87},"h_{j+1,j} = \\left \\| \\hat{v}_{j+1}  \\right\\|_{2}",[],{"type":18,"tag":80,"props":413,"children":414},{},[415],{"type":18,"tag":84,"props":416,"children":418},{"latex-express":417,"styles":87},"v_{j+1} = \\frac{\\hat{v}_{j+1} }{h_{j+1,j} }",[],{"type":18,"tag":80,"props":420,"children":421},{},[422,424],{"type":24,"value":423},"Check for convergence:",{"type":18,"tag":76,"props":425,"children":426},{},[427],{"type":18,"tag":80,"props":428,"children":429},{},[430,432,436],{"type":24,"value":431},"If ",{"type":18,"tag":84,"props":433,"children":435},{"latex-express":434,"styles":87},"||r_k|| \u003C tolerance",[],{"type":24,"value":437},", exit the loop.",{"type":18,"tag":80,"props":439,"children":440},{},[441,443,447],{"type":24,"value":442},"If no convergence is achieved after ",{"type":18,"tag":84,"props":444,"children":446},{"latex-express":445,"styles":87},"maxiterations",[],{"type":24,"value":448},", exit with an error message.",{"type":18,"tag":80,"props":450,"children":451},{},[452,461,463,467],{"type":18,"tag":170,"props":453,"children":454},{},[455,457],{"type":24,"value":456},"Find ",{"type":18,"tag":84,"props":458,"children":460},{"latex-express":459,"styles":87},"y",[],{"type":24,"value":462},": which minimize ",{"type":18,"tag":84,"props":464,"children":466},{"latex-express":465,"styles":87},"\\left\\| r_{0}e_{1}-\\hat{H}_{m}y \\right \\|_{2}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":469,"children":470},{},[471,476,478,482],{"type":18,"tag":170,"props":472,"children":473},{},[474],{"type":24,"value":475},"Compute",{"type":24,"value":477},": ",{"type":18,"tag":84,"props":479,"children":481},{"latex-express":480,"styles":87},"x_{m} = x_{0}+V_{m}y_{m}",[],{"type":24,"value":197},{"type":18,"tag":27,"props":484,"children":485},{},[486,488,492],{"type":24,"value":487},"For example differential model, let ",{"type":18,"tag":84,"props":489,"children":491},{"latex-express":490,"styles":87},"x, y, \\phi",[],{"type":24,"value":493}," is the state presentation of the model\n$$ \\dot{x} = f(x,u) $$",{"type":18,"tag":27,"props":495,"children":496},{},[497],{"type":24,"value":498},"Then the HJBE defined as",{"type":18,"tag":65,"props":500,"children":502},{"latex-express":501,"styles":68},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}\n",[],{"type":18,"tag":27,"props":504,"children":505},{},[506],{"type":24,"value":74},{"type":18,"tag":76,"props":508,"children":509},{},[510,517,524,531,538],{"type":18,"tag":80,"props":511,"children":512},{},[513],{"type":18,"tag":84,"props":514,"children":516},{"latex-express":515,"styles":87},"f(x,u) = \\begin{bmatrix} u_{1}*\\cos{(\\phi)} \\\\ u_{1}*\\sin{(\\phi)} \\\\ u_{2} \\end{bmatrix}",[],{"type":18,"tag":80,"props":518,"children":519},{},[520],{"type":18,"tag":84,"props":521,"children":523},{"latex-express":522,"styles":87},"C(x,u) = \\begin{bmatrix} \\left(u_{1}-\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min} }{2})^{2} \\\\\n          \\left(u_{2}-\\frac{u_{2max}+u_{2min} }{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2}\n\\end{bmatrix}",[],{"type":18,"tag":80,"props":525,"children":526},{},[527],{"type":18,"tag":84,"props":528,"children":530},{"latex-express":529,"styles":87},"\\phi(x) = (x_{N}-x_{N,ref})^{T}Q(x_{N}-x_{N,ref})",[],{"type":18,"tag":80,"props":532,"children":533},{},[534],{"type":18,"tag":84,"props":535,"children":537},{"latex-express":536,"styles":87},"\\lambda = \\begin{bmatrix} \\lambda_{1} & \\lambda_{2} & \\lambda_{3} \\end{bmatrix}",[],{"type":18,"tag":80,"props":539,"children":540},{},[541],{"type":18,"tag":84,"props":542,"children":544},{"latex-express":543,"styles":87}," \\mu = \\begin{bmatrix} \\mu_{1} & \\mu_{2} \\end{bmatrix}",[],{"type":18,"tag":27,"props":546,"children":547},{},[548],{"type":24,"value":549},"Subtitute all of these term into HJBE",{"type":18,"tag":65,"props":551,"children":553},{"latex-express":552,"styles":68},"\n\\begin{align*}\nH(x,u,\\lambda,\\mu) &= \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref})\n                     + (x_{N}-x_{N,ref})^{T}Q(x_{N}-x_{N,ref}) \\\\ & + \\begin{bmatrix} \\lambda_{1} \\\\ \\lambda_{2} \\\\ \\lambda_{3} \\end{bmatrix}^{T} \\begin{bmatrix} u_{1}*\\cos(\\phi) \\\\ u_{1}*\\sin(\\phi) \\\\ u_{2} \\end{bmatrix}\n                     + \\begin{bmatrix} \\mu_{1} \\\\ \\mu_{2} \\end{bmatrix}^{T} \\begin{bmatrix} \\left(u_{1}-\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min}}{2})^{2} \\\\\n            \\left(u_{2}\\frac{u_{2max}+u_{2min}}{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2} \n\\end{bmatrix}\n\\end{align*}",[],{"type":18,"tag":27,"props":555,"children":556},{},[557],{"type":24,"value":558},"By doing partial derivative of HJBE, we get",{"type":18,"tag":277,"props":560,"children":562},{"id":561},"hamiltonian-respect-to-states",[563,565],{"type":24,"value":564},"Hamiltonian respect to states ",{"type":18,"tag":84,"props":566,"children":568},{"latex-express":567,"styles":87},"\\frac{\\partial H}{\\partial x}",[],{"type":18,"tag":65,"props":570,"children":572},{"latex-express":571,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial x} = \\begin{bmatrix}\n     (x-x_{ref})q_{1} \\\\\n     (y-y_{ref})q_{2} \\\\ \n     (\\phi-\\phi_{ref})q_{3} - \\lambda_{1}\\sin{(\\phi)}u_{1} + \\lambda_{2}\\cos{(\\phi)}u_{1}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":18,"tag":277,"props":574,"children":576},{"id":575},"hamiltonian-respect-to-input-control",[577,579],{"type":24,"value":578},"Hamiltonian respect to input control ",{"type":18,"tag":84,"props":580,"children":581},{"latex-express":567,"styles":87},[],{"type":18,"tag":65,"props":583,"children":585},{"latex-express":584,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial u} = \\begin{bmatrix}\n      (u_{1}-u_{1,ref})r_{1}+\\lambda_{1}\\cos{(\\phi)}+\\lambda_{2}\\sin{(\\phi)} \\\\ \n      (u_{2}-u_{2,ref})r_{2}+\\lambda_{3}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":18,"tag":27,"props":587,"children":588},{},[589],{"type":24,"value":590},"I know this is quite complicated, this is just only input control without constraint and solver with single shooting method.",{"type":18,"tag":19,"props":592,"children":594},{"id":593},"implementing-in-python",[595],{"type":24,"value":596},"Implementing in Python",{"type":18,"tag":27,"props":598,"children":599},{},[600,602],{"type":24,"value":601},"It is safe to say that you will need to start from basic first. Like creating class for model representation, but for now I will just go with CGMRES implementing only, since I have done many demonstration of how to create class for model. ",{"type":18,"tag":56,"props":603,"children":604},{},[],{"type":18,"tag":27,"props":606,"children":607},{},[608,610,615],{"type":24,"value":609},"Let's create class for ",{"type":18,"tag":170,"props":611,"children":612},{},[613],{"type":24,"value":614}," Hamiltion Jacobian Bellman Equation ",{"type":24,"value":616}," which we already derived from above equation.",{"type":18,"tag":618,"props":619,"children":624},"code",{"className":620,"code":622,"language":623,"meta":8},[621],"language-python","class HJBEquation:\n\n    def __init__(self, q1, q2, q3, r1, r2, u_max, u_min):\n\n        self.q1 = q1\n        self.q2 = q2\n        self.q3 = q3\n\n        self.r1 = r1\n        self.r2 = r2\n\n        self.u1_min = u_min[0]\n        self.u2_min = u_min[0]\n\n        self.u1_max = u_max[0]\n        self.u2_max = u_max[1]\n\n    def dhdx(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n\n        dhdx1 = (x-x_r)*self.q1\n        dhdx2 = (y-y_r)*self.q2\n        dhdx3 = (yaw-yaw_r)*self.q3-u1*lam1*np.sin(yaw)+u1*lam2*np.cos(yaw)\n\n        return dhdx1, dhdx2, dhdx3\n\n    def dhdu(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n\n        dhdu1 = self.r1*(u1-u1_r)+lam1*np.cos(yaw)+lam2*np.sin(yaw)+2*mu1*u1*(u1+(self.u1_max+self.u1_min)/2)\n        dhdu2 = self.r2*(u2-u2_r)+lam3+2*mu2*(u2+(self.u2_max+self.u2_min)/2)\n\n        return dhdu1, dhdu2\n\n    def dphidx(self, x, y, yaw, x_r, y_r, yaw_r):\n        dphidx1 = self.q1*(x-x_r)\n        dphidx2 = self.q2*(y-y_r)\n        dphidx3 = self.q3*(yaw-yaw_r)\n\n        return dphidx1, dphidx2, dphidx3\n","python",[625],{"type":18,"tag":626,"props":627,"children":628},"pre",{},[629],{"type":18,"tag":618,"props":630,"children":631},{"__ignoreMap":8},[632,661,670,699,707,736,762,788,796,822,848,856,892,925,933,967,1001,1009,1035,1043,1085,1125,1219,1227,1245,1253,1279,1287,1443,1563,1571,1588,1596,1622,1666,1710,1753,1761],{"type":18,"tag":633,"props":634,"children":637},"span",{"class":635,"line":636},"line",1,[638,644,650,656],{"type":18,"tag":633,"props":639,"children":641},{"class":640},"ct-857441",[642],{"type":24,"value":643},"class",{"type":18,"tag":633,"props":645,"children":647},{"class":646},"ct-767297",[648],{"type":24,"value":649}," ",{"type":18,"tag":633,"props":651,"children":653},{"class":652},"ct-806137",[654],{"type":24,"value":655},"HJBEquation",{"type":18,"tag":633,"props":657,"children":658},{"class":646},[659],{"type":24,"value":660},":\n",{"type":18,"tag":633,"props":662,"children":664},{"class":635,"line":663},2,[665],{"type":18,"tag":633,"props":666,"children":667},{},[668],{"type":24,"value":669},"\n",{"type":18,"tag":633,"props":671,"children":673},{"class":635,"line":672},3,[674,679,684,688,694],{"type":18,"tag":633,"props":675,"children":676},{"class":646},[677],{"type":24,"value":678},"    ",{"type":18,"tag":633,"props":680,"children":681},{"class":640},[682],{"type":24,"value":683},"def",{"type":18,"tag":633,"props":685,"children":686},{"class":646},[687],{"type":24,"value":649},{"type":18,"tag":633,"props":689,"children":691},{"class":690},"ct-533739",[692],{"type":24,"value":693},"__init__",{"type":18,"tag":633,"props":695,"children":696},{"class":646},[697],{"type":24,"value":698},"(self, q1, q2, q3, r1, r2, u_max, u_min):\n",{"type":18,"tag":633,"props":700,"children":702},{"class":635,"line":701},4,[703],{"type":18,"tag":633,"props":704,"children":705},{},[706],{"type":24,"value":669},{"type":18,"tag":633,"props":708,"children":710},{"class":635,"line":709},5,[711,716,721,726,731],{"type":18,"tag":633,"props":712,"children":713},{"class":646},[714],{"type":24,"value":715},"        ",{"type":18,"tag":633,"props":717,"children":718},{"class":690},[719],{"type":24,"value":720},"self",{"type":18,"tag":633,"props":722,"children":723},{"class":646},[724],{"type":24,"value":725},".q1 ",{"type":18,"tag":633,"props":727,"children":728},{"class":640},[729],{"type":24,"value":730},"=",{"type":18,"tag":633,"props":732,"children":733},{"class":646},[734],{"type":24,"value":735}," q1\n",{"type":18,"tag":633,"props":737,"children":739},{"class":635,"line":738},6,[740,744,748,753,757],{"type":18,"tag":633,"props":741,"children":742},{"class":646},[743],{"type":24,"value":715},{"type":18,"tag":633,"props":745,"children":746},{"class":690},[747],{"type":24,"value":720},{"type":18,"tag":633,"props":749,"children":750},{"class":646},[751],{"type":24,"value":752},".q2 ",{"type":18,"tag":633,"props":754,"children":755},{"class":640},[756],{"type":24,"value":730},{"type":18,"tag":633,"props":758,"children":759},{"class":646},[760],{"type":24,"value":761}," q2\n",{"type":18,"tag":633,"props":763,"children":765},{"class":635,"line":764},7,[766,770,774,779,783],{"type":18,"tag":633,"props":767,"children":768},{"class":646},[769],{"type":24,"value":715},{"type":18,"tag":633,"props":771,"children":772},{"class":690},[773],{"type":24,"value":720},{"type":18,"tag":633,"props":775,"children":776},{"class":646},[777],{"type":24,"value":778},".q3 ",{"type":18,"tag":633,"props":780,"children":781},{"class":640},[782],{"type":24,"value":730},{"type":18,"tag":633,"props":784,"children":785},{"class":646},[786],{"type":24,"value":787}," q3\n",{"type":18,"tag":633,"props":789,"children":791},{"class":635,"line":790},8,[792],{"type":18,"tag":633,"props":793,"children":794},{},[795],{"type":24,"value":669},{"type":18,"tag":633,"props":797,"children":799},{"class":635,"line":798},9,[800,804,808,813,817],{"type":18,"tag":633,"props":801,"children":802},{"class":646},[803],{"type":24,"value":715},{"type":18,"tag":633,"props":805,"children":806},{"class":690},[807],{"type":24,"value":720},{"type":18,"tag":633,"props":809,"children":810},{"class":646},[811],{"type":24,"value":812},".r1 ",{"type":18,"tag":633,"props":814,"children":815},{"class":640},[816],{"type":24,"value":730},{"type":18,"tag":633,"props":818,"children":819},{"class":646},[820],{"type":24,"value":821}," r1\n",{"type":18,"tag":633,"props":823,"children":825},{"class":635,"line":824},10,[826,830,834,839,843],{"type":18,"tag":633,"props":827,"children":828},{"class":646},[829],{"type":24,"value":715},{"type":18,"tag":633,"props":831,"children":832},{"class":690},[833],{"type":24,"value":720},{"type":18,"tag":633,"props":835,"children":836},{"class":646},[837],{"type":24,"value":838},".r2 ",{"type":18,"tag":633,"props":840,"children":841},{"class":640},[842],{"type":24,"value":730},{"type":18,"tag":633,"props":844,"children":845},{"class":646},[846],{"type":24,"value":847}," r2\n",{"type":18,"tag":633,"props":849,"children":851},{"class":635,"line":850},11,[852],{"type":18,"tag":633,"props":853,"children":854},{},[855],{"type":24,"value":669},{"type":18,"tag":633,"props":857,"children":859},{"class":635,"line":858},12,[860,864,868,873,877,882,887],{"type":18,"tag":633,"props":861,"children":862},{"class":646},[863],{"type":24,"value":715},{"type":18,"tag":633,"props":865,"children":866},{"class":690},[867],{"type":24,"value":720},{"type":18,"tag":633,"props":869,"children":870},{"class":646},[871],{"type":24,"value":872},".u1_min ",{"type":18,"tag":633,"props":874,"children":875},{"class":640},[876],{"type":24,"value":730},{"type":18,"tag":633,"props":878,"children":879},{"class":646},[880],{"type":24,"value":881}," u_min[",{"type":18,"tag":633,"props":883,"children":884},{"class":690},[885],{"type":24,"value":886},"0",{"type":18,"tag":633,"props":888,"children":889},{"class":646},[890],{"type":24,"value":891},"]\n",{"type":18,"tag":633,"props":893,"children":895},{"class":635,"line":894},13,[896,900,904,909,913,917,921],{"type":18,"tag":633,"props":897,"children":898},{"class":646},[899],{"type":24,"value":715},{"type":18,"tag":633,"props":901,"children":902},{"class":690},[903],{"type":24,"value":720},{"type":18,"tag":633,"props":905,"children":906},{"class":646},[907],{"type":24,"value":908},".u2_min ",{"type":18,"tag":633,"props":910,"children":911},{"class":640},[912],{"type":24,"value":730},{"type":18,"tag":633,"props":914,"children":915},{"class":646},[916],{"type":24,"value":881},{"type":18,"tag":633,"props":918,"children":919},{"class":690},[920],{"type":24,"value":886},{"type":18,"tag":633,"props":922,"children":923},{"class":646},[924],{"type":24,"value":891},{"type":18,"tag":633,"props":926,"children":928},{"class":635,"line":927},14,[929],{"type":18,"tag":633,"props":930,"children":931},{},[932],{"type":24,"value":669},{"type":18,"tag":633,"props":934,"children":936},{"class":635,"line":935},15,[937,941,945,950,954,959,963],{"type":18,"tag":633,"props":938,"children":939},{"class":646},[940],{"type":24,"value":715},{"type":18,"tag":633,"props":942,"children":943},{"class":690},[944],{"type":24,"value":720},{"type":18,"tag":633,"props":946,"children":947},{"class":646},[948],{"type":24,"value":949},".u1_max ",{"type":18,"tag":633,"props":951,"children":952},{"class":640},[953],{"type":24,"value":730},{"type":18,"tag":633,"props":955,"children":956},{"class":646},[957],{"type":24,"value":958}," u_max[",{"type":18,"tag":633,"props":960,"children":961},{"class":690},[962],{"type":24,"value":886},{"type":18,"tag":633,"props":964,"children":965},{"class":646},[966],{"type":24,"value":891},{"type":18,"tag":633,"props":968,"children":970},{"class":635,"line":969},16,[971,975,979,984,988,992,997],{"type":18,"tag":633,"props":972,"children":973},{"class":646},[974],{"type":24,"value":715},{"type":18,"tag":633,"props":976,"children":977},{"class":690},[978],{"type":24,"value":720},{"type":18,"tag":633,"props":980,"children":981},{"class":646},[982],{"type":24,"value":983},".u2_max ",{"type":18,"tag":633,"props":985,"children":986},{"class":640},[987],{"type":24,"value":730},{"type":18,"tag":633,"props":989,"children":990},{"class":646},[991],{"type":24,"value":958},{"type":18,"tag":633,"props":993,"children":994},{"class":690},[995],{"type":24,"value":996},"1",{"type":18,"tag":633,"props":998,"children":999},{"class":646},[1000],{"type":24,"value":891},{"type":18,"tag":633,"props":1002,"children":1004},{"class":635,"line":1003},17,[1005],{"type":18,"tag":633,"props":1006,"children":1007},{},[1008],{"type":24,"value":669},{"type":18,"tag":633,"props":1010,"children":1012},{"class":635,"line":1011},18,[1013,1017,1021,1025,1030],{"type":18,"tag":633,"props":1014,"children":1015},{"class":646},[1016],{"type":24,"value":678},{"type":18,"tag":633,"props":1018,"children":1019},{"class":640},[1020],{"type":24,"value":683},{"type":18,"tag":633,"props":1022,"children":1023},{"class":646},[1024],{"type":24,"value":649},{"type":18,"tag":633,"props":1026,"children":1027},{"class":652},[1028],{"type":24,"value":1029},"dhdx",{"type":18,"tag":633,"props":1031,"children":1032},{"class":646},[1033],{"type":24,"value":1034},"(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n",{"type":18,"tag":633,"props":1036,"children":1038},{"class":635,"line":1037},19,[1039],{"type":18,"tag":633,"props":1040,"children":1041},{},[1042],{"type":24,"value":669},{"type":18,"tag":633,"props":1044,"children":1046},{"class":635,"line":1045},20,[1047,1052,1056,1061,1066,1071,1076,1080],{"type":18,"tag":633,"props":1048,"children":1049},{"class":646},[1050],{"type":24,"value":1051},"        dhdx1 ",{"type":18,"tag":633,"props":1053,"children":1054},{"class":640},[1055],{"type":24,"value":730},{"type":18,"tag":633,"props":1057,"children":1058},{"class":646},[1059],{"type":24,"value":1060}," (x",{"type":18,"tag":633,"props":1062,"children":1063},{"class":640},[1064],{"type":24,"value":1065},"-",{"type":18,"tag":633,"props":1067,"children":1068},{"class":646},[1069],{"type":24,"value":1070},"x_r)",{"type":18,"tag":633,"props":1072,"children":1073},{"class":640},[1074],{"type":24,"value":1075},"*",{"type":18,"tag":633,"props":1077,"children":1078},{"class":690},[1079],{"type":24,"value":720},{"type":18,"tag":633,"props":1081,"children":1082},{"class":646},[1083],{"type":24,"value":1084},".q1\n",{"type":18,"tag":633,"props":1086,"children":1088},{"class":635,"line":1087},21,[1089,1094,1098,1103,1107,1112,1116,1120],{"type":18,"tag":633,"props":1090,"children":1091},{"class":646},[1092],{"type":24,"value":1093},"        dhdx2 ",{"type":18,"tag":633,"props":1095,"children":1096},{"class":640},[1097],{"type":24,"value":730},{"type":18,"tag":633,"props":1099,"children":1100},{"class":646},[1101],{"type":24,"value":1102}," (y",{"type":18,"tag":633,"props":1104,"children":1105},{"class":640},[1106],{"type":24,"value":1065},{"type":18,"tag":633,"props":1108,"children":1109},{"class":646},[1110],{"type":24,"value":1111},"y_r)",{"type":18,"tag":633,"props":1113,"children":1114},{"class":640},[1115],{"type":24,"value":1075},{"type":18,"tag":633,"props":1117,"children":1118},{"class":690},[1119],{"type":24,"value":720},{"type":18,"tag":633,"props":1121,"children":1122},{"class":646},[1123],{"type":24,"value":1124},".q2\n",{"type":18,"tag":633,"props":1126,"children":1128},{"class":635,"line":1127},22,[1129,1134,1138,1143,1147,1152,1156,1160,1165,1169,1174,1178,1183,1187,1192,1197,1201,1205,1210,1214],{"type":18,"tag":633,"props":1130,"children":1131},{"class":646},[1132],{"type":24,"value":1133},"        dhdx3 ",{"type":18,"tag":633,"props":1135,"children":1136},{"class":640},[1137],{"type":24,"value":730},{"type":18,"tag":633,"props":1139,"children":1140},{"class":646},[1141],{"type":24,"value":1142}," (yaw",{"type":18,"tag":633,"props":1144,"children":1145},{"class":640},[1146],{"type":24,"value":1065},{"type":18,"tag":633,"props":1148,"children":1149},{"class":646},[1150],{"type":24,"value":1151},"yaw_r)",{"type":18,"tag":633,"props":1153,"children":1154},{"class":640},[1155],{"type":24,"value":1075},{"type":18,"tag":633,"props":1157,"children":1158},{"class":690},[1159],{"type":24,"value":720},{"type":18,"tag":633,"props":1161,"children":1162},{"class":646},[1163],{"type":24,"value":1164},".q3",{"type":18,"tag":633,"props":1166,"children":1167},{"class":640},[1168],{"type":24,"value":1065},{"type":18,"tag":633,"props":1170,"children":1171},{"class":646},[1172],{"type":24,"value":1173},"u1",{"type":18,"tag":633,"props":1175,"children":1176},{"class":640},[1177],{"type":24,"value":1075},{"type":18,"tag":633,"props":1179,"children":1180},{"class":646},[1181],{"type":24,"value":1182},"lam1",{"type":18,"tag":633,"props":1184,"children":1185},{"class":640},[1186],{"type":24,"value":1075},{"type":18,"tag":633,"props":1188,"children":1189},{"class":646},[1190],{"type":24,"value":1191},"np.sin(yaw)",{"type":18,"tag":633,"props":1193,"children":1194},{"class":640},[1195],{"type":24,"value":1196},"+",{"type":18,"tag":633,"props":1198,"children":1199},{"class":646},[1200],{"type":24,"value":1173},{"type":18,"tag":633,"props":1202,"children":1203},{"class":640},[1204],{"type":24,"value":1075},{"type":18,"tag":633,"props":1206,"children":1207},{"class":646},[1208],{"type":24,"value":1209},"lam2",{"type":18,"tag":633,"props":1211,"children":1212},{"class":640},[1213],{"type":24,"value":1075},{"type":18,"tag":633,"props":1215,"children":1216},{"class":646},[1217],{"type":24,"value":1218},"np.cos(yaw)\n",{"type":18,"tag":633,"props":1220,"children":1222},{"class":635,"line":1221},23,[1223],{"type":18,"tag":633,"props":1224,"children":1225},{},[1226],{"type":24,"value":669},{"type":18,"tag":633,"props":1228,"children":1230},{"class":635,"line":1229},24,[1231,1235,1240],{"type":18,"tag":633,"props":1232,"children":1233},{"class":646},[1234],{"type":24,"value":715},{"type":18,"tag":633,"props":1236,"children":1237},{"class":640},[1238],{"type":24,"value":1239},"return",{"type":18,"tag":633,"props":1241,"children":1242},{"class":646},[1243],{"type":24,"value":1244}," dhdx1, dhdx2, dhdx3\n",{"type":18,"tag":633,"props":1246,"children":1248},{"class":635,"line":1247},25,[1249],{"type":18,"tag":633,"props":1250,"children":1251},{},[1252],{"type":24,"value":669},{"type":18,"tag":633,"props":1254,"children":1256},{"class":635,"line":1255},26,[1257,1261,1265,1269,1274],{"type":18,"tag":633,"props":1258,"children":1259},{"class":646},[1260],{"type":24,"value":678},{"type":18,"tag":633,"props":1262,"children":1263},{"class":640},[1264],{"type":24,"value":683},{"type":18,"tag":633,"props":1266,"children":1267},{"class":646},[1268],{"type":24,"value":649},{"type":18,"tag":633,"props":1270,"children":1271},{"class":652},[1272],{"type":24,"value":1273},"dhdu",{"type":18,"tag":633,"props":1275,"children":1276},{"class":646},[1277],{"type":24,"value":1278},"(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n",{"type":18,"tag":633,"props":1280,"children":1282},{"class":635,"line":1281},27,[1283],{"type":18,"tag":633,"props":1284,"children":1285},{},[1286],{"type":24,"value":669},{"type":18,"tag":633,"props":1288,"children":1290},{"class":635,"line":1289},28,[1291,1296,1300,1304,1308,1313,1317,1322,1326,1331,1335,1339,1343,1348,1352,1356,1360,1364,1368,1373,1377,1382,1386,1390,1394,1398,1402,1407,1411,1416,1420,1424,1429,1434,1438],{"type":18,"tag":633,"props":1292,"children":1293},{"class":646},[1294],{"type":24,"value":1295},"        dhdu1 ",{"type":18,"tag":633,"props":1297,"children":1298},{"class":640},[1299],{"type":24,"value":730},{"type":18,"tag":633,"props":1301,"children":1302},{"class":646},[1303],{"type":24,"value":649},{"type":18,"tag":633,"props":1305,"children":1306},{"class":690},[1307],{"type":24,"value":720},{"type":18,"tag":633,"props":1309,"children":1310},{"class":646},[1311],{"type":24,"value":1312},".r1",{"type":18,"tag":633,"props":1314,"children":1315},{"class":640},[1316],{"type":24,"value":1075},{"type":18,"tag":633,"props":1318,"children":1319},{"class":646},[1320],{"type":24,"value":1321},"(u1",{"type":18,"tag":633,"props":1323,"children":1324},{"class":640},[1325],{"type":24,"value":1065},{"type":18,"tag":633,"props":1327,"children":1328},{"class":646},[1329],{"type":24,"value":1330},"u1_r)",{"type":18,"tag":633,"props":1332,"children":1333},{"class":640},[1334],{"type":24,"value":1196},{"type":18,"tag":633,"props":1336,"children":1337},{"class":646},[1338],{"type":24,"value":1182},{"type":18,"tag":633,"props":1340,"children":1341},{"class":640},[1342],{"type":24,"value":1075},{"type":18,"tag":633,"props":1344,"children":1345},{"class":646},[1346],{"type":24,"value":1347},"np.cos(yaw)",{"type":18,"tag":633,"props":1349,"children":1350},{"class":640},[1351],{"type":24,"value":1196},{"type":18,"tag":633,"props":1353,"children":1354},{"class":646},[1355],{"type":24,"value":1209},{"type":18,"tag":633,"props":1357,"children":1358},{"class":640},[1359],{"type":24,"value":1075},{"type":18,"tag":633,"props":1361,"children":1362},{"class":646},[1363],{"type":24,"value":1191},{"type":18,"tag":633,"props":1365,"children":1366},{"class":640},[1367],{"type":24,"value":1196},{"type":18,"tag":633,"props":1369,"children":1370},{"class":690},[1371],{"type":24,"value":1372},"2",{"type":18,"tag":633,"props":1374,"children":1375},{"class":640},[1376],{"type":24,"value":1075},{"type":18,"tag":633,"props":1378,"children":1379},{"class":646},[1380],{"type":24,"value":1381},"mu1",{"type":18,"tag":633,"props":1383,"children":1384},{"class":640},[1385],{"type":24,"value":1075},{"type":18,"tag":633,"props":1387,"children":1388},{"class":646},[1389],{"type":24,"value":1173},{"type":18,"tag":633,"props":1391,"children":1392},{"class":640},[1393],{"type":24,"value":1075},{"type":18,"tag":633,"props":1395,"children":1396},{"class":646},[1397],{"type":24,"value":1321},{"type":18,"tag":633,"props":1399,"children":1400},{"class":640},[1401],{"type":24,"value":1196},{"type":18,"tag":633,"props":1403,"children":1404},{"class":646},[1405],{"type":24,"value":1406},"(",{"type":18,"tag":633,"props":1408,"children":1409},{"class":690},[1410],{"type":24,"value":720},{"type":18,"tag":633,"props":1412,"children":1413},{"class":646},[1414],{"type":24,"value":1415},".u1_max",{"type":18,"tag":633,"props":1417,"children":1418},{"class":640},[1419],{"type":24,"value":1196},{"type":18,"tag":633,"props":1421,"children":1422},{"class":690},[1423],{"type":24,"value":720},{"type":18,"tag":633,"props":1425,"children":1426},{"class":646},[1427],{"type":24,"value":1428},".u1_min)",{"type":18,"tag":633,"props":1430,"children":1431},{"class":640},[1432],{"type":24,"value":1433},"/",{"type":18,"tag":633,"props":1435,"children":1436},{"class":690},[1437],{"type":24,"value":1372},{"type":18,"tag":633,"props":1439,"children":1440},{"class":646},[1441],{"type":24,"value":1442},")\n",{"type":18,"tag":633,"props":1444,"children":1446},{"class":635,"line":1445},29,[1447,1452,1456,1460,1464,1469,1473,1478,1482,1487,1491,1496,1500,1504,1508,1513,1517,1521,1525,1529,1533,1538,1542,1546,1551,1555,1559],{"type":18,"tag":633,"props":1448,"children":1449},{"class":646},[1450],{"type":24,"value":1451},"        dhdu2 ",{"type":18,"tag":633,"props":1453,"children":1454},{"class":640},[1455],{"type":24,"value":730},{"type":18,"tag":633,"props":1457,"children":1458},{"class":646},[1459],{"type":24,"value":649},{"type":18,"tag":633,"props":1461,"children":1462},{"class":690},[1463],{"type":24,"value":720},{"type":18,"tag":633,"props":1465,"children":1466},{"class":646},[1467],{"type":24,"value":1468},".r2",{"type":18,"tag":633,"props":1470,"children":1471},{"class":640},[1472],{"type":24,"value":1075},{"type":18,"tag":633,"props":1474,"children":1475},{"class":646},[1476],{"type":24,"value":1477},"(u2",{"type":18,"tag":633,"props":1479,"children":1480},{"class":640},[1481],{"type":24,"value":1065},{"type":18,"tag":633,"props":1483,"children":1484},{"class":646},[1485],{"type":24,"value":1486},"u2_r)",{"type":18,"tag":633,"props":1488,"children":1489},{"class":640},[1490],{"type":24,"value":1196},{"type":18,"tag":633,"props":1492,"children":1493},{"class":646},[1494],{"type":24,"value":1495},"lam3",{"type":18,"tag":633,"props":1497,"children":1498},{"class":640},[1499],{"type":24,"value":1196},{"type":18,"tag":633,"props":1501,"children":1502},{"class":690},[1503],{"type":24,"value":1372},{"type":18,"tag":633,"props":1505,"children":1506},{"class":640},[1507],{"type":24,"value":1075},{"type":18,"tag":633,"props":1509,"children":1510},{"class":646},[1511],{"type":24,"value":1512},"mu2",{"type":18,"tag":633,"props":1514,"children":1515},{"class":640},[1516],{"type":24,"value":1075},{"type":18,"tag":633,"props":1518,"children":1519},{"class":646},[1520],{"type":24,"value":1477},{"type":18,"tag":633,"props":1522,"children":1523},{"class":640},[1524],{"type":24,"value":1196},{"type":18,"tag":633,"props":1526,"children":1527},{"class":646},[1528],{"type":24,"value":1406},{"type":18,"tag":633,"props":1530,"children":1531},{"class":690},[1532],{"type":24,"value":720},{"type":18,"tag":633,"props":1534,"children":1535},{"class":646},[1536],{"type":24,"value":1537},".u2_max",{"type":18,"tag":633,"props":1539,"children":1540},{"class":640},[1541],{"type":24,"value":1196},{"type":18,"tag":633,"props":1543,"children":1544},{"class":690},[1545],{"type":24,"value":720},{"type":18,"tag":633,"props":1547,"children":1548},{"class":646},[1549],{"type":24,"value":1550},".u2_min)",{"type":18,"tag":633,"props":1552,"children":1553},{"class":640},[1554],{"type":24,"value":1433},{"type":18,"tag":633,"props":1556,"children":1557},{"class":690},[1558],{"type":24,"value":1372},{"type":18,"tag":633,"props":1560,"children":1561},{"class":646},[1562],{"type":24,"value":1442},{"type":18,"tag":633,"props":1564,"children":1566},{"class":635,"line":1565},30,[1567],{"type":18,"tag":633,"props":1568,"children":1569},{},[1570],{"type":24,"value":669},{"type":18,"tag":633,"props":1572,"children":1574},{"class":635,"line":1573},31,[1575,1579,1583],{"type":18,"tag":633,"props":1576,"children":1577},{"class":646},[1578],{"type":24,"value":715},{"type":18,"tag":633,"props":1580,"children":1581},{"class":640},[1582],{"type":24,"value":1239},{"type":18,"tag":633,"props":1584,"children":1585},{"class":646},[1586],{"type":24,"value":1587}," dhdu1, dhdu2\n",{"type":18,"tag":633,"props":1589,"children":1591},{"class":635,"line":1590},32,[1592],{"type":18,"tag":633,"props":1593,"children":1594},{},[1595],{"type":24,"value":669},{"type":18,"tag":633,"props":1597,"children":1599},{"class":635,"line":1598},33,[1600,1604,1608,1612,1617],{"type":18,"tag":633,"props":1601,"children":1602},{"class":646},[1603],{"type":24,"value":678},{"type":18,"tag":633,"props":1605,"children":1606},{"class":640},[1607],{"type":24,"value":683},{"type":18,"tag":633,"props":1609,"children":1610},{"class":646},[1611],{"type":24,"value":649},{"type":18,"tag":633,"props":1613,"children":1614},{"class":652},[1615],{"type":24,"value":1616},"dphidx",{"type":18,"tag":633,"props":1618,"children":1619},{"class":646},[1620],{"type":24,"value":1621},"(self, x, y, yaw, x_r, y_r, yaw_r):\n",{"type":18,"tag":633,"props":1623,"children":1625},{"class":635,"line":1624},34,[1626,1631,1635,1639,1643,1648,1652,1657,1661],{"type":18,"tag":633,"props":1627,"children":1628},{"class":646},[1629],{"type":24,"value":1630},"        dphidx1 ",{"type":18,"tag":633,"props":1632,"children":1633},{"class":640},[1634],{"type":24,"value":730},{"type":18,"tag":633,"props":1636,"children":1637},{"class":646},[1638],{"type":24,"value":649},{"type":18,"tag":633,"props":1640,"children":1641},{"class":690},[1642],{"type":24,"value":720},{"type":18,"tag":633,"props":1644,"children":1645},{"class":646},[1646],{"type":24,"value":1647},".q1",{"type":18,"tag":633,"props":1649,"children":1650},{"class":640},[1651],{"type":24,"value":1075},{"type":18,"tag":633,"props":1653,"children":1654},{"class":646},[1655],{"type":24,"value":1656},"(x",{"type":18,"tag":633,"props":1658,"children":1659},{"class":640},[1660],{"type":24,"value":1065},{"type":18,"tag":633,"props":1662,"children":1663},{"class":646},[1664],{"type":24,"value":1665},"x_r)\n",{"type":18,"tag":633,"props":1667,"children":1669},{"class":635,"line":1668},35,[1670,1675,1679,1683,1687,1692,1696,1701,1705],{"type":18,"tag":633,"props":1671,"children":1672},{"class":646},[1673],{"type":24,"value":1674},"        dphidx2 ",{"type":18,"tag":633,"props":1676,"children":1677},{"class":640},[1678],{"type":24,"value":730},{"type":18,"tag":633,"props":1680,"children":1681},{"class":646},[1682],{"type":24,"value":649},{"type":18,"tag":633,"props":1684,"children":1685},{"class":690},[1686],{"type":24,"value":720},{"type":18,"tag":633,"props":1688,"children":1689},{"class":646},[1690],{"type":24,"value":1691},".q2",{"type":18,"tag":633,"props":1693,"children":1694},{"class":640},[1695],{"type":24,"value":1075},{"type":18,"tag":633,"props":1697,"children":1698},{"class":646},[1699],{"type":24,"value":1700},"(y",{"type":18,"tag":633,"props":1702,"children":1703},{"class":640},[1704],{"type":24,"value":1065},{"type":18,"tag":633,"props":1706,"children":1707},{"class":646},[1708],{"type":24,"value":1709},"y_r)\n",{"type":18,"tag":633,"props":1711,"children":1713},{"class":635,"line":1712},36,[1714,1719,1723,1727,1731,1735,1739,1744,1748],{"type":18,"tag":633,"props":1715,"children":1716},{"class":646},[1717],{"type":24,"value":1718},"        dphidx3 ",{"type":18,"tag":633,"props":1720,"children":1721},{"class":640},[1722],{"type":24,"value":730},{"type":18,"tag":633,"props":1724,"children":1725},{"class":646},[1726],{"type":24,"value":649},{"type":18,"tag":633,"props":1728,"children":1729},{"class":690},[1730],{"type":24,"value":720},{"type":18,"tag":633,"props":1732,"children":1733},{"class":646},[1734],{"type":24,"value":1164},{"type":18,"tag":633,"props":1736,"children":1737},{"class":640},[1738],{"type":24,"value":1075},{"type":18,"tag":633,"props":1740,"children":1741},{"class":646},[1742],{"type":24,"value":1743},"(yaw",{"type":18,"tag":633,"props":1745,"children":1746},{"class":640},[1747],{"type":24,"value":1065},{"type":18,"tag":633,"props":1749,"children":1750},{"class":646},[1751],{"type":24,"value":1752},"yaw_r)\n",{"type":18,"tag":633,"props":1754,"children":1756},{"class":635,"line":1755},37,[1757],{"type":18,"tag":633,"props":1758,"children":1759},{},[1760],{"type":24,"value":669},{"type":18,"tag":633,"props":1762,"children":1764},{"class":635,"line":1763},38,[1765,1769,1773],{"type":18,"tag":633,"props":1766,"children":1767},{"class":646},[1768],{"type":24,"value":715},{"type":18,"tag":633,"props":1770,"children":1771},{"class":640},[1772],{"type":24,"value":1239},{"type":18,"tag":633,"props":1774,"children":1775},{"class":646},[1776],{"type":24,"value":1777}," dphidx1, dphidx2, dphidx3",{"type":18,"tag":27,"props":1779,"children":1780},{},[1781,1783,1788,1789],{"type":24,"value":1782},"Here, I suggest that you should understand the mathematics equations above that I try to explain. It is easy to do it in Python programming language if you already understand its expression. Now I created another class for ",{"type":18,"tag":170,"props":1784,"children":1785},{},[1786],{"type":24,"value":1787}," NMPC with CGMRES ",{"type":24,"value":176},{"type":18,"tag":56,"props":1790,"children":1791},{},[],{"type":18,"tag":618,"props":1793,"children":1796},{"className":1794,"code":1795,"language":623,"meta":8},[621],"class NMPCCGMRES:\n\n    def __init__(self):\n\n        ## NMPC params\n        self.x_dim = 3\n        self.u_dim = 2\n        self.c_dim = 2\n        self.pred_horizons = 10\n\n        ### Continuations Params\n        self.ht = 1e-5\n        self.zeta = 1/self.ht\n        self.alpha = 0.5\n        self.tf = 1.0\n\n        ### Matrix\n\n        self.q1 = 1\n        self.q2 = 6\n        self.q3 = 1\n        self.r1 = 1\n        self.r2 = 0.1\n\n        ### Constraint\n        self.u_min = [ 0,  0]\n        self.u_max = [ 2,  1.57]\n        self.u_dummy = [0.01, 0.01]\n\n        ### Initialize matrix solution\n        self.dU = np.zeros((self.u_dim, self.pred_horizons))\n\n        ### Reference point\n        self.X_r = [3, 2, 0.0]\n        self.U_r = [0, 0]\n",[1797],{"type":18,"tag":626,"props":1798,"children":1799},{},[1800],{"type":18,"tag":618,"props":1801,"children":1802},{"__ignoreMap":8},[1803,1823,1830,1854,1861,1874,1903,1932,1960,1989,1996,2008,2037,2078,2107,2136,2143,2155,2162,2190,2218,2245,2272,2300,2307,2319,2361,2402,2445,2452,2464,2507,2514,2526,2576],{"type":18,"tag":633,"props":1804,"children":1805},{"class":635,"line":636},[1806,1810,1814,1819],{"type":18,"tag":633,"props":1807,"children":1808},{"class":640},[1809],{"type":24,"value":643},{"type":18,"tag":633,"props":1811,"children":1812},{"class":646},[1813],{"type":24,"value":649},{"type":18,"tag":633,"props":1815,"children":1816},{"class":652},[1817],{"type":24,"value":1818},"NMPCCGMRES",{"type":18,"tag":633,"props":1820,"children":1821},{"class":646},[1822],{"type":24,"value":660},{"type":18,"tag":633,"props":1824,"children":1825},{"class":635,"line":663},[1826],{"type":18,"tag":633,"props":1827,"children":1828},{},[1829],{"type":24,"value":669},{"type":18,"tag":633,"props":1831,"children":1832},{"class":635,"line":672},[1833,1837,1841,1845,1849],{"type":18,"tag":633,"props":1834,"children":1835},{"class":646},[1836],{"type":24,"value":678},{"type":18,"tag":633,"props":1838,"children":1839},{"class":640},[1840],{"type":24,"value":683},{"type":18,"tag":633,"props":1842,"children":1843},{"class":646},[1844],{"type":24,"value":649},{"type":18,"tag":633,"props":1846,"children":1847},{"class":690},[1848],{"type":24,"value":693},{"type":18,"tag":633,"props":1850,"children":1851},{"class":646},[1852],{"type":24,"value":1853},"(self):\n",{"type":18,"tag":633,"props":1855,"children":1856},{"class":635,"line":701},[1857],{"type":18,"tag":633,"props":1858,"children":1859},{},[1860],{"type":24,"value":669},{"type":18,"tag":633,"props":1862,"children":1863},{"class":635,"line":709},[1864,1868],{"type":18,"tag":633,"props":1865,"children":1866},{"class":646},[1867],{"type":24,"value":715},{"type":18,"tag":633,"props":1869,"children":1871},{"class":1870},"ct-326375",[1872],{"type":24,"value":1873},"## NMPC params\n",{"type":18,"tag":633,"props":1875,"children":1876},{"class":635,"line":738},[1877,1881,1885,1890,1894,1898],{"type":18,"tag":633,"props":1878,"children":1879},{"class":646},[1880],{"type":24,"value":715},{"type":18,"tag":633,"props":1882,"children":1883},{"class":690},[1884],{"type":24,"value":720},{"type":18,"tag":633,"props":1886,"children":1887},{"class":646},[1888],{"type":24,"value":1889},".x_dim ",{"type":18,"tag":633,"props":1891,"children":1892},{"class":640},[1893],{"type":24,"value":730},{"type":18,"tag":633,"props":1895,"children":1896},{"class":646},[1897],{"type":24,"value":649},{"type":18,"tag":633,"props":1899,"children":1900},{"class":690},[1901],{"type":24,"value":1902},"3\n",{"type":18,"tag":633,"props":1904,"children":1905},{"class":635,"line":764},[1906,1910,1914,1919,1923,1927],{"type":18,"tag":633,"props":1907,"children":1908},{"class":646},[1909],{"type":24,"value":715},{"type":18,"tag":633,"props":1911,"children":1912},{"class":690},[1913],{"type":24,"value":720},{"type":18,"tag":633,"props":1915,"children":1916},{"class":646},[1917],{"type":24,"value":1918},".u_dim ",{"type":18,"tag":633,"props":1920,"children":1921},{"class":640},[1922],{"type":24,"value":730},{"type":18,"tag":633,"props":1924,"children":1925},{"class":646},[1926],{"type":24,"value":649},{"type":18,"tag":633,"props":1928,"children":1929},{"class":690},[1930],{"type":24,"value":1931},"2\n",{"type":18,"tag":633,"props":1933,"children":1934},{"class":635,"line":790},[1935,1939,1943,1948,1952,1956],{"type":18,"tag":633,"props":1936,"children":1937},{"class":646},[1938],{"type":24,"value":715},{"type":18,"tag":633,"props":1940,"children":1941},{"class":690},[1942],{"type":24,"value":720},{"type":18,"tag":633,"props":1944,"children":1945},{"class":646},[1946],{"type":24,"value":1947},".c_dim ",{"type":18,"tag":633,"props":1949,"children":1950},{"class":640},[1951],{"type":24,"value":730},{"type":18,"tag":633,"props":1953,"children":1954},{"class":646},[1955],{"type":24,"value":649},{"type":18,"tag":633,"props":1957,"children":1958},{"class":690},[1959],{"type":24,"value":1931},{"type":18,"tag":633,"props":1961,"children":1962},{"class":635,"line":798},[1963,1967,1971,1976,1980,1984],{"type":18,"tag":633,"props":1964,"children":1965},{"class":646},[1966],{"type":24,"value":715},{"type":18,"tag":633,"props":1968,"children":1969},{"class":690},[1970],{"type":24,"value":720},{"type":18,"tag":633,"props":1972,"children":1973},{"class":646},[1974],{"type":24,"value":1975},".pred_horizons ",{"type":18,"tag":633,"props":1977,"children":1978},{"class":640},[1979],{"type":24,"value":730},{"type":18,"tag":633,"props":1981,"children":1982},{"class":646},[1983],{"type":24,"value":649},{"type":18,"tag":633,"props":1985,"children":1986},{"class":690},[1987],{"type":24,"value":1988},"10\n",{"type":18,"tag":633,"props":1990,"children":1991},{"class":635,"line":824},[1992],{"type":18,"tag":633,"props":1993,"children":1994},{},[1995],{"type":24,"value":669},{"type":18,"tag":633,"props":1997,"children":1998},{"class":635,"line":850},[1999,2003],{"type":18,"tag":633,"props":2000,"children":2001},{"class":646},[2002],{"type":24,"value":715},{"type":18,"tag":633,"props":2004,"children":2005},{"class":1870},[2006],{"type":24,"value":2007},"### Continuations Params\n",{"type":18,"tag":633,"props":2009,"children":2010},{"class":635,"line":858},[2011,2015,2019,2024,2028,2032],{"type":18,"tag":633,"props":2012,"children":2013},{"class":646},[2014],{"type":24,"value":715},{"type":18,"tag":633,"props":2016,"children":2017},{"class":690},[2018],{"type":24,"value":720},{"type":18,"tag":633,"props":2020,"children":2021},{"class":646},[2022],{"type":24,"value":2023},".ht ",{"type":18,"tag":633,"props":2025,"children":2026},{"class":640},[2027],{"type":24,"value":730},{"type":18,"tag":633,"props":2029,"children":2030},{"class":646},[2031],{"type":24,"value":649},{"type":18,"tag":633,"props":2033,"children":2034},{"class":690},[2035],{"type":24,"value":2036},"1e-5\n",{"type":18,"tag":633,"props":2038,"children":2039},{"class":635,"line":894},[2040,2044,2048,2053,2057,2061,2065,2069,2073],{"type":18,"tag":633,"props":2041,"children":2042},{"class":646},[2043],{"type":24,"value":715},{"type":18,"tag":633,"props":2045,"children":2046},{"class":690},[2047],{"type":24,"value":720},{"type":18,"tag":633,"props":2049,"children":2050},{"class":646},[2051],{"type":24,"value":2052},".zeta ",{"type":18,"tag":633,"props":2054,"children":2055},{"class":640},[2056],{"type":24,"value":730},{"type":18,"tag":633,"props":2058,"children":2059},{"class":646},[2060],{"type":24,"value":649},{"type":18,"tag":633,"props":2062,"children":2063},{"class":690},[2064],{"type":24,"value":996},{"type":18,"tag":633,"props":2066,"children":2067},{"class":640},[2068],{"type":24,"value":1433},{"type":18,"tag":633,"props":2070,"children":2071},{"class":690},[2072],{"type":24,"value":720},{"type":18,"tag":633,"props":2074,"children":2075},{"class":646},[2076],{"type":24,"value":2077},".ht\n",{"type":18,"tag":633,"props":2079,"children":2080},{"class":635,"line":927},[2081,2085,2089,2094,2098,2102],{"type":18,"tag":633,"props":2082,"children":2083},{"class":646},[2084],{"type":24,"value":715},{"type":18,"tag":633,"props":2086,"children":2087},{"class":690},[2088],{"type":24,"value":720},{"type":18,"tag":633,"props":2090,"children":2091},{"class":646},[2092],{"type":24,"value":2093},".alpha ",{"type":18,"tag":633,"props":2095,"children":2096},{"class":640},[2097],{"type":24,"value":730},{"type":18,"tag":633,"props":2099,"children":2100},{"class":646},[2101],{"type":24,"value":649},{"type":18,"tag":633,"props":2103,"children":2104},{"class":690},[2105],{"type":24,"value":2106},"0.5\n",{"type":18,"tag":633,"props":2108,"children":2109},{"class":635,"line":935},[2110,2114,2118,2123,2127,2131],{"type":18,"tag":633,"props":2111,"children":2112},{"class":646},[2113],{"type":24,"value":715},{"type":18,"tag":633,"props":2115,"children":2116},{"class":690},[2117],{"type":24,"value":720},{"type":18,"tag":633,"props":2119,"children":2120},{"class":646},[2121],{"type":24,"value":2122},".tf ",{"type":18,"tag":633,"props":2124,"children":2125},{"class":640},[2126],{"type":24,"value":730},{"type":18,"tag":633,"props":2128,"children":2129},{"class":646},[2130],{"type":24,"value":649},{"type":18,"tag":633,"props":2132,"children":2133},{"class":690},[2134],{"type":24,"value":2135},"1.0\n",{"type":18,"tag":633,"props":2137,"children":2138},{"class":635,"line":969},[2139],{"type":18,"tag":633,"props":2140,"children":2141},{},[2142],{"type":24,"value":669},{"type":18,"tag":633,"props":2144,"children":2145},{"class":635,"line":1003},[2146,2150],{"type":18,"tag":633,"props":2147,"children":2148},{"class":646},[2149],{"type":24,"value":715},{"type":18,"tag":633,"props":2151,"children":2152},{"class":1870},[2153],{"type":24,"value":2154},"### Matrix\n",{"type":18,"tag":633,"props":2156,"children":2157},{"class":635,"line":1011},[2158],{"type":18,"tag":633,"props":2159,"children":2160},{},[2161],{"type":24,"value":669},{"type":18,"tag":633,"props":2163,"children":2164},{"class":635,"line":1037},[2165,2169,2173,2177,2181,2185],{"type":18,"tag":633,"props":2166,"children":2167},{"class":646},[2168],{"type":24,"value":715},{"type":18,"tag":633,"props":2170,"children":2171},{"class":690},[2172],{"type":24,"value":720},{"type":18,"tag":633,"props":2174,"children":2175},{"class":646},[2176],{"type":24,"value":725},{"type":18,"tag":633,"props":2178,"children":2179},{"class":640},[2180],{"type":24,"value":730},{"type":18,"tag":633,"props":2182,"children":2183},{"class":646},[2184],{"type":24,"value":649},{"type":18,"tag":633,"props":2186,"children":2187},{"class":690},[2188],{"type":24,"value":2189},"1\n",{"type":18,"tag":633,"props":2191,"children":2192},{"class":635,"line":1045},[2193,2197,2201,2205,2209,2213],{"type":18,"tag":633,"props":2194,"children":2195},{"class":646},[2196],{"type":24,"value":715},{"type":18,"tag":633,"props":2198,"children":2199},{"class":690},[2200],{"type":24,"value":720},{"type":18,"tag":633,"props":2202,"children":2203},{"class":646},[2204],{"type":24,"value":752},{"type":18,"tag":633,"props":2206,"children":2207},{"class":640},[2208],{"type":24,"value":730},{"type":18,"tag":633,"props":2210,"children":2211},{"class":646},[2212],{"type":24,"value":649},{"type":18,"tag":633,"props":2214,"children":2215},{"class":690},[2216],{"type":24,"value":2217},"6\n",{"type":18,"tag":633,"props":2219,"children":2220},{"class":635,"line":1087},[2221,2225,2229,2233,2237,2241],{"type":18,"tag":633,"props":2222,"children":2223},{"class":646},[2224],{"type":24,"value":715},{"type":18,"tag":633,"props":2226,"children":2227},{"class":690},[2228],{"type":24,"value":720},{"type":18,"tag":633,"props":2230,"children":2231},{"class":646},[2232],{"type":24,"value":778},{"type":18,"tag":633,"props":2234,"children":2235},{"class":640},[2236],{"type":24,"value":730},{"type":18,"tag":633,"props":2238,"children":2239},{"class":646},[2240],{"type":24,"value":649},{"type":18,"tag":633,"props":2242,"children":2243},{"class":690},[2244],{"type":24,"value":2189},{"type":18,"tag":633,"props":2246,"children":2247},{"class":635,"line":1127},[2248,2252,2256,2260,2264,2268],{"type":18,"tag":633,"props":2249,"children":2250},{"class":646},[2251],{"type":24,"value":715},{"type":18,"tag":633,"props":2253,"children":2254},{"class":690},[2255],{"type":24,"value":720},{"type":18,"tag":633,"props":2257,"children":2258},{"class":646},[2259],{"type":24,"value":812},{"type":18,"tag":633,"props":2261,"children":2262},{"class":640},[2263],{"type":24,"value":730},{"type":18,"tag":633,"props":2265,"children":2266},{"class":646},[2267],{"type":24,"value":649},{"type":18,"tag":633,"props":2269,"children":2270},{"class":690},[2271],{"type":24,"value":2189},{"type":18,"tag":633,"props":2273,"children":2274},{"class":635,"line":1221},[2275,2279,2283,2287,2291,2295],{"type":18,"tag":633,"props":2276,"children":2277},{"class":646},[2278],{"type":24,"value":715},{"type":18,"tag":633,"props":2280,"children":2281},{"class":690},[2282],{"type":24,"value":720},{"type":18,"tag":633,"props":2284,"children":2285},{"class":646},[2286],{"type":24,"value":838},{"type":18,"tag":633,"props":2288,"children":2289},{"class":640},[2290],{"type":24,"value":730},{"type":18,"tag":633,"props":2292,"children":2293},{"class":646},[2294],{"type":24,"value":649},{"type":18,"tag":633,"props":2296,"children":2297},{"class":690},[2298],{"type":24,"value":2299},"0.1\n",{"type":18,"tag":633,"props":2301,"children":2302},{"class":635,"line":1229},[2303],{"type":18,"tag":633,"props":2304,"children":2305},{},[2306],{"type":24,"value":669},{"type":18,"tag":633,"props":2308,"children":2309},{"class":635,"line":1247},[2310,2314],{"type":18,"tag":633,"props":2311,"children":2312},{"class":646},[2313],{"type":24,"value":715},{"type":18,"tag":633,"props":2315,"children":2316},{"class":1870},[2317],{"type":24,"value":2318},"### Constraint\n",{"type":18,"tag":633,"props":2320,"children":2321},{"class":635,"line":1255},[2322,2326,2330,2335,2339,2344,2348,2353,2357],{"type":18,"tag":633,"props":2323,"children":2324},{"class":646},[2325],{"type":24,"value":715},{"type":18,"tag":633,"props":2327,"children":2328},{"class":690},[2329],{"type":24,"value":720},{"type":18,"tag":633,"props":2331,"children":2332},{"class":646},[2333],{"type":24,"value":2334},".u_min ",{"type":18,"tag":633,"props":2336,"children":2337},{"class":640},[2338],{"type":24,"value":730},{"type":18,"tag":633,"props":2340,"children":2341},{"class":646},[2342],{"type":24,"value":2343}," [ ",{"type":18,"tag":633,"props":2345,"children":2346},{"class":690},[2347],{"type":24,"value":886},{"type":18,"tag":633,"props":2349,"children":2350},{"class":646},[2351],{"type":24,"value":2352},",  ",{"type":18,"tag":633,"props":2354,"children":2355},{"class":690},[2356],{"type":24,"value":886},{"type":18,"tag":633,"props":2358,"children":2359},{"class":646},[2360],{"type":24,"value":891},{"type":18,"tag":633,"props":2362,"children":2363},{"class":635,"line":1281},[2364,2368,2372,2377,2381,2385,2389,2393,2398],{"type":18,"tag":633,"props":2365,"children":2366},{"class":646},[2367],{"type":24,"value":715},{"type":18,"tag":633,"props":2369,"children":2370},{"class":690},[2371],{"type":24,"value":720},{"type":18,"tag":633,"props":2373,"children":2374},{"class":646},[2375],{"type":24,"value":2376},".u_max ",{"type":18,"tag":633,"props":2378,"children":2379},{"class":640},[2380],{"type":24,"value":730},{"type":18,"tag":633,"props":2382,"children":2383},{"class":646},[2384],{"type":24,"value":2343},{"type":18,"tag":633,"props":2386,"children":2387},{"class":690},[2388],{"type":24,"value":1372},{"type":18,"tag":633,"props":2390,"children":2391},{"class":646},[2392],{"type":24,"value":2352},{"type":18,"tag":633,"props":2394,"children":2395},{"class":690},[2396],{"type":24,"value":2397},"1.57",{"type":18,"tag":633,"props":2399,"children":2400},{"class":646},[2401],{"type":24,"value":891},{"type":18,"tag":633,"props":2403,"children":2404},{"class":635,"line":1289},[2405,2409,2413,2418,2422,2427,2432,2437,2441],{"type":18,"tag":633,"props":2406,"children":2407},{"class":646},[2408],{"type":24,"value":715},{"type":18,"tag":633,"props":2410,"children":2411},{"class":690},[2412],{"type":24,"value":720},{"type":18,"tag":633,"props":2414,"children":2415},{"class":646},[2416],{"type":24,"value":2417},".u_dummy ",{"type":18,"tag":633,"props":2419,"children":2420},{"class":640},[2421],{"type":24,"value":730},{"type":18,"tag":633,"props":2423,"children":2424},{"class":646},[2425],{"type":24,"value":2426}," [",{"type":18,"tag":633,"props":2428,"children":2429},{"class":690},[2430],{"type":24,"value":2431},"0.01",{"type":18,"tag":633,"props":2433,"children":2434},{"class":646},[2435],{"type":24,"value":2436},", ",{"type":18,"tag":633,"props":2438,"children":2439},{"class":690},[2440],{"type":24,"value":2431},{"type":18,"tag":633,"props":2442,"children":2443},{"class":646},[2444],{"type":24,"value":891},{"type":18,"tag":633,"props":2446,"children":2447},{"class":635,"line":1445},[2448],{"type":18,"tag":633,"props":2449,"children":2450},{},[2451],{"type":24,"value":669},{"type":18,"tag":633,"props":2453,"children":2454},{"class":635,"line":1565},[2455,2459],{"type":18,"tag":633,"props":2456,"children":2457},{"class":646},[2458],{"type":24,"value":715},{"type":18,"tag":633,"props":2460,"children":2461},{"class":1870},[2462],{"type":24,"value":2463},"### Initialize matrix solution\n",{"type":18,"tag":633,"props":2465,"children":2466},{"class":635,"line":1573},[2467,2471,2475,2480,2484,2489,2493,2498,2502],{"type":18,"tag":633,"props":2468,"children":2469},{"class":646},[2470],{"type":24,"value":715},{"type":18,"tag":633,"props":2472,"children":2473},{"class":690},[2474],{"type":24,"value":720},{"type":18,"tag":633,"props":2476,"children":2477},{"class":646},[2478],{"type":24,"value":2479},".dU ",{"type":18,"tag":633,"props":2481,"children":2482},{"class":640},[2483],{"type":24,"value":730},{"type":18,"tag":633,"props":2485,"children":2486},{"class":646},[2487],{"type":24,"value":2488}," np.zeros((",{"type":18,"tag":633,"props":2490,"children":2491},{"class":690},[2492],{"type":24,"value":720},{"type":18,"tag":633,"props":2494,"children":2495},{"class":646},[2496],{"type":24,"value":2497},".u_dim, ",{"type":18,"tag":633,"props":2499,"children":2500},{"class":690},[2501],{"type":24,"value":720},{"type":18,"tag":633,"props":2503,"children":2504},{"class":646},[2505],{"type":24,"value":2506},".pred_horizons))\n",{"type":18,"tag":633,"props":2508,"children":2509},{"class":635,"line":1590},[2510],{"type":18,"tag":633,"props":2511,"children":2512},{},[2513],{"type":24,"value":669},{"type":18,"tag":633,"props":2515,"children":2516},{"class":635,"line":1598},[2517,2521],{"type":18,"tag":633,"props":2518,"children":2519},{"class":646},[2520],{"type":24,"value":715},{"type":18,"tag":633,"props":2522,"children":2523},{"class":1870},[2524],{"type":24,"value":2525},"### Reference point\n",{"type":18,"tag":633,"props":2527,"children":2528},{"class":635,"line":1624},[2529,2533,2537,2542,2546,2550,2555,2559,2563,2567,2572],{"type":18,"tag":633,"props":2530,"children":2531},{"class":646},[2532],{"type":24,"value":715},{"type":18,"tag":633,"props":2534,"children":2535},{"class":690},[2536],{"type":24,"value":720},{"type":18,"tag":633,"props":2538,"children":2539},{"class":646},[2540],{"type":24,"value":2541},".X_r ",{"type":18,"tag":633,"props":2543,"children":2544},{"class":640},[2545],{"type":24,"value":730},{"type":18,"tag":633,"props":2547,"children":2548},{"class":646},[2549],{"type":24,"value":2426},{"type":18,"tag":633,"props":2551,"children":2552},{"class":690},[2553],{"type":24,"value":2554},"3",{"type":18,"tag":633,"props":2556,"children":2557},{"class":646},[2558],{"type":24,"value":2436},{"type":18,"tag":633,"props":2560,"children":2561},{"class":690},[2562],{"type":24,"value":1372},{"type":18,"tag":633,"props":2564,"children":2565},{"class":646},[2566],{"type":24,"value":2436},{"type":18,"tag":633,"props":2568,"children":2569},{"class":690},[2570],{"type":24,"value":2571},"0.0",{"type":18,"tag":633,"props":2573,"children":2574},{"class":646},[2575],{"type":24,"value":891},{"type":18,"tag":633,"props":2577,"children":2578},{"class":635,"line":1668},[2579,2583,2587,2592,2596,2600,2604,2608,2612],{"type":18,"tag":633,"props":2580,"children":2581},{"class":646},[2582],{"type":24,"value":715},{"type":18,"tag":633,"props":2584,"children":2585},{"class":690},[2586],{"type":24,"value":720},{"type":18,"tag":633,"props":2588,"children":2589},{"class":646},[2590],{"type":24,"value":2591},".U_r ",{"type":18,"tag":633,"props":2593,"children":2594},{"class":640},[2595],{"type":24,"value":730},{"type":18,"tag":633,"props":2597,"children":2598},{"class":646},[2599],{"type":24,"value":2426},{"type":18,"tag":633,"props":2601,"children":2602},{"class":690},[2603],{"type":24,"value":886},{"type":18,"tag":633,"props":2605,"children":2606},{"class":646},[2607],{"type":24,"value":2436},{"type":18,"tag":633,"props":2609,"children":2610},{"class":690},[2611],{"type":24,"value":886},{"type":18,"tag":633,"props":2613,"children":2614},{"class":646},[2615],{"type":24,"value":2616},"]",{"type":18,"tag":27,"props":2618,"children":2619},{},[2620],{"type":24,"value":2621},"These are just for tuning parameters and initialize parameters, let's focus on CGMRES method. As the expression above at equation (1).\nLet's denote that",{"type":18,"tag":618,"props":2623,"children":2626},{"className":2624,"code":2625,"language":623,"meta":8},[621],"X = np.zeros((x_dim, pred_horizons+1))      ## State for N-prediction+1\nU = np.zeros((u_dim, pred_horizons))        ## Input Control for N-prediction\nLambda = np.zeros((x_dim, pred_horizons+1)) ## Costate vector for N-prediction+1\ndt = 0.01                                   ## Sampling Time\n",[2627],{"type":18,"tag":626,"props":2628,"children":2629},{},[2630],{"type":18,"tag":618,"props":2631,"children":2632},{"__ignoreMap":8},[2633,2668,2690,2724],{"type":18,"tag":633,"props":2634,"children":2635},{"class":635,"line":636},[2636,2641,2645,2650,2654,2658,2663],{"type":18,"tag":633,"props":2637,"children":2638},{"class":646},[2639],{"type":24,"value":2640},"X ",{"type":18,"tag":633,"props":2642,"children":2643},{"class":640},[2644],{"type":24,"value":730},{"type":18,"tag":633,"props":2646,"children":2647},{"class":646},[2648],{"type":24,"value":2649}," np.zeros((x_dim, pred_horizons",{"type":18,"tag":633,"props":2651,"children":2652},{"class":640},[2653],{"type":24,"value":1196},{"type":18,"tag":633,"props":2655,"children":2656},{"class":690},[2657],{"type":24,"value":996},{"type":18,"tag":633,"props":2659,"children":2660},{"class":646},[2661],{"type":24,"value":2662},"))      ",{"type":18,"tag":633,"props":2664,"children":2665},{"class":1870},[2666],{"type":24,"value":2667},"## State for N-prediction+1\n",{"type":18,"tag":633,"props":2669,"children":2670},{"class":635,"line":663},[2671,2676,2680,2685],{"type":18,"tag":633,"props":2672,"children":2673},{"class":646},[2674],{"type":24,"value":2675},"U ",{"type":18,"tag":633,"props":2677,"children":2678},{"class":640},[2679],{"type":24,"value":730},{"type":18,"tag":633,"props":2681,"children":2682},{"class":646},[2683],{"type":24,"value":2684}," np.zeros((u_dim, pred_horizons))        ",{"type":18,"tag":633,"props":2686,"children":2687},{"class":1870},[2688],{"type":24,"value":2689},"## Input Control for N-prediction\n",{"type":18,"tag":633,"props":2691,"children":2692},{"class":635,"line":672},[2693,2698,2702,2706,2710,2714,2719],{"type":18,"tag":633,"props":2694,"children":2695},{"class":646},[2696],{"type":24,"value":2697},"Lambda ",{"type":18,"tag":633,"props":2699,"children":2700},{"class":640},[2701],{"type":24,"value":730},{"type":18,"tag":633,"props":2703,"children":2704},{"class":646},[2705],{"type":24,"value":2649},{"type":18,"tag":633,"props":2707,"children":2708},{"class":640},[2709],{"type":24,"value":1196},{"type":18,"tag":633,"props":2711,"children":2712},{"class":690},[2713],{"type":24,"value":996},{"type":18,"tag":633,"props":2715,"children":2716},{"class":646},[2717],{"type":24,"value":2718},")) ",{"type":18,"tag":633,"props":2720,"children":2721},{"class":1870},[2722],{"type":24,"value":2723},"## Costate vector for N-prediction+1\n",{"type":18,"tag":633,"props":2725,"children":2726},{"class":635,"line":701},[2727,2732,2736,2740,2744,2749],{"type":18,"tag":633,"props":2728,"children":2729},{"class":646},[2730],{"type":24,"value":2731},"dt ",{"type":18,"tag":633,"props":2733,"children":2734},{"class":640},[2735],{"type":24,"value":730},{"type":18,"tag":633,"props":2737,"children":2738},{"class":646},[2739],{"type":24,"value":649},{"type":18,"tag":633,"props":2741,"children":2742},{"class":690},[2743],{"type":24,"value":2431},{"type":18,"tag":633,"props":2745,"children":2746},{"class":646},[2747],{"type":24,"value":2748},"                                   ",{"type":18,"tag":633,"props":2750,"children":2751},{"class":1870},[2752],{"type":24,"value":2753},"## Sampling Time",{"type":18,"tag":27,"props":2755,"children":2756},{},[2757],{"type":24,"value":2758},"Then, we can perform equation (1) as",{"type":18,"tag":618,"props":2760,"children":2763},{"className":2761,"code":2762,"language":623,"meta":8},[621],"def calc_state(self, X, U, dt):\n\n        for i in range(self.pred_horizons):\n            x_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, i], U[0, i], U[1, i])\n            \n            X[0, i+1] = X[0, i] + x_dot * dt\n            X[1, i+1] = X[1, i] + y_dot * dt\n            X[2, i+1] = X[2, i] + yaw_dot * dt\n\n        return X\n",[2764],{"type":18,"tag":626,"props":2765,"children":2766},{},[2767],{"type":18,"tag":618,"props":2768,"children":2769},{"__ignoreMap":8},[2770,2791,2798,2842,2893,2901,2967,3027,3087,3094],{"type":18,"tag":633,"props":2771,"children":2772},{"class":635,"line":636},[2773,2777,2781,2786],{"type":18,"tag":633,"props":2774,"children":2775},{"class":640},[2776],{"type":24,"value":683},{"type":18,"tag":633,"props":2778,"children":2779},{"class":646},[2780],{"type":24,"value":649},{"type":18,"tag":633,"props":2782,"children":2783},{"class":652},[2784],{"type":24,"value":2785},"calc_state",{"type":18,"tag":633,"props":2787,"children":2788},{"class":646},[2789],{"type":24,"value":2790},"(self, X, U, dt):\n",{"type":18,"tag":633,"props":2792,"children":2793},{"class":635,"line":663},[2794],{"type":18,"tag":633,"props":2795,"children":2796},{},[2797],{"type":24,"value":669},{"type":18,"tag":633,"props":2799,"children":2800},{"class":635,"line":672},[2801,2805,2810,2815,2820,2824,2829,2833,2837],{"type":18,"tag":633,"props":2802,"children":2803},{"class":646},[2804],{"type":24,"value":715},{"type":18,"tag":633,"props":2806,"children":2807},{"class":640},[2808],{"type":24,"value":2809},"for",{"type":18,"tag":633,"props":2811,"children":2812},{"class":646},[2813],{"type":24,"value":2814}," i ",{"type":18,"tag":633,"props":2816,"children":2817},{"class":640},[2818],{"type":24,"value":2819},"in",{"type":18,"tag":633,"props":2821,"children":2822},{"class":646},[2823],{"type":24,"value":649},{"type":18,"tag":633,"props":2825,"children":2826},{"class":690},[2827],{"type":24,"value":2828},"range",{"type":18,"tag":633,"props":2830,"children":2831},{"class":646},[2832],{"type":24,"value":1406},{"type":18,"tag":633,"props":2834,"children":2835},{"class":690},[2836],{"type":24,"value":720},{"type":18,"tag":633,"props":2838,"children":2839},{"class":646},[2840],{"type":24,"value":2841},".pred_horizons):\n",{"type":18,"tag":633,"props":2843,"children":2844},{"class":635,"line":701},[2845,2850,2854,2858,2862,2867,2871,2876,2880,2884,2888],{"type":18,"tag":633,"props":2846,"children":2847},{"class":646},[2848],{"type":24,"value":2849},"            x_dot, y_dot, yaw_dot ",{"type":18,"tag":633,"props":2851,"children":2852},{"class":640},[2853],{"type":24,"value":730},{"type":18,"tag":633,"props":2855,"children":2856},{"class":646},[2857],{"type":24,"value":649},{"type":18,"tag":633,"props":2859,"children":2860},{"class":690},[2861],{"type":24,"value":720},{"type":18,"tag":633,"props":2863,"children":2864},{"class":646},[2865],{"type":24,"value":2866},".robot_model.forward_kinematic(X[",{"type":18,"tag":633,"props":2868,"children":2869},{"class":690},[2870],{"type":24,"value":1372},{"type":18,"tag":633,"props":2872,"children":2873},{"class":646},[2874],{"type":24,"value":2875},", i], U[",{"type":18,"tag":633,"props":2877,"children":2878},{"class":690},[2879],{"type":24,"value":886},{"type":18,"tag":633,"props":2881,"children":2882},{"class":646},[2883],{"type":24,"value":2875},{"type":18,"tag":633,"props":2885,"children":2886},{"class":690},[2887],{"type":24,"value":996},{"type":18,"tag":633,"props":2889,"children":2890},{"class":646},[2891],{"type":24,"value":2892},", i])\n",{"type":18,"tag":633,"props":2894,"children":2895},{"class":635,"line":709},[2896],{"type":18,"tag":633,"props":2897,"children":2898},{"class":646},[2899],{"type":24,"value":2900},"            \n",{"type":18,"tag":633,"props":2902,"children":2903},{"class":635,"line":738},[2904,2909,2913,2918,2922,2926,2931,2935,2940,2944,2949,2953,2958,2962],{"type":18,"tag":633,"props":2905,"children":2906},{"class":646},[2907],{"type":24,"value":2908},"            X[",{"type":18,"tag":633,"props":2910,"children":2911},{"class":690},[2912],{"type":24,"value":886},{"type":18,"tag":633,"props":2914,"children":2915},{"class":646},[2916],{"type":24,"value":2917},", i",{"type":18,"tag":633,"props":2919,"children":2920},{"class":640},[2921],{"type":24,"value":1196},{"type":18,"tag":633,"props":2923,"children":2924},{"class":690},[2925],{"type":24,"value":996},{"type":18,"tag":633,"props":2927,"children":2928},{"class":646},[2929],{"type":24,"value":2930},"] ",{"type":18,"tag":633,"props":2932,"children":2933},{"class":640},[2934],{"type":24,"value":730},{"type":18,"tag":633,"props":2936,"children":2937},{"class":646},[2938],{"type":24,"value":2939}," X[",{"type":18,"tag":633,"props":2941,"children":2942},{"class":690},[2943],{"type":24,"value":886},{"type":18,"tag":633,"props":2945,"children":2946},{"class":646},[2947],{"type":24,"value":2948},", i] ",{"type":18,"tag":633,"props":2950,"children":2951},{"class":640},[2952],{"type":24,"value":1196},{"type":18,"tag":633,"props":2954,"children":2955},{"class":646},[2956],{"type":24,"value":2957}," x_dot ",{"type":18,"tag":633,"props":2959,"children":2960},{"class":640},[2961],{"type":24,"value":1075},{"type":18,"tag":633,"props":2963,"children":2964},{"class":646},[2965],{"type":24,"value":2966}," dt\n",{"type":18,"tag":633,"props":2968,"children":2969},{"class":635,"line":764},[2970,2974,2978,2982,2986,2990,2994,2998,3002,3006,3010,3014,3019,3023],{"type":18,"tag":633,"props":2971,"children":2972},{"class":646},[2973],{"type":24,"value":2908},{"type":18,"tag":633,"props":2975,"children":2976},{"class":690},[2977],{"type":24,"value":996},{"type":18,"tag":633,"props":2979,"children":2980},{"class":646},[2981],{"type":24,"value":2917},{"type":18,"tag":633,"props":2983,"children":2984},{"class":640},[2985],{"type":24,"value":1196},{"type":18,"tag":633,"props":2987,"children":2988},{"class":690},[2989],{"type":24,"value":996},{"type":18,"tag":633,"props":2991,"children":2992},{"class":646},[2993],{"type":24,"value":2930},{"type":18,"tag":633,"props":2995,"children":2996},{"class":640},[2997],{"type":24,"value":730},{"type":18,"tag":633,"props":2999,"children":3000},{"class":646},[3001],{"type":24,"value":2939},{"type":18,"tag":633,"props":3003,"children":3004},{"class":690},[3005],{"type":24,"value":996},{"type":18,"tag":633,"props":3007,"children":3008},{"class":646},[3009],{"type":24,"value":2948},{"type":18,"tag":633,"props":3011,"children":3012},{"class":640},[3013],{"type":24,"value":1196},{"type":18,"tag":633,"props":3015,"children":3016},{"class":646},[3017],{"type":24,"value":3018}," y_dot ",{"type":18,"tag":633,"props":3020,"children":3021},{"class":640},[3022],{"type":24,"value":1075},{"type":18,"tag":633,"props":3024,"children":3025},{"class":646},[3026],{"type":24,"value":2966},{"type":18,"tag":633,"props":3028,"children":3029},{"class":635,"line":790},[3030,3034,3038,3042,3046,3050,3054,3058,3062,3066,3070,3074,3079,3083],{"type":18,"tag":633,"props":3031,"children":3032},{"class":646},[3033],{"type":24,"value":2908},{"type":18,"tag":633,"props":3035,"children":3036},{"class":690},[3037],{"type":24,"value":1372},{"type":18,"tag":633,"props":3039,"children":3040},{"class":646},[3041],{"type":24,"value":2917},{"type":18,"tag":633,"props":3043,"children":3044},{"class":640},[3045],{"type":24,"value":1196},{"type":18,"tag":633,"props":3047,"children":3048},{"class":690},[3049],{"type":24,"value":996},{"type":18,"tag":633,"props":3051,"children":3052},{"class":646},[3053],{"type":24,"value":2930},{"type":18,"tag":633,"props":3055,"children":3056},{"class":640},[3057],{"type":24,"value":730},{"type":18,"tag":633,"props":3059,"children":3060},{"class":646},[3061],{"type":24,"value":2939},{"type":18,"tag":633,"props":3063,"children":3064},{"class":690},[3065],{"type":24,"value":1372},{"type":18,"tag":633,"props":3067,"children":3068},{"class":646},[3069],{"type":24,"value":2948},{"type":18,"tag":633,"props":3071,"children":3072},{"class":640},[3073],{"type":24,"value":1196},{"type":18,"tag":633,"props":3075,"children":3076},{"class":646},[3077],{"type":24,"value":3078}," yaw_dot ",{"type":18,"tag":633,"props":3080,"children":3081},{"class":640},[3082],{"type":24,"value":1075},{"type":18,"tag":633,"props":3084,"children":3085},{"class":646},[3086],{"type":24,"value":2966},{"type":18,"tag":633,"props":3088,"children":3089},{"class":635,"line":798},[3090],{"type":18,"tag":633,"props":3091,"children":3092},{},[3093],{"type":24,"value":669},{"type":18,"tag":633,"props":3095,"children":3096},{"class":635,"line":824},[3097,3101,3105],{"type":18,"tag":633,"props":3098,"children":3099},{"class":646},[3100],{"type":24,"value":715},{"type":18,"tag":633,"props":3102,"children":3103},{"class":640},[3104],{"type":24,"value":1239},{"type":18,"tag":633,"props":3106,"children":3107},{"class":646},[3108],{"type":24,"value":3109}," X",{"type":18,"tag":27,"props":3111,"children":3112},{},[3113],{"type":24,"value":3114},"Next we calculating costate, we are going in backward direction",{"type":18,"tag":618,"props":3116,"children":3119},{"className":3117,"code":3118,"language":623,"meta":8},[621],"def calc_costate(self, X, U, Lambda, dt):\n\n        x_N, y_N, yaw_N = self.hjb_equation.dphidx(X[0, -1], X[1, -1], X[2, -1],\n                                                   self.X_r[0], self.X_r[1], self.X_r[2])\n        Lambda[0, -1] = x_N\n        Lambda[1, -1] = y_N\n        Lambda[2, -1] = yaw_N\n\n\n        for i in reversed(range(1, self.pred_horizons)):\n\n            dhdx1, dhdx2, dhdx3 = self.hjb_equation.dhdx(\n                X[0, i], X[1, i], X[2, i],\n                self.X_r[0], self.X_r[1], self.X_r[2],\n                U[0, i], Lambda[0, i+1], Lambda[1, i+1]\n            )\n\n            Lambda[0, i] = Lambda[0, i+1] + dhdx1 * dt\n            Lambda[1, i] = Lambda[1, i+1] + dhdx2 * dt\n            Lambda[2, i] = Lambda[2, i+1] + dhdx3 * dt\n    \n\n        return Lambda\n",[3120],{"type":18,"tag":626,"props":3121,"children":3122},{},[3123],{"type":18,"tag":618,"props":3124,"children":3125},{"__ignoreMap":8},[3126,3147,3154,3241,3300,3337,3373,3409,3416,3423,3480,3487,3512,3546,3602,3660,3668,3675,3737,3797,3857,3865,3872],{"type":18,"tag":633,"props":3127,"children":3128},{"class":635,"line":636},[3129,3133,3137,3142],{"type":18,"tag":633,"props":3130,"children":3131},{"class":640},[3132],{"type":24,"value":683},{"type":18,"tag":633,"props":3134,"children":3135},{"class":646},[3136],{"type":24,"value":649},{"type":18,"tag":633,"props":3138,"children":3139},{"class":652},[3140],{"type":24,"value":3141},"calc_costate",{"type":18,"tag":633,"props":3143,"children":3144},{"class":646},[3145],{"type":24,"value":3146},"(self, X, U, Lambda, dt):\n",{"type":18,"tag":633,"props":3148,"children":3149},{"class":635,"line":663},[3150],{"type":18,"tag":633,"props":3151,"children":3152},{},[3153],{"type":24,"value":669},{"type":18,"tag":633,"props":3155,"children":3156},{"class":635,"line":672},[3157,3162,3166,3170,3174,3179,3183,3187,3191,3195,3200,3204,3208,3212,3216,3220,3224,3228,3232,3236],{"type":18,"tag":633,"props":3158,"children":3159},{"class":646},[3160],{"type":24,"value":3161},"        x_N, y_N, yaw_N ",{"type":18,"tag":633,"props":3163,"children":3164},{"class":640},[3165],{"type":24,"value":730},{"type":18,"tag":633,"props":3167,"children":3168},{"class":646},[3169],{"type":24,"value":649},{"type":18,"tag":633,"props":3171,"children":3172},{"class":690},[3173],{"type":24,"value":720},{"type":18,"tag":633,"props":3175,"children":3176},{"class":646},[3177],{"type":24,"value":3178},".hjb_equation.dphidx(X[",{"type":18,"tag":633,"props":3180,"children":3181},{"class":690},[3182],{"type":24,"value":886},{"type":18,"tag":633,"props":3184,"children":3185},{"class":646},[3186],{"type":24,"value":2436},{"type":18,"tag":633,"props":3188,"children":3189},{"class":640},[3190],{"type":24,"value":1065},{"type":18,"tag":633,"props":3192,"children":3193},{"class":690},[3194],{"type":24,"value":996},{"type":18,"tag":633,"props":3196,"children":3197},{"class":646},[3198],{"type":24,"value":3199},"], X[",{"type":18,"tag":633,"props":3201,"children":3202},{"class":690},[3203],{"type":24,"value":996},{"type":18,"tag":633,"props":3205,"children":3206},{"class":646},[3207],{"type":24,"value":2436},{"type":18,"tag":633,"props":3209,"children":3210},{"class":640},[3211],{"type":24,"value":1065},{"type":18,"tag":633,"props":3213,"children":3214},{"class":690},[3215],{"type":24,"value":996},{"type":18,"tag":633,"props":3217,"children":3218},{"class":646},[3219],{"type":24,"value":3199},{"type":18,"tag":633,"props":3221,"children":3222},{"class":690},[3223],{"type":24,"value":1372},{"type":18,"tag":633,"props":3225,"children":3226},{"class":646},[3227],{"type":24,"value":2436},{"type":18,"tag":633,"props":3229,"children":3230},{"class":640},[3231],{"type":24,"value":1065},{"type":18,"tag":633,"props":3233,"children":3234},{"class":690},[3235],{"type":24,"value":996},{"type":18,"tag":633,"props":3237,"children":3238},{"class":646},[3239],{"type":24,"value":3240},"],\n",{"type":18,"tag":633,"props":3242,"children":3243},{"class":635,"line":701},[3244,3249,3253,3258,3262,3267,3271,3275,3279,3283,3287,3291,3295],{"type":18,"tag":633,"props":3245,"children":3246},{"class":646},[3247],{"type":24,"value":3248},"                                                   ",{"type":18,"tag":633,"props":3250,"children":3251},{"class":690},[3252],{"type":24,"value":720},{"type":18,"tag":633,"props":3254,"children":3255},{"class":646},[3256],{"type":24,"value":3257},".X_r[",{"type":18,"tag":633,"props":3259,"children":3260},{"class":690},[3261],{"type":24,"value":886},{"type":18,"tag":633,"props":3263,"children":3264},{"class":646},[3265],{"type":24,"value":3266},"], ",{"type":18,"tag":633,"props":3268,"children":3269},{"class":690},[3270],{"type":24,"value":720},{"type":18,"tag":633,"props":3272,"children":3273},{"class":646},[3274],{"type":24,"value":3257},{"type":18,"tag":633,"props":3276,"children":3277},{"class":690},[3278],{"type":24,"value":996},{"type":18,"tag":633,"props":3280,"children":3281},{"class":646},[3282],{"type":24,"value":3266},{"type":18,"tag":633,"props":3284,"children":3285},{"class":690},[3286],{"type":24,"value":720},{"type":18,"tag":633,"props":3288,"children":3289},{"class":646},[3290],{"type":24,"value":3257},{"type":18,"tag":633,"props":3292,"children":3293},{"class":690},[3294],{"type":24,"value":1372},{"type":18,"tag":633,"props":3296,"children":3297},{"class":646},[3298],{"type":24,"value":3299},"])\n",{"type":18,"tag":633,"props":3301,"children":3302},{"class":635,"line":709},[3303,3308,3312,3316,3320,3324,3328,3332],{"type":18,"tag":633,"props":3304,"children":3305},{"class":646},[3306],{"type":24,"value":3307},"        Lambda[",{"type":18,"tag":633,"props":3309,"children":3310},{"class":690},[3311],{"type":24,"value":886},{"type":18,"tag":633,"props":3313,"children":3314},{"class":646},[3315],{"type":24,"value":2436},{"type":18,"tag":633,"props":3317,"children":3318},{"class":640},[3319],{"type":24,"value":1065},{"type":18,"tag":633,"props":3321,"children":3322},{"class":690},[3323],{"type":24,"value":996},{"type":18,"tag":633,"props":3325,"children":3326},{"class":646},[3327],{"type":24,"value":2930},{"type":18,"tag":633,"props":3329,"children":3330},{"class":640},[3331],{"type":24,"value":730},{"type":18,"tag":633,"props":3333,"children":3334},{"class":646},[3335],{"type":24,"value":3336}," x_N\n",{"type":18,"tag":633,"props":3338,"children":3339},{"class":635,"line":738},[3340,3344,3348,3352,3356,3360,3364,3368],{"type":18,"tag":633,"props":3341,"children":3342},{"class":646},[3343],{"type":24,"value":3307},{"type":18,"tag":633,"props":3345,"children":3346},{"class":690},[3347],{"type":24,"value":996},{"type":18,"tag":633,"props":3349,"children":3350},{"class":646},[3351],{"type":24,"value":2436},{"type":18,"tag":633,"props":3353,"children":3354},{"class":640},[3355],{"type":24,"value":1065},{"type":18,"tag":633,"props":3357,"children":3358},{"class":690},[3359],{"type":24,"value":996},{"type":18,"tag":633,"props":3361,"children":3362},{"class":646},[3363],{"type":24,"value":2930},{"type":18,"tag":633,"props":3365,"children":3366},{"class":640},[3367],{"type":24,"value":730},{"type":18,"tag":633,"props":3369,"children":3370},{"class":646},[3371],{"type":24,"value":3372}," y_N\n",{"type":18,"tag":633,"props":3374,"children":3375},{"class":635,"line":764},[3376,3380,3384,3388,3392,3396,3400,3404],{"type":18,"tag":633,"props":3377,"children":3378},{"class":646},[3379],{"type":24,"value":3307},{"type":18,"tag":633,"props":3381,"children":3382},{"class":690},[3383],{"type":24,"value":1372},{"type":18,"tag":633,"props":3385,"children":3386},{"class":646},[3387],{"type":24,"value":2436},{"type":18,"tag":633,"props":3389,"children":3390},{"class":640},[3391],{"type":24,"value":1065},{"type":18,"tag":633,"props":3393,"children":3394},{"class":690},[3395],{"type":24,"value":996},{"type":18,"tag":633,"props":3397,"children":3398},{"class":646},[3399],{"type":24,"value":2930},{"type":18,"tag":633,"props":3401,"children":3402},{"class":640},[3403],{"type":24,"value":730},{"type":18,"tag":633,"props":3405,"children":3406},{"class":646},[3407],{"type":24,"value":3408}," yaw_N\n",{"type":18,"tag":633,"props":3410,"children":3411},{"class":635,"line":790},[3412],{"type":18,"tag":633,"props":3413,"children":3414},{},[3415],{"type":24,"value":669},{"type":18,"tag":633,"props":3417,"children":3418},{"class":635,"line":798},[3419],{"type":18,"tag":633,"props":3420,"children":3421},{},[3422],{"type":24,"value":669},{"type":18,"tag":633,"props":3424,"children":3425},{"class":635,"line":824},[3426,3430,3434,3438,3442,3446,3451,3455,3459,3463,3467,3471,3475],{"type":18,"tag":633,"props":3427,"children":3428},{"class":646},[3429],{"type":24,"value":715},{"type":18,"tag":633,"props":3431,"children":3432},{"class":640},[3433],{"type":24,"value":2809},{"type":18,"tag":633,"props":3435,"children":3436},{"class":646},[3437],{"type":24,"value":2814},{"type":18,"tag":633,"props":3439,"children":3440},{"class":640},[3441],{"type":24,"value":2819},{"type":18,"tag":633,"props":3443,"children":3444},{"class":646},[3445],{"type":24,"value":649},{"type":18,"tag":633,"props":3447,"children":3448},{"class":690},[3449],{"type":24,"value":3450},"reversed",{"type":18,"tag":633,"props":3452,"children":3453},{"class":646},[3454],{"type":24,"value":1406},{"type":18,"tag":633,"props":3456,"children":3457},{"class":690},[3458],{"type":24,"value":2828},{"type":18,"tag":633,"props":3460,"children":3461},{"class":646},[3462],{"type":24,"value":1406},{"type":18,"tag":633,"props":3464,"children":3465},{"class":690},[3466],{"type":24,"value":996},{"type":18,"tag":633,"props":3468,"children":3469},{"class":646},[3470],{"type":24,"value":2436},{"type":18,"tag":633,"props":3472,"children":3473},{"class":690},[3474],{"type":24,"value":720},{"type":18,"tag":633,"props":3476,"children":3477},{"class":646},[3478],{"type":24,"value":3479},".pred_horizons)):\n",{"type":18,"tag":633,"props":3481,"children":3482},{"class":635,"line":850},[3483],{"type":18,"tag":633,"props":3484,"children":3485},{},[3486],{"type":24,"value":669},{"type":18,"tag":633,"props":3488,"children":3489},{"class":635,"line":858},[3490,3495,3499,3503,3507],{"type":18,"tag":633,"props":3491,"children":3492},{"class":646},[3493],{"type":24,"value":3494},"            dhdx1, dhdx2, dhdx3 ",{"type":18,"tag":633,"props":3496,"children":3497},{"class":640},[3498],{"type":24,"value":730},{"type":18,"tag":633,"props":3500,"children":3501},{"class":646},[3502],{"type":24,"value":649},{"type":18,"tag":633,"props":3504,"children":3505},{"class":690},[3506],{"type":24,"value":720},{"type":18,"tag":633,"props":3508,"children":3509},{"class":646},[3510],{"type":24,"value":3511},".hjb_equation.dhdx(\n",{"type":18,"tag":633,"props":3513,"children":3514},{"class":635,"line":894},[3515,3520,3524,3529,3533,3537,3541],{"type":18,"tag":633,"props":3516,"children":3517},{"class":646},[3518],{"type":24,"value":3519},"                X[",{"type":18,"tag":633,"props":3521,"children":3522},{"class":690},[3523],{"type":24,"value":886},{"type":18,"tag":633,"props":3525,"children":3526},{"class":646},[3527],{"type":24,"value":3528},", i], X[",{"type":18,"tag":633,"props":3530,"children":3531},{"class":690},[3532],{"type":24,"value":996},{"type":18,"tag":633,"props":3534,"children":3535},{"class":646},[3536],{"type":24,"value":3528},{"type":18,"tag":633,"props":3538,"children":3539},{"class":690},[3540],{"type":24,"value":1372},{"type":18,"tag":633,"props":3542,"children":3543},{"class":646},[3544],{"type":24,"value":3545},", i],\n",{"type":18,"tag":633,"props":3547,"children":3548},{"class":635,"line":927},[3549,3554,3558,3562,3566,3570,3574,3578,3582,3586,3590,3594,3598],{"type":18,"tag":633,"props":3550,"children":3551},{"class":646},[3552],{"type":24,"value":3553},"                ",{"type":18,"tag":633,"props":3555,"children":3556},{"class":690},[3557],{"type":24,"value":720},{"type":18,"tag":633,"props":3559,"children":3560},{"class":646},[3561],{"type":24,"value":3257},{"type":18,"tag":633,"props":3563,"children":3564},{"class":690},[3565],{"type":24,"value":886},{"type":18,"tag":633,"props":3567,"children":3568},{"class":646},[3569],{"type":24,"value":3266},{"type":18,"tag":633,"props":3571,"children":3572},{"class":690},[3573],{"type":24,"value":720},{"type":18,"tag":633,"props":3575,"children":3576},{"class":646},[3577],{"type":24,"value":3257},{"type":18,"tag":633,"props":3579,"children":3580},{"class":690},[3581],{"type":24,"value":996},{"type":18,"tag":633,"props":3583,"children":3584},{"class":646},[3585],{"type":24,"value":3266},{"type":18,"tag":633,"props":3587,"children":3588},{"class":690},[3589],{"type":24,"value":720},{"type":18,"tag":633,"props":3591,"children":3592},{"class":646},[3593],{"type":24,"value":3257},{"type":18,"tag":633,"props":3595,"children":3596},{"class":690},[3597],{"type":24,"value":1372},{"type":18,"tag":633,"props":3599,"children":3600},{"class":646},[3601],{"type":24,"value":3240},{"type":18,"tag":633,"props":3603,"children":3604},{"class":635,"line":935},[3605,3610,3614,3619,3623,3627,3631,3635,3640,3644,3648,3652,3656],{"type":18,"tag":633,"props":3606,"children":3607},{"class":646},[3608],{"type":24,"value":3609},"                U[",{"type":18,"tag":633,"props":3611,"children":3612},{"class":690},[3613],{"type":24,"value":886},{"type":18,"tag":633,"props":3615,"children":3616},{"class":646},[3617],{"type":24,"value":3618},", i], Lambda[",{"type":18,"tag":633,"props":3620,"children":3621},{"class":690},[3622],{"type":24,"value":886},{"type":18,"tag":633,"props":3624,"children":3625},{"class":646},[3626],{"type":24,"value":2917},{"type":18,"tag":633,"props":3628,"children":3629},{"class":640},[3630],{"type":24,"value":1196},{"type":18,"tag":633,"props":3632,"children":3633},{"class":690},[3634],{"type":24,"value":996},{"type":18,"tag":633,"props":3636,"children":3637},{"class":646},[3638],{"type":24,"value":3639},"], Lambda[",{"type":18,"tag":633,"props":3641,"children":3642},{"class":690},[3643],{"type":24,"value":996},{"type":18,"tag":633,"props":3645,"children":3646},{"class":646},[3647],{"type":24,"value":2917},{"type":18,"tag":633,"props":3649,"children":3650},{"class":640},[3651],{"type":24,"value":1196},{"type":18,"tag":633,"props":3653,"children":3654},{"class":690},[3655],{"type":24,"value":996},{"type":18,"tag":633,"props":3657,"children":3658},{"class":646},[3659],{"type":24,"value":891},{"type":18,"tag":633,"props":3661,"children":3662},{"class":635,"line":969},[3663],{"type":18,"tag":633,"props":3664,"children":3665},{"class":646},[3666],{"type":24,"value":3667},"            )\n",{"type":18,"tag":633,"props":3669,"children":3670},{"class":635,"line":1003},[3671],{"type":18,"tag":633,"props":3672,"children":3673},{},[3674],{"type":24,"value":669},{"type":18,"tag":633,"props":3676,"children":3677},{"class":635,"line":1011},[3678,3683,3687,3691,3695,3700,3704,3708,3712,3716,3720,3724,3729,3733],{"type":18,"tag":633,"props":3679,"children":3680},{"class":646},[3681],{"type":24,"value":3682},"            Lambda[",{"type":18,"tag":633,"props":3684,"children":3685},{"class":690},[3686],{"type":24,"value":886},{"type":18,"tag":633,"props":3688,"children":3689},{"class":646},[3690],{"type":24,"value":2948},{"type":18,"tag":633,"props":3692,"children":3693},{"class":640},[3694],{"type":24,"value":730},{"type":18,"tag":633,"props":3696,"children":3697},{"class":646},[3698],{"type":24,"value":3699}," Lambda[",{"type":18,"tag":633,"props":3701,"children":3702},{"class":690},[3703],{"type":24,"value":886},{"type":18,"tag":633,"props":3705,"children":3706},{"class":646},[3707],{"type":24,"value":2917},{"type":18,"tag":633,"props":3709,"children":3710},{"class":640},[3711],{"type":24,"value":1196},{"type":18,"tag":633,"props":3713,"children":3714},{"class":690},[3715],{"type":24,"value":996},{"type":18,"tag":633,"props":3717,"children":3718},{"class":646},[3719],{"type":24,"value":2930},{"type":18,"tag":633,"props":3721,"children":3722},{"class":640},[3723],{"type":24,"value":1196},{"type":18,"tag":633,"props":3725,"children":3726},{"class":646},[3727],{"type":24,"value":3728}," dhdx1 ",{"type":18,"tag":633,"props":3730,"children":3731},{"class":640},[3732],{"type":24,"value":1075},{"type":18,"tag":633,"props":3734,"children":3735},{"class":646},[3736],{"type":24,"value":2966},{"type":18,"tag":633,"props":3738,"children":3739},{"class":635,"line":1037},[3740,3744,3748,3752,3756,3760,3764,3768,3772,3776,3780,3784,3789,3793],{"type":18,"tag":633,"props":3741,"children":3742},{"class":646},[3743],{"type":24,"value":3682},{"type":18,"tag":633,"props":3745,"children":3746},{"class":690},[3747],{"type":24,"value":996},{"type":18,"tag":633,"props":3749,"children":3750},{"class":646},[3751],{"type":24,"value":2948},{"type":18,"tag":633,"props":3753,"children":3754},{"class":640},[3755],{"type":24,"value":730},{"type":18,"tag":633,"props":3757,"children":3758},{"class":646},[3759],{"type":24,"value":3699},{"type":18,"tag":633,"props":3761,"children":3762},{"class":690},[3763],{"type":24,"value":996},{"type":18,"tag":633,"props":3765,"children":3766},{"class":646},[3767],{"type":24,"value":2917},{"type":18,"tag":633,"props":3769,"children":3770},{"class":640},[3771],{"type":24,"value":1196},{"type":18,"tag":633,"props":3773,"children":3774},{"class":690},[3775],{"type":24,"value":996},{"type":18,"tag":633,"props":3777,"children":3778},{"class":646},[3779],{"type":24,"value":2930},{"type":18,"tag":633,"props":3781,"children":3782},{"class":640},[3783],{"type":24,"value":1196},{"type":18,"tag":633,"props":3785,"children":3786},{"class":646},[3787],{"type":24,"value":3788}," dhdx2 ",{"type":18,"tag":633,"props":3790,"children":3791},{"class":640},[3792],{"type":24,"value":1075},{"type":18,"tag":633,"props":3794,"children":3795},{"class":646},[3796],{"type":24,"value":2966},{"type":18,"tag":633,"props":3798,"children":3799},{"class":635,"line":1045},[3800,3804,3808,3812,3816,3820,3824,3828,3832,3836,3840,3844,3849,3853],{"type":18,"tag":633,"props":3801,"children":3802},{"class":646},[3803],{"type":24,"value":3682},{"type":18,"tag":633,"props":3805,"children":3806},{"class":690},[3807],{"type":24,"value":1372},{"type":18,"tag":633,"props":3809,"children":3810},{"class":646},[3811],{"type":24,"value":2948},{"type":18,"tag":633,"props":3813,"children":3814},{"class":640},[3815],{"type":24,"value":730},{"type":18,"tag":633,"props":3817,"children":3818},{"class":646},[3819],{"type":24,"value":3699},{"type":18,"tag":633,"props":3821,"children":3822},{"class":690},[3823],{"type":24,"value":1372},{"type":18,"tag":633,"props":3825,"children":3826},{"class":646},[3827],{"type":24,"value":2917},{"type":18,"tag":633,"props":3829,"children":3830},{"class":640},[3831],{"type":24,"value":1196},{"type":18,"tag":633,"props":3833,"children":3834},{"class":690},[3835],{"type":24,"value":996},{"type":18,"tag":633,"props":3837,"children":3838},{"class":646},[3839],{"type":24,"value":2930},{"type":18,"tag":633,"props":3841,"children":3842},{"class":640},[3843],{"type":24,"value":1196},{"type":18,"tag":633,"props":3845,"children":3846},{"class":646},[3847],{"type":24,"value":3848}," dhdx3 ",{"type":18,"tag":633,"props":3850,"children":3851},{"class":640},[3852],{"type":24,"value":1075},{"type":18,"tag":633,"props":3854,"children":3855},{"class":646},[3856],{"type":24,"value":2966},{"type":18,"tag":633,"props":3858,"children":3859},{"class":635,"line":1087},[3860],{"type":18,"tag":633,"props":3861,"children":3862},{"class":646},[3863],{"type":24,"value":3864},"    \n",{"type":18,"tag":633,"props":3866,"children":3867},{"class":635,"line":1127},[3868],{"type":18,"tag":633,"props":3869,"children":3870},{},[3871],{"type":24,"value":669},{"type":18,"tag":633,"props":3873,"children":3874},{"class":635,"line":1221},[3875,3879,3883],{"type":18,"tag":633,"props":3876,"children":3877},{"class":646},[3878],{"type":24,"value":715},{"type":18,"tag":633,"props":3880,"children":3881},{"class":640},[3882],{"type":24,"value":1239},{"type":18,"tag":633,"props":3884,"children":3885},{"class":646},[3886],{"type":24,"value":3887}," Lambda",{"type":18,"tag":27,"props":3889,"children":3890},{},[3891],{"type":24,"value":3892},"And finally, calculating Newton F Function",{"type":18,"tag":618,"props":3894,"children":3897},{"className":3895,"code":3896,"language":623,"meta":8},[621],"def calc_f(self, X, U, Lambda, Mu, dt):\n\n        X_new = self.calc_state(X, U, dt)\n\n        Lambda_new = self.calc_costate(X_new, U, Lambda, dt)\n\n        F = np.zeros((self.u_dim, self.pred_horizons))\n\n        for i in range(self.pred_horizons):\n            dhdu1, dhdu2 = self.hjb_equation.dhdu(X_new[2, i], U[0, i], U[1, i],\n                                                  self.U_r[0], self.U_r[1],\n                                                  Lambda_new[0, i+1], Lambda_new[1, i+1], Lambda_new[2, i+1],\n                                                  Mu[0, i], Mu[1, i])\n            F[0, i] = dhdu1\n            F[1, i] = dhdu2\n            \n        F = F.T.ravel().reshape(-1, 1)\n\n        return F\n",[3898],{"type":18,"tag":626,"props":3899,"children":3900},{},[3901],{"type":18,"tag":618,"props":3902,"children":3903},{"__ignoreMap":8},[3904,3925,3932,3957,3964,3989,3996,4028,4035,4074,4123,4164,4233,4258,4283,4307,4314,4350,4357],{"type":18,"tag":633,"props":3905,"children":3906},{"class":635,"line":636},[3907,3911,3915,3920],{"type":18,"tag":633,"props":3908,"children":3909},{"class":640},[3910],{"type":24,"value":683},{"type":18,"tag":633,"props":3912,"children":3913},{"class":646},[3914],{"type":24,"value":649},{"type":18,"tag":633,"props":3916,"children":3917},{"class":652},[3918],{"type":24,"value":3919},"calc_f",{"type":18,"tag":633,"props":3921,"children":3922},{"class":646},[3923],{"type":24,"value":3924},"(self, X, U, Lambda, Mu, dt):\n",{"type":18,"tag":633,"props":3926,"children":3927},{"class":635,"line":663},[3928],{"type":18,"tag":633,"props":3929,"children":3930},{},[3931],{"type":24,"value":669},{"type":18,"tag":633,"props":3933,"children":3934},{"class":635,"line":672},[3935,3940,3944,3948,3952],{"type":18,"tag":633,"props":3936,"children":3937},{"class":646},[3938],{"type":24,"value":3939},"        X_new ",{"type":18,"tag":633,"props":3941,"children":3942},{"class":640},[3943],{"type":24,"value":730},{"type":18,"tag":633,"props":3945,"children":3946},{"class":646},[3947],{"type":24,"value":649},{"type":18,"tag":633,"props":3949,"children":3950},{"class":690},[3951],{"type":24,"value":720},{"type":18,"tag":633,"props":3953,"children":3954},{"class":646},[3955],{"type":24,"value":3956},".calc_state(X, U, dt)\n",{"type":18,"tag":633,"props":3958,"children":3959},{"class":635,"line":701},[3960],{"type":18,"tag":633,"props":3961,"children":3962},{},[3963],{"type":24,"value":669},{"type":18,"tag":633,"props":3965,"children":3966},{"class":635,"line":709},[3967,3972,3976,3980,3984],{"type":18,"tag":633,"props":3968,"children":3969},{"class":646},[3970],{"type":24,"value":3971},"        Lambda_new ",{"type":18,"tag":633,"props":3973,"children":3974},{"class":640},[3975],{"type":24,"value":730},{"type":18,"tag":633,"props":3977,"children":3978},{"class":646},[3979],{"type":24,"value":649},{"type":18,"tag":633,"props":3981,"children":3982},{"class":690},[3983],{"type":24,"value":720},{"type":18,"tag":633,"props":3985,"children":3986},{"class":646},[3987],{"type":24,"value":3988},".calc_costate(X_new, U, Lambda, dt)\n",{"type":18,"tag":633,"props":3990,"children":3991},{"class":635,"line":738},[3992],{"type":18,"tag":633,"props":3993,"children":3994},{},[3995],{"type":24,"value":669},{"type":18,"tag":633,"props":3997,"children":3998},{"class":635,"line":764},[3999,4004,4008,4012,4016,4020,4024],{"type":18,"tag":633,"props":4000,"children":4001},{"class":646},[4002],{"type":24,"value":4003},"        F ",{"type":18,"tag":633,"props":4005,"children":4006},{"class":640},[4007],{"type":24,"value":730},{"type":18,"tag":633,"props":4009,"children":4010},{"class":646},[4011],{"type":24,"value":2488},{"type":18,"tag":633,"props":4013,"children":4014},{"class":690},[4015],{"type":24,"value":720},{"type":18,"tag":633,"props":4017,"children":4018},{"class":646},[4019],{"type":24,"value":2497},{"type":18,"tag":633,"props":4021,"children":4022},{"class":690},[4023],{"type":24,"value":720},{"type":18,"tag":633,"props":4025,"children":4026},{"class":646},[4027],{"type":24,"value":2506},{"type":18,"tag":633,"props":4029,"children":4030},{"class":635,"line":790},[4031],{"type":18,"tag":633,"props":4032,"children":4033},{},[4034],{"type":24,"value":669},{"type":18,"tag":633,"props":4036,"children":4037},{"class":635,"line":798},[4038,4042,4046,4050,4054,4058,4062,4066,4070],{"type":18,"tag":633,"props":4039,"children":4040},{"class":646},[4041],{"type":24,"value":715},{"type":18,"tag":633,"props":4043,"children":4044},{"class":640},[4045],{"type":24,"value":2809},{"type":18,"tag":633,"props":4047,"children":4048},{"class":646},[4049],{"type":24,"value":2814},{"type":18,"tag":633,"props":4051,"children":4052},{"class":640},[4053],{"type":24,"value":2819},{"type":18,"tag":633,"props":4055,"children":4056},{"class":646},[4057],{"type":24,"value":649},{"type":18,"tag":633,"props":4059,"children":4060},{"class":690},[4061],{"type":24,"value":2828},{"type":18,"tag":633,"props":4063,"children":4064},{"class":646},[4065],{"type":24,"value":1406},{"type":18,"tag":633,"props":4067,"children":4068},{"class":690},[4069],{"type":24,"value":720},{"type":18,"tag":633,"props":4071,"children":4072},{"class":646},[4073],{"type":24,"value":2841},{"type":18,"tag":633,"props":4075,"children":4076},{"class":635,"line":824},[4077,4082,4086,4090,4094,4099,4103,4107,4111,4115,4119],{"type":18,"tag":633,"props":4078,"children":4079},{"class":646},[4080],{"type":24,"value":4081},"            dhdu1, dhdu2 ",{"type":18,"tag":633,"props":4083,"children":4084},{"class":640},[4085],{"type":24,"value":730},{"type":18,"tag":633,"props":4087,"children":4088},{"class":646},[4089],{"type":24,"value":649},{"type":18,"tag":633,"props":4091,"children":4092},{"class":690},[4093],{"type":24,"value":720},{"type":18,"tag":633,"props":4095,"children":4096},{"class":646},[4097],{"type":24,"value":4098},".hjb_equation.dhdu(X_new[",{"type":18,"tag":633,"props":4100,"children":4101},{"class":690},[4102],{"type":24,"value":1372},{"type":18,"tag":633,"props":4104,"children":4105},{"class":646},[4106],{"type":24,"value":2875},{"type":18,"tag":633,"props":4108,"children":4109},{"class":690},[4110],{"type":24,"value":886},{"type":18,"tag":633,"props":4112,"children":4113},{"class":646},[4114],{"type":24,"value":2875},{"type":18,"tag":633,"props":4116,"children":4117},{"class":690},[4118],{"type":24,"value":996},{"type":18,"tag":633,"props":4120,"children":4121},{"class":646},[4122],{"type":24,"value":3545},{"type":18,"tag":633,"props":4124,"children":4125},{"class":635,"line":850},[4126,4131,4135,4140,4144,4148,4152,4156,4160],{"type":18,"tag":633,"props":4127,"children":4128},{"class":646},[4129],{"type":24,"value":4130},"                                                  ",{"type":18,"tag":633,"props":4132,"children":4133},{"class":690},[4134],{"type":24,"value":720},{"type":18,"tag":633,"props":4136,"children":4137},{"class":646},[4138],{"type":24,"value":4139},".U_r[",{"type":18,"tag":633,"props":4141,"children":4142},{"class":690},[4143],{"type":24,"value":886},{"type":18,"tag":633,"props":4145,"children":4146},{"class":646},[4147],{"type":24,"value":3266},{"type":18,"tag":633,"props":4149,"children":4150},{"class":690},[4151],{"type":24,"value":720},{"type":18,"tag":633,"props":4153,"children":4154},{"class":646},[4155],{"type":24,"value":4139},{"type":18,"tag":633,"props":4157,"children":4158},{"class":690},[4159],{"type":24,"value":996},{"type":18,"tag":633,"props":4161,"children":4162},{"class":646},[4163],{"type":24,"value":3240},{"type":18,"tag":633,"props":4165,"children":4166},{"class":635,"line":858},[4167,4172,4176,4180,4184,4188,4193,4197,4201,4205,4209,4213,4217,4221,4225,4229],{"type":18,"tag":633,"props":4168,"children":4169},{"class":646},[4170],{"type":24,"value":4171},"                                                  Lambda_new[",{"type":18,"tag":633,"props":4173,"children":4174},{"class":690},[4175],{"type":24,"value":886},{"type":18,"tag":633,"props":4177,"children":4178},{"class":646},[4179],{"type":24,"value":2917},{"type":18,"tag":633,"props":4181,"children":4182},{"class":640},[4183],{"type":24,"value":1196},{"type":18,"tag":633,"props":4185,"children":4186},{"class":690},[4187],{"type":24,"value":996},{"type":18,"tag":633,"props":4189,"children":4190},{"class":646},[4191],{"type":24,"value":4192},"], Lambda_new[",{"type":18,"tag":633,"props":4194,"children":4195},{"class":690},[4196],{"type":24,"value":996},{"type":18,"tag":633,"props":4198,"children":4199},{"class":646},[4200],{"type":24,"value":2917},{"type":18,"tag":633,"props":4202,"children":4203},{"class":640},[4204],{"type":24,"value":1196},{"type":18,"tag":633,"props":4206,"children":4207},{"class":690},[4208],{"type":24,"value":996},{"type":18,"tag":633,"props":4210,"children":4211},{"class":646},[4212],{"type":24,"value":4192},{"type":18,"tag":633,"props":4214,"children":4215},{"class":690},[4216],{"type":24,"value":1372},{"type":18,"tag":633,"props":4218,"children":4219},{"class":646},[4220],{"type":24,"value":2917},{"type":18,"tag":633,"props":4222,"children":4223},{"class":640},[4224],{"type":24,"value":1196},{"type":18,"tag":633,"props":4226,"children":4227},{"class":690},[4228],{"type":24,"value":996},{"type":18,"tag":633,"props":4230,"children":4231},{"class":646},[4232],{"type":24,"value":3240},{"type":18,"tag":633,"props":4234,"children":4235},{"class":635,"line":894},[4236,4241,4245,4250,4254],{"type":18,"tag":633,"props":4237,"children":4238},{"class":646},[4239],{"type":24,"value":4240},"                                                  Mu[",{"type":18,"tag":633,"props":4242,"children":4243},{"class":690},[4244],{"type":24,"value":886},{"type":18,"tag":633,"props":4246,"children":4247},{"class":646},[4248],{"type":24,"value":4249},", i], Mu[",{"type":18,"tag":633,"props":4251,"children":4252},{"class":690},[4253],{"type":24,"value":996},{"type":18,"tag":633,"props":4255,"children":4256},{"class":646},[4257],{"type":24,"value":2892},{"type":18,"tag":633,"props":4259,"children":4260},{"class":635,"line":927},[4261,4266,4270,4274,4278],{"type":18,"tag":633,"props":4262,"children":4263},{"class":646},[4264],{"type":24,"value":4265},"            F[",{"type":18,"tag":633,"props":4267,"children":4268},{"class":690},[4269],{"type":24,"value":886},{"type":18,"tag":633,"props":4271,"children":4272},{"class":646},[4273],{"type":24,"value":2948},{"type":18,"tag":633,"props":4275,"children":4276},{"class":640},[4277],{"type":24,"value":730},{"type":18,"tag":633,"props":4279,"children":4280},{"class":646},[4281],{"type":24,"value":4282}," dhdu1\n",{"type":18,"tag":633,"props":4284,"children":4285},{"class":635,"line":935},[4286,4290,4294,4298,4302],{"type":18,"tag":633,"props":4287,"children":4288},{"class":646},[4289],{"type":24,"value":4265},{"type":18,"tag":633,"props":4291,"children":4292},{"class":690},[4293],{"type":24,"value":996},{"type":18,"tag":633,"props":4295,"children":4296},{"class":646},[4297],{"type":24,"value":2948},{"type":18,"tag":633,"props":4299,"children":4300},{"class":640},[4301],{"type":24,"value":730},{"type":18,"tag":633,"props":4303,"children":4304},{"class":646},[4305],{"type":24,"value":4306}," dhdu2\n",{"type":18,"tag":633,"props":4308,"children":4309},{"class":635,"line":969},[4310],{"type":18,"tag":633,"props":4311,"children":4312},{"class":646},[4313],{"type":24,"value":2900},{"type":18,"tag":633,"props":4315,"children":4316},{"class":635,"line":1003},[4317,4321,4325,4330,4334,4338,4342,4346],{"type":18,"tag":633,"props":4318,"children":4319},{"class":646},[4320],{"type":24,"value":4003},{"type":18,"tag":633,"props":4322,"children":4323},{"class":640},[4324],{"type":24,"value":730},{"type":18,"tag":633,"props":4326,"children":4327},{"class":646},[4328],{"type":24,"value":4329}," F.T.ravel().reshape(",{"type":18,"tag":633,"props":4331,"children":4332},{"class":640},[4333],{"type":24,"value":1065},{"type":18,"tag":633,"props":4335,"children":4336},{"class":690},[4337],{"type":24,"value":996},{"type":18,"tag":633,"props":4339,"children":4340},{"class":646},[4341],{"type":24,"value":2436},{"type":18,"tag":633,"props":4343,"children":4344},{"class":690},[4345],{"type":24,"value":996},{"type":18,"tag":633,"props":4347,"children":4348},{"class":646},[4349],{"type":24,"value":1442},{"type":18,"tag":633,"props":4351,"children":4352},{"class":635,"line":1011},[4353],{"type":18,"tag":633,"props":4354,"children":4355},{},[4356],{"type":24,"value":669},{"type":18,"tag":633,"props":4358,"children":4359},{"class":635,"line":1037},[4360,4364,4368],{"type":18,"tag":633,"props":4361,"children":4362},{"class":646},[4363],{"type":24,"value":715},{"type":18,"tag":633,"props":4365,"children":4366},{"class":640},[4367],{"type":24,"value":1239},{"type":18,"tag":633,"props":4369,"children":4370},{"class":646},[4371],{"type":24,"value":4372}," F",{"type":18,"tag":27,"props":4374,"children":4375},{},[4376,4378,4384,4386,4391],{"type":24,"value":4377},"Now let's introduce Continuation method for Function ",{"type":18,"tag":4379,"props":4380,"children":4381},"code-inline",{},[4382],{"type":24,"value":4383},"F",{"type":24,"value":4385},", you can look at the ",{"type":18,"tag":170,"props":4387,"children":4388},{},[4389],{"type":24,"value":4390}," Continuation ",{"type":24,"value":4392}," part.",{"type":18,"tag":618,"props":4394,"children":4397},{"className":4395,"code":4396,"language":623,"meta":8},[621],"# Time step horizons\ndt = self.tf * (1-np.exp(-self.alpha*time)) / self.pred_horizons\n# F(x,u,t+h)\nF = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u,t+h)\nx_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, 0], U[0, 0], U[1, 0])\nX[:, 0] = X[:, 0] + np.array([x_dot, y_dot, yaw_dot]) * self.ht\nFxt = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u+hdx,t+h)\nFuxt = self.calc_f(X, U + self.dU*self.ht, Lambda, Mu , dt)\n\n# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n",[4398],{"type":18,"tag":626,"props":4399,"children":4400},{},[4401],{"type":18,"tag":618,"props":4402,"children":4403},{"__ignoreMap":8},[4404,4412,4496,4504,4529,4537,4610,4668,4692,4700,4755,4762,4770,4812],{"type":18,"tag":633,"props":4405,"children":4406},{"class":635,"line":636},[4407],{"type":18,"tag":633,"props":4408,"children":4409},{"class":1870},[4410],{"type":24,"value":4411},"# Time step horizons\n",{"type":18,"tag":633,"props":4413,"children":4414},{"class":635,"line":663},[4415,4419,4423,4427,4431,4435,4439,4444,4448,4452,4457,4461,4465,4470,4474,4479,4483,4487,4491],{"type":18,"tag":633,"props":4416,"children":4417},{"class":646},[4418],{"type":24,"value":2731},{"type":18,"tag":633,"props":4420,"children":4421},{"class":640},[4422],{"type":24,"value":730},{"type":18,"tag":633,"props":4424,"children":4425},{"class":646},[4426],{"type":24,"value":649},{"type":18,"tag":633,"props":4428,"children":4429},{"class":690},[4430],{"type":24,"value":720},{"type":18,"tag":633,"props":4432,"children":4433},{"class":646},[4434],{"type":24,"value":2122},{"type":18,"tag":633,"props":4436,"children":4437},{"class":640},[4438],{"type":24,"value":1075},{"type":18,"tag":633,"props":4440,"children":4441},{"class":646},[4442],{"type":24,"value":4443}," (",{"type":18,"tag":633,"props":4445,"children":4446},{"class":690},[4447],{"type":24,"value":996},{"type":18,"tag":633,"props":4449,"children":4450},{"class":640},[4451],{"type":24,"value":1065},{"type":18,"tag":633,"props":4453,"children":4454},{"class":646},[4455],{"type":24,"value":4456},"np.exp(",{"type":18,"tag":633,"props":4458,"children":4459},{"class":640},[4460],{"type":24,"value":1065},{"type":18,"tag":633,"props":4462,"children":4463},{"class":690},[4464],{"type":24,"value":720},{"type":18,"tag":633,"props":4466,"children":4467},{"class":646},[4468],{"type":24,"value":4469},".alpha",{"type":18,"tag":633,"props":4471,"children":4472},{"class":640},[4473],{"type":24,"value":1075},{"type":18,"tag":633,"props":4475,"children":4476},{"class":646},[4477],{"type":24,"value":4478},"time)) ",{"type":18,"tag":633,"props":4480,"children":4481},{"class":640},[4482],{"type":24,"value":1433},{"type":18,"tag":633,"props":4484,"children":4485},{"class":646},[4486],{"type":24,"value":649},{"type":18,"tag":633,"props":4488,"children":4489},{"class":690},[4490],{"type":24,"value":720},{"type":18,"tag":633,"props":4492,"children":4493},{"class":646},[4494],{"type":24,"value":4495},".pred_horizons\n",{"type":18,"tag":633,"props":4497,"children":4498},{"class":635,"line":672},[4499],{"type":18,"tag":633,"props":4500,"children":4501},{"class":1870},[4502],{"type":24,"value":4503},"# F(x,u,t+h)\n",{"type":18,"tag":633,"props":4505,"children":4506},{"class":635,"line":701},[4507,4512,4516,4520,4524],{"type":18,"tag":633,"props":4508,"children":4509},{"class":646},[4510],{"type":24,"value":4511},"F ",{"type":18,"tag":633,"props":4513,"children":4514},{"class":640},[4515],{"type":24,"value":730},{"type":18,"tag":633,"props":4517,"children":4518},{"class":646},[4519],{"type":24,"value":649},{"type":18,"tag":633,"props":4521,"children":4522},{"class":690},[4523],{"type":24,"value":720},{"type":18,"tag":633,"props":4525,"children":4526},{"class":646},[4527],{"type":24,"value":4528},".calc_f(X, U, Lambda, Mu, dt)\n",{"type":18,"tag":633,"props":4530,"children":4531},{"class":635,"line":709},[4532],{"type":18,"tag":633,"props":4533,"children":4534},{"class":1870},[4535],{"type":24,"value":4536},"# F(x+hdx,u,t+h)\n",{"type":18,"tag":633,"props":4538,"children":4539},{"class":635,"line":738},[4540,4545,4549,4553,4557,4561,4565,4569,4573,4578,4582,4586,4590,4594,4598,4602,4606],{"type":18,"tag":633,"props":4541,"children":4542},{"class":646},[4543],{"type":24,"value":4544},"x_dot, y_dot, yaw_dot ",{"type":18,"tag":633,"props":4546,"children":4547},{"class":640},[4548],{"type":24,"value":730},{"type":18,"tag":633,"props":4550,"children":4551},{"class":646},[4552],{"type":24,"value":649},{"type":18,"tag":633,"props":4554,"children":4555},{"class":690},[4556],{"type":24,"value":720},{"type":18,"tag":633,"props":4558,"children":4559},{"class":646},[4560],{"type":24,"value":2866},{"type":18,"tag":633,"props":4562,"children":4563},{"class":690},[4564],{"type":24,"value":1372},{"type":18,"tag":633,"props":4566,"children":4567},{"class":646},[4568],{"type":24,"value":2436},{"type":18,"tag":633,"props":4570,"children":4571},{"class":690},[4572],{"type":24,"value":886},{"type":18,"tag":633,"props":4574,"children":4575},{"class":646},[4576],{"type":24,"value":4577},"], U[",{"type":18,"tag":633,"props":4579,"children":4580},{"class":690},[4581],{"type":24,"value":886},{"type":18,"tag":633,"props":4583,"children":4584},{"class":646},[4585],{"type":24,"value":2436},{"type":18,"tag":633,"props":4587,"children":4588},{"class":690},[4589],{"type":24,"value":886},{"type":18,"tag":633,"props":4591,"children":4592},{"class":646},[4593],{"type":24,"value":4577},{"type":18,"tag":633,"props":4595,"children":4596},{"class":690},[4597],{"type":24,"value":996},{"type":18,"tag":633,"props":4599,"children":4600},{"class":646},[4601],{"type":24,"value":2436},{"type":18,"tag":633,"props":4603,"children":4604},{"class":690},[4605],{"type":24,"value":886},{"type":18,"tag":633,"props":4607,"children":4608},{"class":646},[4609],{"type":24,"value":3299},{"type":18,"tag":633,"props":4611,"children":4612},{"class":635,"line":764},[4613,4618,4622,4626,4630,4635,4639,4643,4647,4652,4656,4660,4664],{"type":18,"tag":633,"props":4614,"children":4615},{"class":646},[4616],{"type":24,"value":4617},"X[:, ",{"type":18,"tag":633,"props":4619,"children":4620},{"class":690},[4621],{"type":24,"value":886},{"type":18,"tag":633,"props":4623,"children":4624},{"class":646},[4625],{"type":24,"value":2930},{"type":18,"tag":633,"props":4627,"children":4628},{"class":640},[4629],{"type":24,"value":730},{"type":18,"tag":633,"props":4631,"children":4632},{"class":646},[4633],{"type":24,"value":4634}," X[:, ",{"type":18,"tag":633,"props":4636,"children":4637},{"class":690},[4638],{"type":24,"value":886},{"type":18,"tag":633,"props":4640,"children":4641},{"class":646},[4642],{"type":24,"value":2930},{"type":18,"tag":633,"props":4644,"children":4645},{"class":640},[4646],{"type":24,"value":1196},{"type":18,"tag":633,"props":4648,"children":4649},{"class":646},[4650],{"type":24,"value":4651}," np.array([x_dot, y_dot, yaw_dot]) ",{"type":18,"tag":633,"props":4653,"children":4654},{"class":640},[4655],{"type":24,"value":1075},{"type":18,"tag":633,"props":4657,"children":4658},{"class":646},[4659],{"type":24,"value":649},{"type":18,"tag":633,"props":4661,"children":4662},{"class":690},[4663],{"type":24,"value":720},{"type":18,"tag":633,"props":4665,"children":4666},{"class":646},[4667],{"type":24,"value":2077},{"type":18,"tag":633,"props":4669,"children":4670},{"class":635,"line":790},[4671,4676,4680,4684,4688],{"type":18,"tag":633,"props":4672,"children":4673},{"class":646},[4674],{"type":24,"value":4675},"Fxt ",{"type":18,"tag":633,"props":4677,"children":4678},{"class":640},[4679],{"type":24,"value":730},{"type":18,"tag":633,"props":4681,"children":4682},{"class":646},[4683],{"type":24,"value":649},{"type":18,"tag":633,"props":4685,"children":4686},{"class":690},[4687],{"type":24,"value":720},{"type":18,"tag":633,"props":4689,"children":4690},{"class":646},[4691],{"type":24,"value":4528},{"type":18,"tag":633,"props":4693,"children":4694},{"class":635,"line":798},[4695],{"type":18,"tag":633,"props":4696,"children":4697},{"class":1870},[4698],{"type":24,"value":4699},"# F(x+hdx,u+hdx,t+h)\n",{"type":18,"tag":633,"props":4701,"children":4702},{"class":635,"line":824},[4703,4708,4712,4716,4720,4725,4729,4733,4737,4742,4746,4750],{"type":18,"tag":633,"props":4704,"children":4705},{"class":646},[4706],{"type":24,"value":4707},"Fuxt ",{"type":18,"tag":633,"props":4709,"children":4710},{"class":640},[4711],{"type":24,"value":730},{"type":18,"tag":633,"props":4713,"children":4714},{"class":646},[4715],{"type":24,"value":649},{"type":18,"tag":633,"props":4717,"children":4718},{"class":690},[4719],{"type":24,"value":720},{"type":18,"tag":633,"props":4721,"children":4722},{"class":646},[4723],{"type":24,"value":4724},".calc_f(X, U ",{"type":18,"tag":633,"props":4726,"children":4727},{"class":640},[4728],{"type":24,"value":1196},{"type":18,"tag":633,"props":4730,"children":4731},{"class":646},[4732],{"type":24,"value":649},{"type":18,"tag":633,"props":4734,"children":4735},{"class":690},[4736],{"type":24,"value":720},{"type":18,"tag":633,"props":4738,"children":4739},{"class":646},[4740],{"type":24,"value":4741},".dU",{"type":18,"tag":633,"props":4743,"children":4744},{"class":640},[4745],{"type":24,"value":1075},{"type":18,"tag":633,"props":4747,"children":4748},{"class":690},[4749],{"type":24,"value":720},{"type":18,"tag":633,"props":4751,"children":4752},{"class":646},[4753],{"type":24,"value":4754},".ht, Lambda, Mu , dt)\n",{"type":18,"tag":633,"props":4756,"children":4757},{"class":635,"line":850},[4758],{"type":18,"tag":633,"props":4759,"children":4760},{},[4761],{"type":24,"value":669},{"type":18,"tag":633,"props":4763,"children":4764},{"class":635,"line":858},[4765],{"type":18,"tag":633,"props":4766,"children":4767},{"class":1870},[4768],{"type":24,"value":4769},"# Define right-left handside equation\n",{"type":18,"tag":633,"props":4771,"children":4772},{"class":635,"line":894},[4773,4778,4782,4787,4791,4796,4800,4804,4808],{"type":18,"tag":633,"props":4774,"children":4775},{"class":646},[4776],{"type":24,"value":4777},"left ",{"type":18,"tag":633,"props":4779,"children":4780},{"class":640},[4781],{"type":24,"value":730},{"type":18,"tag":633,"props":4783,"children":4784},{"class":646},[4785],{"type":24,"value":4786}," (Fuxt ",{"type":18,"tag":633,"props":4788,"children":4789},{"class":640},[4790],{"type":24,"value":1065},{"type":18,"tag":633,"props":4792,"children":4793},{"class":646},[4794],{"type":24,"value":4795}," Fxt) ",{"type":18,"tag":633,"props":4797,"children":4798},{"class":640},[4799],{"type":24,"value":1433},{"type":18,"tag":633,"props":4801,"children":4802},{"class":646},[4803],{"type":24,"value":649},{"type":18,"tag":633,"props":4805,"children":4806},{"class":690},[4807],{"type":24,"value":720},{"type":18,"tag":633,"props":4809,"children":4810},{"class":646},[4811],{"type":24,"value":2077},{"type":18,"tag":633,"props":4813,"children":4814},{"class":635,"line":927},[4815,4820,4824,4828,4832,4836,4840,4844,4849,4853,4858,4862,4867,4871,4875],{"type":18,"tag":633,"props":4816,"children":4817},{"class":646},[4818],{"type":24,"value":4819},"right ",{"type":18,"tag":633,"props":4821,"children":4822},{"class":640},[4823],{"type":24,"value":730},{"type":18,"tag":633,"props":4825,"children":4826},{"class":646},[4827],{"type":24,"value":649},{"type":18,"tag":633,"props":4829,"children":4830},{"class":640},[4831],{"type":24,"value":1065},{"type":18,"tag":633,"props":4833,"children":4834},{"class":690},[4835],{"type":24,"value":720},{"type":18,"tag":633,"props":4837,"children":4838},{"class":646},[4839],{"type":24,"value":2052},{"type":18,"tag":633,"props":4841,"children":4842},{"class":640},[4843],{"type":24,"value":1075},{"type":18,"tag":633,"props":4845,"children":4846},{"class":646},[4847],{"type":24,"value":4848}," F ",{"type":18,"tag":633,"props":4850,"children":4851},{"class":640},[4852],{"type":24,"value":1065},{"type":18,"tag":633,"props":4854,"children":4855},{"class":646},[4856],{"type":24,"value":4857}," (Fxt ",{"type":18,"tag":633,"props":4859,"children":4860},{"class":640},[4861],{"type":24,"value":1065},{"type":18,"tag":633,"props":4863,"children":4864},{"class":646},[4865],{"type":24,"value":4866}," F)",{"type":18,"tag":633,"props":4868,"children":4869},{"class":640},[4870],{"type":24,"value":1433},{"type":18,"tag":633,"props":4872,"children":4873},{"class":690},[4874],{"type":24,"value":720},{"type":18,"tag":633,"props":4876,"children":4877},{"class":646},[4878],{"type":24,"value":4879},".ht",{"type":18,"tag":27,"props":4881,"children":4882},{},[4883,4885,4889],{"type":24,"value":4884},"Here is the crucial part, we need to implement GMRES solver for our ",{"type":18,"tag":4379,"props":4886,"children":4887},{},[4888],{"type":24,"value":4383},{"type":24,"value":4890}," function to obtain solution vector.",{"type":18,"tag":618,"props":4892,"children":4895},{"className":4893,"code":4894,"language":623,"meta":8},[621],"# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n\n# Define iterations\nm = (self.u_dim ) * self.pred_horizons\n# Define r0\nr0 = right - left\n# print(r0)\n\n# GMRES\nVm = np.zeros((m, m+1))\nVm[:, 0:1] = r0 / np.linalg.norm(r0)\n# print(\"Vm\", Vm[:, 0])\nHm = np.zeros((m+1, m))\n# print(Vm[:, 0])\n\n\nfor i in range(m):\n    Fuxt = self.calc_f(\n        X, U + Vm[:, i:i+1].reshape(self.u_dim, self.pred_horizons, order='F') * self.ht,\n        Lambda, Mu,\n        dt\n    )\n\n    Av = (Fuxt - Fxt) / self.ht\n\n    for k in range(i+1):\n        Hm[k, i] = np.dot(Av.T, Vm[:, k:k+1])\n\n    temp_vec = np.zeros((m, 1))\n\n    for k in range(i+1):\n        temp_vec = temp_vec + np.dot(Hm[k, i], Vm[:, k:k+1])\n\n    v_hat = Av - temp_vec\n\n    Hm[i+1, i] = np.linalg.norm(v_hat)\n\n    Vm[:,i+1:i+2] = v_hat/Hm[i+1, i]\n\ne = np.zeros((m+1, 1))\ne[0, 0] = 1.0\ngm = np.linalg.norm(r0) * e\n# print(gm)\n\nUTMat, gm = self.ToUTMat(Hm, gm, m)\n\nmin_y = np.zeros((m, 1))\n\nfor i in range(m):\n    min_y[i][0] = (gm[i, 0] - np.dot(UTMat[i:i+1 ,:] ,min_y))/UTMat[i, i]\n\ndU_new = self.dU + np.dot(Vm[:, 0:m], min_y).reshape(self.u_dim, self.pred_horizons, order='F')\n\nself.dU = dU_new\n\nU = U + self.dU * self.ht\n",[4896],{"type":18,"tag":626,"props":4897,"children":4898},{},[4899],{"type":18,"tag":618,"props":4900,"children":4901},{"__ignoreMap":8},[4902,4909,4948,5011,5018,5026,5067,5075,5101,5109,5116,5124,5154,5196,5204,5234,5242,5249,5256,5284,5309,5394,5402,5410,5418,5425,5465,5472,5518,5547,5554,5579,5586,5629,5667,5674,5700,5707,5736,5744,5809,5817,5854,5891,5918,5927,5935,5961,5969,5994,6002,6030,6095,6103,6178,6186,6207,6215],{"type":18,"tag":633,"props":4903,"children":4904},{"class":635,"line":636},[4905],{"type":18,"tag":633,"props":4906,"children":4907},{"class":1870},[4908],{"type":24,"value":4769},{"type":18,"tag":633,"props":4910,"children":4911},{"class":635,"line":663},[4912,4916,4920,4924,4928,4932,4936,4940,4944],{"type":18,"tag":633,"props":4913,"children":4914},{"class":646},[4915],{"type":24,"value":4777},{"type":18,"tag":633,"props":4917,"children":4918},{"class":640},[4919],{"type":24,"value":730},{"type":18,"tag":633,"props":4921,"children":4922},{"class":646},[4923],{"type":24,"value":4786},{"type":18,"tag":633,"props":4925,"children":4926},{"class":640},[4927],{"type":24,"value":1065},{"type":18,"tag":633,"props":4929,"children":4930},{"class":646},[4931],{"type":24,"value":4795},{"type":18,"tag":633,"props":4933,"children":4934},{"class":640},[4935],{"type":24,"value":1433},{"type":18,"tag":633,"props":4937,"children":4938},{"class":646},[4939],{"type":24,"value":649},{"type":18,"tag":633,"props":4941,"children":4942},{"class":690},[4943],{"type":24,"value":720},{"type":18,"tag":633,"props":4945,"children":4946},{"class":646},[4947],{"type":24,"value":2077},{"type":18,"tag":633,"props":4949,"children":4950},{"class":635,"line":672},[4951,4955,4959,4963,4967,4971,4975,4979,4983,4987,4991,4995,4999,5003,5007],{"type":18,"tag":633,"props":4952,"children":4953},{"class":646},[4954],{"type":24,"value":4819},{"type":18,"tag":633,"props":4956,"children":4957},{"class":640},[4958],{"type":24,"value":730},{"type":18,"tag":633,"props":4960,"children":4961},{"class":646},[4962],{"type":24,"value":649},{"type":18,"tag":633,"props":4964,"children":4965},{"class":640},[4966],{"type":24,"value":1065},{"type":18,"tag":633,"props":4968,"children":4969},{"class":690},[4970],{"type":24,"value":720},{"type":18,"tag":633,"props":4972,"children":4973},{"class":646},[4974],{"type":24,"value":2052},{"type":18,"tag":633,"props":4976,"children":4977},{"class":640},[4978],{"type":24,"value":1075},{"type":18,"tag":633,"props":4980,"children":4981},{"class":646},[4982],{"type":24,"value":4848},{"type":18,"tag":633,"props":4984,"children":4985},{"class":640},[4986],{"type":24,"value":1065},{"type":18,"tag":633,"props":4988,"children":4989},{"class":646},[4990],{"type":24,"value":4857},{"type":18,"tag":633,"props":4992,"children":4993},{"class":640},[4994],{"type":24,"value":1065},{"type":18,"tag":633,"props":4996,"children":4997},{"class":646},[4998],{"type":24,"value":4866},{"type":18,"tag":633,"props":5000,"children":5001},{"class":640},[5002],{"type":24,"value":1433},{"type":18,"tag":633,"props":5004,"children":5005},{"class":690},[5006],{"type":24,"value":720},{"type":18,"tag":633,"props":5008,"children":5009},{"class":646},[5010],{"type":24,"value":2077},{"type":18,"tag":633,"props":5012,"children":5013},{"class":635,"line":701},[5014],{"type":18,"tag":633,"props":5015,"children":5016},{},[5017],{"type":24,"value":669},{"type":18,"tag":633,"props":5019,"children":5020},{"class":635,"line":709},[5021],{"type":18,"tag":633,"props":5022,"children":5023},{"class":1870},[5024],{"type":24,"value":5025},"# Define iterations\n",{"type":18,"tag":633,"props":5027,"children":5028},{"class":635,"line":738},[5029,5034,5038,5042,5046,5051,5055,5059,5063],{"type":18,"tag":633,"props":5030,"children":5031},{"class":646},[5032],{"type":24,"value":5033},"m ",{"type":18,"tag":633,"props":5035,"children":5036},{"class":640},[5037],{"type":24,"value":730},{"type":18,"tag":633,"props":5039,"children":5040},{"class":646},[5041],{"type":24,"value":4443},{"type":18,"tag":633,"props":5043,"children":5044},{"class":690},[5045],{"type":24,"value":720},{"type":18,"tag":633,"props":5047,"children":5048},{"class":646},[5049],{"type":24,"value":5050},".u_dim ) ",{"type":18,"tag":633,"props":5052,"children":5053},{"class":640},[5054],{"type":24,"value":1075},{"type":18,"tag":633,"props":5056,"children":5057},{"class":646},[5058],{"type":24,"value":649},{"type":18,"tag":633,"props":5060,"children":5061},{"class":690},[5062],{"type":24,"value":720},{"type":18,"tag":633,"props":5064,"children":5065},{"class":646},[5066],{"type":24,"value":4495},{"type":18,"tag":633,"props":5068,"children":5069},{"class":635,"line":764},[5070],{"type":18,"tag":633,"props":5071,"children":5072},{"class":1870},[5073],{"type":24,"value":5074},"# Define r0\n",{"type":18,"tag":633,"props":5076,"children":5077},{"class":635,"line":790},[5078,5083,5087,5092,5096],{"type":18,"tag":633,"props":5079,"children":5080},{"class":646},[5081],{"type":24,"value":5082},"r0 ",{"type":18,"tag":633,"props":5084,"children":5085},{"class":640},[5086],{"type":24,"value":730},{"type":18,"tag":633,"props":5088,"children":5089},{"class":646},[5090],{"type":24,"value":5091}," right ",{"type":18,"tag":633,"props":5093,"children":5094},{"class":640},[5095],{"type":24,"value":1065},{"type":18,"tag":633,"props":5097,"children":5098},{"class":646},[5099],{"type":24,"value":5100}," left\n",{"type":18,"tag":633,"props":5102,"children":5103},{"class":635,"line":798},[5104],{"type":18,"tag":633,"props":5105,"children":5106},{"class":1870},[5107],{"type":24,"value":5108},"# print(r0)\n",{"type":18,"tag":633,"props":5110,"children":5111},{"class":635,"line":824},[5112],{"type":18,"tag":633,"props":5113,"children":5114},{},[5115],{"type":24,"value":669},{"type":18,"tag":633,"props":5117,"children":5118},{"class":635,"line":850},[5119],{"type":18,"tag":633,"props":5120,"children":5121},{"class":1870},[5122],{"type":24,"value":5123},"# GMRES\n",{"type":18,"tag":633,"props":5125,"children":5126},{"class":635,"line":858},[5127,5132,5136,5141,5145,5149],{"type":18,"tag":633,"props":5128,"children":5129},{"class":646},[5130],{"type":24,"value":5131},"Vm ",{"type":18,"tag":633,"props":5133,"children":5134},{"class":640},[5135],{"type":24,"value":730},{"type":18,"tag":633,"props":5137,"children":5138},{"class":646},[5139],{"type":24,"value":5140}," np.zeros((m, m",{"type":18,"tag":633,"props":5142,"children":5143},{"class":640},[5144],{"type":24,"value":1196},{"type":18,"tag":633,"props":5146,"children":5147},{"class":690},[5148],{"type":24,"value":996},{"type":18,"tag":633,"props":5150,"children":5151},{"class":646},[5152],{"type":24,"value":5153},"))\n",{"type":18,"tag":633,"props":5155,"children":5156},{"class":635,"line":894},[5157,5162,5166,5170,5174,5178,5182,5187,5191],{"type":18,"tag":633,"props":5158,"children":5159},{"class":646},[5160],{"type":24,"value":5161},"Vm[:, ",{"type":18,"tag":633,"props":5163,"children":5164},{"class":690},[5165],{"type":24,"value":886},{"type":18,"tag":633,"props":5167,"children":5168},{"class":646},[5169],{"type":24,"value":296},{"type":18,"tag":633,"props":5171,"children":5172},{"class":690},[5173],{"type":24,"value":996},{"type":18,"tag":633,"props":5175,"children":5176},{"class":646},[5177],{"type":24,"value":2930},{"type":18,"tag":633,"props":5179,"children":5180},{"class":640},[5181],{"type":24,"value":730},{"type":18,"tag":633,"props":5183,"children":5184},{"class":646},[5185],{"type":24,"value":5186}," r0 ",{"type":18,"tag":633,"props":5188,"children":5189},{"class":640},[5190],{"type":24,"value":1433},{"type":18,"tag":633,"props":5192,"children":5193},{"class":646},[5194],{"type":24,"value":5195}," np.linalg.norm(r0)\n",{"type":18,"tag":633,"props":5197,"children":5198},{"class":635,"line":927},[5199],{"type":18,"tag":633,"props":5200,"children":5201},{"class":1870},[5202],{"type":24,"value":5203},"# print(\"Vm\", Vm[:, 0])\n",{"type":18,"tag":633,"props":5205,"children":5206},{"class":635,"line":935},[5207,5212,5216,5221,5225,5229],{"type":18,"tag":633,"props":5208,"children":5209},{"class":646},[5210],{"type":24,"value":5211},"Hm ",{"type":18,"tag":633,"props":5213,"children":5214},{"class":640},[5215],{"type":24,"value":730},{"type":18,"tag":633,"props":5217,"children":5218},{"class":646},[5219],{"type":24,"value":5220}," np.zeros((m",{"type":18,"tag":633,"props":5222,"children":5223},{"class":640},[5224],{"type":24,"value":1196},{"type":18,"tag":633,"props":5226,"children":5227},{"class":690},[5228],{"type":24,"value":996},{"type":18,"tag":633,"props":5230,"children":5231},{"class":646},[5232],{"type":24,"value":5233},", m))\n",{"type":18,"tag":633,"props":5235,"children":5236},{"class":635,"line":969},[5237],{"type":18,"tag":633,"props":5238,"children":5239},{"class":1870},[5240],{"type":24,"value":5241},"# print(Vm[:, 0])\n",{"type":18,"tag":633,"props":5243,"children":5244},{"class":635,"line":1003},[5245],{"type":18,"tag":633,"props":5246,"children":5247},{},[5248],{"type":24,"value":669},{"type":18,"tag":633,"props":5250,"children":5251},{"class":635,"line":1011},[5252],{"type":18,"tag":633,"props":5253,"children":5254},{},[5255],{"type":24,"value":669},{"type":18,"tag":633,"props":5257,"children":5258},{"class":635,"line":1037},[5259,5263,5267,5271,5275,5279],{"type":18,"tag":633,"props":5260,"children":5261},{"class":640},[5262],{"type":24,"value":2809},{"type":18,"tag":633,"props":5264,"children":5265},{"class":646},[5266],{"type":24,"value":2814},{"type":18,"tag":633,"props":5268,"children":5269},{"class":640},[5270],{"type":24,"value":2819},{"type":18,"tag":633,"props":5272,"children":5273},{"class":646},[5274],{"type":24,"value":649},{"type":18,"tag":633,"props":5276,"children":5277},{"class":690},[5278],{"type":24,"value":2828},{"type":18,"tag":633,"props":5280,"children":5281},{"class":646},[5282],{"type":24,"value":5283},"(m):\n",{"type":18,"tag":633,"props":5285,"children":5286},{"class":635,"line":1045},[5287,5292,5296,5300,5304],{"type":18,"tag":633,"props":5288,"children":5289},{"class":646},[5290],{"type":24,"value":5291},"    Fuxt ",{"type":18,"tag":633,"props":5293,"children":5294},{"class":640},[5295],{"type":24,"value":730},{"type":18,"tag":633,"props":5297,"children":5298},{"class":646},[5299],{"type":24,"value":649},{"type":18,"tag":633,"props":5301,"children":5302},{"class":690},[5303],{"type":24,"value":720},{"type":18,"tag":633,"props":5305,"children":5306},{"class":646},[5307],{"type":24,"value":5308},".calc_f(\n",{"type":18,"tag":633,"props":5310,"children":5311},{"class":635,"line":1087},[5312,5317,5321,5326,5330,5334,5339,5343,5347,5351,5356,5362,5366,5372,5377,5381,5385,5389],{"type":18,"tag":633,"props":5313,"children":5314},{"class":646},[5315],{"type":24,"value":5316},"        X, U ",{"type":18,"tag":633,"props":5318,"children":5319},{"class":640},[5320],{"type":24,"value":1196},{"type":18,"tag":633,"props":5322,"children":5323},{"class":646},[5324],{"type":24,"value":5325}," Vm[:, i:i",{"type":18,"tag":633,"props":5327,"children":5328},{"class":640},[5329],{"type":24,"value":1196},{"type":18,"tag":633,"props":5331,"children":5332},{"class":690},[5333],{"type":24,"value":996},{"type":18,"tag":633,"props":5335,"children":5336},{"class":646},[5337],{"type":24,"value":5338},"].reshape(",{"type":18,"tag":633,"props":5340,"children":5341},{"class":690},[5342],{"type":24,"value":720},{"type":18,"tag":633,"props":5344,"children":5345},{"class":646},[5346],{"type":24,"value":2497},{"type":18,"tag":633,"props":5348,"children":5349},{"class":690},[5350],{"type":24,"value":720},{"type":18,"tag":633,"props":5352,"children":5353},{"class":646},[5354],{"type":24,"value":5355},".pred_horizons, ",{"type":18,"tag":633,"props":5357,"children":5359},{"class":5358},"ct-657843",[5360],{"type":24,"value":5361},"order",{"type":18,"tag":633,"props":5363,"children":5364},{"class":640},[5365],{"type":24,"value":730},{"type":18,"tag":633,"props":5367,"children":5369},{"class":5368},"ct-244866",[5370],{"type":24,"value":5371},"'F'",{"type":18,"tag":633,"props":5373,"children":5374},{"class":646},[5375],{"type":24,"value":5376},") ",{"type":18,"tag":633,"props":5378,"children":5379},{"class":640},[5380],{"type":24,"value":1075},{"type":18,"tag":633,"props":5382,"children":5383},{"class":646},[5384],{"type":24,"value":649},{"type":18,"tag":633,"props":5386,"children":5387},{"class":690},[5388],{"type":24,"value":720},{"type":18,"tag":633,"props":5390,"children":5391},{"class":646},[5392],{"type":24,"value":5393},".ht,\n",{"type":18,"tag":633,"props":5395,"children":5396},{"class":635,"line":1127},[5397],{"type":18,"tag":633,"props":5398,"children":5399},{"class":646},[5400],{"type":24,"value":5401},"        Lambda, Mu,\n",{"type":18,"tag":633,"props":5403,"children":5404},{"class":635,"line":1221},[5405],{"type":18,"tag":633,"props":5406,"children":5407},{"class":646},[5408],{"type":24,"value":5409},"        dt\n",{"type":18,"tag":633,"props":5411,"children":5412},{"class":635,"line":1229},[5413],{"type":18,"tag":633,"props":5414,"children":5415},{"class":646},[5416],{"type":24,"value":5417},"    )\n",{"type":18,"tag":633,"props":5419,"children":5420},{"class":635,"line":1247},[5421],{"type":18,"tag":633,"props":5422,"children":5423},{},[5424],{"type":24,"value":669},{"type":18,"tag":633,"props":5426,"children":5427},{"class":635,"line":1255},[5428,5433,5437,5441,5445,5449,5453,5457,5461],{"type":18,"tag":633,"props":5429,"children":5430},{"class":646},[5431],{"type":24,"value":5432},"    Av ",{"type":18,"tag":633,"props":5434,"children":5435},{"class":640},[5436],{"type":24,"value":730},{"type":18,"tag":633,"props":5438,"children":5439},{"class":646},[5440],{"type":24,"value":4786},{"type":18,"tag":633,"props":5442,"children":5443},{"class":640},[5444],{"type":24,"value":1065},{"type":18,"tag":633,"props":5446,"children":5447},{"class":646},[5448],{"type":24,"value":4795},{"type":18,"tag":633,"props":5450,"children":5451},{"class":640},[5452],{"type":24,"value":1433},{"type":18,"tag":633,"props":5454,"children":5455},{"class":646},[5456],{"type":24,"value":649},{"type":18,"tag":633,"props":5458,"children":5459},{"class":690},[5460],{"type":24,"value":720},{"type":18,"tag":633,"props":5462,"children":5463},{"class":646},[5464],{"type":24,"value":2077},{"type":18,"tag":633,"props":5466,"children":5467},{"class":635,"line":1281},[5468],{"type":18,"tag":633,"props":5469,"children":5470},{},[5471],{"type":24,"value":669},{"type":18,"tag":633,"props":5473,"children":5474},{"class":635,"line":1289},[5475,5479,5483,5488,5492,5496,5500,5505,5509,5513],{"type":18,"tag":633,"props":5476,"children":5477},{"class":646},[5478],{"type":24,"value":678},{"type":18,"tag":633,"props":5480,"children":5481},{"class":640},[5482],{"type":24,"value":2809},{"type":18,"tag":633,"props":5484,"children":5485},{"class":646},[5486],{"type":24,"value":5487}," k ",{"type":18,"tag":633,"props":5489,"children":5490},{"class":640},[5491],{"type":24,"value":2819},{"type":18,"tag":633,"props":5493,"children":5494},{"class":646},[5495],{"type":24,"value":649},{"type":18,"tag":633,"props":5497,"children":5498},{"class":690},[5499],{"type":24,"value":2828},{"type":18,"tag":633,"props":5501,"children":5502},{"class":646},[5503],{"type":24,"value":5504},"(i",{"type":18,"tag":633,"props":5506,"children":5507},{"class":640},[5508],{"type":24,"value":1196},{"type":18,"tag":633,"props":5510,"children":5511},{"class":690},[5512],{"type":24,"value":996},{"type":18,"tag":633,"props":5514,"children":5515},{"class":646},[5516],{"type":24,"value":5517},"):\n",{"type":18,"tag":633,"props":5519,"children":5520},{"class":635,"line":1445},[5521,5526,5530,5535,5539,5543],{"type":18,"tag":633,"props":5522,"children":5523},{"class":646},[5524],{"type":24,"value":5525},"        Hm[k, i] ",{"type":18,"tag":633,"props":5527,"children":5528},{"class":640},[5529],{"type":24,"value":730},{"type":18,"tag":633,"props":5531,"children":5532},{"class":646},[5533],{"type":24,"value":5534}," np.dot(Av.T, Vm[:, k:k",{"type":18,"tag":633,"props":5536,"children":5537},{"class":640},[5538],{"type":24,"value":1196},{"type":18,"tag":633,"props":5540,"children":5541},{"class":690},[5542],{"type":24,"value":996},{"type":18,"tag":633,"props":5544,"children":5545},{"class":646},[5546],{"type":24,"value":3299},{"type":18,"tag":633,"props":5548,"children":5549},{"class":635,"line":1565},[5550],{"type":18,"tag":633,"props":5551,"children":5552},{},[5553],{"type":24,"value":669},{"type":18,"tag":633,"props":5555,"children":5556},{"class":635,"line":1573},[5557,5562,5566,5571,5575],{"type":18,"tag":633,"props":5558,"children":5559},{"class":646},[5560],{"type":24,"value":5561},"    temp_vec ",{"type":18,"tag":633,"props":5563,"children":5564},{"class":640},[5565],{"type":24,"value":730},{"type":18,"tag":633,"props":5567,"children":5568},{"class":646},[5569],{"type":24,"value":5570}," np.zeros((m, ",{"type":18,"tag":633,"props":5572,"children":5573},{"class":690},[5574],{"type":24,"value":996},{"type":18,"tag":633,"props":5576,"children":5577},{"class":646},[5578],{"type":24,"value":5153},{"type":18,"tag":633,"props":5580,"children":5581},{"class":635,"line":1590},[5582],{"type":18,"tag":633,"props":5583,"children":5584},{},[5585],{"type":24,"value":669},{"type":18,"tag":633,"props":5587,"children":5588},{"class":635,"line":1598},[5589,5593,5597,5601,5605,5609,5613,5617,5621,5625],{"type":18,"tag":633,"props":5590,"children":5591},{"class":646},[5592],{"type":24,"value":678},{"type":18,"tag":633,"props":5594,"children":5595},{"class":640},[5596],{"type":24,"value":2809},{"type":18,"tag":633,"props":5598,"children":5599},{"class":646},[5600],{"type":24,"value":5487},{"type":18,"tag":633,"props":5602,"children":5603},{"class":640},[5604],{"type":24,"value":2819},{"type":18,"tag":633,"props":5606,"children":5607},{"class":646},[5608],{"type":24,"value":649},{"type":18,"tag":633,"props":5610,"children":5611},{"class":690},[5612],{"type":24,"value":2828},{"type":18,"tag":633,"props":5614,"children":5615},{"class":646},[5616],{"type":24,"value":5504},{"type":18,"tag":633,"props":5618,"children":5619},{"class":640},[5620],{"type":24,"value":1196},{"type":18,"tag":633,"props":5622,"children":5623},{"class":690},[5624],{"type":24,"value":996},{"type":18,"tag":633,"props":5626,"children":5627},{"class":646},[5628],{"type":24,"value":5517},{"type":18,"tag":633,"props":5630,"children":5631},{"class":635,"line":1624},[5632,5637,5641,5646,5650,5655,5659,5663],{"type":18,"tag":633,"props":5633,"children":5634},{"class":646},[5635],{"type":24,"value":5636},"        temp_vec ",{"type":18,"tag":633,"props":5638,"children":5639},{"class":640},[5640],{"type":24,"value":730},{"type":18,"tag":633,"props":5642,"children":5643},{"class":646},[5644],{"type":24,"value":5645}," temp_vec ",{"type":18,"tag":633,"props":5647,"children":5648},{"class":640},[5649],{"type":24,"value":1196},{"type":18,"tag":633,"props":5651,"children":5652},{"class":646},[5653],{"type":24,"value":5654}," np.dot(Hm[k, i], Vm[:, k:k",{"type":18,"tag":633,"props":5656,"children":5657},{"class":640},[5658],{"type":24,"value":1196},{"type":18,"tag":633,"props":5660,"children":5661},{"class":690},[5662],{"type":24,"value":996},{"type":18,"tag":633,"props":5664,"children":5665},{"class":646},[5666],{"type":24,"value":3299},{"type":18,"tag":633,"props":5668,"children":5669},{"class":635,"line":1668},[5670],{"type":18,"tag":633,"props":5671,"children":5672},{},[5673],{"type":24,"value":669},{"type":18,"tag":633,"props":5675,"children":5676},{"class":635,"line":1712},[5677,5682,5686,5691,5695],{"type":18,"tag":633,"props":5678,"children":5679},{"class":646},[5680],{"type":24,"value":5681},"    v_hat ",{"type":18,"tag":633,"props":5683,"children":5684},{"class":640},[5685],{"type":24,"value":730},{"type":18,"tag":633,"props":5687,"children":5688},{"class":646},[5689],{"type":24,"value":5690}," Av ",{"type":18,"tag":633,"props":5692,"children":5693},{"class":640},[5694],{"type":24,"value":1065},{"type":18,"tag":633,"props":5696,"children":5697},{"class":646},[5698],{"type":24,"value":5699}," temp_vec\n",{"type":18,"tag":633,"props":5701,"children":5702},{"class":635,"line":1755},[5703],{"type":18,"tag":633,"props":5704,"children":5705},{},[5706],{"type":24,"value":669},{"type":18,"tag":633,"props":5708,"children":5709},{"class":635,"line":1763},[5710,5715,5719,5723,5727,5731],{"type":18,"tag":633,"props":5711,"children":5712},{"class":646},[5713],{"type":24,"value":5714},"    Hm[i",{"type":18,"tag":633,"props":5716,"children":5717},{"class":640},[5718],{"type":24,"value":1196},{"type":18,"tag":633,"props":5720,"children":5721},{"class":690},[5722],{"type":24,"value":996},{"type":18,"tag":633,"props":5724,"children":5725},{"class":646},[5726],{"type":24,"value":2948},{"type":18,"tag":633,"props":5728,"children":5729},{"class":640},[5730],{"type":24,"value":730},{"type":18,"tag":633,"props":5732,"children":5733},{"class":646},[5734],{"type":24,"value":5735}," np.linalg.norm(v_hat)\n",{"type":18,"tag":633,"props":5737,"children":5739},{"class":635,"line":5738},39,[5740],{"type":18,"tag":633,"props":5741,"children":5742},{},[5743],{"type":24,"value":669},{"type":18,"tag":633,"props":5745,"children":5747},{"class":635,"line":5746},40,[5748,5753,5757,5761,5766,5770,5774,5778,5782,5787,5791,5796,5800,5804],{"type":18,"tag":633,"props":5749,"children":5750},{"class":646},[5751],{"type":24,"value":5752},"    Vm[:,i",{"type":18,"tag":633,"props":5754,"children":5755},{"class":640},[5756],{"type":24,"value":1196},{"type":18,"tag":633,"props":5758,"children":5759},{"class":690},[5760],{"type":24,"value":996},{"type":18,"tag":633,"props":5762,"children":5763},{"class":646},[5764],{"type":24,"value":5765},":i",{"type":18,"tag":633,"props":5767,"children":5768},{"class":640},[5769],{"type":24,"value":1196},{"type":18,"tag":633,"props":5771,"children":5772},{"class":690},[5773],{"type":24,"value":1372},{"type":18,"tag":633,"props":5775,"children":5776},{"class":646},[5777],{"type":24,"value":2930},{"type":18,"tag":633,"props":5779,"children":5780},{"class":640},[5781],{"type":24,"value":730},{"type":18,"tag":633,"props":5783,"children":5784},{"class":646},[5785],{"type":24,"value":5786}," v_hat",{"type":18,"tag":633,"props":5788,"children":5789},{"class":640},[5790],{"type":24,"value":1433},{"type":18,"tag":633,"props":5792,"children":5793},{"class":646},[5794],{"type":24,"value":5795},"Hm[i",{"type":18,"tag":633,"props":5797,"children":5798},{"class":640},[5799],{"type":24,"value":1196},{"type":18,"tag":633,"props":5801,"children":5802},{"class":690},[5803],{"type":24,"value":996},{"type":18,"tag":633,"props":5805,"children":5806},{"class":646},[5807],{"type":24,"value":5808},", i]\n",{"type":18,"tag":633,"props":5810,"children":5812},{"class":635,"line":5811},41,[5813],{"type":18,"tag":633,"props":5814,"children":5815},{},[5816],{"type":24,"value":669},{"type":18,"tag":633,"props":5818,"children":5820},{"class":635,"line":5819},42,[5821,5826,5830,5834,5838,5842,5846,5850],{"type":18,"tag":633,"props":5822,"children":5823},{"class":646},[5824],{"type":24,"value":5825},"e ",{"type":18,"tag":633,"props":5827,"children":5828},{"class":640},[5829],{"type":24,"value":730},{"type":18,"tag":633,"props":5831,"children":5832},{"class":646},[5833],{"type":24,"value":5220},{"type":18,"tag":633,"props":5835,"children":5836},{"class":640},[5837],{"type":24,"value":1196},{"type":18,"tag":633,"props":5839,"children":5840},{"class":690},[5841],{"type":24,"value":996},{"type":18,"tag":633,"props":5843,"children":5844},{"class":646},[5845],{"type":24,"value":2436},{"type":18,"tag":633,"props":5847,"children":5848},{"class":690},[5849],{"type":24,"value":996},{"type":18,"tag":633,"props":5851,"children":5852},{"class":646},[5853],{"type":24,"value":5153},{"type":18,"tag":633,"props":5855,"children":5857},{"class":635,"line":5856},43,[5858,5863,5867,5871,5875,5879,5883,5887],{"type":18,"tag":633,"props":5859,"children":5860},{"class":646},[5861],{"type":24,"value":5862},"e[",{"type":18,"tag":633,"props":5864,"children":5865},{"class":690},[5866],{"type":24,"value":886},{"type":18,"tag":633,"props":5868,"children":5869},{"class":646},[5870],{"type":24,"value":2436},{"type":18,"tag":633,"props":5872,"children":5873},{"class":690},[5874],{"type":24,"value":886},{"type":18,"tag":633,"props":5876,"children":5877},{"class":646},[5878],{"type":24,"value":2930},{"type":18,"tag":633,"props":5880,"children":5881},{"class":640},[5882],{"type":24,"value":730},{"type":18,"tag":633,"props":5884,"children":5885},{"class":646},[5886],{"type":24,"value":649},{"type":18,"tag":633,"props":5888,"children":5889},{"class":690},[5890],{"type":24,"value":2135},{"type":18,"tag":633,"props":5892,"children":5894},{"class":635,"line":5893},44,[5895,5900,5904,5909,5913],{"type":18,"tag":633,"props":5896,"children":5897},{"class":646},[5898],{"type":24,"value":5899},"gm ",{"type":18,"tag":633,"props":5901,"children":5902},{"class":640},[5903],{"type":24,"value":730},{"type":18,"tag":633,"props":5905,"children":5906},{"class":646},[5907],{"type":24,"value":5908}," np.linalg.norm(r0) ",{"type":18,"tag":633,"props":5910,"children":5911},{"class":640},[5912],{"type":24,"value":1075},{"type":18,"tag":633,"props":5914,"children":5915},{"class":646},[5916],{"type":24,"value":5917}," e\n",{"type":18,"tag":633,"props":5919,"children":5921},{"class":635,"line":5920},45,[5922],{"type":18,"tag":633,"props":5923,"children":5924},{"class":1870},[5925],{"type":24,"value":5926},"# print(gm)\n",{"type":18,"tag":633,"props":5928,"children":5930},{"class":635,"line":5929},46,[5931],{"type":18,"tag":633,"props":5932,"children":5933},{},[5934],{"type":24,"value":669},{"type":18,"tag":633,"props":5936,"children":5938},{"class":635,"line":5937},47,[5939,5944,5948,5952,5956],{"type":18,"tag":633,"props":5940,"children":5941},{"class":646},[5942],{"type":24,"value":5943},"UTMat, gm ",{"type":18,"tag":633,"props":5945,"children":5946},{"class":640},[5947],{"type":24,"value":730},{"type":18,"tag":633,"props":5949,"children":5950},{"class":646},[5951],{"type":24,"value":649},{"type":18,"tag":633,"props":5953,"children":5954},{"class":690},[5955],{"type":24,"value":720},{"type":18,"tag":633,"props":5957,"children":5958},{"class":646},[5959],{"type":24,"value":5960},".ToUTMat(Hm, gm, m)\n",{"type":18,"tag":633,"props":5962,"children":5964},{"class":635,"line":5963},48,[5965],{"type":18,"tag":633,"props":5966,"children":5967},{},[5968],{"type":24,"value":669},{"type":18,"tag":633,"props":5970,"children":5972},{"class":635,"line":5971},49,[5973,5978,5982,5986,5990],{"type":18,"tag":633,"props":5974,"children":5975},{"class":646},[5976],{"type":24,"value":5977},"min_y ",{"type":18,"tag":633,"props":5979,"children":5980},{"class":640},[5981],{"type":24,"value":730},{"type":18,"tag":633,"props":5983,"children":5984},{"class":646},[5985],{"type":24,"value":5570},{"type":18,"tag":633,"props":5987,"children":5988},{"class":690},[5989],{"type":24,"value":996},{"type":18,"tag":633,"props":5991,"children":5992},{"class":646},[5993],{"type":24,"value":5153},{"type":18,"tag":633,"props":5995,"children":5997},{"class":635,"line":5996},50,[5998],{"type":18,"tag":633,"props":5999,"children":6000},{},[6001],{"type":24,"value":669},{"type":18,"tag":633,"props":6003,"children":6005},{"class":635,"line":6004},51,[6006,6010,6014,6018,6022,6026],{"type":18,"tag":633,"props":6007,"children":6008},{"class":640},[6009],{"type":24,"value":2809},{"type":18,"tag":633,"props":6011,"children":6012},{"class":646},[6013],{"type":24,"value":2814},{"type":18,"tag":633,"props":6015,"children":6016},{"class":640},[6017],{"type":24,"value":2819},{"type":18,"tag":633,"props":6019,"children":6020},{"class":646},[6021],{"type":24,"value":649},{"type":18,"tag":633,"props":6023,"children":6024},{"class":690},[6025],{"type":24,"value":2828},{"type":18,"tag":633,"props":6027,"children":6028},{"class":646},[6029],{"type":24,"value":5283},{"type":18,"tag":633,"props":6031,"children":6033},{"class":635,"line":6032},52,[6034,6039,6043,6047,6051,6056,6060,6064,6068,6073,6077,6081,6086,6090],{"type":18,"tag":633,"props":6035,"children":6036},{"class":646},[6037],{"type":24,"value":6038},"    min_y[i][",{"type":18,"tag":633,"props":6040,"children":6041},{"class":690},[6042],{"type":24,"value":886},{"type":18,"tag":633,"props":6044,"children":6045},{"class":646},[6046],{"type":24,"value":2930},{"type":18,"tag":633,"props":6048,"children":6049},{"class":640},[6050],{"type":24,"value":730},{"type":18,"tag":633,"props":6052,"children":6053},{"class":646},[6054],{"type":24,"value":6055}," (gm[i, ",{"type":18,"tag":633,"props":6057,"children":6058},{"class":690},[6059],{"type":24,"value":886},{"type":18,"tag":633,"props":6061,"children":6062},{"class":646},[6063],{"type":24,"value":2930},{"type":18,"tag":633,"props":6065,"children":6066},{"class":640},[6067],{"type":24,"value":1065},{"type":18,"tag":633,"props":6069,"children":6070},{"class":646},[6071],{"type":24,"value":6072}," np.dot(UTMat[i:i",{"type":18,"tag":633,"props":6074,"children":6075},{"class":640},[6076],{"type":24,"value":1196},{"type":18,"tag":633,"props":6078,"children":6079},{"class":690},[6080],{"type":24,"value":996},{"type":18,"tag":633,"props":6082,"children":6083},{"class":646},[6084],{"type":24,"value":6085}," ,:] ,min_y))",{"type":18,"tag":633,"props":6087,"children":6088},{"class":640},[6089],{"type":24,"value":1433},{"type":18,"tag":633,"props":6091,"children":6092},{"class":646},[6093],{"type":24,"value":6094},"UTMat[i, i]\n",{"type":18,"tag":633,"props":6096,"children":6098},{"class":635,"line":6097},53,[6099],{"type":18,"tag":633,"props":6100,"children":6101},{},[6102],{"type":24,"value":669},{"type":18,"tag":633,"props":6104,"children":6106},{"class":635,"line":6105},54,[6107,6112,6116,6120,6124,6128,6132,6137,6141,6146,6150,6154,6158,6162,6166,6170,6174],{"type":18,"tag":633,"props":6108,"children":6109},{"class":646},[6110],{"type":24,"value":6111},"dU_new ",{"type":18,"tag":633,"props":6113,"children":6114},{"class":640},[6115],{"type":24,"value":730},{"type":18,"tag":633,"props":6117,"children":6118},{"class":646},[6119],{"type":24,"value":649},{"type":18,"tag":633,"props":6121,"children":6122},{"class":690},[6123],{"type":24,"value":720},{"type":18,"tag":633,"props":6125,"children":6126},{"class":646},[6127],{"type":24,"value":2479},{"type":18,"tag":633,"props":6129,"children":6130},{"class":640},[6131],{"type":24,"value":1196},{"type":18,"tag":633,"props":6133,"children":6134},{"class":646},[6135],{"type":24,"value":6136}," np.dot(Vm[:, ",{"type":18,"tag":633,"props":6138,"children":6139},{"class":690},[6140],{"type":24,"value":886},{"type":18,"tag":633,"props":6142,"children":6143},{"class":646},[6144],{"type":24,"value":6145},":m], min_y).reshape(",{"type":18,"tag":633,"props":6147,"children":6148},{"class":690},[6149],{"type":24,"value":720},{"type":18,"tag":633,"props":6151,"children":6152},{"class":646},[6153],{"type":24,"value":2497},{"type":18,"tag":633,"props":6155,"children":6156},{"class":690},[6157],{"type":24,"value":720},{"type":18,"tag":633,"props":6159,"children":6160},{"class":646},[6161],{"type":24,"value":5355},{"type":18,"tag":633,"props":6163,"children":6164},{"class":5358},[6165],{"type":24,"value":5361},{"type":18,"tag":633,"props":6167,"children":6168},{"class":640},[6169],{"type":24,"value":730},{"type":18,"tag":633,"props":6171,"children":6172},{"class":5368},[6173],{"type":24,"value":5371},{"type":18,"tag":633,"props":6175,"children":6176},{"class":646},[6177],{"type":24,"value":1442},{"type":18,"tag":633,"props":6179,"children":6181},{"class":635,"line":6180},55,[6182],{"type":18,"tag":633,"props":6183,"children":6184},{},[6185],{"type":24,"value":669},{"type":18,"tag":633,"props":6187,"children":6189},{"class":635,"line":6188},56,[6190,6194,6198,6202],{"type":18,"tag":633,"props":6191,"children":6192},{"class":690},[6193],{"type":24,"value":720},{"type":18,"tag":633,"props":6195,"children":6196},{"class":646},[6197],{"type":24,"value":2479},{"type":18,"tag":633,"props":6199,"children":6200},{"class":640},[6201],{"type":24,"value":730},{"type":18,"tag":633,"props":6203,"children":6204},{"class":646},[6205],{"type":24,"value":6206}," dU_new\n",{"type":18,"tag":633,"props":6208,"children":6210},{"class":635,"line":6209},57,[6211],{"type":18,"tag":633,"props":6212,"children":6213},{},[6214],{"type":24,"value":669},{"type":18,"tag":633,"props":6216,"children":6218},{"class":635,"line":6217},58,[6219,6223,6227,6232,6236,6240,6244,6248,6252,6256,6260],{"type":18,"tag":633,"props":6220,"children":6221},{"class":646},[6222],{"type":24,"value":2675},{"type":18,"tag":633,"props":6224,"children":6225},{"class":640},[6226],{"type":24,"value":730},{"type":18,"tag":633,"props":6228,"children":6229},{"class":646},[6230],{"type":24,"value":6231}," U ",{"type":18,"tag":633,"props":6233,"children":6234},{"class":640},[6235],{"type":24,"value":1196},{"type":18,"tag":633,"props":6237,"children":6238},{"class":646},[6239],{"type":24,"value":649},{"type":18,"tag":633,"props":6241,"children":6242},{"class":690},[6243],{"type":24,"value":720},{"type":18,"tag":633,"props":6245,"children":6246},{"class":646},[6247],{"type":24,"value":2479},{"type":18,"tag":633,"props":6249,"children":6250},{"class":640},[6251],{"type":24,"value":1075},{"type":18,"tag":633,"props":6253,"children":6254},{"class":646},[6255],{"type":24,"value":649},{"type":18,"tag":633,"props":6257,"children":6258},{"class":690},[6259],{"type":24,"value":720},{"type":18,"tag":633,"props":6261,"children":6262},{"class":646},[6263],{"type":24,"value":4879},{"type":18,"tag":27,"props":6265,"children":6266},{},[6267,6269,6274],{"type":24,"value":6268},"You can look in my code inside function ",{"type":18,"tag":170,"props":6270,"children":6271},{},[6272],{"type":24,"value":6273}," solve_nmpc ",{"type":24,"value":197},{"type":18,"tag":19,"props":6276,"children":6278},{"id":6277},"experiment-in-python",[6279],{"type":24,"value":6280},"Experiment in Python",{"type":18,"tag":27,"props":6282,"children":6283},{},[6284,6286,6289,6291,6294,6296,6300,6302,6306,6308,6312],{"type":24,"value":6285},"GMRES was consider one of the fastest solver for sparse linear algebra problem, so I will include the link for the GMRES algorithms. ",{"type":18,"tag":56,"props":6287,"children":6288},{},[],{"type":24,"value":6290},"\nIn my experiment, I use differential drive robot. ",{"type":18,"tag":56,"props":6292,"children":6293},{},[],{"type":24,"value":6295},"\nConsider as our state representation ",{"type":18,"tag":84,"props":6297,"children":6299},{"latex-express":6298,"styles":87}," x = \\begin{bmatrix} x \\\\ y \\\\ \\phi \\end{bmatrix} ",[],{"type":24,"value":6301}," and of course setting initialization ",{"type":18,"tag":84,"props":6303,"children":6305},{"latex-express":6304,"styles":87}," x_{0} = [0.0, 0.0, 0.0] ",[],{"type":24,"value":6307},", also ",{"type":18,"tag":84,"props":6309,"children":6311},{"latex-express":6310,"styles":87}," u_{0} = [0.0, 0.0] ",[],{"type":24,"value":197},{"type":18,"tag":6314,"props":6315,"children":6320},"figure",{"className":6316},[6317,6318,6319],"mb-4","inline-block","max-w-sm",[6321,6323],{"type":24,"value":6322},"\n  ",{"type":18,"tag":6324,"props":6325,"children":6331},"img",{"className":6326,"src":6328,"width":6329,"height":6330},[6327],"mx-auto","/topics/robotics/nmpc/nmpc_cgmres.gif",700,350,[],{"type":18,"tag":6333,"props":6334,"children":6339},"figcaption",{"className":6335},[68,6336,6337,6338],"text-sm","text-neutral-600","dark:text-neutral-400",[6340],{"type":24,"value":6341},"\n    Animation of Differential Drive robot on optimal trajectory !!!\n",{"type":18,"tag":27,"props":6343,"children":6344},{},[6345],{"type":24,"value":6346},"And here are the optimal data for all state and input control.",{"type":18,"tag":6314,"props":6348,"children":6350},{"className":6349},[6317,6318,6319],[6351,6352],{"type":24,"value":6322},{"type":18,"tag":6324,"props":6353,"children":6358},{"className":6354,"src":6355,"width":6356,"height":6357},[6327],"/topics/robotics/nmpc/cgmreDat1.png",600,300,[],{"type":18,"tag":6333,"props":6360,"children":6362},{"className":6361},[68,6336,6337,6338],[6363],{"type":24,"value":6364},"\n    All data obtained after simulation.\n",{"type":18,"tag":27,"props":6366,"children":6367},{},[6368,6370],{"type":24,"value":6369},"You can find all the code of NMPC even with CasAdi and CGMRES here in my github: ",{"type":18,"tag":6371,"props":6372,"children":6376},"a",{"href":6373,"rel":6374},"https://github.com/SokhengDin/Path-Tracking/tree/main",[6375],"nofollow",[6377],{"type":24,"value":6378},"Path-Tracking",{"type":18,"tag":19,"props":6380,"children":6382},{"id":6381},"in-conclusion",[6383],{"type":24,"value":6384},"In Conclusion",{"type":18,"tag":27,"props":6386,"children":6387},{},[6388],{"type":24,"value":6389},"Nonlinear Model Predictive Control with CGMRES is one of the great NMPC method that you should try, since it provides a very fast numerical calculation thank to the GMRES algorithms with Given Rotation method. Even though compare to another NMPC solver, NMPC with CGMRES sometime is hard for finding the optimal parameters in order to not cause unstable numerical calculation. Next time, I will bring the multiple shooting method which is consider in the promise of more robust numerical stability tha single shooting method.",{"type":18,"tag":19,"props":6391,"children":6393},{"id":6392},"references",[6394],{"type":24,"value":6395},"References",{"type":18,"tag":284,"props":6397,"children":6398},{},[6399,6409,6419,6429,6439],{"type":18,"tag":80,"props":6400,"children":6401},{},[6402],{"type":18,"tag":6371,"props":6403,"children":6406},{"href":6404,"rel":6405},"https://www.researchgate.net/publication/228007717_A_real-time_algorithm_for_nonlinear_receding_horizon_control_using_multiple_shooting_and_continuationKrylov_method",[6375],[6407],{"type":24,"value":6408},"A realtime algorithm for nonlinear receding horizon control using multiple shooting and continuation/Krylov method",{"type":18,"tag":80,"props":6410,"children":6411},{},[6412],{"type":18,"tag":6371,"props":6413,"children":6416},{"href":6414,"rel":6415},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathTracking/cgmres_nmpc",[6375],[6417],{"type":24,"value":6418},"Nonlinear Model Predictive Control with CGMRES of Steering Car ",{"type":18,"tag":80,"props":6420,"children":6421},{},[6422],{"type":18,"tag":6371,"props":6423,"children":6426},{"href":6424,"rel":6425},"https://qiita.com/PozihameBaystar/items/650cc839da5d9c974f5d",[6375],[6427],{"type":24,"value":6428},"C/GMRES3",{"type":18,"tag":80,"props":6430,"children":6431},{},[6432],{"type":18,"tag":6371,"props":6433,"children":6436},{"href":6434,"rel":6435},"https://qiita.com/opticont/items/b3518b470d9e327144be",[6375],[6437],{"type":24,"value":6438},"KrylovGMRES",{"type":18,"tag":80,"props":6440,"children":6441},{},[6442],{"type":18,"tag":6371,"props":6443,"children":6446},{"href":6444,"rel":6445},"https://www.sciencedirect.com/science/article/pii/S2405896318326727",[6375],[6447],{"type":24,"value":6448},"Nonlinear Model Predictive Control of Position and Attitude in a Hexacopter with Three Failed Rotors",{"type":18,"tag":6450,"children":6451},"style",[6452],{"type":24,"value":6453},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-657843{color:#FFAB70;}\n.ct-244866{color:#9ECBFF;}",{"title":8,"searchDepth":663,"depth":663,"links":6455},[6456,6462,6463,6464,6465],{"id":21,"depth":663,"text":25,"children":6457},[6458,6459,6460,6461],{"id":35,"depth":672,"text":38},{"id":46,"depth":672,"text":49},{"id":229,"depth":672,"text":232},{"id":267,"depth":672,"text":270},{"id":593,"depth":663,"text":596},{"id":6277,"depth":663,"text":6280},{"id":6381,"depth":663,"text":6384},{"id":6392,"depth":663,"text":6395},"markdown","content:topics:robotics:nmpc-cgmres.md","content","topics/robotics/nmpc-cgmres.md","md",{"_path":6472,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":6473,"description":6474,"author":11,"slug":6475,"tag":6475,"img":6476,"body":6477,"_type":6466,"_id":10457,"_source":6468,"_file":10458,"_extension":6470},"/topics/robotics/nonlinear-mpc","Nonlinear Model Predictive Control","Introduction to Nonlinear Model Predictive Control","nonlinear-mpc","/topics/robotics/nmpc/predict_horizon.png",{"type":15,"children":6478,"toc":10446},[6479,6483,6487,6508,6514,6520,6533,6538,6543,6548,6552,6557,6596,6601,6605,6610,6658,6664,6676,6680,6685,6690,6695,6700,6704,6708,6713,7896,7902,7907,7911,7915,7920,7924,7930,7935,7939,7955,7959,7963,7967,7973,7985,8017,8022,8551,8556,8732,8741,8996,9001,10014,10019,10367,10373,10378,10388,10394,10399,10404,10410,10442],{"type":18,"tag":19,"props":6480,"children":6481},{"id":35},[6482],{"type":24,"value":38},{"type":18,"tag":27,"props":6484,"children":6485},{},[6486],{"type":24,"value":43},{"type":18,"tag":6488,"props":6489,"children":6496},"div",{"className":6490},[6491,6492,6493,6494,6495],"grid","grid-cols-2","space-x-10","justify-center","items-center",[6497,6498,6502,6503],{"type":24,"value":6322},{"type":18,"tag":6324,"props":6499,"children":6501},{"className":6500,"src":6476,"width":6356,"height":6357},[6327],[],{"type":24,"value":6322},{"type":18,"tag":6324,"props":6504,"children":6507},{"className":6505,"src":6506,"width":6356,"height":6357},[6327],"/topics/robotics/nmpc/set_points.png",[],{"type":18,"tag":6333,"props":6509,"children":6511},{"className":6510},[68,6336,6337,6338],[6512],{"type":24,"value":6513},"\n  A car with finite horizons prediction and set point prediction over finite horizons.\n",{"type":18,"tag":19,"props":6515,"children":6517},{"id":6516},"nonlinear-model-predictive-control",[6518],{"type":24,"value":6519},"Nonlinear Model Predictive Control ?",{"type":18,"tag":27,"props":6521,"children":6522},{},[6523,6525,6528,6530],{"type":24,"value":6524},"Nonlinear Model Predictive Control has the same basic core of its control algorithms. The different is about the mathematical solving over the system. ",{"type":18,"tag":56,"props":6526,"children":6527},{},[],{"type":24,"value":6529},"\nIn the real-life application, most of the system certainly nonlinear and it's more complex than linear model. Linear systems are mostly time-invariant, meaning that the response of the system input is time-independent. Nonlinear systems are time-varying meaning that the response of the system to any input is time-dependent.",{"type":18,"tag":56,"props":6531,"children":6532},{},[],{"type":18,"tag":27,"props":6534,"children":6535},{},[6536],{"type":24,"value":6537},"The system model can be represent as state-space model",{"type":18,"tag":27,"props":6539,"children":6540},{},[6541],{"type":24,"value":6542},"$$ \\dot{X} = f(X,U) $$",{"type":18,"tag":27,"props":6544,"children":6545},{},[6546],{"type":24,"value":6547},"Nonlinear Model Predictive Control also works by solving the quardratic cost subject to the nonlinear function over a future finite horizons. The quadractic cost can be define as",{"type":18,"tag":65,"props":6549,"children":6551},{"latex-express":6550,"styles":68},"J(x,u) = \\displaystyle\\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})",[],{"type":18,"tag":27,"props":6553,"children":6554},{},[6555],{"type":24,"value":6556},"Notation",{"type":18,"tag":76,"props":6558,"children":6559},{},[6560,6569,6578,6587],{"type":18,"tag":80,"props":6561,"children":6562},{},[6563,6567],{"type":18,"tag":84,"props":6564,"children":6566},{"latex-express":6565,"styles":87},"X",[],{"type":24,"value":6568}," is the state of the system. This shall be obtained from the optimiztion problem.",{"type":18,"tag":80,"props":6570,"children":6571},{},[6572,6576],{"type":18,"tag":84,"props":6573,"children":6575},{"latex-express":6574,"styles":87},"X_{ref}",[],{"type":24,"value":6577}," is the reference state of the system or desired input state.",{"type":18,"tag":80,"props":6579,"children":6580},{},[6581,6585],{"type":18,"tag":84,"props":6582,"children":6584},{"latex-express":6583,"styles":87},"U",[],{"type":24,"value":6586}," is the input control of the system. This is a solution obtained from the optimization problem.",{"type":18,"tag":80,"props":6588,"children":6589},{},[6590,6594],{"type":18,"tag":84,"props":6591,"children":6593},{"latex-express":6592,"styles":87},"U_{ref}",[],{"type":24,"value":6595}," is the reference control of the system or desired input control.",{"type":18,"tag":27,"props":6597,"children":6598},{},[6599],{"type":24,"value":6600},"Rewrite the optimization of NMPC problem.",{"type":18,"tag":65,"props":6602,"children":6604},{"latex-express":6603,"styles":68},"\n      \\begin{align*}\n            \\min_{u_{0}, u_{1}, ..., u_{N-1} } \\quad \\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}&Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})\\\\\n            \\text{subject to} \\quad & x_{k+1} = f(x_k, u_k) \\quad \\text{(System dynamics)} \\\\\n            & g(x_k, x_k) \\leq 0 \\quad \\text{(State constraints)} \\\\\n            & h(x_k, x_k) \\leq 0 \\quad \\text{(Input constraints)} \\\\\n            & p(x_k) \\leq 0 \\quad \\text{(Path constraints)} \\\\\n            & x_0=x(0)  \\quad \\text{(Initial condition)}\n      \\end{align*}\n            ",[],{"type":18,"tag":27,"props":6606,"children":6607},{},[6608],{"type":24,"value":6609},"Which,",{"type":18,"tag":76,"props":6611,"children":6612},{},[6613,6622,6631,6640,6648],{"type":18,"tag":80,"props":6614,"children":6615},{},[6616,6620],{"type":18,"tag":84,"props":6617,"children":6619},{"latex-express":6618,"styles":87},"f",[],{"type":24,"value":6621}," is the system dynamics model.",{"type":18,"tag":80,"props":6623,"children":6624},{},[6625,6629],{"type":18,"tag":84,"props":6626,"children":6628},{"latex-express":6627,"styles":87},"g",[],{"type":24,"value":6630}," is the state constraints of the system.",{"type":18,"tag":80,"props":6632,"children":6633},{},[6634,6638],{"type":18,"tag":84,"props":6635,"children":6637},{"latex-express":6636,"styles":87},"h",[],{"type":24,"value":6639}," is the input constraints of the system.",{"type":18,"tag":80,"props":6641,"children":6642},{},[6643,6646],{"type":18,"tag":84,"props":6644,"children":6645},{"latex-express":27,"styles":87},[],{"type":24,"value":6647}," is the path constraint, it help to ensure the safety following path of our system.",{"type":18,"tag":80,"props":6649,"children":6650},{},[6651,6656],{"type":18,"tag":84,"props":6652,"children":6655},{"latex-express":6653,"styles":87,"dist-cond":6654},"\\phi(X_{N})","false",[],{"type":24,"value":6657}," is the terminal cost of the system.",{"type":18,"tag":19,"props":6659,"children":6661},{"id":6660},"discretize-the-system-model-with-runge-kutta-4th-order",[6662],{"type":24,"value":6663},"Discretize the system model with Runge-Kutta 4th order",{"type":18,"tag":27,"props":6665,"children":6666},{},[6667,6669,6674],{"type":24,"value":6668},"I will choose a simple system mode robot ",{"type":18,"tag":170,"props":6670,"children":6671},{},[6672],{"type":24,"value":6673}," DifferentialDrive ",{"type":24,"value":6675},".\nThe forward kinematic equation",{"type":18,"tag":65,"props":6677,"children":6679},{"latex-express":6678,"styles":68},"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix}\n ",[],{"type":18,"tag":27,"props":6681,"children":6682},{},[6683],{"type":24,"value":6684},"State constraints are the restriction imposed on the state variable of the system. It helps our optimizer not to obtain the solution that is outside the boundary region and also ensure the system to always perform the minimal action control in any critical condition.",{"type":18,"tag":27,"props":6686,"children":6687},{},[6688],{"type":24,"value":6689},"We, then can do the approximation",{"type":18,"tag":65,"props":6691,"children":6694},{"latex-express":6692,"styles":68,"dist-cond":6693},"\n    \\begin{align*}\n        k_{1} &= f(x^{*}, u^{*}) \\\\\n        k_{2} &= f(x^{*}+k_{1}\\frac{dt}{2}, u^{*}) \\\\ \n        k_{3} &= f(x^{*}+k_{2}\\frac{dt}{2}, u^{*}) \\\\\n        k_{4} &= f(x^{*}+k_{3}dt, u^{*}) \\\\ \n        \\Rightarrow{x_{k+1} } &= x_{k} + (k_{1}+2k_{2}+2k_{3}+k_{4})\\frac{dt}{6}\n    \\end{align*}\n","true",[],{"type":18,"tag":27,"props":6696,"children":6697},{},[6698],{"type":24,"value":6699},"Let's evaluate it with our model.",{"type":18,"tag":65,"props":6701,"children":6703},{"latex-express":6702,"styles":68},"\n      \\begin{align*}\n        k_{1} &= \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n        k_{2} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{3} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{4} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n    \\end{align*}\n      ",[],{"type":18,"tag":65,"props":6705,"children":6707},{"latex-express":6706,"styles":68},"\n      \\Rightarrow{x_{k+1} } = x_{k} + \\left( \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} + \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix}   \\right) \\frac{dt}{6}\n",[],{"type":18,"tag":27,"props":6709,"children":6710},{},[6711],{"type":24,"value":6712},"How to implement it in Python ???",{"type":18,"tag":618,"props":6714,"children":6717},{"className":6715,"code":6716,"language":623,"meta":8},[621],"import numpy as np\n\n## Define sampling time dt 100Hz\ndt = 0.01\n## Define the num steps for function approximation \nnum_steps = 100\n## Define initial states\nx = 0.0\ny = 0.0\nyaw = 0.0\n## Define input control\nv = 1.5 #m/s\nomega = 1.57 #rad/s\n## Define state represent model\n### define lambda function take variable x\nf = lambda x, u :  np.array([\n      [u[0]*np.cos(x[2])],\n      [u[0]*np.sin(x[2])],\n      [u[1]]\n])\n\nfor _ in range(num_steps):\n    k1 = f([x, y, yaw], [v, omega])\n    k2 = f([x + (dt / 2) * k1[0], y + (dt / 2) * k1[1], yaw + (dt / 2) * k1[2]], [v, omega])\n    k3 = f([x + (dt / 2) * k2[0], y + (dt / 2) * k2[1], yaw + (dt / 2) * k2[2]], [v, omega])\n    k4 = f([x + dt * k3[0], y + dt * k3[1], yaw + dt * k3[2]], [v, omega])\n\n    # Update state of the robot\n    x += (k1[0] + 2 * k2[0] + 2 * k3[0] + k4[0]) * dt / 6\n    y += (k1[1] + 2 * k2[1] + 2 * k3[1] + k4[1]) * dt / 6\n    yaw += (k1[2] + 2 * k2[2] + 2 * k3[2] + k4[2]) * dt / 6\n",[6718],{"type":18,"tag":626,"props":6719,"children":6720},{},[6721],{"type":18,"tag":618,"props":6722,"children":6723},{"__ignoreMap":8},[6724,6747,6754,6762,6782,6790,6811,6819,6840,6860,6880,6888,6918,6947,6955,6963,6989,7023,7055,7071,7078,7085,7114,7131,7273,7410,7500,7507,7519,7647,7771],{"type":18,"tag":633,"props":6725,"children":6726},{"class":635,"line":636},[6727,6732,6737,6742],{"type":18,"tag":633,"props":6728,"children":6729},{"class":640},[6730],{"type":24,"value":6731},"import",{"type":18,"tag":633,"props":6733,"children":6734},{"class":646},[6735],{"type":24,"value":6736}," numpy ",{"type":18,"tag":633,"props":6738,"children":6739},{"class":640},[6740],{"type":24,"value":6741},"as",{"type":18,"tag":633,"props":6743,"children":6744},{"class":646},[6745],{"type":24,"value":6746}," np\n",{"type":18,"tag":633,"props":6748,"children":6749},{"class":635,"line":663},[6750],{"type":18,"tag":633,"props":6751,"children":6752},{},[6753],{"type":24,"value":669},{"type":18,"tag":633,"props":6755,"children":6756},{"class":635,"line":672},[6757],{"type":18,"tag":633,"props":6758,"children":6759},{"class":1870},[6760],{"type":24,"value":6761},"## Define sampling time dt 100Hz\n",{"type":18,"tag":633,"props":6763,"children":6764},{"class":635,"line":701},[6765,6769,6773,6777],{"type":18,"tag":633,"props":6766,"children":6767},{"class":646},[6768],{"type":24,"value":2731},{"type":18,"tag":633,"props":6770,"children":6771},{"class":640},[6772],{"type":24,"value":730},{"type":18,"tag":633,"props":6774,"children":6775},{"class":646},[6776],{"type":24,"value":649},{"type":18,"tag":633,"props":6778,"children":6779},{"class":690},[6780],{"type":24,"value":6781},"0.01\n",{"type":18,"tag":633,"props":6783,"children":6784},{"class":635,"line":709},[6785],{"type":18,"tag":633,"props":6786,"children":6787},{"class":1870},[6788],{"type":24,"value":6789},"## Define the num steps for function approximation \n",{"type":18,"tag":633,"props":6791,"children":6792},{"class":635,"line":738},[6793,6798,6802,6806],{"type":18,"tag":633,"props":6794,"children":6795},{"class":646},[6796],{"type":24,"value":6797},"num_steps ",{"type":18,"tag":633,"props":6799,"children":6800},{"class":640},[6801],{"type":24,"value":730},{"type":18,"tag":633,"props":6803,"children":6804},{"class":646},[6805],{"type":24,"value":649},{"type":18,"tag":633,"props":6807,"children":6808},{"class":690},[6809],{"type":24,"value":6810},"100\n",{"type":18,"tag":633,"props":6812,"children":6813},{"class":635,"line":764},[6814],{"type":18,"tag":633,"props":6815,"children":6816},{"class":1870},[6817],{"type":24,"value":6818},"## Define initial states\n",{"type":18,"tag":633,"props":6820,"children":6821},{"class":635,"line":790},[6822,6827,6831,6835],{"type":18,"tag":633,"props":6823,"children":6824},{"class":646},[6825],{"type":24,"value":6826},"x ",{"type":18,"tag":633,"props":6828,"children":6829},{"class":640},[6830],{"type":24,"value":730},{"type":18,"tag":633,"props":6832,"children":6833},{"class":646},[6834],{"type":24,"value":649},{"type":18,"tag":633,"props":6836,"children":6837},{"class":690},[6838],{"type":24,"value":6839},"0.0\n",{"type":18,"tag":633,"props":6841,"children":6842},{"class":635,"line":798},[6843,6848,6852,6856],{"type":18,"tag":633,"props":6844,"children":6845},{"class":646},[6846],{"type":24,"value":6847},"y ",{"type":18,"tag":633,"props":6849,"children":6850},{"class":640},[6851],{"type":24,"value":730},{"type":18,"tag":633,"props":6853,"children":6854},{"class":646},[6855],{"type":24,"value":649},{"type":18,"tag":633,"props":6857,"children":6858},{"class":690},[6859],{"type":24,"value":6839},{"type":18,"tag":633,"props":6861,"children":6862},{"class":635,"line":824},[6863,6868,6872,6876],{"type":18,"tag":633,"props":6864,"children":6865},{"class":646},[6866],{"type":24,"value":6867},"yaw ",{"type":18,"tag":633,"props":6869,"children":6870},{"class":640},[6871],{"type":24,"value":730},{"type":18,"tag":633,"props":6873,"children":6874},{"class":646},[6875],{"type":24,"value":649},{"type":18,"tag":633,"props":6877,"children":6878},{"class":690},[6879],{"type":24,"value":6839},{"type":18,"tag":633,"props":6881,"children":6882},{"class":635,"line":850},[6883],{"type":18,"tag":633,"props":6884,"children":6885},{"class":1870},[6886],{"type":24,"value":6887},"## Define input control\n",{"type":18,"tag":633,"props":6889,"children":6890},{"class":635,"line":858},[6891,6896,6900,6904,6909,6913],{"type":18,"tag":633,"props":6892,"children":6893},{"class":646},[6894],{"type":24,"value":6895},"v ",{"type":18,"tag":633,"props":6897,"children":6898},{"class":640},[6899],{"type":24,"value":730},{"type":18,"tag":633,"props":6901,"children":6902},{"class":646},[6903],{"type":24,"value":649},{"type":18,"tag":633,"props":6905,"children":6906},{"class":690},[6907],{"type":24,"value":6908},"1.5",{"type":18,"tag":633,"props":6910,"children":6911},{"class":646},[6912],{"type":24,"value":649},{"type":18,"tag":633,"props":6914,"children":6915},{"class":1870},[6916],{"type":24,"value":6917},"#m/s\n",{"type":18,"tag":633,"props":6919,"children":6920},{"class":635,"line":894},[6921,6926,6930,6934,6938,6942],{"type":18,"tag":633,"props":6922,"children":6923},{"class":646},[6924],{"type":24,"value":6925},"omega ",{"type":18,"tag":633,"props":6927,"children":6928},{"class":640},[6929],{"type":24,"value":730},{"type":18,"tag":633,"props":6931,"children":6932},{"class":646},[6933],{"type":24,"value":649},{"type":18,"tag":633,"props":6935,"children":6936},{"class":690},[6937],{"type":24,"value":2397},{"type":18,"tag":633,"props":6939,"children":6940},{"class":646},[6941],{"type":24,"value":649},{"type":18,"tag":633,"props":6943,"children":6944},{"class":1870},[6945],{"type":24,"value":6946},"#rad/s\n",{"type":18,"tag":633,"props":6948,"children":6949},{"class":635,"line":927},[6950],{"type":18,"tag":633,"props":6951,"children":6952},{"class":1870},[6953],{"type":24,"value":6954},"## Define state represent model\n",{"type":18,"tag":633,"props":6956,"children":6957},{"class":635,"line":935},[6958],{"type":18,"tag":633,"props":6959,"children":6960},{"class":1870},[6961],{"type":24,"value":6962},"### define lambda function take variable x\n",{"type":18,"tag":633,"props":6964,"children":6965},{"class":635,"line":969},[6966,6971,6975,6979,6984],{"type":18,"tag":633,"props":6967,"children":6968},{"class":646},[6969],{"type":24,"value":6970},"f ",{"type":18,"tag":633,"props":6972,"children":6973},{"class":640},[6974],{"type":24,"value":730},{"type":18,"tag":633,"props":6976,"children":6977},{"class":646},[6978],{"type":24,"value":649},{"type":18,"tag":633,"props":6980,"children":6981},{"class":640},[6982],{"type":24,"value":6983},"lambda",{"type":18,"tag":633,"props":6985,"children":6986},{"class":646},[6987],{"type":24,"value":6988}," x, u :  np.array([\n",{"type":18,"tag":633,"props":6990,"children":6991},{"class":635,"line":1003},[6992,6997,7001,7005,7009,7014,7018],{"type":18,"tag":633,"props":6993,"children":6994},{"class":646},[6995],{"type":24,"value":6996},"      [u[",{"type":18,"tag":633,"props":6998,"children":6999},{"class":690},[7000],{"type":24,"value":886},{"type":18,"tag":633,"props":7002,"children":7003},{"class":646},[7004],{"type":24,"value":2616},{"type":18,"tag":633,"props":7006,"children":7007},{"class":640},[7008],{"type":24,"value":1075},{"type":18,"tag":633,"props":7010,"children":7011},{"class":646},[7012],{"type":24,"value":7013},"np.cos(x[",{"type":18,"tag":633,"props":7015,"children":7016},{"class":690},[7017],{"type":24,"value":1372},{"type":18,"tag":633,"props":7019,"children":7020},{"class":646},[7021],{"type":24,"value":7022},"])],\n",{"type":18,"tag":633,"props":7024,"children":7025},{"class":635,"line":1011},[7026,7030,7034,7038,7042,7047,7051],{"type":18,"tag":633,"props":7027,"children":7028},{"class":646},[7029],{"type":24,"value":6996},{"type":18,"tag":633,"props":7031,"children":7032},{"class":690},[7033],{"type":24,"value":886},{"type":18,"tag":633,"props":7035,"children":7036},{"class":646},[7037],{"type":24,"value":2616},{"type":18,"tag":633,"props":7039,"children":7040},{"class":640},[7041],{"type":24,"value":1075},{"type":18,"tag":633,"props":7043,"children":7044},{"class":646},[7045],{"type":24,"value":7046},"np.sin(x[",{"type":18,"tag":633,"props":7048,"children":7049},{"class":690},[7050],{"type":24,"value":1372},{"type":18,"tag":633,"props":7052,"children":7053},{"class":646},[7054],{"type":24,"value":7022},{"type":18,"tag":633,"props":7056,"children":7057},{"class":635,"line":1037},[7058,7062,7066],{"type":18,"tag":633,"props":7059,"children":7060},{"class":646},[7061],{"type":24,"value":6996},{"type":18,"tag":633,"props":7063,"children":7064},{"class":690},[7065],{"type":24,"value":996},{"type":18,"tag":633,"props":7067,"children":7068},{"class":646},[7069],{"type":24,"value":7070},"]]\n",{"type":18,"tag":633,"props":7072,"children":7073},{"class":635,"line":1045},[7074],{"type":18,"tag":633,"props":7075,"children":7076},{"class":646},[7077],{"type":24,"value":3299},{"type":18,"tag":633,"props":7079,"children":7080},{"class":635,"line":1087},[7081],{"type":18,"tag":633,"props":7082,"children":7083},{},[7084],{"type":24,"value":669},{"type":18,"tag":633,"props":7086,"children":7087},{"class":635,"line":1127},[7088,7092,7097,7101,7105,7109],{"type":18,"tag":633,"props":7089,"children":7090},{"class":640},[7091],{"type":24,"value":2809},{"type":18,"tag":633,"props":7093,"children":7094},{"class":646},[7095],{"type":24,"value":7096}," _ ",{"type":18,"tag":633,"props":7098,"children":7099},{"class":640},[7100],{"type":24,"value":2819},{"type":18,"tag":633,"props":7102,"children":7103},{"class":646},[7104],{"type":24,"value":649},{"type":18,"tag":633,"props":7106,"children":7107},{"class":690},[7108],{"type":24,"value":2828},{"type":18,"tag":633,"props":7110,"children":7111},{"class":646},[7112],{"type":24,"value":7113},"(num_steps):\n",{"type":18,"tag":633,"props":7115,"children":7116},{"class":635,"line":1221},[7117,7122,7126],{"type":18,"tag":633,"props":7118,"children":7119},{"class":646},[7120],{"type":24,"value":7121},"    k1 ",{"type":18,"tag":633,"props":7123,"children":7124},{"class":640},[7125],{"type":24,"value":730},{"type":18,"tag":633,"props":7127,"children":7128},{"class":646},[7129],{"type":24,"value":7130}," f([x, y, yaw], [v, omega])\n",{"type":18,"tag":633,"props":7132,"children":7133},{"class":635,"line":1229},[7134,7139,7143,7148,7152,7157,7161,7165,7169,7173,7177,7182,7186,7191,7195,7199,7203,7207,7211,7215,7219,7223,7227,7232,7236,7240,7244,7248,7252,7256,7260,7264,7268],{"type":18,"tag":633,"props":7135,"children":7136},{"class":646},[7137],{"type":24,"value":7138},"    k2 ",{"type":18,"tag":633,"props":7140,"children":7141},{"class":640},[7142],{"type":24,"value":730},{"type":18,"tag":633,"props":7144,"children":7145},{"class":646},[7146],{"type":24,"value":7147}," f([x ",{"type":18,"tag":633,"props":7149,"children":7150},{"class":640},[7151],{"type":24,"value":1196},{"type":18,"tag":633,"props":7153,"children":7154},{"class":646},[7155],{"type":24,"value":7156}," (dt ",{"type":18,"tag":633,"props":7158,"children":7159},{"class":640},[7160],{"type":24,"value":1433},{"type":18,"tag":633,"props":7162,"children":7163},{"class":646},[7164],{"type":24,"value":649},{"type":18,"tag":633,"props":7166,"children":7167},{"class":690},[7168],{"type":24,"value":1372},{"type":18,"tag":633,"props":7170,"children":7171},{"class":646},[7172],{"type":24,"value":5376},{"type":18,"tag":633,"props":7174,"children":7175},{"class":640},[7176],{"type":24,"value":1075},{"type":18,"tag":633,"props":7178,"children":7179},{"class":646},[7180],{"type":24,"value":7181}," k1[",{"type":18,"tag":633,"props":7183,"children":7184},{"class":690},[7185],{"type":24,"value":886},{"type":18,"tag":633,"props":7187,"children":7188},{"class":646},[7189],{"type":24,"value":7190},"], y ",{"type":18,"tag":633,"props":7192,"children":7193},{"class":640},[7194],{"type":24,"value":1196},{"type":18,"tag":633,"props":7196,"children":7197},{"class":646},[7198],{"type":24,"value":7156},{"type":18,"tag":633,"props":7200,"children":7201},{"class":640},[7202],{"type":24,"value":1433},{"type":18,"tag":633,"props":7204,"children":7205},{"class":646},[7206],{"type":24,"value":649},{"type":18,"tag":633,"props":7208,"children":7209},{"class":690},[7210],{"type":24,"value":1372},{"type":18,"tag":633,"props":7212,"children":7213},{"class":646},[7214],{"type":24,"value":5376},{"type":18,"tag":633,"props":7216,"children":7217},{"class":640},[7218],{"type":24,"value":1075},{"type":18,"tag":633,"props":7220,"children":7221},{"class":646},[7222],{"type":24,"value":7181},{"type":18,"tag":633,"props":7224,"children":7225},{"class":690},[7226],{"type":24,"value":996},{"type":18,"tag":633,"props":7228,"children":7229},{"class":646},[7230],{"type":24,"value":7231},"], yaw ",{"type":18,"tag":633,"props":7233,"children":7234},{"class":640},[7235],{"type":24,"value":1196},{"type":18,"tag":633,"props":7237,"children":7238},{"class":646},[7239],{"type":24,"value":7156},{"type":18,"tag":633,"props":7241,"children":7242},{"class":640},[7243],{"type":24,"value":1433},{"type":18,"tag":633,"props":7245,"children":7246},{"class":646},[7247],{"type":24,"value":649},{"type":18,"tag":633,"props":7249,"children":7250},{"class":690},[7251],{"type":24,"value":1372},{"type":18,"tag":633,"props":7253,"children":7254},{"class":646},[7255],{"type":24,"value":5376},{"type":18,"tag":633,"props":7257,"children":7258},{"class":640},[7259],{"type":24,"value":1075},{"type":18,"tag":633,"props":7261,"children":7262},{"class":646},[7263],{"type":24,"value":7181},{"type":18,"tag":633,"props":7265,"children":7266},{"class":690},[7267],{"type":24,"value":1372},{"type":18,"tag":633,"props":7269,"children":7270},{"class":646},[7271],{"type":24,"value":7272},"]], [v, omega])\n",{"type":18,"tag":633,"props":7274,"children":7275},{"class":635,"line":1247},[7276,7281,7285,7289,7293,7297,7301,7305,7309,7313,7317,7322,7326,7330,7334,7338,7342,7346,7350,7354,7358,7362,7366,7370,7374,7378,7382,7386,7390,7394,7398,7402,7406],{"type":18,"tag":633,"props":7277,"children":7278},{"class":646},[7279],{"type":24,"value":7280},"    k3 ",{"type":18,"tag":633,"props":7282,"children":7283},{"class":640},[7284],{"type":24,"value":730},{"type":18,"tag":633,"props":7286,"children":7287},{"class":646},[7288],{"type":24,"value":7147},{"type":18,"tag":633,"props":7290,"children":7291},{"class":640},[7292],{"type":24,"value":1196},{"type":18,"tag":633,"props":7294,"children":7295},{"class":646},[7296],{"type":24,"value":7156},{"type":18,"tag":633,"props":7298,"children":7299},{"class":640},[7300],{"type":24,"value":1433},{"type":18,"tag":633,"props":7302,"children":7303},{"class":646},[7304],{"type":24,"value":649},{"type":18,"tag":633,"props":7306,"children":7307},{"class":690},[7308],{"type":24,"value":1372},{"type":18,"tag":633,"props":7310,"children":7311},{"class":646},[7312],{"type":24,"value":5376},{"type":18,"tag":633,"props":7314,"children":7315},{"class":640},[7316],{"type":24,"value":1075},{"type":18,"tag":633,"props":7318,"children":7319},{"class":646},[7320],{"type":24,"value":7321}," k2[",{"type":18,"tag":633,"props":7323,"children":7324},{"class":690},[7325],{"type":24,"value":886},{"type":18,"tag":633,"props":7327,"children":7328},{"class":646},[7329],{"type":24,"value":7190},{"type":18,"tag":633,"props":7331,"children":7332},{"class":640},[7333],{"type":24,"value":1196},{"type":18,"tag":633,"props":7335,"children":7336},{"class":646},[7337],{"type":24,"value":7156},{"type":18,"tag":633,"props":7339,"children":7340},{"class":640},[7341],{"type":24,"value":1433},{"type":18,"tag":633,"props":7343,"children":7344},{"class":646},[7345],{"type":24,"value":649},{"type":18,"tag":633,"props":7347,"children":7348},{"class":690},[7349],{"type":24,"value":1372},{"type":18,"tag":633,"props":7351,"children":7352},{"class":646},[7353],{"type":24,"value":5376},{"type":18,"tag":633,"props":7355,"children":7356},{"class":640},[7357],{"type":24,"value":1075},{"type":18,"tag":633,"props":7359,"children":7360},{"class":646},[7361],{"type":24,"value":7321},{"type":18,"tag":633,"props":7363,"children":7364},{"class":690},[7365],{"type":24,"value":996},{"type":18,"tag":633,"props":7367,"children":7368},{"class":646},[7369],{"type":24,"value":7231},{"type":18,"tag":633,"props":7371,"children":7372},{"class":640},[7373],{"type":24,"value":1196},{"type":18,"tag":633,"props":7375,"children":7376},{"class":646},[7377],{"type":24,"value":7156},{"type":18,"tag":633,"props":7379,"children":7380},{"class":640},[7381],{"type":24,"value":1433},{"type":18,"tag":633,"props":7383,"children":7384},{"class":646},[7385],{"type":24,"value":649},{"type":18,"tag":633,"props":7387,"children":7388},{"class":690},[7389],{"type":24,"value":1372},{"type":18,"tag":633,"props":7391,"children":7392},{"class":646},[7393],{"type":24,"value":5376},{"type":18,"tag":633,"props":7395,"children":7396},{"class":640},[7397],{"type":24,"value":1075},{"type":18,"tag":633,"props":7399,"children":7400},{"class":646},[7401],{"type":24,"value":7321},{"type":18,"tag":633,"props":7403,"children":7404},{"class":690},[7405],{"type":24,"value":1372},{"type":18,"tag":633,"props":7407,"children":7408},{"class":646},[7409],{"type":24,"value":7272},{"type":18,"tag":633,"props":7411,"children":7412},{"class":635,"line":1255},[7413,7418,7422,7426,7430,7435,7439,7444,7448,7452,7456,7460,7464,7468,7472,7476,7480,7484,7488,7492,7496],{"type":18,"tag":633,"props":7414,"children":7415},{"class":646},[7416],{"type":24,"value":7417},"    k4 ",{"type":18,"tag":633,"props":7419,"children":7420},{"class":640},[7421],{"type":24,"value":730},{"type":18,"tag":633,"props":7423,"children":7424},{"class":646},[7425],{"type":24,"value":7147},{"type":18,"tag":633,"props":7427,"children":7428},{"class":640},[7429],{"type":24,"value":1196},{"type":18,"tag":633,"props":7431,"children":7432},{"class":646},[7433],{"type":24,"value":7434}," dt ",{"type":18,"tag":633,"props":7436,"children":7437},{"class":640},[7438],{"type":24,"value":1075},{"type":18,"tag":633,"props":7440,"children":7441},{"class":646},[7442],{"type":24,"value":7443}," k3[",{"type":18,"tag":633,"props":7445,"children":7446},{"class":690},[7447],{"type":24,"value":886},{"type":18,"tag":633,"props":7449,"children":7450},{"class":646},[7451],{"type":24,"value":7190},{"type":18,"tag":633,"props":7453,"children":7454},{"class":640},[7455],{"type":24,"value":1196},{"type":18,"tag":633,"props":7457,"children":7458},{"class":646},[7459],{"type":24,"value":7434},{"type":18,"tag":633,"props":7461,"children":7462},{"class":640},[7463],{"type":24,"value":1075},{"type":18,"tag":633,"props":7465,"children":7466},{"class":646},[7467],{"type":24,"value":7443},{"type":18,"tag":633,"props":7469,"children":7470},{"class":690},[7471],{"type":24,"value":996},{"type":18,"tag":633,"props":7473,"children":7474},{"class":646},[7475],{"type":24,"value":7231},{"type":18,"tag":633,"props":7477,"children":7478},{"class":640},[7479],{"type":24,"value":1196},{"type":18,"tag":633,"props":7481,"children":7482},{"class":646},[7483],{"type":24,"value":7434},{"type":18,"tag":633,"props":7485,"children":7486},{"class":640},[7487],{"type":24,"value":1075},{"type":18,"tag":633,"props":7489,"children":7490},{"class":646},[7491],{"type":24,"value":7443},{"type":18,"tag":633,"props":7493,"children":7494},{"class":690},[7495],{"type":24,"value":1372},{"type":18,"tag":633,"props":7497,"children":7498},{"class":646},[7499],{"type":24,"value":7272},{"type":18,"tag":633,"props":7501,"children":7502},{"class":635,"line":1281},[7503],{"type":18,"tag":633,"props":7504,"children":7505},{},[7506],{"type":24,"value":669},{"type":18,"tag":633,"props":7508,"children":7509},{"class":635,"line":1289},[7510,7514],{"type":18,"tag":633,"props":7511,"children":7512},{"class":646},[7513],{"type":24,"value":678},{"type":18,"tag":633,"props":7515,"children":7516},{"class":1870},[7517],{"type":24,"value":7518},"# Update state of the robot\n",{"type":18,"tag":633,"props":7520,"children":7521},{"class":635,"line":1445},[7522,7527,7532,7537,7541,7545,7549,7553,7557,7561,7565,7569,7573,7577,7581,7585,7589,7593,7597,7601,7605,7609,7613,7618,7622,7627,7631,7635,7639,7643],{"type":18,"tag":633,"props":7523,"children":7524},{"class":646},[7525],{"type":24,"value":7526},"    x ",{"type":18,"tag":633,"props":7528,"children":7529},{"class":640},[7530],{"type":24,"value":7531},"+=",{"type":18,"tag":633,"props":7533,"children":7534},{"class":646},[7535],{"type":24,"value":7536}," (k1[",{"type":18,"tag":633,"props":7538,"children":7539},{"class":690},[7540],{"type":24,"value":886},{"type":18,"tag":633,"props":7542,"children":7543},{"class":646},[7544],{"type":24,"value":2930},{"type":18,"tag":633,"props":7546,"children":7547},{"class":640},[7548],{"type":24,"value":1196},{"type":18,"tag":633,"props":7550,"children":7551},{"class":646},[7552],{"type":24,"value":649},{"type":18,"tag":633,"props":7554,"children":7555},{"class":690},[7556],{"type":24,"value":1372},{"type":18,"tag":633,"props":7558,"children":7559},{"class":646},[7560],{"type":24,"value":649},{"type":18,"tag":633,"props":7562,"children":7563},{"class":640},[7564],{"type":24,"value":1075},{"type":18,"tag":633,"props":7566,"children":7567},{"class":646},[7568],{"type":24,"value":7321},{"type":18,"tag":633,"props":7570,"children":7571},{"class":690},[7572],{"type":24,"value":886},{"type":18,"tag":633,"props":7574,"children":7575},{"class":646},[7576],{"type":24,"value":2930},{"type":18,"tag":633,"props":7578,"children":7579},{"class":640},[7580],{"type":24,"value":1196},{"type":18,"tag":633,"props":7582,"children":7583},{"class":646},[7584],{"type":24,"value":649},{"type":18,"tag":633,"props":7586,"children":7587},{"class":690},[7588],{"type":24,"value":1372},{"type":18,"tag":633,"props":7590,"children":7591},{"class":646},[7592],{"type":24,"value":649},{"type":18,"tag":633,"props":7594,"children":7595},{"class":640},[7596],{"type":24,"value":1075},{"type":18,"tag":633,"props":7598,"children":7599},{"class":646},[7600],{"type":24,"value":7443},{"type":18,"tag":633,"props":7602,"children":7603},{"class":690},[7604],{"type":24,"value":886},{"type":18,"tag":633,"props":7606,"children":7607},{"class":646},[7608],{"type":24,"value":2930},{"type":18,"tag":633,"props":7610,"children":7611},{"class":640},[7612],{"type":24,"value":1196},{"type":18,"tag":633,"props":7614,"children":7615},{"class":646},[7616],{"type":24,"value":7617}," k4[",{"type":18,"tag":633,"props":7619,"children":7620},{"class":690},[7621],{"type":24,"value":886},{"type":18,"tag":633,"props":7623,"children":7624},{"class":646},[7625],{"type":24,"value":7626},"]) ",{"type":18,"tag":633,"props":7628,"children":7629},{"class":640},[7630],{"type":24,"value":1075},{"type":18,"tag":633,"props":7632,"children":7633},{"class":646},[7634],{"type":24,"value":7434},{"type":18,"tag":633,"props":7636,"children":7637},{"class":640},[7638],{"type":24,"value":1433},{"type":18,"tag":633,"props":7640,"children":7641},{"class":646},[7642],{"type":24,"value":649},{"type":18,"tag":633,"props":7644,"children":7645},{"class":690},[7646],{"type":24,"value":2217},{"type":18,"tag":633,"props":7648,"children":7649},{"class":635,"line":1565},[7650,7655,7659,7663,7667,7671,7675,7679,7683,7687,7691,7695,7699,7703,7707,7711,7715,7719,7723,7727,7731,7735,7739,7743,7747,7751,7755,7759,7763,7767],{"type":18,"tag":633,"props":7651,"children":7652},{"class":646},[7653],{"type":24,"value":7654},"    y ",{"type":18,"tag":633,"props":7656,"children":7657},{"class":640},[7658],{"type":24,"value":7531},{"type":18,"tag":633,"props":7660,"children":7661},{"class":646},[7662],{"type":24,"value":7536},{"type":18,"tag":633,"props":7664,"children":7665},{"class":690},[7666],{"type":24,"value":996},{"type":18,"tag":633,"props":7668,"children":7669},{"class":646},[7670],{"type":24,"value":2930},{"type":18,"tag":633,"props":7672,"children":7673},{"class":640},[7674],{"type":24,"value":1196},{"type":18,"tag":633,"props":7676,"children":7677},{"class":646},[7678],{"type":24,"value":649},{"type":18,"tag":633,"props":7680,"children":7681},{"class":690},[7682],{"type":24,"value":1372},{"type":18,"tag":633,"props":7684,"children":7685},{"class":646},[7686],{"type":24,"value":649},{"type":18,"tag":633,"props":7688,"children":7689},{"class":640},[7690],{"type":24,"value":1075},{"type":18,"tag":633,"props":7692,"children":7693},{"class":646},[7694],{"type":24,"value":7321},{"type":18,"tag":633,"props":7696,"children":7697},{"class":690},[7698],{"type":24,"value":996},{"type":18,"tag":633,"props":7700,"children":7701},{"class":646},[7702],{"type":24,"value":2930},{"type":18,"tag":633,"props":7704,"children":7705},{"class":640},[7706],{"type":24,"value":1196},{"type":18,"tag":633,"props":7708,"children":7709},{"class":646},[7710],{"type":24,"value":649},{"type":18,"tag":633,"props":7712,"children":7713},{"class":690},[7714],{"type":24,"value":1372},{"type":18,"tag":633,"props":7716,"children":7717},{"class":646},[7718],{"type":24,"value":649},{"type":18,"tag":633,"props":7720,"children":7721},{"class":640},[7722],{"type":24,"value":1075},{"type":18,"tag":633,"props":7724,"children":7725},{"class":646},[7726],{"type":24,"value":7443},{"type":18,"tag":633,"props":7728,"children":7729},{"class":690},[7730],{"type":24,"value":996},{"type":18,"tag":633,"props":7732,"children":7733},{"class":646},[7734],{"type":24,"value":2930},{"type":18,"tag":633,"props":7736,"children":7737},{"class":640},[7738],{"type":24,"value":1196},{"type":18,"tag":633,"props":7740,"children":7741},{"class":646},[7742],{"type":24,"value":7617},{"type":18,"tag":633,"props":7744,"children":7745},{"class":690},[7746],{"type":24,"value":996},{"type":18,"tag":633,"props":7748,"children":7749},{"class":646},[7750],{"type":24,"value":7626},{"type":18,"tag":633,"props":7752,"children":7753},{"class":640},[7754],{"type":24,"value":1075},{"type":18,"tag":633,"props":7756,"children":7757},{"class":646},[7758],{"type":24,"value":7434},{"type":18,"tag":633,"props":7760,"children":7761},{"class":640},[7762],{"type":24,"value":1433},{"type":18,"tag":633,"props":7764,"children":7765},{"class":646},[7766],{"type":24,"value":649},{"type":18,"tag":633,"props":7768,"children":7769},{"class":690},[7770],{"type":24,"value":2217},{"type":18,"tag":633,"props":7772,"children":7773},{"class":635,"line":1573},[7774,7779,7783,7787,7791,7795,7799,7803,7807,7811,7815,7819,7823,7827,7831,7835,7839,7843,7847,7851,7855,7859,7863,7867,7871,7875,7879,7883,7887,7891],{"type":18,"tag":633,"props":7775,"children":7776},{"class":646},[7777],{"type":24,"value":7778},"    yaw ",{"type":18,"tag":633,"props":7780,"children":7781},{"class":640},[7782],{"type":24,"value":7531},{"type":18,"tag":633,"props":7784,"children":7785},{"class":646},[7786],{"type":24,"value":7536},{"type":18,"tag":633,"props":7788,"children":7789},{"class":690},[7790],{"type":24,"value":1372},{"type":18,"tag":633,"props":7792,"children":7793},{"class":646},[7794],{"type":24,"value":2930},{"type":18,"tag":633,"props":7796,"children":7797},{"class":640},[7798],{"type":24,"value":1196},{"type":18,"tag":633,"props":7800,"children":7801},{"class":646},[7802],{"type":24,"value":649},{"type":18,"tag":633,"props":7804,"children":7805},{"class":690},[7806],{"type":24,"value":1372},{"type":18,"tag":633,"props":7808,"children":7809},{"class":646},[7810],{"type":24,"value":649},{"type":18,"tag":633,"props":7812,"children":7813},{"class":640},[7814],{"type":24,"value":1075},{"type":18,"tag":633,"props":7816,"children":7817},{"class":646},[7818],{"type":24,"value":7321},{"type":18,"tag":633,"props":7820,"children":7821},{"class":690},[7822],{"type":24,"value":1372},{"type":18,"tag":633,"props":7824,"children":7825},{"class":646},[7826],{"type":24,"value":2930},{"type":18,"tag":633,"props":7828,"children":7829},{"class":640},[7830],{"type":24,"value":1196},{"type":18,"tag":633,"props":7832,"children":7833},{"class":646},[7834],{"type":24,"value":649},{"type":18,"tag":633,"props":7836,"children":7837},{"class":690},[7838],{"type":24,"value":1372},{"type":18,"tag":633,"props":7840,"children":7841},{"class":646},[7842],{"type":24,"value":649},{"type":18,"tag":633,"props":7844,"children":7845},{"class":640},[7846],{"type":24,"value":1075},{"type":18,"tag":633,"props":7848,"children":7849},{"class":646},[7850],{"type":24,"value":7443},{"type":18,"tag":633,"props":7852,"children":7853},{"class":690},[7854],{"type":24,"value":1372},{"type":18,"tag":633,"props":7856,"children":7857},{"class":646},[7858],{"type":24,"value":2930},{"type":18,"tag":633,"props":7860,"children":7861},{"class":640},[7862],{"type":24,"value":1196},{"type":18,"tag":633,"props":7864,"children":7865},{"class":646},[7866],{"type":24,"value":7617},{"type":18,"tag":633,"props":7868,"children":7869},{"class":690},[7870],{"type":24,"value":1372},{"type":18,"tag":633,"props":7872,"children":7873},{"class":646},[7874],{"type":24,"value":7626},{"type":18,"tag":633,"props":7876,"children":7877},{"class":640},[7878],{"type":24,"value":1075},{"type":18,"tag":633,"props":7880,"children":7881},{"class":646},[7882],{"type":24,"value":7434},{"type":18,"tag":633,"props":7884,"children":7885},{"class":640},[7886],{"type":24,"value":1433},{"type":18,"tag":633,"props":7888,"children":7889},{"class":646},[7890],{"type":24,"value":649},{"type":18,"tag":633,"props":7892,"children":7893},{"class":690},[7894],{"type":24,"value":7895},"6",{"type":18,"tag":19,"props":7897,"children":7899},{"id":7898},"single-shooting-method",[7900],{"type":24,"value":7901},"Single Shooting Method",{"type":18,"tag":27,"props":7903,"children":7904},{},[7905],{"type":24,"value":7906},"Single Shooting Method is a method that we transform the optimal control problem to the nonlinear programming problem with just one decision variable.",{"type":18,"tag":65,"props":7908,"children":7910},{"latex-express":7909,"styles":68},"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}\\right]\n        \\end{align*}\n",[],{"type":18,"tag":65,"props":7912,"children":7914},{"latex-express":7913,"styles":68},"\n      \\begin{align*}\n            x_{u} &= F(w,x_{0},t_{k}) \\\\\n            F(w,x_{0},t_{0}) &= x_{0} \\\\\n        \\end{align*}\n",[],{"type":18,"tag":27,"props":7916,"children":7917},{},[7918],{"type":24,"value":7919},"Then solve the NLP",{"type":18,"tag":65,"props":7921,"children":7923},{"latex-express":7922,"styles":68},"\n      \\begin{align*}\n            \\min_{w}\\Phi(F(w,x_{0},t_{k}), w) \\\\ \n            \\text{Subject to} \\hspace{1cm}  g_{1}(F(w,x_{0},t_{k}),w) \\leq{0}\n        \\end{align*}\n",[],{"type":18,"tag":19,"props":7925,"children":7927},{"id":7926},"multiple-shooting-method",[7928],{"type":24,"value":7929},"Multiple Shooting Method",{"type":18,"tag":27,"props":7931,"children":7932},{},[7933],{"type":24,"value":7934},"Multiple Shooting Method is a method that consist of transforming of optimal control problem to the nonlinear programming problem with multiple decision variables.",{"type":18,"tag":65,"props":7936,"children":7938},{"latex-express":7937,"styles":68},"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}, x_{0}, ..., x_{N}\\right]\n        \\end{align*}\n",[],{"type":18,"tag":76,"props":7940,"children":7941},{},[7942,7950],{"type":18,"tag":80,"props":7943,"children":7944},{},[7945,7948],{"type":18,"tag":84,"props":7946,"children":7947},{"latex-express":6565,"styles":87},[],{"type":24,"value":7949}," becoming decision variable in the opimization problem as well as u",{"type":18,"tag":80,"props":7951,"children":7952},{},[7953],{"type":24,"value":7954},"We apply path constraint at each iteration step",{"type":18,"tag":65,"props":7956,"children":7958},{"latex-express":7957,"styles":68},"\n      \\begin{equation*}\n                x_{k+1}-f(x_{k},u_{k}) = 0\n            \\end{equation*}\n",[],{"type":18,"tag":27,"props":7960,"children":7961},{},[7962],{"type":24,"value":7919},{"type":18,"tag":65,"props":7964,"children":7966},{"latex-express":7965,"styles":68},"\n      \\begin{align*}\n            \\min_{w}  \\Phi(F(w,x_{0},t_{k}),& w) \\\\ \n            \\text{s.t}\\hspace{0.5cm}  g_{1}(F(w,x_{0},t_{k}),w) &\\leq{0} \\\\ \n                               g_{2}(w) = \\begin{bmatrix}\n                                  \\bar{x}_{0}-x_{0} \\\\\n                                  f(x_{0},u_{0})-x_{1} \\\\ \n                                  \\vdots \\\\\n                                  f(x_{N-1}, u_{N-1}-x_{N})\n                              \\end{bmatrix} &= 0\n        \\end{align*}\n",[],{"type":18,"tag":19,"props":7968,"children":7970},{"id":7969},"full-implement-in-python",[7971],{"type":24,"value":7972},"Full Implement in Python",{"type":18,"tag":27,"props":7974,"children":7975},{},[7976,7978,7983],{"type":24,"value":7977},"We will use ",{"type":18,"tag":4379,"props":7979,"children":7980},{},[7981],{"type":24,"value":7982},"Casadi",{"type":24,"value":7984}," as a numerical optimization framework.",{"type":18,"tag":618,"props":7986,"children":7989},{"className":7987,"code":7988,"language":623,"meta":8},[621],"import casadi as ca\n",[7990],{"type":18,"tag":626,"props":7991,"children":7992},{},[7993],{"type":18,"tag":618,"props":7994,"children":7995},{"__ignoreMap":8},[7996],{"type":18,"tag":633,"props":7997,"children":7998},{"class":635,"line":636},[7999,8003,8008,8012],{"type":18,"tag":633,"props":8000,"children":8001},{"class":640},[8002],{"type":24,"value":6731},{"type":18,"tag":633,"props":8004,"children":8005},{"class":646},[8006],{"type":24,"value":8007}," casadi ",{"type":18,"tag":633,"props":8009,"children":8010},{"class":640},[8011],{"type":24,"value":6741},{"type":18,"tag":633,"props":8013,"children":8014},{"class":646},[8015],{"type":24,"value":8016}," ca",{"type":18,"tag":27,"props":8018,"children":8019},{},[8020],{"type":24,"value":8021},"Define state representation and input control of our nonlinear model.",{"type":18,"tag":618,"props":8023,"children":8026},{"className":8024,"code":8025,"language":623,"meta":8},[621],"# Symbolic Variables\n## States\nx = ca.SX.sym(\"x\")\ny = ca.SX.sym(\"y\")\ntheta = ca.SX.sym(\"theta\")\nstates = ca.vertcat(x, y, theta)\nnum_states = states.numel()\n\n## Control\nu1 = ca.SX.sym(\"u1\")\nu2 = ca.SX.sym(\"u2\")\ncontrols = ca.vertcat(u1, u2)\nnum_controls = controls.numel()\n\n# Define Nonlinear model\n## Rotation Matrix\nrot_mat = ca.vertcat(\n    ca.horzcat(ca.cos(theta), ca.sin(theta), 0),\n    ca.horzcat(-ca.sin(theta), ca.cos(theta), 0),\n    ca.horzcat(0, 0, 1)\n)\n\nvx = u1 * ca.cos(theta)\nvy = u1 * ca.sin(theta)\nvyaw = u2\n\nrhs = ca.vertcat(vx, vy, vyaw)\n## Define mapped nonlinear function f(x,u) -> rhs\nf = ca.Function('f', [states, controls], [rhs])\n",[8027],{"type":18,"tag":626,"props":8028,"children":8029},{},[8030],{"type":18,"tag":618,"props":8031,"children":8032},{"__ignoreMap":8},[8033,8041,8049,8084,8116,8149,8166,8183,8190,8198,8231,8264,8281,8298,8305,8313,8321,8338,8355,8380,8411,8418,8425,8451,8476,8493,8500,8517,8525],{"type":18,"tag":633,"props":8034,"children":8035},{"class":635,"line":636},[8036],{"type":18,"tag":633,"props":8037,"children":8038},{"class":1870},[8039],{"type":24,"value":8040},"# Symbolic Variables\n",{"type":18,"tag":633,"props":8042,"children":8043},{"class":635,"line":663},[8044],{"type":18,"tag":633,"props":8045,"children":8046},{"class":1870},[8047],{"type":24,"value":8048},"## States\n",{"type":18,"tag":633,"props":8050,"children":8051},{"class":635,"line":672},[8052,8056,8060,8065,8070,8075,8080],{"type":18,"tag":633,"props":8053,"children":8054},{"class":646},[8055],{"type":24,"value":6826},{"type":18,"tag":633,"props":8057,"children":8058},{"class":640},[8059],{"type":24,"value":730},{"type":18,"tag":633,"props":8061,"children":8062},{"class":646},[8063],{"type":24,"value":8064}," ca.",{"type":18,"tag":633,"props":8066,"children":8067},{"class":690},[8068],{"type":24,"value":8069},"SX",{"type":18,"tag":633,"props":8071,"children":8072},{"class":646},[8073],{"type":24,"value":8074},".sym(",{"type":18,"tag":633,"props":8076,"children":8077},{"class":5368},[8078],{"type":24,"value":8079},"\"x\"",{"type":18,"tag":633,"props":8081,"children":8082},{"class":646},[8083],{"type":24,"value":1442},{"type":18,"tag":633,"props":8085,"children":8086},{"class":635,"line":701},[8087,8091,8095,8099,8103,8107,8112],{"type":18,"tag":633,"props":8088,"children":8089},{"class":646},[8090],{"type":24,"value":6847},{"type":18,"tag":633,"props":8092,"children":8093},{"class":640},[8094],{"type":24,"value":730},{"type":18,"tag":633,"props":8096,"children":8097},{"class":646},[8098],{"type":24,"value":8064},{"type":18,"tag":633,"props":8100,"children":8101},{"class":690},[8102],{"type":24,"value":8069},{"type":18,"tag":633,"props":8104,"children":8105},{"class":646},[8106],{"type":24,"value":8074},{"type":18,"tag":633,"props":8108,"children":8109},{"class":5368},[8110],{"type":24,"value":8111},"\"y\"",{"type":18,"tag":633,"props":8113,"children":8114},{"class":646},[8115],{"type":24,"value":1442},{"type":18,"tag":633,"props":8117,"children":8118},{"class":635,"line":709},[8119,8124,8128,8132,8136,8140,8145],{"type":18,"tag":633,"props":8120,"children":8121},{"class":646},[8122],{"type":24,"value":8123},"theta ",{"type":18,"tag":633,"props":8125,"children":8126},{"class":640},[8127],{"type":24,"value":730},{"type":18,"tag":633,"props":8129,"children":8130},{"class":646},[8131],{"type":24,"value":8064},{"type":18,"tag":633,"props":8133,"children":8134},{"class":690},[8135],{"type":24,"value":8069},{"type":18,"tag":633,"props":8137,"children":8138},{"class":646},[8139],{"type":24,"value":8074},{"type":18,"tag":633,"props":8141,"children":8142},{"class":5368},[8143],{"type":24,"value":8144},"\"theta\"",{"type":18,"tag":633,"props":8146,"children":8147},{"class":646},[8148],{"type":24,"value":1442},{"type":18,"tag":633,"props":8150,"children":8151},{"class":635,"line":738},[8152,8157,8161],{"type":18,"tag":633,"props":8153,"children":8154},{"class":646},[8155],{"type":24,"value":8156},"states ",{"type":18,"tag":633,"props":8158,"children":8159},{"class":640},[8160],{"type":24,"value":730},{"type":18,"tag":633,"props":8162,"children":8163},{"class":646},[8164],{"type":24,"value":8165}," ca.vertcat(x, y, theta)\n",{"type":18,"tag":633,"props":8167,"children":8168},{"class":635,"line":764},[8169,8174,8178],{"type":18,"tag":633,"props":8170,"children":8171},{"class":646},[8172],{"type":24,"value":8173},"num_states ",{"type":18,"tag":633,"props":8175,"children":8176},{"class":640},[8177],{"type":24,"value":730},{"type":18,"tag":633,"props":8179,"children":8180},{"class":646},[8181],{"type":24,"value":8182}," states.numel()\n",{"type":18,"tag":633,"props":8184,"children":8185},{"class":635,"line":790},[8186],{"type":18,"tag":633,"props":8187,"children":8188},{},[8189],{"type":24,"value":669},{"type":18,"tag":633,"props":8191,"children":8192},{"class":635,"line":798},[8193],{"type":18,"tag":633,"props":8194,"children":8195},{"class":1870},[8196],{"type":24,"value":8197},"## Control\n",{"type":18,"tag":633,"props":8199,"children":8200},{"class":635,"line":824},[8201,8206,8210,8214,8218,8222,8227],{"type":18,"tag":633,"props":8202,"children":8203},{"class":646},[8204],{"type":24,"value":8205},"u1 ",{"type":18,"tag":633,"props":8207,"children":8208},{"class":640},[8209],{"type":24,"value":730},{"type":18,"tag":633,"props":8211,"children":8212},{"class":646},[8213],{"type":24,"value":8064},{"type":18,"tag":633,"props":8215,"children":8216},{"class":690},[8217],{"type":24,"value":8069},{"type":18,"tag":633,"props":8219,"children":8220},{"class":646},[8221],{"type":24,"value":8074},{"type":18,"tag":633,"props":8223,"children":8224},{"class":5368},[8225],{"type":24,"value":8226},"\"u1\"",{"type":18,"tag":633,"props":8228,"children":8229},{"class":646},[8230],{"type":24,"value":1442},{"type":18,"tag":633,"props":8232,"children":8233},{"class":635,"line":850},[8234,8239,8243,8247,8251,8255,8260],{"type":18,"tag":633,"props":8235,"children":8236},{"class":646},[8237],{"type":24,"value":8238},"u2 ",{"type":18,"tag":633,"props":8240,"children":8241},{"class":640},[8242],{"type":24,"value":730},{"type":18,"tag":633,"props":8244,"children":8245},{"class":646},[8246],{"type":24,"value":8064},{"type":18,"tag":633,"props":8248,"children":8249},{"class":690},[8250],{"type":24,"value":8069},{"type":18,"tag":633,"props":8252,"children":8253},{"class":646},[8254],{"type":24,"value":8074},{"type":18,"tag":633,"props":8256,"children":8257},{"class":5368},[8258],{"type":24,"value":8259},"\"u2\"",{"type":18,"tag":633,"props":8261,"children":8262},{"class":646},[8263],{"type":24,"value":1442},{"type":18,"tag":633,"props":8265,"children":8266},{"class":635,"line":858},[8267,8272,8276],{"type":18,"tag":633,"props":8268,"children":8269},{"class":646},[8270],{"type":24,"value":8271},"controls ",{"type":18,"tag":633,"props":8273,"children":8274},{"class":640},[8275],{"type":24,"value":730},{"type":18,"tag":633,"props":8277,"children":8278},{"class":646},[8279],{"type":24,"value":8280}," ca.vertcat(u1, u2)\n",{"type":18,"tag":633,"props":8282,"children":8283},{"class":635,"line":894},[8284,8289,8293],{"type":18,"tag":633,"props":8285,"children":8286},{"class":646},[8287],{"type":24,"value":8288},"num_controls ",{"type":18,"tag":633,"props":8290,"children":8291},{"class":640},[8292],{"type":24,"value":730},{"type":18,"tag":633,"props":8294,"children":8295},{"class":646},[8296],{"type":24,"value":8297}," controls.numel()\n",{"type":18,"tag":633,"props":8299,"children":8300},{"class":635,"line":927},[8301],{"type":18,"tag":633,"props":8302,"children":8303},{},[8304],{"type":24,"value":669},{"type":18,"tag":633,"props":8306,"children":8307},{"class":635,"line":935},[8308],{"type":18,"tag":633,"props":8309,"children":8310},{"class":1870},[8311],{"type":24,"value":8312},"# Define Nonlinear model\n",{"type":18,"tag":633,"props":8314,"children":8315},{"class":635,"line":969},[8316],{"type":18,"tag":633,"props":8317,"children":8318},{"class":1870},[8319],{"type":24,"value":8320},"## Rotation Matrix\n",{"type":18,"tag":633,"props":8322,"children":8323},{"class":635,"line":1003},[8324,8329,8333],{"type":18,"tag":633,"props":8325,"children":8326},{"class":646},[8327],{"type":24,"value":8328},"rot_mat ",{"type":18,"tag":633,"props":8330,"children":8331},{"class":640},[8332],{"type":24,"value":730},{"type":18,"tag":633,"props":8334,"children":8335},{"class":646},[8336],{"type":24,"value":8337}," ca.vertcat(\n",{"type":18,"tag":633,"props":8339,"children":8340},{"class":635,"line":1011},[8341,8346,8350],{"type":18,"tag":633,"props":8342,"children":8343},{"class":646},[8344],{"type":24,"value":8345},"    ca.horzcat(ca.cos(theta), ca.sin(theta), ",{"type":18,"tag":633,"props":8347,"children":8348},{"class":690},[8349],{"type":24,"value":886},{"type":18,"tag":633,"props":8351,"children":8352},{"class":646},[8353],{"type":24,"value":8354},"),\n",{"type":18,"tag":633,"props":8356,"children":8357},{"class":635,"line":1037},[8358,8363,8367,8372,8376],{"type":18,"tag":633,"props":8359,"children":8360},{"class":646},[8361],{"type":24,"value":8362},"    ca.horzcat(",{"type":18,"tag":633,"props":8364,"children":8365},{"class":640},[8366],{"type":24,"value":1065},{"type":18,"tag":633,"props":8368,"children":8369},{"class":646},[8370],{"type":24,"value":8371},"ca.sin(theta), ca.cos(theta), ",{"type":18,"tag":633,"props":8373,"children":8374},{"class":690},[8375],{"type":24,"value":886},{"type":18,"tag":633,"props":8377,"children":8378},{"class":646},[8379],{"type":24,"value":8354},{"type":18,"tag":633,"props":8381,"children":8382},{"class":635,"line":1045},[8383,8387,8391,8395,8399,8403,8407],{"type":18,"tag":633,"props":8384,"children":8385},{"class":646},[8386],{"type":24,"value":8362},{"type":18,"tag":633,"props":8388,"children":8389},{"class":690},[8390],{"type":24,"value":886},{"type":18,"tag":633,"props":8392,"children":8393},{"class":646},[8394],{"type":24,"value":2436},{"type":18,"tag":633,"props":8396,"children":8397},{"class":690},[8398],{"type":24,"value":886},{"type":18,"tag":633,"props":8400,"children":8401},{"class":646},[8402],{"type":24,"value":2436},{"type":18,"tag":633,"props":8404,"children":8405},{"class":690},[8406],{"type":24,"value":996},{"type":18,"tag":633,"props":8408,"children":8409},{"class":646},[8410],{"type":24,"value":1442},{"type":18,"tag":633,"props":8412,"children":8413},{"class":635,"line":1087},[8414],{"type":18,"tag":633,"props":8415,"children":8416},{"class":646},[8417],{"type":24,"value":1442},{"type":18,"tag":633,"props":8419,"children":8420},{"class":635,"line":1127},[8421],{"type":18,"tag":633,"props":8422,"children":8423},{},[8424],{"type":24,"value":669},{"type":18,"tag":633,"props":8426,"children":8427},{"class":635,"line":1221},[8428,8433,8437,8442,8446],{"type":18,"tag":633,"props":8429,"children":8430},{"class":646},[8431],{"type":24,"value":8432},"vx ",{"type":18,"tag":633,"props":8434,"children":8435},{"class":640},[8436],{"type":24,"value":730},{"type":18,"tag":633,"props":8438,"children":8439},{"class":646},[8440],{"type":24,"value":8441}," u1 ",{"type":18,"tag":633,"props":8443,"children":8444},{"class":640},[8445],{"type":24,"value":1075},{"type":18,"tag":633,"props":8447,"children":8448},{"class":646},[8449],{"type":24,"value":8450}," ca.cos(theta)\n",{"type":18,"tag":633,"props":8452,"children":8453},{"class":635,"line":1229},[8454,8459,8463,8467,8471],{"type":18,"tag":633,"props":8455,"children":8456},{"class":646},[8457],{"type":24,"value":8458},"vy ",{"type":18,"tag":633,"props":8460,"children":8461},{"class":640},[8462],{"type":24,"value":730},{"type":18,"tag":633,"props":8464,"children":8465},{"class":646},[8466],{"type":24,"value":8441},{"type":18,"tag":633,"props":8468,"children":8469},{"class":640},[8470],{"type":24,"value":1075},{"type":18,"tag":633,"props":8472,"children":8473},{"class":646},[8474],{"type":24,"value":8475}," ca.sin(theta)\n",{"type":18,"tag":633,"props":8477,"children":8478},{"class":635,"line":1247},[8479,8484,8488],{"type":18,"tag":633,"props":8480,"children":8481},{"class":646},[8482],{"type":24,"value":8483},"vyaw ",{"type":18,"tag":633,"props":8485,"children":8486},{"class":640},[8487],{"type":24,"value":730},{"type":18,"tag":633,"props":8489,"children":8490},{"class":646},[8491],{"type":24,"value":8492}," u2\n",{"type":18,"tag":633,"props":8494,"children":8495},{"class":635,"line":1255},[8496],{"type":18,"tag":633,"props":8497,"children":8498},{},[8499],{"type":24,"value":669},{"type":18,"tag":633,"props":8501,"children":8502},{"class":635,"line":1281},[8503,8508,8512],{"type":18,"tag":633,"props":8504,"children":8505},{"class":646},[8506],{"type":24,"value":8507},"rhs ",{"type":18,"tag":633,"props":8509,"children":8510},{"class":640},[8511],{"type":24,"value":730},{"type":18,"tag":633,"props":8513,"children":8514},{"class":646},[8515],{"type":24,"value":8516}," ca.vertcat(vx, vy, vyaw)\n",{"type":18,"tag":633,"props":8518,"children":8519},{"class":635,"line":1289},[8520],{"type":18,"tag":633,"props":8521,"children":8522},{"class":1870},[8523],{"type":24,"value":8524},"## Define mapped nonlinear function f(x,u) -> rhs\n",{"type":18,"tag":633,"props":8526,"children":8527},{"class":635,"line":1445},[8528,8532,8536,8541,8546],{"type":18,"tag":633,"props":8529,"children":8530},{"class":646},[8531],{"type":24,"value":6970},{"type":18,"tag":633,"props":8533,"children":8534},{"class":640},[8535],{"type":24,"value":730},{"type":18,"tag":633,"props":8537,"children":8538},{"class":646},[8539],{"type":24,"value":8540}," ca.Function(",{"type":18,"tag":633,"props":8542,"children":8543},{"class":5368},[8544],{"type":24,"value":8545},"'f'",{"type":18,"tag":633,"props":8547,"children":8548},{"class":646},[8549],{"type":24,"value":8550},", [states, controls], [rhs])",{"type":18,"tag":27,"props":8552,"children":8553},{},[8554],{"type":24,"value":8555},"Declare symbolic matrix",{"type":18,"tag":618,"props":8557,"children":8560},{"className":8558,"code":8559,"language":623,"meta":8},[621],"X = ca.SX.sym('X', num_states, prediction_horizons + 1)\nX_ref = ca.SX.sym('X_ref', num_states, prediction_horizons + 1)\nU = ca.SX.sym('U', num_controls, prediction_horizons)\nU_ref = ca.SX.sym('U_ref', num_controls, prediction_horizons)\n",[8561],{"type":18,"tag":626,"props":8562,"children":8563},{},[8564],{"type":18,"tag":618,"props":8565,"children":8566},{"__ignoreMap":8},[8567,8616,8665,8698],{"type":18,"tag":633,"props":8568,"children":8569},{"class":635,"line":636},[8570,8574,8578,8582,8586,8590,8595,8600,8604,8608,8612],{"type":18,"tag":633,"props":8571,"children":8572},{"class":646},[8573],{"type":24,"value":2640},{"type":18,"tag":633,"props":8575,"children":8576},{"class":640},[8577],{"type":24,"value":730},{"type":18,"tag":633,"props":8579,"children":8580},{"class":646},[8581],{"type":24,"value":8064},{"type":18,"tag":633,"props":8583,"children":8584},{"class":690},[8585],{"type":24,"value":8069},{"type":18,"tag":633,"props":8587,"children":8588},{"class":646},[8589],{"type":24,"value":8074},{"type":18,"tag":633,"props":8591,"children":8592},{"class":5368},[8593],{"type":24,"value":8594},"'X'",{"type":18,"tag":633,"props":8596,"children":8597},{"class":646},[8598],{"type":24,"value":8599},", num_states, prediction_horizons ",{"type":18,"tag":633,"props":8601,"children":8602},{"class":640},[8603],{"type":24,"value":1196},{"type":18,"tag":633,"props":8605,"children":8606},{"class":646},[8607],{"type":24,"value":649},{"type":18,"tag":633,"props":8609,"children":8610},{"class":690},[8611],{"type":24,"value":996},{"type":18,"tag":633,"props":8613,"children":8614},{"class":646},[8615],{"type":24,"value":1442},{"type":18,"tag":633,"props":8617,"children":8618},{"class":635,"line":663},[8619,8624,8628,8632,8636,8640,8645,8649,8653,8657,8661],{"type":18,"tag":633,"props":8620,"children":8621},{"class":646},[8622],{"type":24,"value":8623},"X_ref ",{"type":18,"tag":633,"props":8625,"children":8626},{"class":640},[8627],{"type":24,"value":730},{"type":18,"tag":633,"props":8629,"children":8630},{"class":646},[8631],{"type":24,"value":8064},{"type":18,"tag":633,"props":8633,"children":8634},{"class":690},[8635],{"type":24,"value":8069},{"type":18,"tag":633,"props":8637,"children":8638},{"class":646},[8639],{"type":24,"value":8074},{"type":18,"tag":633,"props":8641,"children":8642},{"class":5368},[8643],{"type":24,"value":8644},"'X_ref'",{"type":18,"tag":633,"props":8646,"children":8647},{"class":646},[8648],{"type":24,"value":8599},{"type":18,"tag":633,"props":8650,"children":8651},{"class":640},[8652],{"type":24,"value":1196},{"type":18,"tag":633,"props":8654,"children":8655},{"class":646},[8656],{"type":24,"value":649},{"type":18,"tag":633,"props":8658,"children":8659},{"class":690},[8660],{"type":24,"value":996},{"type":18,"tag":633,"props":8662,"children":8663},{"class":646},[8664],{"type":24,"value":1442},{"type":18,"tag":633,"props":8666,"children":8667},{"class":635,"line":672},[8668,8672,8676,8680,8684,8688,8693],{"type":18,"tag":633,"props":8669,"children":8670},{"class":646},[8671],{"type":24,"value":2675},{"type":18,"tag":633,"props":8673,"children":8674},{"class":640},[8675],{"type":24,"value":730},{"type":18,"tag":633,"props":8677,"children":8678},{"class":646},[8679],{"type":24,"value":8064},{"type":18,"tag":633,"props":8681,"children":8682},{"class":690},[8683],{"type":24,"value":8069},{"type":18,"tag":633,"props":8685,"children":8686},{"class":646},[8687],{"type":24,"value":8074},{"type":18,"tag":633,"props":8689,"children":8690},{"class":5368},[8691],{"type":24,"value":8692},"'U'",{"type":18,"tag":633,"props":8694,"children":8695},{"class":646},[8696],{"type":24,"value":8697},", num_controls, prediction_horizons)\n",{"type":18,"tag":633,"props":8699,"children":8700},{"class":635,"line":701},[8701,8706,8710,8714,8718,8722,8727],{"type":18,"tag":633,"props":8702,"children":8703},{"class":646},[8704],{"type":24,"value":8705},"U_ref ",{"type":18,"tag":633,"props":8707,"children":8708},{"class":640},[8709],{"type":24,"value":730},{"type":18,"tag":633,"props":8711,"children":8712},{"class":646},[8713],{"type":24,"value":8064},{"type":18,"tag":633,"props":8715,"children":8716},{"class":690},[8717],{"type":24,"value":8069},{"type":18,"tag":633,"props":8719,"children":8720},{"class":646},[8721],{"type":24,"value":8074},{"type":18,"tag":633,"props":8723,"children":8724},{"class":5368},[8725],{"type":24,"value":8726},"'U_ref'",{"type":18,"tag":633,"props":8728,"children":8729},{"class":646},[8730],{"type":24,"value":8731},", num_controls, prediction_horizons)",{"type":18,"tag":27,"props":8733,"children":8734},{},[8735,8737],{"type":24,"value":8736},"Define nonlinear programming and options for ",{"type":18,"tag":4379,"props":8738,"children":8739},{},[8740],{"type":24,"value":7982},{"type":18,"tag":618,"props":8742,"children":8745},{"className":8743,"code":8744,"language":623,"meta":8},[621],"nlp_prob = {\n    'f': cost_fn,\n    'x': opt_var,\n    'p': opt_dec,\n    'g': g\n}\n\nnlp_opts = {\n    'ipopt.max_iter': 5000,\n    'ipopt.print_level': 0,\n    'ipopt.acceptable_tol': 1e-6,\n    'ipopt.acceptable_obj_change_tol': 1e-4,\n    'print_time': 0\n}\n",[8746],{"type":18,"tag":626,"props":8747,"children":8748},{},[8749],{"type":18,"tag":618,"props":8750,"children":8751},{"__ignoreMap":8},[8752,8769,8785,8802,8819,8836,8844,8851,8867,8893,8917,8942,8967,8988],{"type":18,"tag":633,"props":8753,"children":8754},{"class":635,"line":636},[8755,8760,8764],{"type":18,"tag":633,"props":8756,"children":8757},{"class":646},[8758],{"type":24,"value":8759},"nlp_prob ",{"type":18,"tag":633,"props":8761,"children":8762},{"class":640},[8763],{"type":24,"value":730},{"type":18,"tag":633,"props":8765,"children":8766},{"class":646},[8767],{"type":24,"value":8768}," {\n",{"type":18,"tag":633,"props":8770,"children":8771},{"class":635,"line":663},[8772,8776,8780],{"type":18,"tag":633,"props":8773,"children":8774},{"class":646},[8775],{"type":24,"value":678},{"type":18,"tag":633,"props":8777,"children":8778},{"class":5368},[8779],{"type":24,"value":8545},{"type":18,"tag":633,"props":8781,"children":8782},{"class":646},[8783],{"type":24,"value":8784},": cost_fn,\n",{"type":18,"tag":633,"props":8786,"children":8787},{"class":635,"line":672},[8788,8792,8797],{"type":18,"tag":633,"props":8789,"children":8790},{"class":646},[8791],{"type":24,"value":678},{"type":18,"tag":633,"props":8793,"children":8794},{"class":5368},[8795],{"type":24,"value":8796},"'x'",{"type":18,"tag":633,"props":8798,"children":8799},{"class":646},[8800],{"type":24,"value":8801},": opt_var,\n",{"type":18,"tag":633,"props":8803,"children":8804},{"class":635,"line":701},[8805,8809,8814],{"type":18,"tag":633,"props":8806,"children":8807},{"class":646},[8808],{"type":24,"value":678},{"type":18,"tag":633,"props":8810,"children":8811},{"class":5368},[8812],{"type":24,"value":8813},"'p'",{"type":18,"tag":633,"props":8815,"children":8816},{"class":646},[8817],{"type":24,"value":8818},": opt_dec,\n",{"type":18,"tag":633,"props":8820,"children":8821},{"class":635,"line":709},[8822,8826,8831],{"type":18,"tag":633,"props":8823,"children":8824},{"class":646},[8825],{"type":24,"value":678},{"type":18,"tag":633,"props":8827,"children":8828},{"class":5368},[8829],{"type":24,"value":8830},"'g'",{"type":18,"tag":633,"props":8832,"children":8833},{"class":646},[8834],{"type":24,"value":8835},": g\n",{"type":18,"tag":633,"props":8837,"children":8838},{"class":635,"line":738},[8839],{"type":18,"tag":633,"props":8840,"children":8841},{"class":646},[8842],{"type":24,"value":8843},"}\n",{"type":18,"tag":633,"props":8845,"children":8846},{"class":635,"line":764},[8847],{"type":18,"tag":633,"props":8848,"children":8849},{},[8850],{"type":24,"value":669},{"type":18,"tag":633,"props":8852,"children":8853},{"class":635,"line":790},[8854,8859,8863],{"type":18,"tag":633,"props":8855,"children":8856},{"class":646},[8857],{"type":24,"value":8858},"nlp_opts ",{"type":18,"tag":633,"props":8860,"children":8861},{"class":640},[8862],{"type":24,"value":730},{"type":18,"tag":633,"props":8864,"children":8865},{"class":646},[8866],{"type":24,"value":8768},{"type":18,"tag":633,"props":8868,"children":8869},{"class":635,"line":798},[8870,8874,8879,8883,8888],{"type":18,"tag":633,"props":8871,"children":8872},{"class":646},[8873],{"type":24,"value":678},{"type":18,"tag":633,"props":8875,"children":8876},{"class":5368},[8877],{"type":24,"value":8878},"'ipopt.max_iter'",{"type":18,"tag":633,"props":8880,"children":8881},{"class":646},[8882],{"type":24,"value":477},{"type":18,"tag":633,"props":8884,"children":8885},{"class":690},[8886],{"type":24,"value":8887},"5000",{"type":18,"tag":633,"props":8889,"children":8890},{"class":646},[8891],{"type":24,"value":8892},",\n",{"type":18,"tag":633,"props":8894,"children":8895},{"class":635,"line":824},[8896,8900,8905,8909,8913],{"type":18,"tag":633,"props":8897,"children":8898},{"class":646},[8899],{"type":24,"value":678},{"type":18,"tag":633,"props":8901,"children":8902},{"class":5368},[8903],{"type":24,"value":8904},"'ipopt.print_level'",{"type":18,"tag":633,"props":8906,"children":8907},{"class":646},[8908],{"type":24,"value":477},{"type":18,"tag":633,"props":8910,"children":8911},{"class":690},[8912],{"type":24,"value":886},{"type":18,"tag":633,"props":8914,"children":8915},{"class":646},[8916],{"type":24,"value":8892},{"type":18,"tag":633,"props":8918,"children":8919},{"class":635,"line":850},[8920,8924,8929,8933,8938],{"type":18,"tag":633,"props":8921,"children":8922},{"class":646},[8923],{"type":24,"value":678},{"type":18,"tag":633,"props":8925,"children":8926},{"class":5368},[8927],{"type":24,"value":8928},"'ipopt.acceptable_tol'",{"type":18,"tag":633,"props":8930,"children":8931},{"class":646},[8932],{"type":24,"value":477},{"type":18,"tag":633,"props":8934,"children":8935},{"class":690},[8936],{"type":24,"value":8937},"1e-6",{"type":18,"tag":633,"props":8939,"children":8940},{"class":646},[8941],{"type":24,"value":8892},{"type":18,"tag":633,"props":8943,"children":8944},{"class":635,"line":858},[8945,8949,8954,8958,8963],{"type":18,"tag":633,"props":8946,"children":8947},{"class":646},[8948],{"type":24,"value":678},{"type":18,"tag":633,"props":8950,"children":8951},{"class":5368},[8952],{"type":24,"value":8953},"'ipopt.acceptable_obj_change_tol'",{"type":18,"tag":633,"props":8955,"children":8956},{"class":646},[8957],{"type":24,"value":477},{"type":18,"tag":633,"props":8959,"children":8960},{"class":690},[8961],{"type":24,"value":8962},"1e-4",{"type":18,"tag":633,"props":8964,"children":8965},{"class":646},[8966],{"type":24,"value":8892},{"type":18,"tag":633,"props":8968,"children":8969},{"class":635,"line":894},[8970,8974,8979,8983],{"type":18,"tag":633,"props":8971,"children":8972},{"class":646},[8973],{"type":24,"value":678},{"type":18,"tag":633,"props":8975,"children":8976},{"class":5368},[8977],{"type":24,"value":8978},"'print_time'",{"type":18,"tag":633,"props":8980,"children":8981},{"class":646},[8982],{"type":24,"value":477},{"type":18,"tag":633,"props":8984,"children":8985},{"class":690},[8986],{"type":24,"value":8987},"0\n",{"type":18,"tag":633,"props":8989,"children":8990},{"class":635,"line":927},[8991],{"type":18,"tag":633,"props":8992,"children":8993},{"class":646},[8994],{"type":24,"value":8995},"}",{"type":18,"tag":27,"props":8997,"children":8998},{},[8999],{"type":24,"value":9000},"Determine boundary and constraint for our optimizer",{"type":18,"tag":618,"props":9002,"children":9005},{"className":9003,"code":9004,"language":623,"meta":8},[621],"lbx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\nubx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\n\nlbx[0: num_states * (prediction_horizons + 1): num_states] = x_min\nlbx[1: num_states * (prediction_horizons + 1): num_states] = y_min\nlbx[2: num_states * (prediction_horizons + 1): num_states] = theta_min\n\nubx[0: num_states * (prediction_horizons + 1): num_states] = x_max\nubx[1: num_states * (prediction_horizons + 1): num_states] = y_max\nubx[2: num_states * (prediction_horizons + 1): num_states] = theta_max\n\nlbx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\nlbx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\n\nubx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\nubx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\n\nargs = {\n    'lbg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'ubg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'lbx': lbx,\n    'ubx': ubx\n}\n",[9006],{"type":18,"tag":626,"props":9007,"children":9008},{},[9009],{"type":18,"tag":618,"props":9010,"children":9011},{"__ignoreMap":8},[9012,9089,9161,9168,9219,9267,9315,9322,9371,9419,9467,9474,9557,9652,9659,9740,9835,9842,9858,9917,9973,9990,10007],{"type":18,"tag":633,"props":9013,"children":9014},{"class":635,"line":636},[9015,9020,9024,9028,9033,9038,9042,9047,9051,9055,9059,9063,9067,9072,9076,9081,9085],{"type":18,"tag":633,"props":9016,"children":9017},{"class":646},[9018],{"type":24,"value":9019},"lbx ",{"type":18,"tag":633,"props":9021,"children":9022},{"class":640},[9023],{"type":24,"value":730},{"type":18,"tag":633,"props":9025,"children":9026},{"class":646},[9027],{"type":24,"value":8064},{"type":18,"tag":633,"props":9029,"children":9030},{"class":690},[9031],{"type":24,"value":9032},"DM",{"type":18,"tag":633,"props":9034,"children":9035},{"class":646},[9036],{"type":24,"value":9037},".zeros((num_states ",{"type":18,"tag":633,"props":9039,"children":9040},{"class":640},[9041],{"type":24,"value":1075},{"type":18,"tag":633,"props":9043,"children":9044},{"class":646},[9045],{"type":24,"value":9046}," (prediction_horizons ",{"type":18,"tag":633,"props":9048,"children":9049},{"class":640},[9050],{"type":24,"value":1196},{"type":18,"tag":633,"props":9052,"children":9053},{"class":646},[9054],{"type":24,"value":649},{"type":18,"tag":633,"props":9056,"children":9057},{"class":690},[9058],{"type":24,"value":996},{"type":18,"tag":633,"props":9060,"children":9061},{"class":646},[9062],{"type":24,"value":5376},{"type":18,"tag":633,"props":9064,"children":9065},{"class":640},[9066],{"type":24,"value":1196},{"type":18,"tag":633,"props":9068,"children":9069},{"class":646},[9070],{"type":24,"value":9071}," num_controls ",{"type":18,"tag":633,"props":9073,"children":9074},{"class":640},[9075],{"type":24,"value":1075},{"type":18,"tag":633,"props":9077,"children":9078},{"class":646},[9079],{"type":24,"value":9080}," prediction_horizons, ",{"type":18,"tag":633,"props":9082,"children":9083},{"class":690},[9084],{"type":24,"value":996},{"type":18,"tag":633,"props":9086,"children":9087},{"class":646},[9088],{"type":24,"value":5153},{"type":18,"tag":633,"props":9090,"children":9091},{"class":635,"line":663},[9092,9097,9101,9105,9109,9113,9117,9121,9125,9129,9133,9137,9141,9145,9149,9153,9157],{"type":18,"tag":633,"props":9093,"children":9094},{"class":646},[9095],{"type":24,"value":9096},"ubx ",{"type":18,"tag":633,"props":9098,"children":9099},{"class":640},[9100],{"type":24,"value":730},{"type":18,"tag":633,"props":9102,"children":9103},{"class":646},[9104],{"type":24,"value":8064},{"type":18,"tag":633,"props":9106,"children":9107},{"class":690},[9108],{"type":24,"value":9032},{"type":18,"tag":633,"props":9110,"children":9111},{"class":646},[9112],{"type":24,"value":9037},{"type":18,"tag":633,"props":9114,"children":9115},{"class":640},[9116],{"type":24,"value":1075},{"type":18,"tag":633,"props":9118,"children":9119},{"class":646},[9120],{"type":24,"value":9046},{"type":18,"tag":633,"props":9122,"children":9123},{"class":640},[9124],{"type":24,"value":1196},{"type":18,"tag":633,"props":9126,"children":9127},{"class":646},[9128],{"type":24,"value":649},{"type":18,"tag":633,"props":9130,"children":9131},{"class":690},[9132],{"type":24,"value":996},{"type":18,"tag":633,"props":9134,"children":9135},{"class":646},[9136],{"type":24,"value":5376},{"type":18,"tag":633,"props":9138,"children":9139},{"class":640},[9140],{"type":24,"value":1196},{"type":18,"tag":633,"props":9142,"children":9143},{"class":646},[9144],{"type":24,"value":9071},{"type":18,"tag":633,"props":9146,"children":9147},{"class":640},[9148],{"type":24,"value":1075},{"type":18,"tag":633,"props":9150,"children":9151},{"class":646},[9152],{"type":24,"value":9080},{"type":18,"tag":633,"props":9154,"children":9155},{"class":690},[9156],{"type":24,"value":996},{"type":18,"tag":633,"props":9158,"children":9159},{"class":646},[9160],{"type":24,"value":5153},{"type":18,"tag":633,"props":9162,"children":9163},{"class":635,"line":672},[9164],{"type":18,"tag":633,"props":9165,"children":9166},{},[9167],{"type":24,"value":669},{"type":18,"tag":633,"props":9169,"children":9170},{"class":635,"line":701},[9171,9176,9180,9185,9189,9193,9197,9201,9205,9210,9214],{"type":18,"tag":633,"props":9172,"children":9173},{"class":646},[9174],{"type":24,"value":9175},"lbx[",{"type":18,"tag":633,"props":9177,"children":9178},{"class":690},[9179],{"type":24,"value":886},{"type":18,"tag":633,"props":9181,"children":9182},{"class":646},[9183],{"type":24,"value":9184},": num_states ",{"type":18,"tag":633,"props":9186,"children":9187},{"class":640},[9188],{"type":24,"value":1075},{"type":18,"tag":633,"props":9190,"children":9191},{"class":646},[9192],{"type":24,"value":9046},{"type":18,"tag":633,"props":9194,"children":9195},{"class":640},[9196],{"type":24,"value":1196},{"type":18,"tag":633,"props":9198,"children":9199},{"class":646},[9200],{"type":24,"value":649},{"type":18,"tag":633,"props":9202,"children":9203},{"class":690},[9204],{"type":24,"value":996},{"type":18,"tag":633,"props":9206,"children":9207},{"class":646},[9208],{"type":24,"value":9209},"): num_states] ",{"type":18,"tag":633,"props":9211,"children":9212},{"class":640},[9213],{"type":24,"value":730},{"type":18,"tag":633,"props":9215,"children":9216},{"class":646},[9217],{"type":24,"value":9218}," x_min\n",{"type":18,"tag":633,"props":9220,"children":9221},{"class":635,"line":709},[9222,9226,9230,9234,9238,9242,9246,9250,9254,9258,9262],{"type":18,"tag":633,"props":9223,"children":9224},{"class":646},[9225],{"type":24,"value":9175},{"type":18,"tag":633,"props":9227,"children":9228},{"class":690},[9229],{"type":24,"value":996},{"type":18,"tag":633,"props":9231,"children":9232},{"class":646},[9233],{"type":24,"value":9184},{"type":18,"tag":633,"props":9235,"children":9236},{"class":640},[9237],{"type":24,"value":1075},{"type":18,"tag":633,"props":9239,"children":9240},{"class":646},[9241],{"type":24,"value":9046},{"type":18,"tag":633,"props":9243,"children":9244},{"class":640},[9245],{"type":24,"value":1196},{"type":18,"tag":633,"props":9247,"children":9248},{"class":646},[9249],{"type":24,"value":649},{"type":18,"tag":633,"props":9251,"children":9252},{"class":690},[9253],{"type":24,"value":996},{"type":18,"tag":633,"props":9255,"children":9256},{"class":646},[9257],{"type":24,"value":9209},{"type":18,"tag":633,"props":9259,"children":9260},{"class":640},[9261],{"type":24,"value":730},{"type":18,"tag":633,"props":9263,"children":9264},{"class":646},[9265],{"type":24,"value":9266}," y_min\n",{"type":18,"tag":633,"props":9268,"children":9269},{"class":635,"line":738},[9270,9274,9278,9282,9286,9290,9294,9298,9302,9306,9310],{"type":18,"tag":633,"props":9271,"children":9272},{"class":646},[9273],{"type":24,"value":9175},{"type":18,"tag":633,"props":9275,"children":9276},{"class":690},[9277],{"type":24,"value":1372},{"type":18,"tag":633,"props":9279,"children":9280},{"class":646},[9281],{"type":24,"value":9184},{"type":18,"tag":633,"props":9283,"children":9284},{"class":640},[9285],{"type":24,"value":1075},{"type":18,"tag":633,"props":9287,"children":9288},{"class":646},[9289],{"type":24,"value":9046},{"type":18,"tag":633,"props":9291,"children":9292},{"class":640},[9293],{"type":24,"value":1196},{"type":18,"tag":633,"props":9295,"children":9296},{"class":646},[9297],{"type":24,"value":649},{"type":18,"tag":633,"props":9299,"children":9300},{"class":690},[9301],{"type":24,"value":996},{"type":18,"tag":633,"props":9303,"children":9304},{"class":646},[9305],{"type":24,"value":9209},{"type":18,"tag":633,"props":9307,"children":9308},{"class":640},[9309],{"type":24,"value":730},{"type":18,"tag":633,"props":9311,"children":9312},{"class":646},[9313],{"type":24,"value":9314}," theta_min\n",{"type":18,"tag":633,"props":9316,"children":9317},{"class":635,"line":764},[9318],{"type":18,"tag":633,"props":9319,"children":9320},{},[9321],{"type":24,"value":669},{"type":18,"tag":633,"props":9323,"children":9324},{"class":635,"line":790},[9325,9330,9334,9338,9342,9346,9350,9354,9358,9362,9366],{"type":18,"tag":633,"props":9326,"children":9327},{"class":646},[9328],{"type":24,"value":9329},"ubx[",{"type":18,"tag":633,"props":9331,"children":9332},{"class":690},[9333],{"type":24,"value":886},{"type":18,"tag":633,"props":9335,"children":9336},{"class":646},[9337],{"type":24,"value":9184},{"type":18,"tag":633,"props":9339,"children":9340},{"class":640},[9341],{"type":24,"value":1075},{"type":18,"tag":633,"props":9343,"children":9344},{"class":646},[9345],{"type":24,"value":9046},{"type":18,"tag":633,"props":9347,"children":9348},{"class":640},[9349],{"type":24,"value":1196},{"type":18,"tag":633,"props":9351,"children":9352},{"class":646},[9353],{"type":24,"value":649},{"type":18,"tag":633,"props":9355,"children":9356},{"class":690},[9357],{"type":24,"value":996},{"type":18,"tag":633,"props":9359,"children":9360},{"class":646},[9361],{"type":24,"value":9209},{"type":18,"tag":633,"props":9363,"children":9364},{"class":640},[9365],{"type":24,"value":730},{"type":18,"tag":633,"props":9367,"children":9368},{"class":646},[9369],{"type":24,"value":9370}," x_max\n",{"type":18,"tag":633,"props":9372,"children":9373},{"class":635,"line":798},[9374,9378,9382,9386,9390,9394,9398,9402,9406,9410,9414],{"type":18,"tag":633,"props":9375,"children":9376},{"class":646},[9377],{"type":24,"value":9329},{"type":18,"tag":633,"props":9379,"children":9380},{"class":690},[9381],{"type":24,"value":996},{"type":18,"tag":633,"props":9383,"children":9384},{"class":646},[9385],{"type":24,"value":9184},{"type":18,"tag":633,"props":9387,"children":9388},{"class":640},[9389],{"type":24,"value":1075},{"type":18,"tag":633,"props":9391,"children":9392},{"class":646},[9393],{"type":24,"value":9046},{"type":18,"tag":633,"props":9395,"children":9396},{"class":640},[9397],{"type":24,"value":1196},{"type":18,"tag":633,"props":9399,"children":9400},{"class":646},[9401],{"type":24,"value":649},{"type":18,"tag":633,"props":9403,"children":9404},{"class":690},[9405],{"type":24,"value":996},{"type":18,"tag":633,"props":9407,"children":9408},{"class":646},[9409],{"type":24,"value":9209},{"type":18,"tag":633,"props":9411,"children":9412},{"class":640},[9413],{"type":24,"value":730},{"type":18,"tag":633,"props":9415,"children":9416},{"class":646},[9417],{"type":24,"value":9418}," y_max\n",{"type":18,"tag":633,"props":9420,"children":9421},{"class":635,"line":824},[9422,9426,9430,9434,9438,9442,9446,9450,9454,9458,9462],{"type":18,"tag":633,"props":9423,"children":9424},{"class":646},[9425],{"type":24,"value":9329},{"type":18,"tag":633,"props":9427,"children":9428},{"class":690},[9429],{"type":24,"value":1372},{"type":18,"tag":633,"props":9431,"children":9432},{"class":646},[9433],{"type":24,"value":9184},{"type":18,"tag":633,"props":9435,"children":9436},{"class":640},[9437],{"type":24,"value":1075},{"type":18,"tag":633,"props":9439,"children":9440},{"class":646},[9441],{"type":24,"value":9046},{"type":18,"tag":633,"props":9443,"children":9444},{"class":640},[9445],{"type":24,"value":1196},{"type":18,"tag":633,"props":9447,"children":9448},{"class":646},[9449],{"type":24,"value":649},{"type":18,"tag":633,"props":9451,"children":9452},{"class":690},[9453],{"type":24,"value":996},{"type":18,"tag":633,"props":9455,"children":9456},{"class":646},[9457],{"type":24,"value":9209},{"type":18,"tag":633,"props":9459,"children":9460},{"class":640},[9461],{"type":24,"value":730},{"type":18,"tag":633,"props":9463,"children":9464},{"class":646},[9465],{"type":24,"value":9466}," theta_max\n",{"type":18,"tag":633,"props":9468,"children":9469},{"class":635,"line":850},[9470],{"type":18,"tag":633,"props":9471,"children":9472},{},[9473],{"type":24,"value":669},{"type":18,"tag":633,"props":9475,"children":9476},{"class":635,"line":858},[9477,9482,9486,9490,9494,9498,9502,9507,9511,9515,9519,9523,9527,9531,9535,9539,9543,9548,9552],{"type":18,"tag":633,"props":9478,"children":9479},{"class":646},[9480],{"type":24,"value":9481},"lbx[num_states ",{"type":18,"tag":633,"props":9483,"children":9484},{"class":640},[9485],{"type":24,"value":1075},{"type":18,"tag":633,"props":9487,"children":9488},{"class":646},[9489],{"type":24,"value":9046},{"type":18,"tag":633,"props":9491,"children":9492},{"class":640},[9493],{"type":24,"value":1196},{"type":18,"tag":633,"props":9495,"children":9496},{"class":646},[9497],{"type":24,"value":649},{"type":18,"tag":633,"props":9499,"children":9500},{"class":690},[9501],{"type":24,"value":996},{"type":18,"tag":633,"props":9503,"children":9504},{"class":646},[9505],{"type":24,"value":9506},"): num_states ",{"type":18,"tag":633,"props":9508,"children":9509},{"class":640},[9510],{"type":24,"value":1075},{"type":18,"tag":633,"props":9512,"children":9513},{"class":646},[9514],{"type":24,"value":9046},{"type":18,"tag":633,"props":9516,"children":9517},{"class":640},[9518],{"type":24,"value":1196},{"type":18,"tag":633,"props":9520,"children":9521},{"class":646},[9522],{"type":24,"value":649},{"type":18,"tag":633,"props":9524,"children":9525},{"class":690},[9526],{"type":24,"value":996},{"type":18,"tag":633,"props":9528,"children":9529},{"class":646},[9530],{"type":24,"value":5376},{"type":18,"tag":633,"props":9532,"children":9533},{"class":640},[9534],{"type":24,"value":1196},{"type":18,"tag":633,"props":9536,"children":9537},{"class":646},[9538],{"type":24,"value":9071},{"type":18,"tag":633,"props":9540,"children":9541},{"class":640},[9542],{"type":24,"value":1075},{"type":18,"tag":633,"props":9544,"children":9545},{"class":646},[9546],{"type":24,"value":9547}," prediction_horizons: num_controls] ",{"type":18,"tag":633,"props":9549,"children":9550},{"class":640},[9551],{"type":24,"value":730},{"type":18,"tag":633,"props":9553,"children":9554},{"class":646},[9555],{"type":24,"value":9556}," u_min\n",{"type":18,"tag":633,"props":9558,"children":9559},{"class":635,"line":894},[9560,9564,9568,9572,9576,9580,9584,9588,9592,9596,9600,9604,9608,9612,9616,9620,9624,9628,9632,9636,9640,9644,9648],{"type":18,"tag":633,"props":9561,"children":9562},{"class":646},[9563],{"type":24,"value":9481},{"type":18,"tag":633,"props":9565,"children":9566},{"class":640},[9567],{"type":24,"value":1075},{"type":18,"tag":633,"props":9569,"children":9570},{"class":646},[9571],{"type":24,"value":9046},{"type":18,"tag":633,"props":9573,"children":9574},{"class":640},[9575],{"type":24,"value":1196},{"type":18,"tag":633,"props":9577,"children":9578},{"class":646},[9579],{"type":24,"value":649},{"type":18,"tag":633,"props":9581,"children":9582},{"class":690},[9583],{"type":24,"value":996},{"type":18,"tag":633,"props":9585,"children":9586},{"class":646},[9587],{"type":24,"value":5376},{"type":18,"tag":633,"props":9589,"children":9590},{"class":640},[9591],{"type":24,"value":1196},{"type":18,"tag":633,"props":9593,"children":9594},{"class":646},[9595],{"type":24,"value":649},{"type":18,"tag":633,"props":9597,"children":9598},{"class":690},[9599],{"type":24,"value":996},{"type":18,"tag":633,"props":9601,"children":9602},{"class":646},[9603],{"type":24,"value":9184},{"type":18,"tag":633,"props":9605,"children":9606},{"class":640},[9607],{"type":24,"value":1075},{"type":18,"tag":633,"props":9609,"children":9610},{"class":646},[9611],{"type":24,"value":9046},{"type":18,"tag":633,"props":9613,"children":9614},{"class":640},[9615],{"type":24,"value":1196},{"type":18,"tag":633,"props":9617,"children":9618},{"class":646},[9619],{"type":24,"value":649},{"type":18,"tag":633,"props":9621,"children":9622},{"class":690},[9623],{"type":24,"value":996},{"type":18,"tag":633,"props":9625,"children":9626},{"class":646},[9627],{"type":24,"value":5376},{"type":18,"tag":633,"props":9629,"children":9630},{"class":640},[9631],{"type":24,"value":1196},{"type":18,"tag":633,"props":9633,"children":9634},{"class":646},[9635],{"type":24,"value":9071},{"type":18,"tag":633,"props":9637,"children":9638},{"class":640},[9639],{"type":24,"value":1075},{"type":18,"tag":633,"props":9641,"children":9642},{"class":646},[9643],{"type":24,"value":9547},{"type":18,"tag":633,"props":9645,"children":9646},{"class":640},[9647],{"type":24,"value":730},{"type":18,"tag":633,"props":9649,"children":9650},{"class":646},[9651],{"type":24,"value":9556},{"type":18,"tag":633,"props":9653,"children":9654},{"class":635,"line":927},[9655],{"type":18,"tag":633,"props":9656,"children":9657},{},[9658],{"type":24,"value":669},{"type":18,"tag":633,"props":9660,"children":9661},{"class":635,"line":935},[9662,9667,9671,9675,9679,9683,9687,9691,9695,9699,9703,9707,9711,9715,9719,9723,9727,9731,9735],{"type":18,"tag":633,"props":9663,"children":9664},{"class":646},[9665],{"type":24,"value":9666},"ubx[num_states ",{"type":18,"tag":633,"props":9668,"children":9669},{"class":640},[9670],{"type":24,"value":1075},{"type":18,"tag":633,"props":9672,"children":9673},{"class":646},[9674],{"type":24,"value":9046},{"type":18,"tag":633,"props":9676,"children":9677},{"class":640},[9678],{"type":24,"value":1196},{"type":18,"tag":633,"props":9680,"children":9681},{"class":646},[9682],{"type":24,"value":649},{"type":18,"tag":633,"props":9684,"children":9685},{"class":690},[9686],{"type":24,"value":996},{"type":18,"tag":633,"props":9688,"children":9689},{"class":646},[9690],{"type":24,"value":9506},{"type":18,"tag":633,"props":9692,"children":9693},{"class":640},[9694],{"type":24,"value":1075},{"type":18,"tag":633,"props":9696,"children":9697},{"class":646},[9698],{"type":24,"value":9046},{"type":18,"tag":633,"props":9700,"children":9701},{"class":640},[9702],{"type":24,"value":1196},{"type":18,"tag":633,"props":9704,"children":9705},{"class":646},[9706],{"type":24,"value":649},{"type":18,"tag":633,"props":9708,"children":9709},{"class":690},[9710],{"type":24,"value":996},{"type":18,"tag":633,"props":9712,"children":9713},{"class":646},[9714],{"type":24,"value":5376},{"type":18,"tag":633,"props":9716,"children":9717},{"class":640},[9718],{"type":24,"value":1196},{"type":18,"tag":633,"props":9720,"children":9721},{"class":646},[9722],{"type":24,"value":9071},{"type":18,"tag":633,"props":9724,"children":9725},{"class":640},[9726],{"type":24,"value":1075},{"type":18,"tag":633,"props":9728,"children":9729},{"class":646},[9730],{"type":24,"value":9547},{"type":18,"tag":633,"props":9732,"children":9733},{"class":640},[9734],{"type":24,"value":730},{"type":18,"tag":633,"props":9736,"children":9737},{"class":646},[9738],{"type":24,"value":9739}," u_max\n",{"type":18,"tag":633,"props":9741,"children":9742},{"class":635,"line":969},[9743,9747,9751,9755,9759,9763,9767,9771,9775,9779,9783,9787,9791,9795,9799,9803,9807,9811,9815,9819,9823,9827,9831],{"type":18,"tag":633,"props":9744,"children":9745},{"class":646},[9746],{"type":24,"value":9666},{"type":18,"tag":633,"props":9748,"children":9749},{"class":640},[9750],{"type":24,"value":1075},{"type":18,"tag":633,"props":9752,"children":9753},{"class":646},[9754],{"type":24,"value":9046},{"type":18,"tag":633,"props":9756,"children":9757},{"class":640},[9758],{"type":24,"value":1196},{"type":18,"tag":633,"props":9760,"children":9761},{"class":646},[9762],{"type":24,"value":649},{"type":18,"tag":633,"props":9764,"children":9765},{"class":690},[9766],{"type":24,"value":996},{"type":18,"tag":633,"props":9768,"children":9769},{"class":646},[9770],{"type":24,"value":5376},{"type":18,"tag":633,"props":9772,"children":9773},{"class":640},[9774],{"type":24,"value":1196},{"type":18,"tag":633,"props":9776,"children":9777},{"class":646},[9778],{"type":24,"value":649},{"type":18,"tag":633,"props":9780,"children":9781},{"class":690},[9782],{"type":24,"value":996},{"type":18,"tag":633,"props":9784,"children":9785},{"class":646},[9786],{"type":24,"value":9184},{"type":18,"tag":633,"props":9788,"children":9789},{"class":640},[9790],{"type":24,"value":1075},{"type":18,"tag":633,"props":9792,"children":9793},{"class":646},[9794],{"type":24,"value":9046},{"type":18,"tag":633,"props":9796,"children":9797},{"class":640},[9798],{"type":24,"value":1196},{"type":18,"tag":633,"props":9800,"children":9801},{"class":646},[9802],{"type":24,"value":649},{"type":18,"tag":633,"props":9804,"children":9805},{"class":690},[9806],{"type":24,"value":996},{"type":18,"tag":633,"props":9808,"children":9809},{"class":646},[9810],{"type":24,"value":5376},{"type":18,"tag":633,"props":9812,"children":9813},{"class":640},[9814],{"type":24,"value":1196},{"type":18,"tag":633,"props":9816,"children":9817},{"class":646},[9818],{"type":24,"value":9071},{"type":18,"tag":633,"props":9820,"children":9821},{"class":640},[9822],{"type":24,"value":1075},{"type":18,"tag":633,"props":9824,"children":9825},{"class":646},[9826],{"type":24,"value":9547},{"type":18,"tag":633,"props":9828,"children":9829},{"class":640},[9830],{"type":24,"value":730},{"type":18,"tag":633,"props":9832,"children":9833},{"class":646},[9834],{"type":24,"value":9739},{"type":18,"tag":633,"props":9836,"children":9837},{"class":635,"line":1003},[9838],{"type":18,"tag":633,"props":9839,"children":9840},{},[9841],{"type":24,"value":669},{"type":18,"tag":633,"props":9843,"children":9844},{"class":635,"line":1011},[9845,9850,9854],{"type":18,"tag":633,"props":9846,"children":9847},{"class":646},[9848],{"type":24,"value":9849},"args ",{"type":18,"tag":633,"props":9851,"children":9852},{"class":640},[9853],{"type":24,"value":730},{"type":18,"tag":633,"props":9855,"children":9856},{"class":646},[9857],{"type":24,"value":8768},{"type":18,"tag":633,"props":9859,"children":9860},{"class":635,"line":1037},[9861,9865,9870,9875,9879,9883,9887,9891,9895,9899,9903,9908,9912],{"type":18,"tag":633,"props":9862,"children":9863},{"class":646},[9864],{"type":24,"value":678},{"type":18,"tag":633,"props":9866,"children":9867},{"class":5368},[9868],{"type":24,"value":9869},"'lbg'",{"type":18,"tag":633,"props":9871,"children":9872},{"class":646},[9873],{"type":24,"value":9874},": ca.",{"type":18,"tag":633,"props":9876,"children":9877},{"class":690},[9878],{"type":24,"value":9032},{"type":18,"tag":633,"props":9880,"children":9881},{"class":646},[9882],{"type":24,"value":9037},{"type":18,"tag":633,"props":9884,"children":9885},{"class":640},[9886],{"type":24,"value":1075},{"type":18,"tag":633,"props":9888,"children":9889},{"class":646},[9890],{"type":24,"value":9046},{"type":18,"tag":633,"props":9892,"children":9893},{"class":640},[9894],{"type":24,"value":1196},{"type":18,"tag":633,"props":9896,"children":9897},{"class":646},[9898],{"type":24,"value":649},{"type":18,"tag":633,"props":9900,"children":9901},{"class":690},[9902],{"type":24,"value":996},{"type":18,"tag":633,"props":9904,"children":9905},{"class":646},[9906],{"type":24,"value":9907},"), ",{"type":18,"tag":633,"props":9909,"children":9910},{"class":690},[9911],{"type":24,"value":996},{"type":18,"tag":633,"props":9913,"children":9914},{"class":646},[9915],{"type":24,"value":9916},")),\n",{"type":18,"tag":633,"props":9918,"children":9919},{"class":635,"line":1045},[9920,9924,9929,9933,9937,9941,9945,9949,9953,9957,9961,9965,9969],{"type":18,"tag":633,"props":9921,"children":9922},{"class":646},[9923],{"type":24,"value":678},{"type":18,"tag":633,"props":9925,"children":9926},{"class":5368},[9927],{"type":24,"value":9928},"'ubg'",{"type":18,"tag":633,"props":9930,"children":9931},{"class":646},[9932],{"type":24,"value":9874},{"type":18,"tag":633,"props":9934,"children":9935},{"class":690},[9936],{"type":24,"value":9032},{"type":18,"tag":633,"props":9938,"children":9939},{"class":646},[9940],{"type":24,"value":9037},{"type":18,"tag":633,"props":9942,"children":9943},{"class":640},[9944],{"type":24,"value":1075},{"type":18,"tag":633,"props":9946,"children":9947},{"class":646},[9948],{"type":24,"value":9046},{"type":18,"tag":633,"props":9950,"children":9951},{"class":640},[9952],{"type":24,"value":1196},{"type":18,"tag":633,"props":9954,"children":9955},{"class":646},[9956],{"type":24,"value":649},{"type":18,"tag":633,"props":9958,"children":9959},{"class":690},[9960],{"type":24,"value":996},{"type":18,"tag":633,"props":9962,"children":9963},{"class":646},[9964],{"type":24,"value":9907},{"type":18,"tag":633,"props":9966,"children":9967},{"class":690},[9968],{"type":24,"value":996},{"type":18,"tag":633,"props":9970,"children":9971},{"class":646},[9972],{"type":24,"value":9916},{"type":18,"tag":633,"props":9974,"children":9975},{"class":635,"line":1087},[9976,9980,9985],{"type":18,"tag":633,"props":9977,"children":9978},{"class":646},[9979],{"type":24,"value":678},{"type":18,"tag":633,"props":9981,"children":9982},{"class":5368},[9983],{"type":24,"value":9984},"'lbx'",{"type":18,"tag":633,"props":9986,"children":9987},{"class":646},[9988],{"type":24,"value":9989},": lbx,\n",{"type":18,"tag":633,"props":9991,"children":9992},{"class":635,"line":1127},[9993,9997,10002],{"type":18,"tag":633,"props":9994,"children":9995},{"class":646},[9996],{"type":24,"value":678},{"type":18,"tag":633,"props":9998,"children":9999},{"class":5368},[10000],{"type":24,"value":10001},"'ubx'",{"type":18,"tag":633,"props":10003,"children":10004},{"class":646},[10005],{"type":24,"value":10006},": ubx\n",{"type":18,"tag":633,"props":10008,"children":10009},{"class":635,"line":1221},[10010],{"type":18,"tag":633,"props":10011,"children":10012},{"class":646},[10013],{"type":24,"value":8995},{"type":18,"tag":27,"props":10015,"children":10016},{},[10017],{"type":24,"value":10018},"Obtain the solution from the solver at each iteration",{"type":18,"tag":618,"props":10020,"children":10023},{"className":10021,"code":10022,"language":623,"meta":8},[621],"sol = solver(\n            x0=args['x0'],\n            p=args['p'],\n            lbx=args['lbx'],\n            ubx=args['ubx'],\n            lbg=args['lbg'],\n            ubg=args['ubg'],\n        )\n\n        sol_x = ca.reshape(sol['x'][:num_states * (prediction_horizons + 1)], 3, prediction_horizons + 1)\n        sol_u = ca.reshape(sol['x'][num_states * (prediction_horizons + 1):], 2, prediction_horizons)\n",[10024],{"type":18,"tag":626,"props":10025,"children":10026},{},[10027],{"type":18,"tag":618,"props":10028,"children":10029},{"__ignoreMap":8},[10030,10047,10078,10105,10133,10161,10189,10217,10225,10232,10308],{"type":18,"tag":633,"props":10031,"children":10032},{"class":635,"line":636},[10033,10038,10042],{"type":18,"tag":633,"props":10034,"children":10035},{"class":646},[10036],{"type":24,"value":10037},"sol ",{"type":18,"tag":633,"props":10039,"children":10040},{"class":640},[10041],{"type":24,"value":730},{"type":18,"tag":633,"props":10043,"children":10044},{"class":646},[10045],{"type":24,"value":10046}," solver(\n",{"type":18,"tag":633,"props":10048,"children":10049},{"class":635,"line":663},[10050,10055,10060,10064,10069,10074],{"type":18,"tag":633,"props":10051,"children":10052},{"class":646},[10053],{"type":24,"value":10054},"            ",{"type":18,"tag":633,"props":10056,"children":10057},{"class":5358},[10058],{"type":24,"value":10059},"x0",{"type":18,"tag":633,"props":10061,"children":10062},{"class":640},[10063],{"type":24,"value":730},{"type":18,"tag":633,"props":10065,"children":10066},{"class":646},[10067],{"type":24,"value":10068},"args[",{"type":18,"tag":633,"props":10070,"children":10071},{"class":5368},[10072],{"type":24,"value":10073},"'x0'",{"type":18,"tag":633,"props":10075,"children":10076},{"class":646},[10077],{"type":24,"value":3240},{"type":18,"tag":633,"props":10079,"children":10080},{"class":635,"line":672},[10081,10085,10089,10093,10097,10101],{"type":18,"tag":633,"props":10082,"children":10083},{"class":646},[10084],{"type":24,"value":10054},{"type":18,"tag":633,"props":10086,"children":10087},{"class":5358},[10088],{"type":24,"value":27},{"type":18,"tag":633,"props":10090,"children":10091},{"class":640},[10092],{"type":24,"value":730},{"type":18,"tag":633,"props":10094,"children":10095},{"class":646},[10096],{"type":24,"value":10068},{"type":18,"tag":633,"props":10098,"children":10099},{"class":5368},[10100],{"type":24,"value":8813},{"type":18,"tag":633,"props":10102,"children":10103},{"class":646},[10104],{"type":24,"value":3240},{"type":18,"tag":633,"props":10106,"children":10107},{"class":635,"line":701},[10108,10112,10117,10121,10125,10129],{"type":18,"tag":633,"props":10109,"children":10110},{"class":646},[10111],{"type":24,"value":10054},{"type":18,"tag":633,"props":10113,"children":10114},{"class":5358},[10115],{"type":24,"value":10116},"lbx",{"type":18,"tag":633,"props":10118,"children":10119},{"class":640},[10120],{"type":24,"value":730},{"type":18,"tag":633,"props":10122,"children":10123},{"class":646},[10124],{"type":24,"value":10068},{"type":18,"tag":633,"props":10126,"children":10127},{"class":5368},[10128],{"type":24,"value":9984},{"type":18,"tag":633,"props":10130,"children":10131},{"class":646},[10132],{"type":24,"value":3240},{"type":18,"tag":633,"props":10134,"children":10135},{"class":635,"line":709},[10136,10140,10145,10149,10153,10157],{"type":18,"tag":633,"props":10137,"children":10138},{"class":646},[10139],{"type":24,"value":10054},{"type":18,"tag":633,"props":10141,"children":10142},{"class":5358},[10143],{"type":24,"value":10144},"ubx",{"type":18,"tag":633,"props":10146,"children":10147},{"class":640},[10148],{"type":24,"value":730},{"type":18,"tag":633,"props":10150,"children":10151},{"class":646},[10152],{"type":24,"value":10068},{"type":18,"tag":633,"props":10154,"children":10155},{"class":5368},[10156],{"type":24,"value":10001},{"type":18,"tag":633,"props":10158,"children":10159},{"class":646},[10160],{"type":24,"value":3240},{"type":18,"tag":633,"props":10162,"children":10163},{"class":635,"line":738},[10164,10168,10173,10177,10181,10185],{"type":18,"tag":633,"props":10165,"children":10166},{"class":646},[10167],{"type":24,"value":10054},{"type":18,"tag":633,"props":10169,"children":10170},{"class":5358},[10171],{"type":24,"value":10172},"lbg",{"type":18,"tag":633,"props":10174,"children":10175},{"class":640},[10176],{"type":24,"value":730},{"type":18,"tag":633,"props":10178,"children":10179},{"class":646},[10180],{"type":24,"value":10068},{"type":18,"tag":633,"props":10182,"children":10183},{"class":5368},[10184],{"type":24,"value":9869},{"type":18,"tag":633,"props":10186,"children":10187},{"class":646},[10188],{"type":24,"value":3240},{"type":18,"tag":633,"props":10190,"children":10191},{"class":635,"line":764},[10192,10196,10201,10205,10209,10213],{"type":18,"tag":633,"props":10193,"children":10194},{"class":646},[10195],{"type":24,"value":10054},{"type":18,"tag":633,"props":10197,"children":10198},{"class":5358},[10199],{"type":24,"value":10200},"ubg",{"type":18,"tag":633,"props":10202,"children":10203},{"class":640},[10204],{"type":24,"value":730},{"type":18,"tag":633,"props":10206,"children":10207},{"class":646},[10208],{"type":24,"value":10068},{"type":18,"tag":633,"props":10210,"children":10211},{"class":5368},[10212],{"type":24,"value":9928},{"type":18,"tag":633,"props":10214,"children":10215},{"class":646},[10216],{"type":24,"value":3240},{"type":18,"tag":633,"props":10218,"children":10219},{"class":635,"line":790},[10220],{"type":18,"tag":633,"props":10221,"children":10222},{"class":646},[10223],{"type":24,"value":10224},"        )\n",{"type":18,"tag":633,"props":10226,"children":10227},{"class":635,"line":798},[10228],{"type":18,"tag":633,"props":10229,"children":10230},{},[10231],{"type":24,"value":669},{"type":18,"tag":633,"props":10233,"children":10234},{"class":635,"line":824},[10235,10240,10244,10249,10253,10258,10262,10266,10270,10274,10278,10283,10287,10292,10296,10300,10304],{"type":18,"tag":633,"props":10236,"children":10237},{"class":646},[10238],{"type":24,"value":10239},"        sol_x ",{"type":18,"tag":633,"props":10241,"children":10242},{"class":640},[10243],{"type":24,"value":730},{"type":18,"tag":633,"props":10245,"children":10246},{"class":646},[10247],{"type":24,"value":10248}," ca.reshape(sol[",{"type":18,"tag":633,"props":10250,"children":10251},{"class":5368},[10252],{"type":24,"value":8796},{"type":18,"tag":633,"props":10254,"children":10255},{"class":646},[10256],{"type":24,"value":10257},"][:num_states ",{"type":18,"tag":633,"props":10259,"children":10260},{"class":640},[10261],{"type":24,"value":1075},{"type":18,"tag":633,"props":10263,"children":10264},{"class":646},[10265],{"type":24,"value":9046},{"type":18,"tag":633,"props":10267,"children":10268},{"class":640},[10269],{"type":24,"value":1196},{"type":18,"tag":633,"props":10271,"children":10272},{"class":646},[10273],{"type":24,"value":649},{"type":18,"tag":633,"props":10275,"children":10276},{"class":690},[10277],{"type":24,"value":996},{"type":18,"tag":633,"props":10279,"children":10280},{"class":646},[10281],{"type":24,"value":10282},")], ",{"type":18,"tag":633,"props":10284,"children":10285},{"class":690},[10286],{"type":24,"value":2554},{"type":18,"tag":633,"props":10288,"children":10289},{"class":646},[10290],{"type":24,"value":10291},", prediction_horizons ",{"type":18,"tag":633,"props":10293,"children":10294},{"class":640},[10295],{"type":24,"value":1196},{"type":18,"tag":633,"props":10297,"children":10298},{"class":646},[10299],{"type":24,"value":649},{"type":18,"tag":633,"props":10301,"children":10302},{"class":690},[10303],{"type":24,"value":996},{"type":18,"tag":633,"props":10305,"children":10306},{"class":646},[10307],{"type":24,"value":1442},{"type":18,"tag":633,"props":10309,"children":10310},{"class":635,"line":850},[10311,10316,10320,10324,10328,10333,10337,10341,10345,10349,10353,10358,10362],{"type":18,"tag":633,"props":10312,"children":10313},{"class":646},[10314],{"type":24,"value":10315},"        sol_u ",{"type":18,"tag":633,"props":10317,"children":10318},{"class":640},[10319],{"type":24,"value":730},{"type":18,"tag":633,"props":10321,"children":10322},{"class":646},[10323],{"type":24,"value":10248},{"type":18,"tag":633,"props":10325,"children":10326},{"class":5368},[10327],{"type":24,"value":8796},{"type":18,"tag":633,"props":10329,"children":10330},{"class":646},[10331],{"type":24,"value":10332},"][num_states ",{"type":18,"tag":633,"props":10334,"children":10335},{"class":640},[10336],{"type":24,"value":1075},{"type":18,"tag":633,"props":10338,"children":10339},{"class":646},[10340],{"type":24,"value":9046},{"type":18,"tag":633,"props":10342,"children":10343},{"class":640},[10344],{"type":24,"value":1196},{"type":18,"tag":633,"props":10346,"children":10347},{"class":646},[10348],{"type":24,"value":649},{"type":18,"tag":633,"props":10350,"children":10351},{"class":690},[10352],{"type":24,"value":996},{"type":18,"tag":633,"props":10354,"children":10355},{"class":646},[10356],{"type":24,"value":10357},"):], ",{"type":18,"tag":633,"props":10359,"children":10360},{"class":690},[10361],{"type":24,"value":1372},{"type":18,"tag":633,"props":10363,"children":10364},{"class":646},[10365],{"type":24,"value":10366},", prediction_horizons)",{"type":18,"tag":19,"props":10368,"children":10370},{"id":10369},"result",[10371],{"type":24,"value":10372},"Result",{"type":18,"tag":27,"props":10374,"children":10375},{},[10376],{"type":24,"value":10377},"I use MPC to control the differential drive robot to move from it zero position the the desired postion that I want to follow !.\nI generate a circle trajectory and I fit this curve into my beautiful and robustness cost and then volia !!!.",{"type":18,"tag":6314,"props":10379,"children":10381},{"className":10380},[6317,6318,6319],[10382,10383],{"type":24,"value":6322},{"type":18,"tag":6324,"props":10384,"children":10387},{"className":10385,"src":10386,"width":6356,"height":6357},[6327],"/topics/robotics/nmpc/diff_mpc.png",[],{"type":18,"tag":6333,"props":10389,"children":10391},{"className":10390},[68,6336,6337,6338],[10392],{"type":24,"value":10393},"\n    Plot of differential drive robot follow the circle trajectory !!!.\n",{"type":18,"tag":19,"props":10395,"children":10396},{"id":6381},[10397],{"type":24,"value":10398},"In conclusion",{"type":18,"tag":27,"props":10400,"children":10401},{},[10402],{"type":24,"value":10403},"In my opinion, I think MPC is suitable for the control system, since it can provide the significant control input that was predicted over the finite future of time. This can ensure the safety of the system and also can provide a quick look or reaction to the control action of the system too.",{"type":18,"tag":19,"props":10405,"children":10407},{"id":10406},"reference",[10408],{"type":24,"value":10409},"Reference",{"type":18,"tag":284,"props":10411,"children":10412},{},[10413,10423,10433],{"type":18,"tag":80,"props":10414,"children":10415},{},[10416],{"type":18,"tag":6371,"props":10417,"children":10420},{"href":10418,"rel":10419},"https://github.com/MMehrez/MPC-and-MHE-implementation-in-MATLAB-using-Casadi",[6375],[10421],{"type":24,"value":10422},"MPC-and-MHE-implementation-in-MATLAB-using-Casadi",{"type":18,"tag":80,"props":10424,"children":10425},{},[10426],{"type":18,"tag":6371,"props":10427,"children":10430},{"href":10428,"rel":10429},"https://web.casadi.org",[6375],[10431],{"type":24,"value":10432},"CasAdi",{"type":18,"tag":80,"props":10434,"children":10435},{},[10436],{"type":18,"tag":6371,"props":10437,"children":10440},{"href":10438,"rel":10439},"https://github.com/SokhengDin/PathTracking",[6375],[10441],{"type":24,"value":6378},{"type":18,"tag":6450,"children":10443},[10444],{"type":24,"value":10445},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-326375{color:#6A737D;}\n.ct-533739{color:#79B8FF;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":663,"depth":663,"links":10447},[10448,10449,10450,10451,10452,10453,10454,10455,10456],{"id":35,"depth":663,"text":38},{"id":6516,"depth":663,"text":6519},{"id":6660,"depth":663,"text":6663},{"id":7898,"depth":663,"text":7901},{"id":7926,"depth":663,"text":7929},{"id":7969,"depth":663,"text":7972},{"id":10369,"depth":663,"text":10372},{"id":6381,"depth":663,"text":10398},{"id":10406,"depth":663,"text":10409},"content:topics:robotics:nonlinear-mpc.md","topics/robotics/nonlinear-mpc.md",{"_path":10460,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":10461,"description":10462,"author":10463,"slug":10464,"tag":10464,"img":10465,"body":10466,"_type":6466,"_id":12358,"_source":6468,"_file":12359,"_extension":6470},"/topics/robotics/pid-controller","Introduction to PID Controller in Python","PID Control is a feedback control","DIN SOKHENG","pid","/topics/robotics/nmpc/PID.png",{"type":15,"children":10467,"toc":12344},[10468,10474,10484,10490,10495,10501,10505,10544,10553,10559,10565,10575,10581,10586,10620,10626,10631,10636,10646,10652,10657,10661,10666,10670,10675,11077,11094,11640,11645,11651,11657,11675,11761,11766,11828,11833,11917,11929,12215,12221,12240,12254,12258,12268,12274,12284,12290,12294,12299,12303,12340],{"type":18,"tag":19,"props":10469,"children":10471},{"id":10470},"what-is-pid-controller",[10472],{"type":24,"value":10473},"What is PID Controller ?",{"type":18,"tag":27,"props":10475,"children":10476},{},[10477,10479,10483],{"type":24,"value":10478},"The Proportional Integral Derivative (PID) controller is a traditional method in control systems that has found widespread use in control system engineering and industrial applications since its emergence in the 1940s. A PID controller is considered a feedback controller, aiming to minimize the error between the system's feedback and the desired setpoint by manually or automatically fine-tuning the coefficients ",{"type":18,"tag":84,"props":10480,"children":10482},{"latex-express":10481,"styles":87},"K_{P}, K_{I}, K_{D}",[],{"type":24,"value":197},{"type":18,"tag":19,"props":10485,"children":10487},{"id":10486},"how-it-works",[10488],{"type":24,"value":10489},"How it works ?",{"type":18,"tag":27,"props":10491,"children":10492},{},[10493],{"type":24,"value":10494},"Imagine you want to control the speed of a DC motor to reach 300 RPM, but due to the natural response of the DC motor, it cannot reach the desired angular speed. PID offers a solution to this natural response by adjusting the system's time response using its three components, as shown in the formula below.",{"type":18,"tag":19,"props":10496,"children":10498},{"id":10497},"formulation",[10499],{"type":24,"value":10500},"Formulation",{"type":18,"tag":65,"props":10502,"children":10504},{"latex-express":10503,"styles":68},"u(t) = K_{p}e(t) + K_{I} \\int_{0}^{t} e(t) dt + K_{D} \\frac{d e(t)}{dt} ",[],{"type":18,"tag":76,"props":10506,"children":10507},{},[10508,10517,10526,10535],{"type":18,"tag":80,"props":10509,"children":10510},{},[10511,10515],{"type":18,"tag":84,"props":10512,"children":10514},{"latex-express":10513,"styles":87},"K_{P}",[],{"type":24,"value":10516}," represents the proportional gain.",{"type":18,"tag":80,"props":10518,"children":10519},{},[10520,10524],{"type":18,"tag":84,"props":10521,"children":10523},{"latex-express":10522,"styles":87},"K_{I}",[],{"type":24,"value":10525}," represents the integral gain.",{"type":18,"tag":80,"props":10527,"children":10528},{},[10529,10533],{"type":18,"tag":84,"props":10530,"children":10532},{"latex-express":10531,"styles":87},"K_{D}",[],{"type":24,"value":10534}," represents the derivative gain.",{"type":18,"tag":80,"props":10536,"children":10537},{},[10538,10542],{"type":18,"tag":84,"props":10539,"children":10541},{"latex-express":10540,"styles":87},"e(t)=target-feedback",[],{"type":24,"value":10543}," is the error between target point and feedback of the system",{"type":18,"tag":6314,"props":10545,"children":10547},{"className":10546},[6317,6318,6319],[10548,10549],{"type":24,"value":6322},{"type":18,"tag":6324,"props":10550,"children":10552},{"className":10551,"src":10465},[6327],[],{"type":18,"tag":6333,"props":10554,"children":10556},{"className":10555},[68,6336,6337,6338],[10557],{"type":24,"value":10558},"\n    The Block diagram of PID Controller\n",{"type":18,"tag":19,"props":10560,"children":10562},{"id":10561},"response-time",[10563],{"type":24,"value":10564},"Response Time",{"type":18,"tag":6314,"props":10566,"children":10568},{"className":10567},[6317,6318,6319],[10569,10570],{"type":24,"value":6322},{"type":18,"tag":6324,"props":10571,"children":10574},{"className":10572,"src":10573},[6327],"/topics/robotics/nmpc/response_timepid.png",[],{"type":18,"tag":6333,"props":10576,"children":10578},{"className":10577},[68,6336,6337,6338],[10579],{"type":24,"value":10580},"\n    The response time of the system with each K_P, K_I, K_D\n",{"type":18,"tag":27,"props":10582,"children":10583},{},[10584],{"type":24,"value":10585},"As you can see in the figure above, the response time of the system is difference.",{"type":18,"tag":76,"props":10587,"children":10588},{},[10589,10600,10610],{"type":18,"tag":80,"props":10590,"children":10591},{},[10592,10594,10598],{"type":24,"value":10593},"The response time with ",{"type":18,"tag":84,"props":10595,"children":10597},{"latex-express":10596,"styles":87},"K_{I}=2",[],{"type":24,"value":10599}," the system is likely to overshoot before reaching the steady-state, which may not be suitable for applications like controlling a DC motor.",{"type":18,"tag":80,"props":10601,"children":10602},{},[10603,10604,10608],{"type":24,"value":10593},{"type":18,"tag":84,"props":10605,"children":10607},{"latex-express":10606,"styles":87},"K_{i}=0.5, ",[],{"type":24,"value":10609},"  the response does not overshoot but has a slower response to reach the steady-state.",{"type":18,"tag":80,"props":10611,"children":10612},{},[10613,10614,10618],{"type":24,"value":10593},{"type":18,"tag":84,"props":10615,"children":10617},{"latex-express":10616,"styles":87},"K_{p}=1, K_{i}=1, K_{d}=1",[],{"type":24,"value":10619},"  there is a slight overshoot, but the steady-state is reached faster.",{"type":18,"tag":19,"props":10621,"children":10623},{"id":10622},"how-can-we-write-pid-code-in-python",[10624],{"type":24,"value":10625},"How can we write PID code in Python ?",{"type":18,"tag":27,"props":10627,"children":10628},{},[10629],{"type":24,"value":10630},"Let's use a differential drive robot as a case study system. A differential drive robot is commonly used in robotics and automation, making it an ideal choice for a demonstration.",{"type":18,"tag":27,"props":10632,"children":10633},{},[10634],{"type":24,"value":10635},"The configuration of Differential Drive Robot in axes OXY.",{"type":18,"tag":6314,"props":10637,"children":10639},{"className":10638},[6317,6318,6319],[10640,10641],{"type":24,"value":6322},{"type":18,"tag":6324,"props":10642,"children":10645},{"className":10643,"src":10644},[6327],"/topics/robotics/nmpc/diff_drive.png",[],{"type":18,"tag":6333,"props":10647,"children":10649},{"className":10648},[68,6336,6337,6338],[10650],{"type":24,"value":10651},"\n    The configuration of Differential Drive Robot in axes OXY.\n",{"type":18,"tag":27,"props":10653,"children":10654},{},[10655],{"type":24,"value":10656},"The forward kinematic equation",{"type":18,"tag":65,"props":10658,"children":10660},{"latex-express":10659,"styles":68},"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{\\theta} \\\\ \\omega \\end{bmatrix}\n ",[],{"type":18,"tag":27,"props":10662,"children":10663},{},[10664],{"type":24,"value":10665},"So, if we discretize the forward kinematic with a certain sampling time, we will get",{"type":18,"tag":84,"props":10667,"children":10669},{"latex-express":10668,"styles":68},"\n\\begin{bmatrix} x_{t+1} \\\\ y_{t+1} \\\\ \\theta_{t+1} \\end{bmatrix} = \\begin{bmatrix} x_{t} \\\\ y_{t} \\\\ \\theta_{t} \\end{bmatrix} +\\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix} \\times \\Delta t\n ",[],{"type":18,"tag":27,"props":10671,"children":10672},{},[10673],{"type":24,"value":10674},"In Python,",{"type":18,"tag":618,"props":10676,"children":10679},{"className":10677,"code":10678,"language":623,"meta":8},[621],"class DifferentialDrive:\n    def __init__(self):\n        self.r = 0.05\n        self.L = 0.25\n    def forward_kinematic(self, v, omega, yaw):\n        vx = v*np.cos(yaw)\n        vy = v*np.sin(yaw)\n        vyaw = omega\n\n        return vx, vy, vyaw\n    def discrete_state(self, x, y, yaw, v, omega, dt):\n        dx, dy, dyaw = self.forward_kinematic(v, omega, yaw)\n        x_next = x + dx * dt\n        y_next = y + dy * dt\n        yaw_next = yaw + dyaw * dt\n\n        return x_next, y_next, yaw_next\n",[10680],{"type":18,"tag":626,"props":10681,"children":10682},{},[10683],{"type":18,"tag":618,"props":10684,"children":10685},{"__ignoreMap":8},[10686,10706,10729,10758,10787,10812,10837,10862,10879,10886,10902,10927,10952,10986,11020,11054,11061],{"type":18,"tag":633,"props":10687,"children":10688},{"class":635,"line":636},[10689,10693,10697,10702],{"type":18,"tag":633,"props":10690,"children":10691},{"class":640},[10692],{"type":24,"value":643},{"type":18,"tag":633,"props":10694,"children":10695},{"class":646},[10696],{"type":24,"value":649},{"type":18,"tag":633,"props":10698,"children":10699},{"class":652},[10700],{"type":24,"value":10701},"DifferentialDrive",{"type":18,"tag":633,"props":10703,"children":10704},{"class":646},[10705],{"type":24,"value":660},{"type":18,"tag":633,"props":10707,"children":10708},{"class":635,"line":663},[10709,10713,10717,10721,10725],{"type":18,"tag":633,"props":10710,"children":10711},{"class":646},[10712],{"type":24,"value":678},{"type":18,"tag":633,"props":10714,"children":10715},{"class":640},[10716],{"type":24,"value":683},{"type":18,"tag":633,"props":10718,"children":10719},{"class":646},[10720],{"type":24,"value":649},{"type":18,"tag":633,"props":10722,"children":10723},{"class":690},[10724],{"type":24,"value":693},{"type":18,"tag":633,"props":10726,"children":10727},{"class":646},[10728],{"type":24,"value":1853},{"type":18,"tag":633,"props":10730,"children":10731},{"class":635,"line":672},[10732,10736,10740,10745,10749,10753],{"type":18,"tag":633,"props":10733,"children":10734},{"class":646},[10735],{"type":24,"value":715},{"type":18,"tag":633,"props":10737,"children":10738},{"class":690},[10739],{"type":24,"value":720},{"type":18,"tag":633,"props":10741,"children":10742},{"class":646},[10743],{"type":24,"value":10744},".r ",{"type":18,"tag":633,"props":10746,"children":10747},{"class":640},[10748],{"type":24,"value":730},{"type":18,"tag":633,"props":10750,"children":10751},{"class":646},[10752],{"type":24,"value":649},{"type":18,"tag":633,"props":10754,"children":10755},{"class":690},[10756],{"type":24,"value":10757},"0.05\n",{"type":18,"tag":633,"props":10759,"children":10760},{"class":635,"line":701},[10761,10765,10769,10774,10778,10782],{"type":18,"tag":633,"props":10762,"children":10763},{"class":646},[10764],{"type":24,"value":715},{"type":18,"tag":633,"props":10766,"children":10767},{"class":690},[10768],{"type":24,"value":720},{"type":18,"tag":633,"props":10770,"children":10771},{"class":646},[10772],{"type":24,"value":10773},".L ",{"type":18,"tag":633,"props":10775,"children":10776},{"class":640},[10777],{"type":24,"value":730},{"type":18,"tag":633,"props":10779,"children":10780},{"class":646},[10781],{"type":24,"value":649},{"type":18,"tag":633,"props":10783,"children":10784},{"class":690},[10785],{"type":24,"value":10786},"0.25\n",{"type":18,"tag":633,"props":10788,"children":10789},{"class":635,"line":709},[10790,10794,10798,10802,10807],{"type":18,"tag":633,"props":10791,"children":10792},{"class":646},[10793],{"type":24,"value":678},{"type":18,"tag":633,"props":10795,"children":10796},{"class":640},[10797],{"type":24,"value":683},{"type":18,"tag":633,"props":10799,"children":10800},{"class":646},[10801],{"type":24,"value":649},{"type":18,"tag":633,"props":10803,"children":10804},{"class":652},[10805],{"type":24,"value":10806},"forward_kinematic",{"type":18,"tag":633,"props":10808,"children":10809},{"class":646},[10810],{"type":24,"value":10811},"(self, v, omega, yaw):\n",{"type":18,"tag":633,"props":10813,"children":10814},{"class":635,"line":738},[10815,10820,10824,10829,10833],{"type":18,"tag":633,"props":10816,"children":10817},{"class":646},[10818],{"type":24,"value":10819},"        vx ",{"type":18,"tag":633,"props":10821,"children":10822},{"class":640},[10823],{"type":24,"value":730},{"type":18,"tag":633,"props":10825,"children":10826},{"class":646},[10827],{"type":24,"value":10828}," v",{"type":18,"tag":633,"props":10830,"children":10831},{"class":640},[10832],{"type":24,"value":1075},{"type":18,"tag":633,"props":10834,"children":10835},{"class":646},[10836],{"type":24,"value":1218},{"type":18,"tag":633,"props":10838,"children":10839},{"class":635,"line":764},[10840,10845,10849,10853,10857],{"type":18,"tag":633,"props":10841,"children":10842},{"class":646},[10843],{"type":24,"value":10844},"        vy ",{"type":18,"tag":633,"props":10846,"children":10847},{"class":640},[10848],{"type":24,"value":730},{"type":18,"tag":633,"props":10850,"children":10851},{"class":646},[10852],{"type":24,"value":10828},{"type":18,"tag":633,"props":10854,"children":10855},{"class":640},[10856],{"type":24,"value":1075},{"type":18,"tag":633,"props":10858,"children":10859},{"class":646},[10860],{"type":24,"value":10861},"np.sin(yaw)\n",{"type":18,"tag":633,"props":10863,"children":10864},{"class":635,"line":790},[10865,10870,10874],{"type":18,"tag":633,"props":10866,"children":10867},{"class":646},[10868],{"type":24,"value":10869},"        vyaw ",{"type":18,"tag":633,"props":10871,"children":10872},{"class":640},[10873],{"type":24,"value":730},{"type":18,"tag":633,"props":10875,"children":10876},{"class":646},[10877],{"type":24,"value":10878}," omega\n",{"type":18,"tag":633,"props":10880,"children":10881},{"class":635,"line":798},[10882],{"type":18,"tag":633,"props":10883,"children":10884},{},[10885],{"type":24,"value":669},{"type":18,"tag":633,"props":10887,"children":10888},{"class":635,"line":824},[10889,10893,10897],{"type":18,"tag":633,"props":10890,"children":10891},{"class":646},[10892],{"type":24,"value":715},{"type":18,"tag":633,"props":10894,"children":10895},{"class":640},[10896],{"type":24,"value":1239},{"type":18,"tag":633,"props":10898,"children":10899},{"class":646},[10900],{"type":24,"value":10901}," vx, vy, vyaw\n",{"type":18,"tag":633,"props":10903,"children":10904},{"class":635,"line":850},[10905,10909,10913,10917,10922],{"type":18,"tag":633,"props":10906,"children":10907},{"class":646},[10908],{"type":24,"value":678},{"type":18,"tag":633,"props":10910,"children":10911},{"class":640},[10912],{"type":24,"value":683},{"type":18,"tag":633,"props":10914,"children":10915},{"class":646},[10916],{"type":24,"value":649},{"type":18,"tag":633,"props":10918,"children":10919},{"class":652},[10920],{"type":24,"value":10921},"discrete_state",{"type":18,"tag":633,"props":10923,"children":10924},{"class":646},[10925],{"type":24,"value":10926},"(self, x, y, yaw, v, omega, dt):\n",{"type":18,"tag":633,"props":10928,"children":10929},{"class":635,"line":858},[10930,10935,10939,10943,10947],{"type":18,"tag":633,"props":10931,"children":10932},{"class":646},[10933],{"type":24,"value":10934},"        dx, dy, dyaw ",{"type":18,"tag":633,"props":10936,"children":10937},{"class":640},[10938],{"type":24,"value":730},{"type":18,"tag":633,"props":10940,"children":10941},{"class":646},[10942],{"type":24,"value":649},{"type":18,"tag":633,"props":10944,"children":10945},{"class":690},[10946],{"type":24,"value":720},{"type":18,"tag":633,"props":10948,"children":10949},{"class":646},[10950],{"type":24,"value":10951},".forward_kinematic(v, omega, yaw)\n",{"type":18,"tag":633,"props":10953,"children":10954},{"class":635,"line":894},[10955,10960,10964,10969,10973,10978,10982],{"type":18,"tag":633,"props":10956,"children":10957},{"class":646},[10958],{"type":24,"value":10959},"        x_next ",{"type":18,"tag":633,"props":10961,"children":10962},{"class":640},[10963],{"type":24,"value":730},{"type":18,"tag":633,"props":10965,"children":10966},{"class":646},[10967],{"type":24,"value":10968}," x ",{"type":18,"tag":633,"props":10970,"children":10971},{"class":640},[10972],{"type":24,"value":1196},{"type":18,"tag":633,"props":10974,"children":10975},{"class":646},[10976],{"type":24,"value":10977}," dx ",{"type":18,"tag":633,"props":10979,"children":10980},{"class":640},[10981],{"type":24,"value":1075},{"type":18,"tag":633,"props":10983,"children":10984},{"class":646},[10985],{"type":24,"value":2966},{"type":18,"tag":633,"props":10987,"children":10988},{"class":635,"line":927},[10989,10994,10998,11003,11007,11012,11016],{"type":18,"tag":633,"props":10990,"children":10991},{"class":646},[10992],{"type":24,"value":10993},"        y_next ",{"type":18,"tag":633,"props":10995,"children":10996},{"class":640},[10997],{"type":24,"value":730},{"type":18,"tag":633,"props":10999,"children":11000},{"class":646},[11001],{"type":24,"value":11002}," y ",{"type":18,"tag":633,"props":11004,"children":11005},{"class":640},[11006],{"type":24,"value":1196},{"type":18,"tag":633,"props":11008,"children":11009},{"class":646},[11010],{"type":24,"value":11011}," dy ",{"type":18,"tag":633,"props":11013,"children":11014},{"class":640},[11015],{"type":24,"value":1075},{"type":18,"tag":633,"props":11017,"children":11018},{"class":646},[11019],{"type":24,"value":2966},{"type":18,"tag":633,"props":11021,"children":11022},{"class":635,"line":935},[11023,11028,11032,11037,11041,11046,11050],{"type":18,"tag":633,"props":11024,"children":11025},{"class":646},[11026],{"type":24,"value":11027},"        yaw_next ",{"type":18,"tag":633,"props":11029,"children":11030},{"class":640},[11031],{"type":24,"value":730},{"type":18,"tag":633,"props":11033,"children":11034},{"class":646},[11035],{"type":24,"value":11036}," yaw ",{"type":18,"tag":633,"props":11038,"children":11039},{"class":640},[11040],{"type":24,"value":1196},{"type":18,"tag":633,"props":11042,"children":11043},{"class":646},[11044],{"type":24,"value":11045}," dyaw ",{"type":18,"tag":633,"props":11047,"children":11048},{"class":640},[11049],{"type":24,"value":1075},{"type":18,"tag":633,"props":11051,"children":11052},{"class":646},[11053],{"type":24,"value":2966},{"type":18,"tag":633,"props":11055,"children":11056},{"class":635,"line":969},[11057],{"type":18,"tag":633,"props":11058,"children":11059},{},[11060],{"type":24,"value":669},{"type":18,"tag":633,"props":11062,"children":11063},{"class":635,"line":1003},[11064,11068,11072],{"type":18,"tag":633,"props":11065,"children":11066},{"class":646},[11067],{"type":24,"value":715},{"type":18,"tag":633,"props":11069,"children":11070},{"class":640},[11071],{"type":24,"value":1239},{"type":18,"tag":633,"props":11073,"children":11074},{"class":646},[11075],{"type":24,"value":11076}," x_next, y_next, yaw_next",{"type":18,"tag":27,"props":11078,"children":11079},{},[11080,11082,11086,11088,11093],{"type":24,"value":11081},"The ",{"type":18,"tag":170,"props":11083,"children":11084},{},[11085],{"type":24,"value":6673},{"type":24,"value":11087}," class that we defined, has all the need attribute to use for PID control !!. We just need to write another class for our ",{"type":18,"tag":170,"props":11089,"children":11090},{},[11091],{"type":24,"value":11092}," PID Controller ",{"type":24,"value":197},{"type":18,"tag":618,"props":11095,"children":11098},{"className":11096,"code":11097,"language":623,"meta":8},[621],"class PIDController:\n    def __init__(self, kp, ki, kd, dt):\n\n        self.kp = kp\n        self.ki = ki\n        self.kd = kd\n        self.dt = dt\n        self.integral = 0\n\n    def calculate_pid(self, errors):\n        # Calculate proportional error\n        proportional = self.kp * errors[-1]\n        # Calculate integration error\n        integral = self.integral + self.ki * (errors[-1]) * self.dt\n        self.integral = integral\n        # Calculate derivative error\n        derivative = self.kd * (errors[-1] - errors[-2])/self.dt\n\n        output = proportional + integral + derivative\n\n        return output\n",[11099],{"type":18,"tag":626,"props":11100,"children":11101},{},[11102],{"type":18,"tag":618,"props":11103,"children":11104},{"__ignoreMap":8},[11105,11125,11149,11156,11181,11206,11231,11255,11283,11290,11315,11327,11372,11384,11462,11486,11498,11575,11582,11617,11624],{"type":18,"tag":633,"props":11106,"children":11107},{"class":635,"line":636},[11108,11112,11116,11121],{"type":18,"tag":633,"props":11109,"children":11110},{"class":640},[11111],{"type":24,"value":643},{"type":18,"tag":633,"props":11113,"children":11114},{"class":646},[11115],{"type":24,"value":649},{"type":18,"tag":633,"props":11117,"children":11118},{"class":652},[11119],{"type":24,"value":11120},"PIDController",{"type":18,"tag":633,"props":11122,"children":11123},{"class":646},[11124],{"type":24,"value":660},{"type":18,"tag":633,"props":11126,"children":11127},{"class":635,"line":663},[11128,11132,11136,11140,11144],{"type":18,"tag":633,"props":11129,"children":11130},{"class":646},[11131],{"type":24,"value":678},{"type":18,"tag":633,"props":11133,"children":11134},{"class":640},[11135],{"type":24,"value":683},{"type":18,"tag":633,"props":11137,"children":11138},{"class":646},[11139],{"type":24,"value":649},{"type":18,"tag":633,"props":11141,"children":11142},{"class":690},[11143],{"type":24,"value":693},{"type":18,"tag":633,"props":11145,"children":11146},{"class":646},[11147],{"type":24,"value":11148},"(self, kp, ki, kd, dt):\n",{"type":18,"tag":633,"props":11150,"children":11151},{"class":635,"line":672},[11152],{"type":18,"tag":633,"props":11153,"children":11154},{},[11155],{"type":24,"value":669},{"type":18,"tag":633,"props":11157,"children":11158},{"class":635,"line":701},[11159,11163,11167,11172,11176],{"type":18,"tag":633,"props":11160,"children":11161},{"class":646},[11162],{"type":24,"value":715},{"type":18,"tag":633,"props":11164,"children":11165},{"class":690},[11166],{"type":24,"value":720},{"type":18,"tag":633,"props":11168,"children":11169},{"class":646},[11170],{"type":24,"value":11171},".kp ",{"type":18,"tag":633,"props":11173,"children":11174},{"class":640},[11175],{"type":24,"value":730},{"type":18,"tag":633,"props":11177,"children":11178},{"class":646},[11179],{"type":24,"value":11180}," kp\n",{"type":18,"tag":633,"props":11182,"children":11183},{"class":635,"line":709},[11184,11188,11192,11197,11201],{"type":18,"tag":633,"props":11185,"children":11186},{"class":646},[11187],{"type":24,"value":715},{"type":18,"tag":633,"props":11189,"children":11190},{"class":690},[11191],{"type":24,"value":720},{"type":18,"tag":633,"props":11193,"children":11194},{"class":646},[11195],{"type":24,"value":11196},".ki ",{"type":18,"tag":633,"props":11198,"children":11199},{"class":640},[11200],{"type":24,"value":730},{"type":18,"tag":633,"props":11202,"children":11203},{"class":646},[11204],{"type":24,"value":11205}," ki\n",{"type":18,"tag":633,"props":11207,"children":11208},{"class":635,"line":738},[11209,11213,11217,11222,11226],{"type":18,"tag":633,"props":11210,"children":11211},{"class":646},[11212],{"type":24,"value":715},{"type":18,"tag":633,"props":11214,"children":11215},{"class":690},[11216],{"type":24,"value":720},{"type":18,"tag":633,"props":11218,"children":11219},{"class":646},[11220],{"type":24,"value":11221},".kd ",{"type":18,"tag":633,"props":11223,"children":11224},{"class":640},[11225],{"type":24,"value":730},{"type":18,"tag":633,"props":11227,"children":11228},{"class":646},[11229],{"type":24,"value":11230}," kd\n",{"type":18,"tag":633,"props":11232,"children":11233},{"class":635,"line":764},[11234,11238,11242,11247,11251],{"type":18,"tag":633,"props":11235,"children":11236},{"class":646},[11237],{"type":24,"value":715},{"type":18,"tag":633,"props":11239,"children":11240},{"class":690},[11241],{"type":24,"value":720},{"type":18,"tag":633,"props":11243,"children":11244},{"class":646},[11245],{"type":24,"value":11246},".dt ",{"type":18,"tag":633,"props":11248,"children":11249},{"class":640},[11250],{"type":24,"value":730},{"type":18,"tag":633,"props":11252,"children":11253},{"class":646},[11254],{"type":24,"value":2966},{"type":18,"tag":633,"props":11256,"children":11257},{"class":635,"line":790},[11258,11262,11266,11271,11275,11279],{"type":18,"tag":633,"props":11259,"children":11260},{"class":646},[11261],{"type":24,"value":715},{"type":18,"tag":633,"props":11263,"children":11264},{"class":690},[11265],{"type":24,"value":720},{"type":18,"tag":633,"props":11267,"children":11268},{"class":646},[11269],{"type":24,"value":11270},".integral ",{"type":18,"tag":633,"props":11272,"children":11273},{"class":640},[11274],{"type":24,"value":730},{"type":18,"tag":633,"props":11276,"children":11277},{"class":646},[11278],{"type":24,"value":649},{"type":18,"tag":633,"props":11280,"children":11281},{"class":690},[11282],{"type":24,"value":8987},{"type":18,"tag":633,"props":11284,"children":11285},{"class":635,"line":798},[11286],{"type":18,"tag":633,"props":11287,"children":11288},{},[11289],{"type":24,"value":669},{"type":18,"tag":633,"props":11291,"children":11292},{"class":635,"line":824},[11293,11297,11301,11305,11310],{"type":18,"tag":633,"props":11294,"children":11295},{"class":646},[11296],{"type":24,"value":678},{"type":18,"tag":633,"props":11298,"children":11299},{"class":640},[11300],{"type":24,"value":683},{"type":18,"tag":633,"props":11302,"children":11303},{"class":646},[11304],{"type":24,"value":649},{"type":18,"tag":633,"props":11306,"children":11307},{"class":652},[11308],{"type":24,"value":11309},"calculate_pid",{"type":18,"tag":633,"props":11311,"children":11312},{"class":646},[11313],{"type":24,"value":11314},"(self, errors):\n",{"type":18,"tag":633,"props":11316,"children":11317},{"class":635,"line":850},[11318,11322],{"type":18,"tag":633,"props":11319,"children":11320},{"class":646},[11321],{"type":24,"value":715},{"type":18,"tag":633,"props":11323,"children":11324},{"class":1870},[11325],{"type":24,"value":11326},"# Calculate proportional error\n",{"type":18,"tag":633,"props":11328,"children":11329},{"class":635,"line":858},[11330,11335,11339,11343,11347,11351,11355,11360,11364,11368],{"type":18,"tag":633,"props":11331,"children":11332},{"class":646},[11333],{"type":24,"value":11334},"        proportional ",{"type":18,"tag":633,"props":11336,"children":11337},{"class":640},[11338],{"type":24,"value":730},{"type":18,"tag":633,"props":11340,"children":11341},{"class":646},[11342],{"type":24,"value":649},{"type":18,"tag":633,"props":11344,"children":11345},{"class":690},[11346],{"type":24,"value":720},{"type":18,"tag":633,"props":11348,"children":11349},{"class":646},[11350],{"type":24,"value":11171},{"type":18,"tag":633,"props":11352,"children":11353},{"class":640},[11354],{"type":24,"value":1075},{"type":18,"tag":633,"props":11356,"children":11357},{"class":646},[11358],{"type":24,"value":11359}," errors[",{"type":18,"tag":633,"props":11361,"children":11362},{"class":640},[11363],{"type":24,"value":1065},{"type":18,"tag":633,"props":11365,"children":11366},{"class":690},[11367],{"type":24,"value":996},{"type":18,"tag":633,"props":11369,"children":11370},{"class":646},[11371],{"type":24,"value":891},{"type":18,"tag":633,"props":11373,"children":11374},{"class":635,"line":894},[11375,11379],{"type":18,"tag":633,"props":11376,"children":11377},{"class":646},[11378],{"type":24,"value":715},{"type":18,"tag":633,"props":11380,"children":11381},{"class":1870},[11382],{"type":24,"value":11383},"# Calculate integration error\n",{"type":18,"tag":633,"props":11385,"children":11386},{"class":635,"line":927},[11387,11392,11396,11400,11404,11408,11412,11416,11420,11424,11428,11433,11437,11441,11445,11449,11453,11457],{"type":18,"tag":633,"props":11388,"children":11389},{"class":646},[11390],{"type":24,"value":11391},"        integral ",{"type":18,"tag":633,"props":11393,"children":11394},{"class":640},[11395],{"type":24,"value":730},{"type":18,"tag":633,"props":11397,"children":11398},{"class":646},[11399],{"type":24,"value":649},{"type":18,"tag":633,"props":11401,"children":11402},{"class":690},[11403],{"type":24,"value":720},{"type":18,"tag":633,"props":11405,"children":11406},{"class":646},[11407],{"type":24,"value":11270},{"type":18,"tag":633,"props":11409,"children":11410},{"class":640},[11411],{"type":24,"value":1196},{"type":18,"tag":633,"props":11413,"children":11414},{"class":646},[11415],{"type":24,"value":649},{"type":18,"tag":633,"props":11417,"children":11418},{"class":690},[11419],{"type":24,"value":720},{"type":18,"tag":633,"props":11421,"children":11422},{"class":646},[11423],{"type":24,"value":11196},{"type":18,"tag":633,"props":11425,"children":11426},{"class":640},[11427],{"type":24,"value":1075},{"type":18,"tag":633,"props":11429,"children":11430},{"class":646},[11431],{"type":24,"value":11432}," (errors[",{"type":18,"tag":633,"props":11434,"children":11435},{"class":640},[11436],{"type":24,"value":1065},{"type":18,"tag":633,"props":11438,"children":11439},{"class":690},[11440],{"type":24,"value":996},{"type":18,"tag":633,"props":11442,"children":11443},{"class":646},[11444],{"type":24,"value":7626},{"type":18,"tag":633,"props":11446,"children":11447},{"class":640},[11448],{"type":24,"value":1075},{"type":18,"tag":633,"props":11450,"children":11451},{"class":646},[11452],{"type":24,"value":649},{"type":18,"tag":633,"props":11454,"children":11455},{"class":690},[11456],{"type":24,"value":720},{"type":18,"tag":633,"props":11458,"children":11459},{"class":646},[11460],{"type":24,"value":11461},".dt\n",{"type":18,"tag":633,"props":11463,"children":11464},{"class":635,"line":935},[11465,11469,11473,11477,11481],{"type":18,"tag":633,"props":11466,"children":11467},{"class":646},[11468],{"type":24,"value":715},{"type":18,"tag":633,"props":11470,"children":11471},{"class":690},[11472],{"type":24,"value":720},{"type":18,"tag":633,"props":11474,"children":11475},{"class":646},[11476],{"type":24,"value":11270},{"type":18,"tag":633,"props":11478,"children":11479},{"class":640},[11480],{"type":24,"value":730},{"type":18,"tag":633,"props":11482,"children":11483},{"class":646},[11484],{"type":24,"value":11485}," integral\n",{"type":18,"tag":633,"props":11487,"children":11488},{"class":635,"line":969},[11489,11493],{"type":18,"tag":633,"props":11490,"children":11491},{"class":646},[11492],{"type":24,"value":715},{"type":18,"tag":633,"props":11494,"children":11495},{"class":1870},[11496],{"type":24,"value":11497},"# Calculate derivative error\n",{"type":18,"tag":633,"props":11499,"children":11500},{"class":635,"line":1003},[11501,11506,11510,11514,11518,11522,11526,11530,11534,11538,11542,11546,11550,11554,11558,11563,11567,11571],{"type":18,"tag":633,"props":11502,"children":11503},{"class":646},[11504],{"type":24,"value":11505},"        derivative ",{"type":18,"tag":633,"props":11507,"children":11508},{"class":640},[11509],{"type":24,"value":730},{"type":18,"tag":633,"props":11511,"children":11512},{"class":646},[11513],{"type":24,"value":649},{"type":18,"tag":633,"props":11515,"children":11516},{"class":690},[11517],{"type":24,"value":720},{"type":18,"tag":633,"props":11519,"children":11520},{"class":646},[11521],{"type":24,"value":11221},{"type":18,"tag":633,"props":11523,"children":11524},{"class":640},[11525],{"type":24,"value":1075},{"type":18,"tag":633,"props":11527,"children":11528},{"class":646},[11529],{"type":24,"value":11432},{"type":18,"tag":633,"props":11531,"children":11532},{"class":640},[11533],{"type":24,"value":1065},{"type":18,"tag":633,"props":11535,"children":11536},{"class":690},[11537],{"type":24,"value":996},{"type":18,"tag":633,"props":11539,"children":11540},{"class":646},[11541],{"type":24,"value":2930},{"type":18,"tag":633,"props":11543,"children":11544},{"class":640},[11545],{"type":24,"value":1065},{"type":18,"tag":633,"props":11547,"children":11548},{"class":646},[11549],{"type":24,"value":11359},{"type":18,"tag":633,"props":11551,"children":11552},{"class":640},[11553],{"type":24,"value":1065},{"type":18,"tag":633,"props":11555,"children":11556},{"class":690},[11557],{"type":24,"value":1372},{"type":18,"tag":633,"props":11559,"children":11560},{"class":646},[11561],{"type":24,"value":11562},"])",{"type":18,"tag":633,"props":11564,"children":11565},{"class":640},[11566],{"type":24,"value":1433},{"type":18,"tag":633,"props":11568,"children":11569},{"class":690},[11570],{"type":24,"value":720},{"type":18,"tag":633,"props":11572,"children":11573},{"class":646},[11574],{"type":24,"value":11461},{"type":18,"tag":633,"props":11576,"children":11577},{"class":635,"line":1011},[11578],{"type":18,"tag":633,"props":11579,"children":11580},{},[11581],{"type":24,"value":669},{"type":18,"tag":633,"props":11583,"children":11584},{"class":635,"line":1037},[11585,11590,11594,11599,11603,11608,11612],{"type":18,"tag":633,"props":11586,"children":11587},{"class":646},[11588],{"type":24,"value":11589},"        output ",{"type":18,"tag":633,"props":11591,"children":11592},{"class":640},[11593],{"type":24,"value":730},{"type":18,"tag":633,"props":11595,"children":11596},{"class":646},[11597],{"type":24,"value":11598}," proportional ",{"type":18,"tag":633,"props":11600,"children":11601},{"class":640},[11602],{"type":24,"value":1196},{"type":18,"tag":633,"props":11604,"children":11605},{"class":646},[11606],{"type":24,"value":11607}," integral ",{"type":18,"tag":633,"props":11609,"children":11610},{"class":640},[11611],{"type":24,"value":1196},{"type":18,"tag":633,"props":11613,"children":11614},{"class":646},[11615],{"type":24,"value":11616}," derivative\n",{"type":18,"tag":633,"props":11618,"children":11619},{"class":635,"line":1045},[11620],{"type":18,"tag":633,"props":11621,"children":11622},{},[11623],{"type":24,"value":669},{"type":18,"tag":633,"props":11625,"children":11626},{"class":635,"line":1087},[11627,11631,11635],{"type":18,"tag":633,"props":11628,"children":11629},{"class":646},[11630],{"type":24,"value":715},{"type":18,"tag":633,"props":11632,"children":11633},{"class":640},[11634],{"type":24,"value":1239},{"type":18,"tag":633,"props":11636,"children":11637},{"class":646},[11638],{"type":24,"value":11639}," output",{"type":18,"tag":27,"props":11641,"children":11642},{},[11643],{"type":24,"value":11644},"Don't worry, this class just defined as the PID formula. So, by doing this, we will be able to use all the characteristic of our PID controller.",{"type":18,"tag":19,"props":11646,"children":11648},{"id":11647},"experiment",[11649],{"type":24,"value":11650},"Experiment",{"type":18,"tag":33,"props":11652,"children":11654},{"id":11653},"pid-for-point-control",[11655],{"type":24,"value":11656},"PID for point control",{"type":18,"tag":27,"props":11658,"children":11659},{},[11660,11662,11666,11668,11673],{"type":24,"value":11661},"If I want my DifferentialDrive robot go to point ",{"type":18,"tag":84,"props":11663,"children":11665},{"latex-express":11664,"styles":87},"x_{ref}, y_{ref}, \\theta_{ref}",[],{"type":24,"value":11667},", Then I can calculate the error between the reference point and the feedback position of the robot. I simulated my robot in the  ",{"type":18,"tag":4379,"props":11669,"children":11670},{},[11671],{"type":24,"value":11672},"for loop",{"type":24,"value":11674}," and calculate this error recursively.",{"type":18,"tag":618,"props":11676,"children":11679},{"className":11677,"code":11678,"language":623,"meta":8},[621],"error_x.append(ref_path[0]-current_x)\nerror_y.append(ref_path[1]-current_y)\nerror_yaw.append(ref_path[2]-current_yaw)\n",[11680],{"type":18,"tag":626,"props":11681,"children":11682},{},[11683],{"type":18,"tag":618,"props":11684,"children":11685},{"__ignoreMap":8},[11686,11711,11736],{"type":18,"tag":633,"props":11687,"children":11688},{"class":635,"line":636},[11689,11694,11698,11702,11706],{"type":18,"tag":633,"props":11690,"children":11691},{"class":646},[11692],{"type":24,"value":11693},"error_x.append(ref_path[",{"type":18,"tag":633,"props":11695,"children":11696},{"class":690},[11697],{"type":24,"value":886},{"type":18,"tag":633,"props":11699,"children":11700},{"class":646},[11701],{"type":24,"value":2616},{"type":18,"tag":633,"props":11703,"children":11704},{"class":640},[11705],{"type":24,"value":1065},{"type":18,"tag":633,"props":11707,"children":11708},{"class":646},[11709],{"type":24,"value":11710},"current_x)\n",{"type":18,"tag":633,"props":11712,"children":11713},{"class":635,"line":663},[11714,11719,11723,11727,11731],{"type":18,"tag":633,"props":11715,"children":11716},{"class":646},[11717],{"type":24,"value":11718},"error_y.append(ref_path[",{"type":18,"tag":633,"props":11720,"children":11721},{"class":690},[11722],{"type":24,"value":996},{"type":18,"tag":633,"props":11724,"children":11725},{"class":646},[11726],{"type":24,"value":2616},{"type":18,"tag":633,"props":11728,"children":11729},{"class":640},[11730],{"type":24,"value":1065},{"type":18,"tag":633,"props":11732,"children":11733},{"class":646},[11734],{"type":24,"value":11735},"current_y)\n",{"type":18,"tag":633,"props":11737,"children":11738},{"class":635,"line":672},[11739,11744,11748,11752,11756],{"type":18,"tag":633,"props":11740,"children":11741},{"class":646},[11742],{"type":24,"value":11743},"error_yaw.append(ref_path[",{"type":18,"tag":633,"props":11745,"children":11746},{"class":690},[11747],{"type":24,"value":1372},{"type":18,"tag":633,"props":11749,"children":11750},{"class":646},[11751],{"type":24,"value":2616},{"type":18,"tag":633,"props":11753,"children":11754},{"class":640},[11755],{"type":24,"value":1065},{"type":18,"tag":633,"props":11757,"children":11758},{"class":646},[11759],{"type":24,"value":11760},"current_yaw)",{"type":18,"tag":27,"props":11762,"children":11763},{},[11764],{"type":24,"value":11765},"Then, let's apply PID",{"type":18,"tag":618,"props":11767,"children":11770},{"className":11768,"code":11769,"language":623,"meta":8},[621],"output_vx = pid_controller_x.calculate_pid(error_x)\noutput_vy = pid_controller_y.calculate_pid(error_y)\noutput_omega = pid_controller_yaw.calculate_pid(error_yaw)\n",[11771],{"type":18,"tag":626,"props":11772,"children":11773},{},[11774],{"type":18,"tag":618,"props":11775,"children":11776},{"__ignoreMap":8},[11777,11794,11811],{"type":18,"tag":633,"props":11778,"children":11779},{"class":635,"line":636},[11780,11785,11789],{"type":18,"tag":633,"props":11781,"children":11782},{"class":646},[11783],{"type":24,"value":11784},"output_vx ",{"type":18,"tag":633,"props":11786,"children":11787},{"class":640},[11788],{"type":24,"value":730},{"type":18,"tag":633,"props":11790,"children":11791},{"class":646},[11792],{"type":24,"value":11793}," pid_controller_x.calculate_pid(error_x)\n",{"type":18,"tag":633,"props":11795,"children":11796},{"class":635,"line":663},[11797,11802,11806],{"type":18,"tag":633,"props":11798,"children":11799},{"class":646},[11800],{"type":24,"value":11801},"output_vy ",{"type":18,"tag":633,"props":11803,"children":11804},{"class":640},[11805],{"type":24,"value":730},{"type":18,"tag":633,"props":11807,"children":11808},{"class":646},[11809],{"type":24,"value":11810}," pid_controller_y.calculate_pid(error_y)\n",{"type":18,"tag":633,"props":11812,"children":11813},{"class":635,"line":672},[11814,11819,11823],{"type":18,"tag":633,"props":11815,"children":11816},{"class":646},[11817],{"type":24,"value":11818},"output_omega ",{"type":18,"tag":633,"props":11820,"children":11821},{"class":640},[11822],{"type":24,"value":730},{"type":18,"tag":633,"props":11824,"children":11825},{"class":646},[11826],{"type":24,"value":11827}," pid_controller_yaw.calculate_pid(error_yaw)",{"type":18,"tag":27,"props":11829,"children":11830},{},[11831],{"type":24,"value":11832},"We will also need to update current position of the robot with the given optimal value from the PID controller.",{"type":18,"tag":618,"props":11834,"children":11837},{"className":11835,"code":11836,"language":623,"meta":8},[621],"x_next, y_next, yaw_next = diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) # Skip for omega we only look for x, y\ncurrent_x = x_next\ncurrent_y = y_next\ncurrent_yaw = yaw_next\n",[11838],{"type":18,"tag":626,"props":11839,"children":11840},{},[11841],{"type":18,"tag":618,"props":11842,"children":11843},{"__ignoreMap":8},[11844,11866,11883,11900],{"type":18,"tag":633,"props":11845,"children":11846},{"class":635,"line":636},[11847,11852,11856,11861],{"type":18,"tag":633,"props":11848,"children":11849},{"class":646},[11850],{"type":24,"value":11851},"x_next, y_next, yaw_next ",{"type":18,"tag":633,"props":11853,"children":11854},{"class":640},[11855],{"type":24,"value":730},{"type":18,"tag":633,"props":11857,"children":11858},{"class":646},[11859],{"type":24,"value":11860}," diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) ",{"type":18,"tag":633,"props":11862,"children":11863},{"class":1870},[11864],{"type":24,"value":11865},"# Skip for omega we only look for x, y\n",{"type":18,"tag":633,"props":11867,"children":11868},{"class":635,"line":663},[11869,11874,11878],{"type":18,"tag":633,"props":11870,"children":11871},{"class":646},[11872],{"type":24,"value":11873},"current_x ",{"type":18,"tag":633,"props":11875,"children":11876},{"class":640},[11877],{"type":24,"value":730},{"type":18,"tag":633,"props":11879,"children":11880},{"class":646},[11881],{"type":24,"value":11882}," x_next\n",{"type":18,"tag":633,"props":11884,"children":11885},{"class":635,"line":672},[11886,11891,11895],{"type":18,"tag":633,"props":11887,"children":11888},{"class":646},[11889],{"type":24,"value":11890},"current_y ",{"type":18,"tag":633,"props":11892,"children":11893},{"class":640},[11894],{"type":24,"value":730},{"type":18,"tag":633,"props":11896,"children":11897},{"class":646},[11898],{"type":24,"value":11899}," y_next\n",{"type":18,"tag":633,"props":11901,"children":11902},{"class":635,"line":701},[11903,11908,11912],{"type":18,"tag":633,"props":11904,"children":11905},{"class":646},[11906],{"type":24,"value":11907},"current_yaw ",{"type":18,"tag":633,"props":11909,"children":11910},{"class":640},[11911],{"type":24,"value":730},{"type":18,"tag":633,"props":11913,"children":11914},{"class":646},[11915],{"type":24,"value":11916}," yaw_next",{"type":18,"tag":27,"props":11918,"children":11919},{},[11920,11922,11927],{"type":24,"value":11921},"I use ",{"type":18,"tag":4379,"props":11923,"children":11924},{},[11925],{"type":24,"value":11926},"matplotlib",{"type":24,"value":11928}," library to simulate my robot.",{"type":18,"tag":618,"props":11930,"children":11933},{"className":11931,"code":11932,"language":623,"meta":8},[621],"plt.clf()\nplt.gcf().canvas.mpl_connect('key_release_event',\n            lambda event: [exit(0) if event.key == 'escape' else None])\nplot_arrow(current_x, current_y, current_yaw)\nplt.plot(5, 5)\nplt.plot(ref_path[0], ref_path[1], marker=\"x\", color=\"blue\", label=\"Input Trajectory\")\nplt.axis(\"equal\")\nplt.grid(True)\nplt.legend()\nplt.pause(0.0001)\n",[11934],{"type":18,"tag":626,"props":11935,"children":11936},{},[11937],{"type":18,"tag":618,"props":11938,"children":11939},{"__ignoreMap":8},[11940,11948,11965,12044,12052,12077,12155,12172,12189,12197],{"type":18,"tag":633,"props":11941,"children":11942},{"class":635,"line":636},[11943],{"type":18,"tag":633,"props":11944,"children":11945},{"class":646},[11946],{"type":24,"value":11947},"plt.clf()\n",{"type":18,"tag":633,"props":11949,"children":11950},{"class":635,"line":663},[11951,11956,11961],{"type":18,"tag":633,"props":11952,"children":11953},{"class":646},[11954],{"type":24,"value":11955},"plt.gcf().canvas.mpl_connect(",{"type":18,"tag":633,"props":11957,"children":11958},{"class":5368},[11959],{"type":24,"value":11960},"'key_release_event'",{"type":18,"tag":633,"props":11962,"children":11963},{"class":646},[11964],{"type":24,"value":8892},{"type":18,"tag":633,"props":11966,"children":11967},{"class":635,"line":672},[11968,11972,11976,11981,11986,11990,11994,11998,12003,12008,12013,12017,12022,12026,12031,12035,12040],{"type":18,"tag":633,"props":11969,"children":11970},{"class":646},[11971],{"type":24,"value":10054},{"type":18,"tag":633,"props":11973,"children":11974},{"class":640},[11975],{"type":24,"value":6983},{"type":18,"tag":633,"props":11977,"children":11978},{"class":646},[11979],{"type":24,"value":11980}," event: [",{"type":18,"tag":633,"props":11982,"children":11983},{"class":690},[11984],{"type":24,"value":11985},"exit",{"type":18,"tag":633,"props":11987,"children":11988},{"class":646},[11989],{"type":24,"value":1406},{"type":18,"tag":633,"props":11991,"children":11992},{"class":690},[11993],{"type":24,"value":886},{"type":18,"tag":633,"props":11995,"children":11996},{"class":646},[11997],{"type":24,"value":5376},{"type":18,"tag":633,"props":11999,"children":12000},{"class":640},[12001],{"type":24,"value":12002},"if",{"type":18,"tag":633,"props":12004,"children":12005},{"class":646},[12006],{"type":24,"value":12007}," event.key ",{"type":18,"tag":633,"props":12009,"children":12010},{"class":640},[12011],{"type":24,"value":12012},"==",{"type":18,"tag":633,"props":12014,"children":12015},{"class":646},[12016],{"type":24,"value":649},{"type":18,"tag":633,"props":12018,"children":12019},{"class":5368},[12020],{"type":24,"value":12021},"'escape'",{"type":18,"tag":633,"props":12023,"children":12024},{"class":646},[12025],{"type":24,"value":649},{"type":18,"tag":633,"props":12027,"children":12028},{"class":640},[12029],{"type":24,"value":12030},"else",{"type":18,"tag":633,"props":12032,"children":12033},{"class":646},[12034],{"type":24,"value":649},{"type":18,"tag":633,"props":12036,"children":12037},{"class":690},[12038],{"type":24,"value":12039},"None",{"type":18,"tag":633,"props":12041,"children":12042},{"class":646},[12043],{"type":24,"value":3299},{"type":18,"tag":633,"props":12045,"children":12046},{"class":635,"line":701},[12047],{"type":18,"tag":633,"props":12048,"children":12049},{"class":646},[12050],{"type":24,"value":12051},"plot_arrow(current_x, current_y, current_yaw)\n",{"type":18,"tag":633,"props":12053,"children":12054},{"class":635,"line":709},[12055,12060,12065,12069,12073],{"type":18,"tag":633,"props":12056,"children":12057},{"class":646},[12058],{"type":24,"value":12059},"plt.plot(",{"type":18,"tag":633,"props":12061,"children":12062},{"class":690},[12063],{"type":24,"value":12064},"5",{"type":18,"tag":633,"props":12066,"children":12067},{"class":646},[12068],{"type":24,"value":2436},{"type":18,"tag":633,"props":12070,"children":12071},{"class":690},[12072],{"type":24,"value":12064},{"type":18,"tag":633,"props":12074,"children":12075},{"class":646},[12076],{"type":24,"value":1442},{"type":18,"tag":633,"props":12078,"children":12079},{"class":635,"line":738},[12080,12085,12089,12094,12098,12102,12107,12111,12115,12119,12124,12128,12133,12137,12142,12146,12151],{"type":18,"tag":633,"props":12081,"children":12082},{"class":646},[12083],{"type":24,"value":12084},"plt.plot(ref_path[",{"type":18,"tag":633,"props":12086,"children":12087},{"class":690},[12088],{"type":24,"value":886},{"type":18,"tag":633,"props":12090,"children":12091},{"class":646},[12092],{"type":24,"value":12093},"], ref_path[",{"type":18,"tag":633,"props":12095,"children":12096},{"class":690},[12097],{"type":24,"value":996},{"type":18,"tag":633,"props":12099,"children":12100},{"class":646},[12101],{"type":24,"value":3266},{"type":18,"tag":633,"props":12103,"children":12104},{"class":5358},[12105],{"type":24,"value":12106},"marker",{"type":18,"tag":633,"props":12108,"children":12109},{"class":640},[12110],{"type":24,"value":730},{"type":18,"tag":633,"props":12112,"children":12113},{"class":5368},[12114],{"type":24,"value":8079},{"type":18,"tag":633,"props":12116,"children":12117},{"class":646},[12118],{"type":24,"value":2436},{"type":18,"tag":633,"props":12120,"children":12121},{"class":5358},[12122],{"type":24,"value":12123},"color",{"type":18,"tag":633,"props":12125,"children":12126},{"class":640},[12127],{"type":24,"value":730},{"type":18,"tag":633,"props":12129,"children":12130},{"class":5368},[12131],{"type":24,"value":12132},"\"blue\"",{"type":18,"tag":633,"props":12134,"children":12135},{"class":646},[12136],{"type":24,"value":2436},{"type":18,"tag":633,"props":12138,"children":12139},{"class":5358},[12140],{"type":24,"value":12141},"label",{"type":18,"tag":633,"props":12143,"children":12144},{"class":640},[12145],{"type":24,"value":730},{"type":18,"tag":633,"props":12147,"children":12148},{"class":5368},[12149],{"type":24,"value":12150},"\"Input Trajectory\"",{"type":18,"tag":633,"props":12152,"children":12153},{"class":646},[12154],{"type":24,"value":1442},{"type":18,"tag":633,"props":12156,"children":12157},{"class":635,"line":764},[12158,12163,12168],{"type":18,"tag":633,"props":12159,"children":12160},{"class":646},[12161],{"type":24,"value":12162},"plt.axis(",{"type":18,"tag":633,"props":12164,"children":12165},{"class":5368},[12166],{"type":24,"value":12167},"\"equal\"",{"type":18,"tag":633,"props":12169,"children":12170},{"class":646},[12171],{"type":24,"value":1442},{"type":18,"tag":633,"props":12173,"children":12174},{"class":635,"line":790},[12175,12180,12185],{"type":18,"tag":633,"props":12176,"children":12177},{"class":646},[12178],{"type":24,"value":12179},"plt.grid(",{"type":18,"tag":633,"props":12181,"children":12182},{"class":690},[12183],{"type":24,"value":12184},"True",{"type":18,"tag":633,"props":12186,"children":12187},{"class":646},[12188],{"type":24,"value":1442},{"type":18,"tag":633,"props":12190,"children":12191},{"class":635,"line":798},[12192],{"type":18,"tag":633,"props":12193,"children":12194},{"class":646},[12195],{"type":24,"value":12196},"plt.legend()\n",{"type":18,"tag":633,"props":12198,"children":12199},{"class":635,"line":824},[12200,12205,12210],{"type":18,"tag":633,"props":12201,"children":12202},{"class":646},[12203],{"type":24,"value":12204},"plt.pause(",{"type":18,"tag":633,"props":12206,"children":12207},{"class":690},[12208],{"type":24,"value":12209},"0.0001",{"type":18,"tag":633,"props":12211,"children":12212},{"class":646},[12213],{"type":24,"value":12214},")",{"type":18,"tag":33,"props":12216,"children":12218},{"id":12217},"path-tracking",[12219],{"type":24,"value":12220},"Path Tracking",{"type":18,"tag":27,"props":12222,"children":12223},{},[12224,12226,12231,12233,12238],{"type":24,"value":12225},"The code is all way the same. The different is that, I fit the continuous point into the robot instead of fixed goal point. I use ",{"type":18,"tag":4379,"props":12227,"children":12228},{},[12229],{"type":24,"value":12230},"BeizerCurve",{"type":24,"value":12232}," function to generate ",{"type":18,"tag":170,"props":12234,"children":12235},{},[12236],{"type":24,"value":12237}," Spline Trajectory ",{"type":24,"value":12239}," for the robot.",{"type":18,"tag":27,"props":12241,"children":12242},{},[12243,12245,12252],{"type":24,"value":12244},"The full code is published open-source on my Github. Link here ",{"type":18,"tag":6371,"props":12246,"children":12249},{"href":12247,"rel":12248},"https://github.com/SokhengDin/PathTracking/tree/main/PID",[6375],[12250],{"type":24,"value":12251},"Github",{"type":24,"value":12253},". Hit the star for me if you like my work .",{"type":18,"tag":33,"props":12255,"children":12256},{"id":10369},[12257],{"type":24,"value":10372},{"type":18,"tag":6314,"props":12259,"children":12261},{"className":12260},[6317,6318,6319],[12262,12263],{"type":24,"value":6322},{"type":18,"tag":6324,"props":12264,"children":12267},{"className":12265,"src":12266},[6327],"/topics/robotics/nmpc/Figure_pid_p.png",[],{"type":18,"tag":6333,"props":12269,"children":12271},{"className":12270},[68,6336,6337,6338],[12272],{"type":24,"value":12273},"\n    PID Controller with position control on Differential Drive Robot\n",{"type":18,"tag":6314,"props":12275,"children":12277},{"className":12276},[6317,6318,6319],[12278,12279],{"type":24,"value":6322},{"type":18,"tag":6324,"props":12280,"children":12283},{"className":12281,"src":12282},[6327],"/topics/robotics/nmpc/Figure_pid_t.png",[],{"type":18,"tag":6333,"props":12285,"children":12287},{"className":12286},[68,6336,6337,6338],[12288],{"type":24,"value":12289},"\n    PID Controller with path tracking control on Differential Drive Robot\n",{"type":18,"tag":19,"props":12291,"children":12292},{"id":6381},[12293],{"type":24,"value":6384},{"type":18,"tag":27,"props":12295,"children":12296},{},[12297],{"type":24,"value":12298},"In my opinion, the PID Controller is an excellent choice for most control system applications due to its simplicity and powerful capabilities in handling complex control challenges arising from various systems.",{"type":18,"tag":19,"props":12300,"children":12301},{"id":6392},[12302],{"type":24,"value":6395},{"type":18,"tag":284,"props":12304,"children":12305},{},[12306,12315,12320,12330],{"type":18,"tag":80,"props":12307,"children":12308},{},[12309],{"type":18,"tag":6371,"props":12310,"children":12313},{"href":12311,"rel":12312},"https://en.wikipedia.org/wiki/B%C3%A9zier_curve",[6375],[12314],{"type":24,"value":12230},{"type":18,"tag":80,"props":12316,"children":12317},{},[12318],{"type":24,"value":12319},"PID Controller: Control Systems Engineering by Normal S. Nise.",{"type":18,"tag":80,"props":12321,"children":12322},{},[12323],{"type":18,"tag":6371,"props":12324,"children":12327},{"href":12325,"rel":12326},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathPlanning/BezierPath",[6375],[12328],{"type":24,"value":12329},"Beizer Path",{"type":18,"tag":80,"props":12331,"children":12332},{},[12333],{"type":18,"tag":6371,"props":12334,"children":12337},{"href":12335,"rel":12336},"https://www.cds.caltech.edu/~murray/courses/cds101/fa02/caltech/astrom-ch6.pdf",[6375],[12338],{"type":24,"value":12339},"PID Lecture",{"type":18,"tag":6450,"children":12341},[12342],{"type":24,"value":12343},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":663,"depth":663,"links":12345},[12346,12347,12348,12349,12350,12351,12356,12357],{"id":10470,"depth":663,"text":10473},{"id":10486,"depth":663,"text":10489},{"id":10497,"depth":663,"text":10500},{"id":10561,"depth":663,"text":10564},{"id":10622,"depth":663,"text":10625},{"id":11647,"depth":663,"text":11650,"children":12352},[12353,12354,12355],{"id":11653,"depth":672,"text":11656},{"id":12217,"depth":672,"text":12220},{"id":10369,"depth":672,"text":10372},{"id":6381,"depth":663,"text":6384},{"id":6392,"depth":663,"text":6395},"content:topics:robotics:pid-controller.md","topics/robotics/pid-controller.md",{"_path":12361,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12362,"description":12363,"slug":12364,"tag":12364,"img":12365,"body":12366,"_type":6466,"_id":12598,"_source":6468,"_file":12599,"_extension":6470},"/topics/robotics/pure-pursuit","Pure Pursuit Controller","Introduction to Pure Pursuit Controller","pure-pursuit","/topics/robotics/nmpc/pure_pursuit.png",{"type":15,"children":12367,"toc":12591},[12368,12373,12383,12389,12394,12446,12452,12457,12509,12515,12520,12543,12548,12587],{"type":18,"tag":19,"props":12369,"children":12371},{"id":12370},"pure-pursuit-controller",[12372],{"type":24,"value":12362},{"type":18,"tag":27,"props":12374,"children":12375},{},[12376,12377,12381],{"type":24,"value":11081},{"type":18,"tag":170,"props":12378,"children":12379},{},[12380],{"type":24,"value":12362},{"type":24,"value":12382}," is a widely-used path-tracking algorithm in robotics and autonomous vehicle navigation. Its primary objective is to guide a vehicle or robot along a predefined path while ensuring precise path-following.",{"type":18,"tag":33,"props":12384,"children":12386},{"id":12385},"principle-of-operation",[12387],{"type":24,"value":12388},"Principle of Operation",{"type":18,"tag":27,"props":12390,"children":12391},{},[12392],{"type":24,"value":12393},"The operation of the Pure Pursuit Controller is based on a straightforward concept:",{"type":18,"tag":284,"props":12395,"children":12396},{},[12397,12407,12417,12427,12437],{"type":18,"tag":80,"props":12398,"children":12399},{},[12400,12405],{"type":18,"tag":170,"props":12401,"children":12402},{},[12403],{"type":24,"value":12404},"Path Definition",{"type":24,"value":12406},": The controller works with a defined path, often represented as a series of waypoints or a continuous curve, each associated with specific coordinates (x, y) and curvature information.",{"type":18,"tag":80,"props":12408,"children":12409},{},[12410,12415],{"type":18,"tag":170,"props":12411,"children":12412},{},[12413],{"type":24,"value":12414},"Target Point Selection",{"type":24,"value":12416},": The controller continuously selects a target point ahead of the vehicle. This target point is typically chosen as the point on the path that is a certain fixed distance (known as the \"lookahead distance\") in front of the vehicle.",{"type":18,"tag":80,"props":12418,"children":12419},{},[12420,12425],{"type":18,"tag":170,"props":12421,"children":12422},{},[12423],{"type":24,"value":12424},"Steering Command Calculation",{"type":24,"value":12426},": To navigate toward the target point, the controller calculates the steering command, often represented as the desired steering angle or curvature, required to reach the target point. Commonly, this involves computing the angle between the vehicle's current heading and the vector pointing from the current position to the target point.",{"type":18,"tag":80,"props":12428,"children":12429},{},[12430,12435],{"type":18,"tag":170,"props":12431,"children":12432},{},[12433],{"type":24,"value":12434},"Vehicle Control",{"type":24,"value":12436},": The calculated steering command is used to control the vehicle's steering mechanism (e.g., steering wheel or wheel angles) to guide it toward the target point.",{"type":18,"tag":80,"props":12438,"children":12439},{},[12440,12444],{"type":18,"tag":170,"props":12441,"children":12442},{},[12443],{"type":24,"value":349},{"type":24,"value":12445},": The process is iterative, with the controller continuously selecting new target points ahead as the vehicle advances along the path and adjusting its steering to reach them.",{"type":18,"tag":33,"props":12447,"children":12449},{"id":12448},"advantages",[12450],{"type":24,"value":12451},"Advantages",{"type":18,"tag":27,"props":12453,"children":12454},{},[12455],{"type":24,"value":12456},"The Pure Pursuit Controller offers several advantages:",{"type":18,"tag":76,"props":12458,"children":12459},{},[12460,12470,12479,12489,12499],{"type":18,"tag":80,"props":12461,"children":12462},{},[12463,12468],{"type":18,"tag":170,"props":12464,"children":12465},{},[12466],{"type":24,"value":12467},"Simplicity",{"type":24,"value":12469},": It is conceptually simple and easy to implement, making it suitable for a wide range of robotic and vehicle navigation applications.",{"type":18,"tag":80,"props":12471,"children":12472},{},[12473,12477],{"type":18,"tag":170,"props":12474,"children":12475},{},[12476],{"type":24,"value":12220},{"type":24,"value":12478},": The controller excels at accurate path tracking, even in complex environments with curves and turns.",{"type":18,"tag":80,"props":12480,"children":12481},{},[12482,12487],{"type":18,"tag":170,"props":12483,"children":12484},{},[12485],{"type":24,"value":12486},"Real-Time Operation",{"type":24,"value":12488},": It can operate in real-time, making it well-suited for dynamic environments where quick decision-making is crucial.",{"type":18,"tag":80,"props":12490,"children":12491},{},[12492,12497],{"type":18,"tag":170,"props":12493,"children":12494},{},[12495],{"type":24,"value":12496},"Adaptability",{"type":24,"value":12498},": The controller can adapt to changes in the path, such as deviations caused by obstacles or unexpected conditions, by continuously updating the target point.",{"type":18,"tag":80,"props":12500,"children":12501},{},[12502,12507],{"type":18,"tag":170,"props":12503,"children":12504},{},[12505],{"type":24,"value":12506},"Low Computational Overhead",{"type":24,"value":12508},": Compared to some other control algorithms, the Pure Pursuit Controller often has low computational requirements, which is advantageous for resource-constrained systems.",{"type":18,"tag":33,"props":12510,"children":12512},{"id":12511},"limitations",[12513],{"type":24,"value":12514},"Limitations",{"type":18,"tag":27,"props":12516,"children":12517},{},[12518],{"type":24,"value":12519},"Despite its advantages, the Pure Pursuit Controller has some limitations:",{"type":18,"tag":76,"props":12521,"children":12522},{},[12523,12533],{"type":18,"tag":80,"props":12524,"children":12525},{},[12526,12531],{"type":18,"tag":170,"props":12527,"children":12528},{},[12529],{"type":24,"value":12530},"Lookahead Distance Sensitivity",{"type":24,"value":12532},": Its performance can be sensitive to the choice of the lookahead distance, which requires careful tuning for optimal path tracking.",{"type":18,"tag":80,"props":12534,"children":12535},{},[12536,12541],{"type":18,"tag":170,"props":12537,"children":12538},{},[12539],{"type":24,"value":12540},"Non-Holonomic Assumption",{"type":24,"value":12542},": The controller assumes that the vehicle is non-holonomic, meaning it cannot move sideways. This assumption may not hold for certain types of vehicles, such as omnidirectional robots.",{"type":18,"tag":27,"props":12544,"children":12545},{},[12546],{"type":24,"value":12547},"In summary, the Pure Pursuit Controller is a straightforward yet effective algorithm for path tracking and navigation. Its ability to calculate a steering command based on a selected target point ahead of the vehicle makes it a valuable tool for applications ranging from autonomous cars to mobile robots.",{"type":18,"tag":618,"props":12549,"children":12554},{"className":12550,"code":12552,"language":12553,"meta":8},[12551],"language-js","console.log(\"Hello world\")\n\n","js",[12555],{"type":18,"tag":626,"props":12556,"children":12557},{},[12558],{"type":18,"tag":618,"props":12559,"children":12560},{"__ignoreMap":8},[12561],{"type":18,"tag":633,"props":12562,"children":12563},{"class":635,"line":636},[12564,12569,12574,12578,12583],{"type":18,"tag":633,"props":12565,"children":12566},{"class":646},[12567],{"type":24,"value":12568},"console.",{"type":18,"tag":633,"props":12570,"children":12571},{"class":652},[12572],{"type":24,"value":12573},"log",{"type":18,"tag":633,"props":12575,"children":12576},{"class":646},[12577],{"type":24,"value":1406},{"type":18,"tag":633,"props":12579,"children":12580},{"class":5368},[12581],{"type":24,"value":12582},"\"Hello world\"",{"type":18,"tag":633,"props":12584,"children":12585},{"class":646},[12586],{"type":24,"value":12214},{"type":18,"tag":6450,"children":12588},[12589],{"type":24,"value":12590},".ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-244866{color:#9ECBFF;}",{"title":8,"searchDepth":663,"depth":663,"links":12592},[12593],{"id":12370,"depth":663,"text":12362,"children":12594},[12595,12596,12597],{"id":12385,"depth":672,"text":12388},{"id":12448,"depth":672,"text":12451},{"id":12511,"depth":672,"text":12514},"content:topics:robotics:pure-pursuit.md","topics/robotics/pure-pursuit.md",{"_path":12601,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12602,"description":12603,"slug":12604,"tag":12604,"body":12605,"_type":6466,"_id":12806,"_source":6468,"_file":12807,"_extension":6470},"/topics/robotics/stanley-controller","Stanley Controller","Introduction to Stanley Controller","stanley",{"type":15,"children":12606,"toc":12799},[12607,12612,12622,12626,12631,12692,12696,12701,12752,12756,12761,12794],{"type":18,"tag":19,"props":12608,"children":12610},{"id":12609},"stanley-controller",[12611],{"type":24,"value":12602},{"type":18,"tag":27,"props":12613,"children":12614},{},[12615,12616,12620],{"type":24,"value":11081},{"type":18,"tag":170,"props":12617,"children":12618},{},[12619],{"type":24,"value":12602},{"type":24,"value":12621}," is an advanced path-tracking algorithm primarily used in the field of autonomous vehicle navigation. It is named after its creator, Professor John K. Hedrick, who developed it at Stanford University. The Stanley Controller is designed to enable a vehicle to follow a predefined path with high accuracy and stability.",{"type":18,"tag":33,"props":12623,"children":12624},{"id":12385},[12625],{"type":24,"value":12388},{"type":18,"tag":27,"props":12627,"children":12628},{},[12629],{"type":24,"value":12630},"The Stanley Controller operates based on a combination of control and feedback mechanisms:",{"type":18,"tag":284,"props":12632,"children":12633},{},[12634,12643,12653,12663,12673,12682],{"type":18,"tag":80,"props":12635,"children":12636},{},[12637,12641],{"type":18,"tag":170,"props":12638,"children":12639},{},[12640],{"type":24,"value":12404},{"type":24,"value":12642},": A predefined path is represented as a series of waypoints or a continuous curve. Each waypoint is associated with specific coordinates (x, y) and often includes additional information like desired speed and curvature.",{"type":18,"tag":80,"props":12644,"children":12645},{},[12646,12651],{"type":18,"tag":170,"props":12647,"children":12648},{},[12649],{"type":24,"value":12650},"Cross-Track Error (CTE) Calculation",{"type":24,"value":12652},": The controller calculates the cross-track error, which is the perpendicular distance between the vehicle's current position and the desired path. This error represents how far the vehicle has deviated from the path.",{"type":18,"tag":80,"props":12654,"children":12655},{},[12656,12661],{"type":18,"tag":170,"props":12657,"children":12658},{},[12659],{"type":24,"value":12660},"Heading Error Calculation",{"type":24,"value":12662},": The heading error, which is the difference between the vehicle's current heading (yaw angle) and the desired path's tangent angle at the nearest waypoint, is also computed.",{"type":18,"tag":80,"props":12664,"children":12665},{},[12666,12671],{"type":18,"tag":170,"props":12667,"children":12668},{},[12669],{"type":24,"value":12670},"Control Command Generation",{"type":24,"value":12672},": Using the calculated cross-track error and heading error, the Stanley Controller generates control commands. These commands typically include steering angle adjustments and throttle/brake control to minimize both errors.",{"type":18,"tag":80,"props":12674,"children":12675},{},[12676,12680],{"type":18,"tag":170,"props":12677,"children":12678},{},[12679],{"type":24,"value":12434},{"type":24,"value":12681},": The generated control commands are applied to the vehicle's steering and throttle/brake systems to guide it back to the desired path.",{"type":18,"tag":80,"props":12683,"children":12684},{},[12685,12690],{"type":18,"tag":170,"props":12686,"children":12687},{},[12688],{"type":24,"value":12689},"Iterative Feedback",{"type":24,"value":12691},": The process is iterative, with the controller continuously recalculating the cross-track and heading errors and adjusting the control commands to keep the vehicle on track.",{"type":18,"tag":33,"props":12693,"children":12694},{"id":12448},[12695],{"type":24,"value":12451},{"type":18,"tag":27,"props":12697,"children":12698},{},[12699],{"type":24,"value":12700},"The Stanley Controller offers several advantages:",{"type":18,"tag":76,"props":12702,"children":12703},{},[12704,12714,12724,12733,12742],{"type":18,"tag":80,"props":12705,"children":12706},{},[12707,12712],{"type":18,"tag":170,"props":12708,"children":12709},{},[12710],{"type":24,"value":12711},"High Accuracy",{"type":24,"value":12713},": It is known for its ability to achieve precise path-following, even in challenging conditions and complex road geometries.",{"type":18,"tag":80,"props":12715,"children":12716},{},[12717,12722],{"type":18,"tag":170,"props":12718,"children":12719},{},[12720],{"type":24,"value":12721},"Stability",{"type":24,"value":12723},": The controller's feedback mechanisms contribute to stable and smooth vehicle motion, reducing the risk of overshooting or oscillations.",{"type":18,"tag":80,"props":12725,"children":12726},{},[12727,12731],{"type":18,"tag":170,"props":12728,"children":12729},{},[12730],{"type":24,"value":12496},{"type":24,"value":12732},": The Stanley Controller can adapt to changes in the path, such as deviations caused by obstacles or dynamic road conditions.",{"type":18,"tag":80,"props":12734,"children":12735},{},[12736,12740],{"type":18,"tag":170,"props":12737,"children":12738},{},[12739],{"type":24,"value":12486},{"type":24,"value":12741},": It can operate in real-time, making it suitable for autonomous vehicle navigation in dynamic environments.",{"type":18,"tag":80,"props":12743,"children":12744},{},[12745,12750],{"type":18,"tag":170,"props":12746,"children":12747},{},[12748],{"type":24,"value":12749},"Versatility",{"type":24,"value":12751},": While primarily used in autonomous vehicles, the Stanley Controller's principles can be applied to various path-tracking tasks.",{"type":18,"tag":33,"props":12753,"children":12754},{"id":12511},[12755],{"type":24,"value":12514},{"type":18,"tag":27,"props":12757,"children":12758},{},[12759],{"type":24,"value":12760},"Despite its advantages, the Stanley Controller has some limitations:",{"type":18,"tag":76,"props":12762,"children":12763},{},[12764,12774,12784],{"type":18,"tag":80,"props":12765,"children":12766},{},[12767,12772],{"type":18,"tag":170,"props":12768,"children":12769},{},[12770],{"type":24,"value":12771},"Complexity",{"type":24,"value":12773},": Implementing the Stanley Controller can be more complex than some other control algorithms due to its mathematical calculations and tuning requirements.",{"type":18,"tag":80,"props":12775,"children":12776},{},[12777,12782],{"type":18,"tag":170,"props":12778,"children":12779},{},[12780],{"type":24,"value":12781},"Initialization",{"type":24,"value":12783},": It relies on accurate initialization, including knowledge of the vehicle's initial position and heading relative to the path.",{"type":18,"tag":80,"props":12785,"children":12786},{},[12787,12792],{"type":18,"tag":170,"props":12788,"children":12789},{},[12790],{"type":24,"value":12791},"Sensitivity to Noise",{"type":24,"value":12793},": Like many feedback-based controllers, the Stanley Controller can be sensitive to noisy sensor data and require robust sensor fusion techniques.",{"type":18,"tag":27,"props":12795,"children":12796},{},[12797],{"type":24,"value":12798},"In summary, the Stanley Controller is an advanced path-tracking algorithm known for its accuracy and stability, making it a valuable tool in the field of autonomous vehicle navigation. Proper implementation and tuning are essential to harness its full potential.",{"title":8,"searchDepth":663,"depth":663,"links":12800},[12801],{"id":12609,"depth":663,"text":12602,"children":12802},[12803,12804,12805],{"id":12385,"depth":672,"text":12388},{"id":12448,"depth":672,"text":12451},{"id":12511,"depth":672,"text":12514},"content:topics:robotics:stanley-controller.md","topics/robotics/stanley-controller.md",1697293979838]