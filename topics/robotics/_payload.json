[{"data":1,"prerenderedAt":12789},["Reactive",2],{"topics/robotics":3},[4,6452,10440,12341,12581],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":9,"description":10,"author":11,"slug":12,"tag":12,"img":13,"body":14,"_type":6447,"_id":6448,"_source":6449,"_file":6450,"_extension":6451},"/topics/robotics/nmpc-cgmres","robotics",false,"","Nonlinear Model Predictive Control with C/GMRES","Optimal Control theory","Din Sokheng","nmpc-cgmres","/topics/robotics/nmpc/nmpc_cgmres.png",{"type":15,"children":16,"toc":6435},"root",[17,26,32,39,44,50,59,64,70,75,164,180,198,203,212,216,227,233,242,246,250,265,271,276,283,483,494,499,503,507,545,550,554,559,563,567,572,578,586,598,1759,1773,2598,2603,2735,2740,3091,3096,3869,3874,4354,4374,4861,4872,6245,6256,6262,6294,6313,6323,6328,6340,6346,6360,6366,6371,6377,6430],{"type":18,"tag":19,"props":20,"children":22},"element","h2",{"id":21},"the-optimal-control-theory-in-control-system",[23],{"type":24,"value":25},"text","The Optimal Control Theory in Control System",{"type":18,"tag":27,"props":28,"children":29},"p",{},[30],{"type":24,"value":31},"Optimal Control is a branch of control theory in control system, the theory works by solving the optimization problem of the dynamical system in order to find the optimal solution for the system",{"type":18,"tag":33,"props":34,"children":36},"h3",{"id":35},"what-is-model-predictive-control",[37],{"type":24,"value":38},"What is Model Predictive Control ?",{"type":18,"tag":27,"props":40,"children":41},{},[42],{"type":24,"value":43},"Model Predictive Control (MPC) is the optimal control method that use optimization algorithms to solve the cost function the occurs from the desired input and obtain back the optimal input control over the finite and infinite horizons. Recently, MPC is hyping up among the control system researcher, since it is fast, efficiency and robustness for any high complex system.",{"type":18,"tag":33,"props":45,"children":47},{"id":46},"hamilton-jacobian-bellman-equation-hjbe",[48],{"type":24,"value":49},"Hamilton Jacobian Bellman Equation (HJBE)",{"type":18,"tag":27,"props":51,"children":52},{},[53,55],{"type":24,"value":54},"Actually, the HJBE is a nonlinear partial differential equation that it consists necessary conditions for optimality of control by minimizing the loss function of the system. ",{"type":18,"tag":56,"props":57,"children":58},"br",{},[],{"type":18,"tag":27,"props":60,"children":61},{},[62],{"type":24,"value":63},"We have the Hamiltonian Jacobian Bellman Equation",{"type":18,"tag":65,"props":66,"children":69},"math-render-b",{"latex-express":67,"styles":68},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T} Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}","text-center",[],{"type":18,"tag":27,"props":71,"children":72},{},[73],{"type":24,"value":74},"Which",{"type":18,"tag":76,"props":77,"children":78},"ul",{},[79,91,106,119,128,137,146,155],{"type":18,"tag":80,"props":81,"children":82},"li",{},[83,89],{"type":18,"tag":84,"props":85,"children":88},"math-render",{"latex-express":86,"styles":87},"N","inline-flex",[],{"type":24,"value":90}," is the number of prediction future horizons or shooting node.",{"type":18,"tag":80,"props":92,"children":93},{},[94,98,100,104],{"type":18,"tag":84,"props":95,"children":97},{"latex-express":96,"styles":87},"x_{k}",[],{"type":24,"value":99}," is the state of the system at shooting node ",{"type":18,"tag":84,"props":101,"children":103},{"latex-express":102,"styles":87},"k",[],{"type":24,"value":105}," .",{"type":18,"tag":80,"props":107,"children":108},{},[109,113,115,118],{"type":18,"tag":84,"props":110,"children":112},{"latex-express":111,"styles":87},"u_{k}",[],{"type":24,"value":114}," is the input control of the system at shooting node ",{"type":18,"tag":84,"props":116,"children":117},{"latex-express":102,"styles":87},[],{"type":24,"value":105},{"type":18,"tag":80,"props":120,"children":121},{},[122,126],{"type":18,"tag":84,"props":123,"children":125},{"latex-express":124,"styles":87},"Q, R",[],{"type":24,"value":127}," are diagonal matrix which helps the optimization solving the nlp problem.",{"type":18,"tag":80,"props":129,"children":130},{},[131,135],{"type":18,"tag":84,"props":132,"children":134},{"latex-express":133,"styles":87},"f(x,u)",[],{"type":24,"value":136}," is the state representation of the system.",{"type":18,"tag":80,"props":138,"children":139},{},[140,144],{"type":18,"tag":84,"props":141,"children":143},{"latex-express":142,"styles":87},"C(x,u)",[],{"type":24,"value":145},"  is the constraint of the system.",{"type":18,"tag":80,"props":147,"children":148},{},[149,153],{"type":18,"tag":84,"props":150,"children":152},{"latex-express":151,"styles":87},"\\lambda",[],{"type":24,"value":154},"  is the costate vector for state representation.",{"type":18,"tag":80,"props":156,"children":157},{},[158,162],{"type":18,"tag":84,"props":159,"children":161},{"latex-express":160,"styles":87},"\\mu",[],{"type":24,"value":163},"  is the Lagrange multiplier vector for the equality constraint.",{"type":18,"tag":27,"props":165,"children":166},{},[167,169,175,177],{"type":24,"value":168},"Nonlinear Model Predictive Control has multiples solving method, but in this demonstration I will stick with the Continuation/GMRES method proposed by professor ",{"type":18,"tag":170,"props":171,"children":172},"strong",{},[173],{"type":24,"value":174}," Toshiyuki Ohtsuka ",{"type":24,"value":176},". ",{"type":18,"tag":56,"props":178,"children":179},{},[],{"type":18,"tag":27,"props":181,"children":182},{},[183,185,189,191,196],{"type":24,"value":184},"Supposed we want to obtain solution vector ",{"type":18,"tag":84,"props":186,"children":188},{"latex-express":187,"styles":87},"U(t) = [ u_{0}^{*}, \\mu_{0}^{*}, \\cdots, u_{N-1}^{*}, \\mu_{N-1}^{*} ]",[],{"type":24,"value":190},"   at sampling time $t$, we then define the discretization of ",{"type":18,"tag":170,"props":192,"children":193},{},[194],{"type":24,"value":195}," Euler Lagrangian Equation (ELE) ",{"type":24,"value":197},".",{"type":18,"tag":65,"props":199,"children":202},{"latex-express":200,"style":201},"\n\\begin{align}\n    x_{i+1}^{*}(t) &= x_{i}^{*}(t) + f(x_{i}^{*}(t), u_{i}^{*}(t))  \\\\\n    \\lambda_{i}^{*}(t) &= \\lambda_{i+1}^{*}(t) + \\frac{\\partial H}{\\partial x}\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) \\\\\n    \\lambda_{N}^{*}(t) &= \\frac{\\partial \\phi(x)}{\\partial x} \\\\\n    \\frac{\\partial H}{\\partial u} &\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) = 0 \\\\\n    C&(x_{i}^{*}(t),u_{i}^{*}(t)) = 0\n\\end{align}\n","text-ceneter",[],{"type":18,"tag":27,"props":204,"children":205},{},[206,208],{"type":24,"value":207},"To solve this nonlinear problem iteratively, we use Newton's method ",{"type":18,"tag":84,"props":209,"children":211},{"latex-express":210,"styles":87},"F(x,u)=0",[],{"type":18,"tag":65,"props":213,"children":215},{"latex-express":214,"styles":68},"\n\\begin{equation*}\n    F(x,u) = \\begin{bmatrix}\n        \\frac{\\partial H}{\\partial u} \\left( x_{0}^{*}, u_{0}^{*}(t), \\lambda_{1}^{*}(t), \\mu_{0}^{*}(t) \\right) \\\\\n        C(x_{0}^{*}(t),u_{0}^{*}(t))  \\\\\n        \\vdots \\\\\n        \\frac{\\partial H}{\\partial u} \\left( x_{N-1}^{*}, u_{N-1}^{*}(t), \\lambda_{N}^{*}(t), \\mu_{N-1}^{*}(t) \\right) \\\\\n        C(x_{N-1}^{*}(t),u_{N-1}^{*}(t)) \\\\\n    \\end{bmatrix} = 0\n\\end{equation*}",[],{"type":18,"tag":27,"props":217,"children":218},{},[219,221,225],{"type":24,"value":220},"Solving this problem directly will caused big computational complexity, hence we use Continuation to reduce the complexity of the ",{"type":18,"tag":84,"props":222,"children":224},{"latex-express":223,"styles":87},"F(x,u)",[],{"type":24,"value":226}," function and then solve it by using GMRES method.",{"type":18,"tag":33,"props":228,"children":230},{"id":229},"continuation",[231],{"type":24,"value":232},"Continuation",{"type":18,"tag":27,"props":234,"children":235},{},[236,238],{"type":24,"value":237},"Denote  ",{"type":18,"tag":84,"props":239,"children":241},{"latex-express":240,"styles":87},"\\zeta, \\alpha, h \\in{\\mathbb{R} }",[],{"type":18,"tag":65,"props":243,"children":245},{"latex-express":244,"styles":68},"\n\\begin{equation}\n    \\frac{\\partial F}{\\partial u}(x,u) \\dot{u}(t) = -\\zeta F(x,u)(t)-\\frac{\\partial F}{\\partial x}(x,u)(t)\\dot{x}-\\frac{\\partial F}{\\partial t}(x,u)(t) \n\\end{equation}",[],{"type":18,"tag":65,"props":247,"children":249},{"latex-express":248,"styles":68},"\n\\begin{equation}\n    \\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h} = -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}\n\\end{equation}",[],{"type":18,"tag":27,"props":251,"children":252},{},[253,255,259,261],{"type":24,"value":254},"Let ",{"type":18,"tag":65,"props":256,"children":258},{"latex-express":257,"styles":68},"right=\\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h}",[],{"type":24,"value":260}," and ",{"type":18,"tag":65,"props":262,"children":264},{"latex-express":263,"styles":68},"left =  -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}",[],{"type":18,"tag":33,"props":266,"children":268},{"id":267},"generalized-minimal-residue-method-gmres",[269],{"type":24,"value":270},"Generalized Minimal Residue Method (GMRES)",{"type":18,"tag":27,"props":272,"children":273},{},[274],{"type":24,"value":275},"The Generalized Minimal Residual (GMRES) algorithm is an iterative method for solving linear systems of equations. It is often used for large sparse linear systems.",{"type":18,"tag":277,"props":278,"children":280},"h4",{"id":279},"algorithm-description",[281],{"type":24,"value":282},"Algorithm Description",{"type":18,"tag":284,"props":285,"children":286},"ol",{},[287,342,449,468],{"type":18,"tag":80,"props":288,"children":289},{},[290,295,297],{"type":18,"tag":170,"props":291,"children":292},{},[293],{"type":24,"value":294},"Initialize",{"type":24,"value":296},":",{"type":18,"tag":76,"props":298,"children":299},{},[300,310,320],{"type":18,"tag":80,"props":301,"children":302},{},[303,305,309],{"type":24,"value":304},"Choose an initial guess for the solution, denoted as ",{"type":18,"tag":84,"props":306,"children":308},{"latex-express":307,"styles":87},"x_{0}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":311,"children":312},{},[313,315,319],{"type":24,"value":314},"Set the residual vector ",{"type":18,"tag":84,"props":316,"children":318},{"latex-express":317,"styles":87},"r_{0}=\\left\\| Ax_{0}-b \\right\\|",[],{"type":24,"value":197},{"type":18,"tag":80,"props":321,"children":322},{},[323,325,329,331,335,337,341],{"type":24,"value":324},"Set ",{"type":18,"tag":84,"props":326,"children":328},{"latex-express":327,"styles":87},"v_{1}=\\frac{r_{0} }{\\left\\| r_{0} \\right\\|}",[],{"type":24,"value":330},", where ",{"type":18,"tag":84,"props":332,"children":334},{"latex-express":333,"styles":87},"\\left\\| r_{0} \\right\\|",[],{"type":24,"value":336},"  is the norm of ",{"type":18,"tag":84,"props":338,"children":340},{"latex-express":339,"styles":87},"r_{0}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":343,"children":344},{},[345,350,351],{"type":18,"tag":170,"props":346,"children":347},{},[348],{"type":24,"value":349},"Iterative Process",{"type":24,"value":296},{"type":18,"tag":76,"props":352,"children":353},{},[354,364,438],{"type":18,"tag":80,"props":355,"children":356},{},[357,359,363],{"type":24,"value":358},"Choose a vector ",{"type":18,"tag":84,"props":360,"children":362},{"latex-express":361,"styles":87},"v_{1}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":365,"children":366},{},[367,369,373,375,379,380],{"type":24,"value":368},"For ",{"type":18,"tag":84,"props":370,"children":372},{"latex-express":371,"styles":87},"k=0",[],{"type":24,"value":374}," to ",{"type":18,"tag":84,"props":376,"children":378},{"latex-express":377,"styles":87},"maxiteration",[],{"type":24,"value":296},{"type":18,"tag":76,"props":381,"children":382},{},[383,419],{"type":18,"tag":80,"props":384,"children":385},{},[386,388],{"type":24,"value":387},"Arnoldi process:",{"type":18,"tag":76,"props":389,"children":390},{},[391,398,405,412],{"type":18,"tag":80,"props":392,"children":393},{},[394],{"type":18,"tag":84,"props":395,"children":397},{"latex-express":396,"styles":87},"h_{i,j} = \\left(Av_{j}, v_{i} \\right)",[],{"type":18,"tag":80,"props":399,"children":400},{},[401],{"type":18,"tag":84,"props":402,"children":404},{"latex-express":403,"styles":87},"\\hat{v}_{j+1} = Av_{j} - \\sum_{i=1}^{j}h_{i,j}v_{i}",[],{"type":18,"tag":80,"props":406,"children":407},{},[408],{"type":18,"tag":84,"props":409,"children":411},{"latex-express":410,"styles":87},"h_{j+1,j} = \\left \\| \\hat{v}_{j+1}  \\right\\|_{2}",[],{"type":18,"tag":80,"props":413,"children":414},{},[415],{"type":18,"tag":84,"props":416,"children":418},{"latex-express":417,"styles":87},"v_{j+1} = \\frac{\\hat{v}_{j+1} }{h_{j+1,j} }",[],{"type":18,"tag":80,"props":420,"children":421},{},[422,424],{"type":24,"value":423},"Check for convergence:",{"type":18,"tag":76,"props":425,"children":426},{},[427],{"type":18,"tag":80,"props":428,"children":429},{},[430,432,436],{"type":24,"value":431},"If ",{"type":18,"tag":84,"props":433,"children":435},{"latex-express":434,"styles":87},"||r_k|| \u003C tolerance",[],{"type":24,"value":437},", exit the loop.",{"type":18,"tag":80,"props":439,"children":440},{},[441,443,447],{"type":24,"value":442},"If no convergence is achieved after ",{"type":18,"tag":84,"props":444,"children":446},{"latex-express":445,"styles":87},"maxiterations",[],{"type":24,"value":448},", exit with an error message.",{"type":18,"tag":80,"props":450,"children":451},{},[452,461,463,467],{"type":18,"tag":170,"props":453,"children":454},{},[455,457],{"type":24,"value":456},"Find ",{"type":18,"tag":84,"props":458,"children":460},{"latex-express":459,"styles":87},"y",[],{"type":24,"value":462},": which minimize ",{"type":18,"tag":84,"props":464,"children":466},{"latex-express":465,"styles":87},"\\left\\| r_{0}e_{1}-\\hat{H}_{m}y \\right \\|_{2}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":469,"children":470},{},[471,476,478,482],{"type":18,"tag":170,"props":472,"children":473},{},[474],{"type":24,"value":475},"Compute",{"type":24,"value":477},": ",{"type":18,"tag":84,"props":479,"children":481},{"latex-express":480,"styles":87},"x_{m} = x_{0}+V_{m}y_{m}",[],{"type":24,"value":197},{"type":18,"tag":27,"props":484,"children":485},{},[486,488,492],{"type":24,"value":487},"For example differential model, let ",{"type":18,"tag":84,"props":489,"children":491},{"latex-express":490,"styles":87},"x, y, \\phi",[],{"type":24,"value":493}," is the state presentation of the model\n$$ \\dot{x} = f(x,u) $$",{"type":18,"tag":27,"props":495,"children":496},{},[497],{"type":24,"value":498},"Then the HJBE defined as",{"type":18,"tag":65,"props":500,"children":502},{"latex-express":501,"styles":68},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}\n",[],{"type":18,"tag":27,"props":504,"children":505},{},[506],{"type":24,"value":74},{"type":18,"tag":76,"props":508,"children":509},{},[510,517,524,531,538],{"type":18,"tag":80,"props":511,"children":512},{},[513],{"type":18,"tag":84,"props":514,"children":516},{"latex-express":515,"styles":87},"f(x,u) = \\begin{bmatrix} u_{1}*\\cos{(\\phi)} \\\\ u_{1}*\\sin{(\\phi)} \\\\ u_{2} \\end{bmatrix}",[],{"type":18,"tag":80,"props":518,"children":519},{},[520],{"type":18,"tag":84,"props":521,"children":523},{"latex-express":522,"styles":87},"C(x,u) = \\begin{bmatrix} \\left(u_{1}-\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min} }{2})^{2} \\\\\n          \\left(u_{2}-\\frac{u_{2max}+u_{2min}}{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2}\n\\end{bmatrix}",[],{"type":18,"tag":80,"props":525,"children":526},{},[527],{"type":18,"tag":84,"props":528,"children":530},{"latex-express":529,"styles":87},"\\phi(x) = (x_{N}-x_{N,ref})^{T}Q(x_{N}-x_{N,ref})",[],{"type":18,"tag":80,"props":532,"children":533},{},[534],{"type":18,"tag":84,"props":535,"children":537},{"latex-express":536,"styles":87},"\\lambda = \\begin{bmatrix} \\lambda_{1} & \\lambda_{2} & \\lambda_{3} \\end{bmatrix}",[],{"type":18,"tag":80,"props":539,"children":540},{},[541],{"type":18,"tag":84,"props":542,"children":544},{"latex-express":543,"styles":87}," \\mu = \\begin{bmatrix} \\mu_{1} & \\mu_{2} \\end{bmatrix}",[],{"type":18,"tag":27,"props":546,"children":547},{},[548],{"type":24,"value":549},"Subtitute all of these term into HJBE",{"type":18,"tag":65,"props":551,"children":553},{"latex-express":552,"styles":68},"\n\\begin{align*}\nH(x,u,\\lambda,\\mu) &= \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref})\n                     + (x_{N-1}-x_{N-1,ref})^{T}Q(x_{N-1}-x_{N-1,ref}) \\\\ & + \\begin{bmatrix} \\lambda_{1} \\\\ \\lambda_{2} \\\\ \\lambda_{3} \\end{bmatrix}^{T} \\begin{bmatrix} u_{1}*\\cos(\\phi) \\\\ u_{1}*\\sin(\\phi) \\\\ u_{2} \\end{bmatrix}\n                     + \\begin{bmatrix} \\mu_{1} \\\\ \\mu_{2} \\end{bmatrix}^{T} \\begin{bmatrix} \\left(u_{1}+\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min}}{2})^{2} \\\\\n            \\left(u_{2}+\\frac{u_{2max}+u_{2min}}{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2} \n\\end{bmatrix}\n\\end{align*}",[],{"type":18,"tag":27,"props":555,"children":556},{},[557],{"type":24,"value":558},"By doing partial derivative of HJBE, we get",{"type":18,"tag":65,"props":560,"children":562},{"latex-express":561,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial x} = \\begin{bmatrix}\n     (x-x_{ref})q_{1} \\\\\n     (y-y_{ref})q_{2} \\\\ \n     (\\phi-\\phi_{ref})q_{3} - \\lambda_{1}\\sin{(\\phi)}u_{1} + \\lambda_{2}\\cos{(\\phi)}u_{1}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":18,"tag":65,"props":564,"children":566},{"latex-express":565,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial u} = \\begin{bmatrix}\n      (u_{1}-u_{1,ref})r_{1}+\\lambda_{1}\\cos{(\\phi)}+\\lambda_{2}\\sin{(\\phi)} \\\\ \n      (u_{2}-u_{2,ref})r_{2}+\\lambda_{3}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":18,"tag":27,"props":568,"children":569},{},[570],{"type":24,"value":571},"I know this is quite complicated, this is just only input control without constraint and solver with single shooting method.",{"type":18,"tag":19,"props":573,"children":575},{"id":574},"implementing-in-python",[576],{"type":24,"value":577},"Implementing in Python",{"type":18,"tag":27,"props":579,"children":580},{},[581,583],{"type":24,"value":582},"It is safe to say that you will need to start from basic first. Like creating class for model representation, but for now I will just go with CGMRES implementing only, since I have done many demonstration of how to create class for model. ",{"type":18,"tag":56,"props":584,"children":585},{},[],{"type":18,"tag":27,"props":587,"children":588},{},[589,591,596],{"type":24,"value":590},"Let's create class for ",{"type":18,"tag":170,"props":592,"children":593},{},[594],{"type":24,"value":595}," Hamiltion Jacobian Bellman Equation ",{"type":24,"value":597}," which we already derived from above equation.",{"type":18,"tag":599,"props":600,"children":605},"code",{"className":601,"code":603,"language":604,"meta":8},[602],"language-python","class HJBEquation:\n\n    def __init__(self, q1, q2, q3, r1, r2, u_max, u_min):\n\n        self.q1 = q1\n        self.q2 = q2\n        self.q3 = q3\n\n        self.r1 = r1\n        self.r2 = r2\n\n        self.u1_min = u_min[0]\n        self.u2_min = u_min[0]\n\n        self.u1_max = u_max[0]\n        self.u2_max = u_max[1]\n\n    def dhdx(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n\n        dhdx1 = (x-x_r)*self.q1\n        dhdx2 = (y-y_r)*self.q2\n        dhdx3 = (yaw-yaw_r)*self.q3-u1*lam1*np.sin(yaw)+u1*lam2*np.cos(yaw)\n\n        return dhdx1, dhdx2, dhdx3\n\n    def dhdu(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n\n        dhdu1 = self.r1*(u1-u1_r)+lam1*np.cos(yaw)+lam2*np.sin(yaw)+2*mu1*u1*(u1+(self.u1_max+self.u1_min)/2)\n        dhdu2 = self.r2*(u2-u2_r)+lam3+2*mu2*(u2+(self.u2_max+self.u2_min)/2)\n\n        return dhdu1, dhdu2\n\n    def dphidx(self, x, y, yaw, x_r, y_r, yaw_r):\n        dphidx1 = self.q1*(x-x_r)\n        dphidx2 = self.q2*(y-y_r)\n        dphidx3 = self.q3*(yaw-yaw_r)\n\n        return dphidx1, dphidx2, dphidx3\n","python",[606],{"type":18,"tag":607,"props":608,"children":609},"pre",{},[610],{"type":18,"tag":599,"props":611,"children":612},{"__ignoreMap":8},[613,642,651,680,688,717,743,769,777,803,829,837,873,906,914,948,982,990,1016,1024,1066,1106,1200,1208,1226,1234,1260,1268,1424,1544,1552,1569,1577,1603,1647,1691,1734,1742],{"type":18,"tag":614,"props":615,"children":618},"span",{"class":616,"line":617},"line",1,[619,625,631,637],{"type":18,"tag":614,"props":620,"children":622},{"class":621},"ct-857441",[623],{"type":24,"value":624},"class",{"type":18,"tag":614,"props":626,"children":628},{"class":627},"ct-767297",[629],{"type":24,"value":630}," ",{"type":18,"tag":614,"props":632,"children":634},{"class":633},"ct-806137",[635],{"type":24,"value":636},"HJBEquation",{"type":18,"tag":614,"props":638,"children":639},{"class":627},[640],{"type":24,"value":641},":\n",{"type":18,"tag":614,"props":643,"children":645},{"class":616,"line":644},2,[646],{"type":18,"tag":614,"props":647,"children":648},{},[649],{"type":24,"value":650},"\n",{"type":18,"tag":614,"props":652,"children":654},{"class":616,"line":653},3,[655,660,665,669,675],{"type":18,"tag":614,"props":656,"children":657},{"class":627},[658],{"type":24,"value":659},"    ",{"type":18,"tag":614,"props":661,"children":662},{"class":621},[663],{"type":24,"value":664},"def",{"type":18,"tag":614,"props":666,"children":667},{"class":627},[668],{"type":24,"value":630},{"type":18,"tag":614,"props":670,"children":672},{"class":671},"ct-533739",[673],{"type":24,"value":674},"__init__",{"type":18,"tag":614,"props":676,"children":677},{"class":627},[678],{"type":24,"value":679},"(self, q1, q2, q3, r1, r2, u_max, u_min):\n",{"type":18,"tag":614,"props":681,"children":683},{"class":616,"line":682},4,[684],{"type":18,"tag":614,"props":685,"children":686},{},[687],{"type":24,"value":650},{"type":18,"tag":614,"props":689,"children":691},{"class":616,"line":690},5,[692,697,702,707,712],{"type":18,"tag":614,"props":693,"children":694},{"class":627},[695],{"type":24,"value":696},"        ",{"type":18,"tag":614,"props":698,"children":699},{"class":671},[700],{"type":24,"value":701},"self",{"type":18,"tag":614,"props":703,"children":704},{"class":627},[705],{"type":24,"value":706},".q1 ",{"type":18,"tag":614,"props":708,"children":709},{"class":621},[710],{"type":24,"value":711},"=",{"type":18,"tag":614,"props":713,"children":714},{"class":627},[715],{"type":24,"value":716}," q1\n",{"type":18,"tag":614,"props":718,"children":720},{"class":616,"line":719},6,[721,725,729,734,738],{"type":18,"tag":614,"props":722,"children":723},{"class":627},[724],{"type":24,"value":696},{"type":18,"tag":614,"props":726,"children":727},{"class":671},[728],{"type":24,"value":701},{"type":18,"tag":614,"props":730,"children":731},{"class":627},[732],{"type":24,"value":733},".q2 ",{"type":18,"tag":614,"props":735,"children":736},{"class":621},[737],{"type":24,"value":711},{"type":18,"tag":614,"props":739,"children":740},{"class":627},[741],{"type":24,"value":742}," q2\n",{"type":18,"tag":614,"props":744,"children":746},{"class":616,"line":745},7,[747,751,755,760,764],{"type":18,"tag":614,"props":748,"children":749},{"class":627},[750],{"type":24,"value":696},{"type":18,"tag":614,"props":752,"children":753},{"class":671},[754],{"type":24,"value":701},{"type":18,"tag":614,"props":756,"children":757},{"class":627},[758],{"type":24,"value":759},".q3 ",{"type":18,"tag":614,"props":761,"children":762},{"class":621},[763],{"type":24,"value":711},{"type":18,"tag":614,"props":765,"children":766},{"class":627},[767],{"type":24,"value":768}," q3\n",{"type":18,"tag":614,"props":770,"children":772},{"class":616,"line":771},8,[773],{"type":18,"tag":614,"props":774,"children":775},{},[776],{"type":24,"value":650},{"type":18,"tag":614,"props":778,"children":780},{"class":616,"line":779},9,[781,785,789,794,798],{"type":18,"tag":614,"props":782,"children":783},{"class":627},[784],{"type":24,"value":696},{"type":18,"tag":614,"props":786,"children":787},{"class":671},[788],{"type":24,"value":701},{"type":18,"tag":614,"props":790,"children":791},{"class":627},[792],{"type":24,"value":793},".r1 ",{"type":18,"tag":614,"props":795,"children":796},{"class":621},[797],{"type":24,"value":711},{"type":18,"tag":614,"props":799,"children":800},{"class":627},[801],{"type":24,"value":802}," r1\n",{"type":18,"tag":614,"props":804,"children":806},{"class":616,"line":805},10,[807,811,815,820,824],{"type":18,"tag":614,"props":808,"children":809},{"class":627},[810],{"type":24,"value":696},{"type":18,"tag":614,"props":812,"children":813},{"class":671},[814],{"type":24,"value":701},{"type":18,"tag":614,"props":816,"children":817},{"class":627},[818],{"type":24,"value":819},".r2 ",{"type":18,"tag":614,"props":821,"children":822},{"class":621},[823],{"type":24,"value":711},{"type":18,"tag":614,"props":825,"children":826},{"class":627},[827],{"type":24,"value":828}," r2\n",{"type":18,"tag":614,"props":830,"children":832},{"class":616,"line":831},11,[833],{"type":18,"tag":614,"props":834,"children":835},{},[836],{"type":24,"value":650},{"type":18,"tag":614,"props":838,"children":840},{"class":616,"line":839},12,[841,845,849,854,858,863,868],{"type":18,"tag":614,"props":842,"children":843},{"class":627},[844],{"type":24,"value":696},{"type":18,"tag":614,"props":846,"children":847},{"class":671},[848],{"type":24,"value":701},{"type":18,"tag":614,"props":850,"children":851},{"class":627},[852],{"type":24,"value":853},".u1_min ",{"type":18,"tag":614,"props":855,"children":856},{"class":621},[857],{"type":24,"value":711},{"type":18,"tag":614,"props":859,"children":860},{"class":627},[861],{"type":24,"value":862}," u_min[",{"type":18,"tag":614,"props":864,"children":865},{"class":671},[866],{"type":24,"value":867},"0",{"type":18,"tag":614,"props":869,"children":870},{"class":627},[871],{"type":24,"value":872},"]\n",{"type":18,"tag":614,"props":874,"children":876},{"class":616,"line":875},13,[877,881,885,890,894,898,902],{"type":18,"tag":614,"props":878,"children":879},{"class":627},[880],{"type":24,"value":696},{"type":18,"tag":614,"props":882,"children":883},{"class":671},[884],{"type":24,"value":701},{"type":18,"tag":614,"props":886,"children":887},{"class":627},[888],{"type":24,"value":889},".u2_min ",{"type":18,"tag":614,"props":891,"children":892},{"class":621},[893],{"type":24,"value":711},{"type":18,"tag":614,"props":895,"children":896},{"class":627},[897],{"type":24,"value":862},{"type":18,"tag":614,"props":899,"children":900},{"class":671},[901],{"type":24,"value":867},{"type":18,"tag":614,"props":903,"children":904},{"class":627},[905],{"type":24,"value":872},{"type":18,"tag":614,"props":907,"children":909},{"class":616,"line":908},14,[910],{"type":18,"tag":614,"props":911,"children":912},{},[913],{"type":24,"value":650},{"type":18,"tag":614,"props":915,"children":917},{"class":616,"line":916},15,[918,922,926,931,935,940,944],{"type":18,"tag":614,"props":919,"children":920},{"class":627},[921],{"type":24,"value":696},{"type":18,"tag":614,"props":923,"children":924},{"class":671},[925],{"type":24,"value":701},{"type":18,"tag":614,"props":927,"children":928},{"class":627},[929],{"type":24,"value":930},".u1_max ",{"type":18,"tag":614,"props":932,"children":933},{"class":621},[934],{"type":24,"value":711},{"type":18,"tag":614,"props":936,"children":937},{"class":627},[938],{"type":24,"value":939}," u_max[",{"type":18,"tag":614,"props":941,"children":942},{"class":671},[943],{"type":24,"value":867},{"type":18,"tag":614,"props":945,"children":946},{"class":627},[947],{"type":24,"value":872},{"type":18,"tag":614,"props":949,"children":951},{"class":616,"line":950},16,[952,956,960,965,969,973,978],{"type":18,"tag":614,"props":953,"children":954},{"class":627},[955],{"type":24,"value":696},{"type":18,"tag":614,"props":957,"children":958},{"class":671},[959],{"type":24,"value":701},{"type":18,"tag":614,"props":961,"children":962},{"class":627},[963],{"type":24,"value":964},".u2_max ",{"type":18,"tag":614,"props":966,"children":967},{"class":621},[968],{"type":24,"value":711},{"type":18,"tag":614,"props":970,"children":971},{"class":627},[972],{"type":24,"value":939},{"type":18,"tag":614,"props":974,"children":975},{"class":671},[976],{"type":24,"value":977},"1",{"type":18,"tag":614,"props":979,"children":980},{"class":627},[981],{"type":24,"value":872},{"type":18,"tag":614,"props":983,"children":985},{"class":616,"line":984},17,[986],{"type":18,"tag":614,"props":987,"children":988},{},[989],{"type":24,"value":650},{"type":18,"tag":614,"props":991,"children":993},{"class":616,"line":992},18,[994,998,1002,1006,1011],{"type":18,"tag":614,"props":995,"children":996},{"class":627},[997],{"type":24,"value":659},{"type":18,"tag":614,"props":999,"children":1000},{"class":621},[1001],{"type":24,"value":664},{"type":18,"tag":614,"props":1003,"children":1004},{"class":627},[1005],{"type":24,"value":630},{"type":18,"tag":614,"props":1007,"children":1008},{"class":633},[1009],{"type":24,"value":1010},"dhdx",{"type":18,"tag":614,"props":1012,"children":1013},{"class":627},[1014],{"type":24,"value":1015},"(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n",{"type":18,"tag":614,"props":1017,"children":1019},{"class":616,"line":1018},19,[1020],{"type":18,"tag":614,"props":1021,"children":1022},{},[1023],{"type":24,"value":650},{"type":18,"tag":614,"props":1025,"children":1027},{"class":616,"line":1026},20,[1028,1033,1037,1042,1047,1052,1057,1061],{"type":18,"tag":614,"props":1029,"children":1030},{"class":627},[1031],{"type":24,"value":1032},"        dhdx1 ",{"type":18,"tag":614,"props":1034,"children":1035},{"class":621},[1036],{"type":24,"value":711},{"type":18,"tag":614,"props":1038,"children":1039},{"class":627},[1040],{"type":24,"value":1041}," (x",{"type":18,"tag":614,"props":1043,"children":1044},{"class":621},[1045],{"type":24,"value":1046},"-",{"type":18,"tag":614,"props":1048,"children":1049},{"class":627},[1050],{"type":24,"value":1051},"x_r)",{"type":18,"tag":614,"props":1053,"children":1054},{"class":621},[1055],{"type":24,"value":1056},"*",{"type":18,"tag":614,"props":1058,"children":1059},{"class":671},[1060],{"type":24,"value":701},{"type":18,"tag":614,"props":1062,"children":1063},{"class":627},[1064],{"type":24,"value":1065},".q1\n",{"type":18,"tag":614,"props":1067,"children":1069},{"class":616,"line":1068},21,[1070,1075,1079,1084,1088,1093,1097,1101],{"type":18,"tag":614,"props":1071,"children":1072},{"class":627},[1073],{"type":24,"value":1074},"        dhdx2 ",{"type":18,"tag":614,"props":1076,"children":1077},{"class":621},[1078],{"type":24,"value":711},{"type":18,"tag":614,"props":1080,"children":1081},{"class":627},[1082],{"type":24,"value":1083}," (y",{"type":18,"tag":614,"props":1085,"children":1086},{"class":621},[1087],{"type":24,"value":1046},{"type":18,"tag":614,"props":1089,"children":1090},{"class":627},[1091],{"type":24,"value":1092},"y_r)",{"type":18,"tag":614,"props":1094,"children":1095},{"class":621},[1096],{"type":24,"value":1056},{"type":18,"tag":614,"props":1098,"children":1099},{"class":671},[1100],{"type":24,"value":701},{"type":18,"tag":614,"props":1102,"children":1103},{"class":627},[1104],{"type":24,"value":1105},".q2\n",{"type":18,"tag":614,"props":1107,"children":1109},{"class":616,"line":1108},22,[1110,1115,1119,1124,1128,1133,1137,1141,1146,1150,1155,1159,1164,1168,1173,1178,1182,1186,1191,1195],{"type":18,"tag":614,"props":1111,"children":1112},{"class":627},[1113],{"type":24,"value":1114},"        dhdx3 ",{"type":18,"tag":614,"props":1116,"children":1117},{"class":621},[1118],{"type":24,"value":711},{"type":18,"tag":614,"props":1120,"children":1121},{"class":627},[1122],{"type":24,"value":1123}," (yaw",{"type":18,"tag":614,"props":1125,"children":1126},{"class":621},[1127],{"type":24,"value":1046},{"type":18,"tag":614,"props":1129,"children":1130},{"class":627},[1131],{"type":24,"value":1132},"yaw_r)",{"type":18,"tag":614,"props":1134,"children":1135},{"class":621},[1136],{"type":24,"value":1056},{"type":18,"tag":614,"props":1138,"children":1139},{"class":671},[1140],{"type":24,"value":701},{"type":18,"tag":614,"props":1142,"children":1143},{"class":627},[1144],{"type":24,"value":1145},".q3",{"type":18,"tag":614,"props":1147,"children":1148},{"class":621},[1149],{"type":24,"value":1046},{"type":18,"tag":614,"props":1151,"children":1152},{"class":627},[1153],{"type":24,"value":1154},"u1",{"type":18,"tag":614,"props":1156,"children":1157},{"class":621},[1158],{"type":24,"value":1056},{"type":18,"tag":614,"props":1160,"children":1161},{"class":627},[1162],{"type":24,"value":1163},"lam1",{"type":18,"tag":614,"props":1165,"children":1166},{"class":621},[1167],{"type":24,"value":1056},{"type":18,"tag":614,"props":1169,"children":1170},{"class":627},[1171],{"type":24,"value":1172},"np.sin(yaw)",{"type":18,"tag":614,"props":1174,"children":1175},{"class":621},[1176],{"type":24,"value":1177},"+",{"type":18,"tag":614,"props":1179,"children":1180},{"class":627},[1181],{"type":24,"value":1154},{"type":18,"tag":614,"props":1183,"children":1184},{"class":621},[1185],{"type":24,"value":1056},{"type":18,"tag":614,"props":1187,"children":1188},{"class":627},[1189],{"type":24,"value":1190},"lam2",{"type":18,"tag":614,"props":1192,"children":1193},{"class":621},[1194],{"type":24,"value":1056},{"type":18,"tag":614,"props":1196,"children":1197},{"class":627},[1198],{"type":24,"value":1199},"np.cos(yaw)\n",{"type":18,"tag":614,"props":1201,"children":1203},{"class":616,"line":1202},23,[1204],{"type":18,"tag":614,"props":1205,"children":1206},{},[1207],{"type":24,"value":650},{"type":18,"tag":614,"props":1209,"children":1211},{"class":616,"line":1210},24,[1212,1216,1221],{"type":18,"tag":614,"props":1213,"children":1214},{"class":627},[1215],{"type":24,"value":696},{"type":18,"tag":614,"props":1217,"children":1218},{"class":621},[1219],{"type":24,"value":1220},"return",{"type":18,"tag":614,"props":1222,"children":1223},{"class":627},[1224],{"type":24,"value":1225}," dhdx1, dhdx2, dhdx3\n",{"type":18,"tag":614,"props":1227,"children":1229},{"class":616,"line":1228},25,[1230],{"type":18,"tag":614,"props":1231,"children":1232},{},[1233],{"type":24,"value":650},{"type":18,"tag":614,"props":1235,"children":1237},{"class":616,"line":1236},26,[1238,1242,1246,1250,1255],{"type":18,"tag":614,"props":1239,"children":1240},{"class":627},[1241],{"type":24,"value":659},{"type":18,"tag":614,"props":1243,"children":1244},{"class":621},[1245],{"type":24,"value":664},{"type":18,"tag":614,"props":1247,"children":1248},{"class":627},[1249],{"type":24,"value":630},{"type":18,"tag":614,"props":1251,"children":1252},{"class":633},[1253],{"type":24,"value":1254},"dhdu",{"type":18,"tag":614,"props":1256,"children":1257},{"class":627},[1258],{"type":24,"value":1259},"(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n",{"type":18,"tag":614,"props":1261,"children":1263},{"class":616,"line":1262},27,[1264],{"type":18,"tag":614,"props":1265,"children":1266},{},[1267],{"type":24,"value":650},{"type":18,"tag":614,"props":1269,"children":1271},{"class":616,"line":1270},28,[1272,1277,1281,1285,1289,1294,1298,1303,1307,1312,1316,1320,1324,1329,1333,1337,1341,1345,1349,1354,1358,1363,1367,1371,1375,1379,1383,1388,1392,1397,1401,1405,1410,1415,1419],{"type":18,"tag":614,"props":1273,"children":1274},{"class":627},[1275],{"type":24,"value":1276},"        dhdu1 ",{"type":18,"tag":614,"props":1278,"children":1279},{"class":621},[1280],{"type":24,"value":711},{"type":18,"tag":614,"props":1282,"children":1283},{"class":627},[1284],{"type":24,"value":630},{"type":18,"tag":614,"props":1286,"children":1287},{"class":671},[1288],{"type":24,"value":701},{"type":18,"tag":614,"props":1290,"children":1291},{"class":627},[1292],{"type":24,"value":1293},".r1",{"type":18,"tag":614,"props":1295,"children":1296},{"class":621},[1297],{"type":24,"value":1056},{"type":18,"tag":614,"props":1299,"children":1300},{"class":627},[1301],{"type":24,"value":1302},"(u1",{"type":18,"tag":614,"props":1304,"children":1305},{"class":621},[1306],{"type":24,"value":1046},{"type":18,"tag":614,"props":1308,"children":1309},{"class":627},[1310],{"type":24,"value":1311},"u1_r)",{"type":18,"tag":614,"props":1313,"children":1314},{"class":621},[1315],{"type":24,"value":1177},{"type":18,"tag":614,"props":1317,"children":1318},{"class":627},[1319],{"type":24,"value":1163},{"type":18,"tag":614,"props":1321,"children":1322},{"class":621},[1323],{"type":24,"value":1056},{"type":18,"tag":614,"props":1325,"children":1326},{"class":627},[1327],{"type":24,"value":1328},"np.cos(yaw)",{"type":18,"tag":614,"props":1330,"children":1331},{"class":621},[1332],{"type":24,"value":1177},{"type":18,"tag":614,"props":1334,"children":1335},{"class":627},[1336],{"type":24,"value":1190},{"type":18,"tag":614,"props":1338,"children":1339},{"class":621},[1340],{"type":24,"value":1056},{"type":18,"tag":614,"props":1342,"children":1343},{"class":627},[1344],{"type":24,"value":1172},{"type":18,"tag":614,"props":1346,"children":1347},{"class":621},[1348],{"type":24,"value":1177},{"type":18,"tag":614,"props":1350,"children":1351},{"class":671},[1352],{"type":24,"value":1353},"2",{"type":18,"tag":614,"props":1355,"children":1356},{"class":621},[1357],{"type":24,"value":1056},{"type":18,"tag":614,"props":1359,"children":1360},{"class":627},[1361],{"type":24,"value":1362},"mu1",{"type":18,"tag":614,"props":1364,"children":1365},{"class":621},[1366],{"type":24,"value":1056},{"type":18,"tag":614,"props":1368,"children":1369},{"class":627},[1370],{"type":24,"value":1154},{"type":18,"tag":614,"props":1372,"children":1373},{"class":621},[1374],{"type":24,"value":1056},{"type":18,"tag":614,"props":1376,"children":1377},{"class":627},[1378],{"type":24,"value":1302},{"type":18,"tag":614,"props":1380,"children":1381},{"class":621},[1382],{"type":24,"value":1177},{"type":18,"tag":614,"props":1384,"children":1385},{"class":627},[1386],{"type":24,"value":1387},"(",{"type":18,"tag":614,"props":1389,"children":1390},{"class":671},[1391],{"type":24,"value":701},{"type":18,"tag":614,"props":1393,"children":1394},{"class":627},[1395],{"type":24,"value":1396},".u1_max",{"type":18,"tag":614,"props":1398,"children":1399},{"class":621},[1400],{"type":24,"value":1177},{"type":18,"tag":614,"props":1402,"children":1403},{"class":671},[1404],{"type":24,"value":701},{"type":18,"tag":614,"props":1406,"children":1407},{"class":627},[1408],{"type":24,"value":1409},".u1_min)",{"type":18,"tag":614,"props":1411,"children":1412},{"class":621},[1413],{"type":24,"value":1414},"/",{"type":18,"tag":614,"props":1416,"children":1417},{"class":671},[1418],{"type":24,"value":1353},{"type":18,"tag":614,"props":1420,"children":1421},{"class":627},[1422],{"type":24,"value":1423},")\n",{"type":18,"tag":614,"props":1425,"children":1427},{"class":616,"line":1426},29,[1428,1433,1437,1441,1445,1450,1454,1459,1463,1468,1472,1477,1481,1485,1489,1494,1498,1502,1506,1510,1514,1519,1523,1527,1532,1536,1540],{"type":18,"tag":614,"props":1429,"children":1430},{"class":627},[1431],{"type":24,"value":1432},"        dhdu2 ",{"type":18,"tag":614,"props":1434,"children":1435},{"class":621},[1436],{"type":24,"value":711},{"type":18,"tag":614,"props":1438,"children":1439},{"class":627},[1440],{"type":24,"value":630},{"type":18,"tag":614,"props":1442,"children":1443},{"class":671},[1444],{"type":24,"value":701},{"type":18,"tag":614,"props":1446,"children":1447},{"class":627},[1448],{"type":24,"value":1449},".r2",{"type":18,"tag":614,"props":1451,"children":1452},{"class":621},[1453],{"type":24,"value":1056},{"type":18,"tag":614,"props":1455,"children":1456},{"class":627},[1457],{"type":24,"value":1458},"(u2",{"type":18,"tag":614,"props":1460,"children":1461},{"class":621},[1462],{"type":24,"value":1046},{"type":18,"tag":614,"props":1464,"children":1465},{"class":627},[1466],{"type":24,"value":1467},"u2_r)",{"type":18,"tag":614,"props":1469,"children":1470},{"class":621},[1471],{"type":24,"value":1177},{"type":18,"tag":614,"props":1473,"children":1474},{"class":627},[1475],{"type":24,"value":1476},"lam3",{"type":18,"tag":614,"props":1478,"children":1479},{"class":621},[1480],{"type":24,"value":1177},{"type":18,"tag":614,"props":1482,"children":1483},{"class":671},[1484],{"type":24,"value":1353},{"type":18,"tag":614,"props":1486,"children":1487},{"class":621},[1488],{"type":24,"value":1056},{"type":18,"tag":614,"props":1490,"children":1491},{"class":627},[1492],{"type":24,"value":1493},"mu2",{"type":18,"tag":614,"props":1495,"children":1496},{"class":621},[1497],{"type":24,"value":1056},{"type":18,"tag":614,"props":1499,"children":1500},{"class":627},[1501],{"type":24,"value":1458},{"type":18,"tag":614,"props":1503,"children":1504},{"class":621},[1505],{"type":24,"value":1177},{"type":18,"tag":614,"props":1507,"children":1508},{"class":627},[1509],{"type":24,"value":1387},{"type":18,"tag":614,"props":1511,"children":1512},{"class":671},[1513],{"type":24,"value":701},{"type":18,"tag":614,"props":1515,"children":1516},{"class":627},[1517],{"type":24,"value":1518},".u2_max",{"type":18,"tag":614,"props":1520,"children":1521},{"class":621},[1522],{"type":24,"value":1177},{"type":18,"tag":614,"props":1524,"children":1525},{"class":671},[1526],{"type":24,"value":701},{"type":18,"tag":614,"props":1528,"children":1529},{"class":627},[1530],{"type":24,"value":1531},".u2_min)",{"type":18,"tag":614,"props":1533,"children":1534},{"class":621},[1535],{"type":24,"value":1414},{"type":18,"tag":614,"props":1537,"children":1538},{"class":671},[1539],{"type":24,"value":1353},{"type":18,"tag":614,"props":1541,"children":1542},{"class":627},[1543],{"type":24,"value":1423},{"type":18,"tag":614,"props":1545,"children":1547},{"class":616,"line":1546},30,[1548],{"type":18,"tag":614,"props":1549,"children":1550},{},[1551],{"type":24,"value":650},{"type":18,"tag":614,"props":1553,"children":1555},{"class":616,"line":1554},31,[1556,1560,1564],{"type":18,"tag":614,"props":1557,"children":1558},{"class":627},[1559],{"type":24,"value":696},{"type":18,"tag":614,"props":1561,"children":1562},{"class":621},[1563],{"type":24,"value":1220},{"type":18,"tag":614,"props":1565,"children":1566},{"class":627},[1567],{"type":24,"value":1568}," dhdu1, dhdu2\n",{"type":18,"tag":614,"props":1570,"children":1572},{"class":616,"line":1571},32,[1573],{"type":18,"tag":614,"props":1574,"children":1575},{},[1576],{"type":24,"value":650},{"type":18,"tag":614,"props":1578,"children":1580},{"class":616,"line":1579},33,[1581,1585,1589,1593,1598],{"type":18,"tag":614,"props":1582,"children":1583},{"class":627},[1584],{"type":24,"value":659},{"type":18,"tag":614,"props":1586,"children":1587},{"class":621},[1588],{"type":24,"value":664},{"type":18,"tag":614,"props":1590,"children":1591},{"class":627},[1592],{"type":24,"value":630},{"type":18,"tag":614,"props":1594,"children":1595},{"class":633},[1596],{"type":24,"value":1597},"dphidx",{"type":18,"tag":614,"props":1599,"children":1600},{"class":627},[1601],{"type":24,"value":1602},"(self, x, y, yaw, x_r, y_r, yaw_r):\n",{"type":18,"tag":614,"props":1604,"children":1606},{"class":616,"line":1605},34,[1607,1612,1616,1620,1624,1629,1633,1638,1642],{"type":18,"tag":614,"props":1608,"children":1609},{"class":627},[1610],{"type":24,"value":1611},"        dphidx1 ",{"type":18,"tag":614,"props":1613,"children":1614},{"class":621},[1615],{"type":24,"value":711},{"type":18,"tag":614,"props":1617,"children":1618},{"class":627},[1619],{"type":24,"value":630},{"type":18,"tag":614,"props":1621,"children":1622},{"class":671},[1623],{"type":24,"value":701},{"type":18,"tag":614,"props":1625,"children":1626},{"class":627},[1627],{"type":24,"value":1628},".q1",{"type":18,"tag":614,"props":1630,"children":1631},{"class":621},[1632],{"type":24,"value":1056},{"type":18,"tag":614,"props":1634,"children":1635},{"class":627},[1636],{"type":24,"value":1637},"(x",{"type":18,"tag":614,"props":1639,"children":1640},{"class":621},[1641],{"type":24,"value":1046},{"type":18,"tag":614,"props":1643,"children":1644},{"class":627},[1645],{"type":24,"value":1646},"x_r)\n",{"type":18,"tag":614,"props":1648,"children":1650},{"class":616,"line":1649},35,[1651,1656,1660,1664,1668,1673,1677,1682,1686],{"type":18,"tag":614,"props":1652,"children":1653},{"class":627},[1654],{"type":24,"value":1655},"        dphidx2 ",{"type":18,"tag":614,"props":1657,"children":1658},{"class":621},[1659],{"type":24,"value":711},{"type":18,"tag":614,"props":1661,"children":1662},{"class":627},[1663],{"type":24,"value":630},{"type":18,"tag":614,"props":1665,"children":1666},{"class":671},[1667],{"type":24,"value":701},{"type":18,"tag":614,"props":1669,"children":1670},{"class":627},[1671],{"type":24,"value":1672},".q2",{"type":18,"tag":614,"props":1674,"children":1675},{"class":621},[1676],{"type":24,"value":1056},{"type":18,"tag":614,"props":1678,"children":1679},{"class":627},[1680],{"type":24,"value":1681},"(y",{"type":18,"tag":614,"props":1683,"children":1684},{"class":621},[1685],{"type":24,"value":1046},{"type":18,"tag":614,"props":1687,"children":1688},{"class":627},[1689],{"type":24,"value":1690},"y_r)\n",{"type":18,"tag":614,"props":1692,"children":1694},{"class":616,"line":1693},36,[1695,1700,1704,1708,1712,1716,1720,1725,1729],{"type":18,"tag":614,"props":1696,"children":1697},{"class":627},[1698],{"type":24,"value":1699},"        dphidx3 ",{"type":18,"tag":614,"props":1701,"children":1702},{"class":621},[1703],{"type":24,"value":711},{"type":18,"tag":614,"props":1705,"children":1706},{"class":627},[1707],{"type":24,"value":630},{"type":18,"tag":614,"props":1709,"children":1710},{"class":671},[1711],{"type":24,"value":701},{"type":18,"tag":614,"props":1713,"children":1714},{"class":627},[1715],{"type":24,"value":1145},{"type":18,"tag":614,"props":1717,"children":1718},{"class":621},[1719],{"type":24,"value":1056},{"type":18,"tag":614,"props":1721,"children":1722},{"class":627},[1723],{"type":24,"value":1724},"(yaw",{"type":18,"tag":614,"props":1726,"children":1727},{"class":621},[1728],{"type":24,"value":1046},{"type":18,"tag":614,"props":1730,"children":1731},{"class":627},[1732],{"type":24,"value":1733},"yaw_r)\n",{"type":18,"tag":614,"props":1735,"children":1737},{"class":616,"line":1736},37,[1738],{"type":18,"tag":614,"props":1739,"children":1740},{},[1741],{"type":24,"value":650},{"type":18,"tag":614,"props":1743,"children":1745},{"class":616,"line":1744},38,[1746,1750,1754],{"type":18,"tag":614,"props":1747,"children":1748},{"class":627},[1749],{"type":24,"value":696},{"type":18,"tag":614,"props":1751,"children":1752},{"class":621},[1753],{"type":24,"value":1220},{"type":18,"tag":614,"props":1755,"children":1756},{"class":627},[1757],{"type":24,"value":1758}," dphidx1, dphidx2, dphidx3",{"type":18,"tag":27,"props":1760,"children":1761},{},[1762,1764,1769,1770],{"type":24,"value":1763},"Here, I suggest that you should understand the mathematics equations above that I try to explain. It is easy to do it in Python programming language if you already understand its expression. Now I created another class for ",{"type":18,"tag":170,"props":1765,"children":1766},{},[1767],{"type":24,"value":1768}," NMPC with CGMRES ",{"type":24,"value":176},{"type":18,"tag":56,"props":1771,"children":1772},{},[],{"type":18,"tag":599,"props":1774,"children":1777},{"className":1775,"code":1776,"language":604,"meta":8},[602],"class NMPCCGMRES:\n\n    def __init__(self):\n\n        ## NMPC params\n        self.x_dim = 3\n        self.u_dim = 2\n        self.c_dim = 2\n        self.pred_horizons = 10\n\n        ### Continuations Params\n        self.ht = 1e-5\n        self.zeta = 1/self.ht\n        self.alpha = 0.5\n        self.tf = 1.0\n\n        ### Matrix\n\n        self.q1 = 1\n        self.q2 = 6\n        self.q3 = 1\n        self.r1 = 1\n        self.r2 = 0.1\n\n        ### Constraint\n        self.u_min = [ 0,  0]\n        self.u_max = [ 2,  1.57]\n        self.u_dummy = [0.01, 0.01]\n\n        ### Initialize matrix solution\n        self.dU = np.zeros((self.u_dim, self.pred_horizons))\n\n        ### Reference point\n        self.X_r = [3, 2, 0.0]\n        self.U_r = [0, 0]\n",[1778],{"type":18,"tag":607,"props":1779,"children":1780},{},[1781],{"type":18,"tag":599,"props":1782,"children":1783},{"__ignoreMap":8},[1784,1804,1811,1835,1842,1855,1884,1913,1941,1970,1977,1989,2018,2059,2088,2117,2124,2136,2143,2171,2199,2226,2253,2281,2288,2300,2342,2383,2426,2433,2445,2488,2495,2507,2557],{"type":18,"tag":614,"props":1785,"children":1786},{"class":616,"line":617},[1787,1791,1795,1800],{"type":18,"tag":614,"props":1788,"children":1789},{"class":621},[1790],{"type":24,"value":624},{"type":18,"tag":614,"props":1792,"children":1793},{"class":627},[1794],{"type":24,"value":630},{"type":18,"tag":614,"props":1796,"children":1797},{"class":633},[1798],{"type":24,"value":1799},"NMPCCGMRES",{"type":18,"tag":614,"props":1801,"children":1802},{"class":627},[1803],{"type":24,"value":641},{"type":18,"tag":614,"props":1805,"children":1806},{"class":616,"line":644},[1807],{"type":18,"tag":614,"props":1808,"children":1809},{},[1810],{"type":24,"value":650},{"type":18,"tag":614,"props":1812,"children":1813},{"class":616,"line":653},[1814,1818,1822,1826,1830],{"type":18,"tag":614,"props":1815,"children":1816},{"class":627},[1817],{"type":24,"value":659},{"type":18,"tag":614,"props":1819,"children":1820},{"class":621},[1821],{"type":24,"value":664},{"type":18,"tag":614,"props":1823,"children":1824},{"class":627},[1825],{"type":24,"value":630},{"type":18,"tag":614,"props":1827,"children":1828},{"class":671},[1829],{"type":24,"value":674},{"type":18,"tag":614,"props":1831,"children":1832},{"class":627},[1833],{"type":24,"value":1834},"(self):\n",{"type":18,"tag":614,"props":1836,"children":1837},{"class":616,"line":682},[1838],{"type":18,"tag":614,"props":1839,"children":1840},{},[1841],{"type":24,"value":650},{"type":18,"tag":614,"props":1843,"children":1844},{"class":616,"line":690},[1845,1849],{"type":18,"tag":614,"props":1846,"children":1847},{"class":627},[1848],{"type":24,"value":696},{"type":18,"tag":614,"props":1850,"children":1852},{"class":1851},"ct-326375",[1853],{"type":24,"value":1854},"## NMPC params\n",{"type":18,"tag":614,"props":1856,"children":1857},{"class":616,"line":719},[1858,1862,1866,1871,1875,1879],{"type":18,"tag":614,"props":1859,"children":1860},{"class":627},[1861],{"type":24,"value":696},{"type":18,"tag":614,"props":1863,"children":1864},{"class":671},[1865],{"type":24,"value":701},{"type":18,"tag":614,"props":1867,"children":1868},{"class":627},[1869],{"type":24,"value":1870},".x_dim ",{"type":18,"tag":614,"props":1872,"children":1873},{"class":621},[1874],{"type":24,"value":711},{"type":18,"tag":614,"props":1876,"children":1877},{"class":627},[1878],{"type":24,"value":630},{"type":18,"tag":614,"props":1880,"children":1881},{"class":671},[1882],{"type":24,"value":1883},"3\n",{"type":18,"tag":614,"props":1885,"children":1886},{"class":616,"line":745},[1887,1891,1895,1900,1904,1908],{"type":18,"tag":614,"props":1888,"children":1889},{"class":627},[1890],{"type":24,"value":696},{"type":18,"tag":614,"props":1892,"children":1893},{"class":671},[1894],{"type":24,"value":701},{"type":18,"tag":614,"props":1896,"children":1897},{"class":627},[1898],{"type":24,"value":1899},".u_dim ",{"type":18,"tag":614,"props":1901,"children":1902},{"class":621},[1903],{"type":24,"value":711},{"type":18,"tag":614,"props":1905,"children":1906},{"class":627},[1907],{"type":24,"value":630},{"type":18,"tag":614,"props":1909,"children":1910},{"class":671},[1911],{"type":24,"value":1912},"2\n",{"type":18,"tag":614,"props":1914,"children":1915},{"class":616,"line":771},[1916,1920,1924,1929,1933,1937],{"type":18,"tag":614,"props":1917,"children":1918},{"class":627},[1919],{"type":24,"value":696},{"type":18,"tag":614,"props":1921,"children":1922},{"class":671},[1923],{"type":24,"value":701},{"type":18,"tag":614,"props":1925,"children":1926},{"class":627},[1927],{"type":24,"value":1928},".c_dim ",{"type":18,"tag":614,"props":1930,"children":1931},{"class":621},[1932],{"type":24,"value":711},{"type":18,"tag":614,"props":1934,"children":1935},{"class":627},[1936],{"type":24,"value":630},{"type":18,"tag":614,"props":1938,"children":1939},{"class":671},[1940],{"type":24,"value":1912},{"type":18,"tag":614,"props":1942,"children":1943},{"class":616,"line":779},[1944,1948,1952,1957,1961,1965],{"type":18,"tag":614,"props":1945,"children":1946},{"class":627},[1947],{"type":24,"value":696},{"type":18,"tag":614,"props":1949,"children":1950},{"class":671},[1951],{"type":24,"value":701},{"type":18,"tag":614,"props":1953,"children":1954},{"class":627},[1955],{"type":24,"value":1956},".pred_horizons ",{"type":18,"tag":614,"props":1958,"children":1959},{"class":621},[1960],{"type":24,"value":711},{"type":18,"tag":614,"props":1962,"children":1963},{"class":627},[1964],{"type":24,"value":630},{"type":18,"tag":614,"props":1966,"children":1967},{"class":671},[1968],{"type":24,"value":1969},"10\n",{"type":18,"tag":614,"props":1971,"children":1972},{"class":616,"line":805},[1973],{"type":18,"tag":614,"props":1974,"children":1975},{},[1976],{"type":24,"value":650},{"type":18,"tag":614,"props":1978,"children":1979},{"class":616,"line":831},[1980,1984],{"type":18,"tag":614,"props":1981,"children":1982},{"class":627},[1983],{"type":24,"value":696},{"type":18,"tag":614,"props":1985,"children":1986},{"class":1851},[1987],{"type":24,"value":1988},"### Continuations Params\n",{"type":18,"tag":614,"props":1990,"children":1991},{"class":616,"line":839},[1992,1996,2000,2005,2009,2013],{"type":18,"tag":614,"props":1993,"children":1994},{"class":627},[1995],{"type":24,"value":696},{"type":18,"tag":614,"props":1997,"children":1998},{"class":671},[1999],{"type":24,"value":701},{"type":18,"tag":614,"props":2001,"children":2002},{"class":627},[2003],{"type":24,"value":2004},".ht ",{"type":18,"tag":614,"props":2006,"children":2007},{"class":621},[2008],{"type":24,"value":711},{"type":18,"tag":614,"props":2010,"children":2011},{"class":627},[2012],{"type":24,"value":630},{"type":18,"tag":614,"props":2014,"children":2015},{"class":671},[2016],{"type":24,"value":2017},"1e-5\n",{"type":18,"tag":614,"props":2019,"children":2020},{"class":616,"line":875},[2021,2025,2029,2034,2038,2042,2046,2050,2054],{"type":18,"tag":614,"props":2022,"children":2023},{"class":627},[2024],{"type":24,"value":696},{"type":18,"tag":614,"props":2026,"children":2027},{"class":671},[2028],{"type":24,"value":701},{"type":18,"tag":614,"props":2030,"children":2031},{"class":627},[2032],{"type":24,"value":2033},".zeta ",{"type":18,"tag":614,"props":2035,"children":2036},{"class":621},[2037],{"type":24,"value":711},{"type":18,"tag":614,"props":2039,"children":2040},{"class":627},[2041],{"type":24,"value":630},{"type":18,"tag":614,"props":2043,"children":2044},{"class":671},[2045],{"type":24,"value":977},{"type":18,"tag":614,"props":2047,"children":2048},{"class":621},[2049],{"type":24,"value":1414},{"type":18,"tag":614,"props":2051,"children":2052},{"class":671},[2053],{"type":24,"value":701},{"type":18,"tag":614,"props":2055,"children":2056},{"class":627},[2057],{"type":24,"value":2058},".ht\n",{"type":18,"tag":614,"props":2060,"children":2061},{"class":616,"line":908},[2062,2066,2070,2075,2079,2083],{"type":18,"tag":614,"props":2063,"children":2064},{"class":627},[2065],{"type":24,"value":696},{"type":18,"tag":614,"props":2067,"children":2068},{"class":671},[2069],{"type":24,"value":701},{"type":18,"tag":614,"props":2071,"children":2072},{"class":627},[2073],{"type":24,"value":2074},".alpha ",{"type":18,"tag":614,"props":2076,"children":2077},{"class":621},[2078],{"type":24,"value":711},{"type":18,"tag":614,"props":2080,"children":2081},{"class":627},[2082],{"type":24,"value":630},{"type":18,"tag":614,"props":2084,"children":2085},{"class":671},[2086],{"type":24,"value":2087},"0.5\n",{"type":18,"tag":614,"props":2089,"children":2090},{"class":616,"line":916},[2091,2095,2099,2104,2108,2112],{"type":18,"tag":614,"props":2092,"children":2093},{"class":627},[2094],{"type":24,"value":696},{"type":18,"tag":614,"props":2096,"children":2097},{"class":671},[2098],{"type":24,"value":701},{"type":18,"tag":614,"props":2100,"children":2101},{"class":627},[2102],{"type":24,"value":2103},".tf ",{"type":18,"tag":614,"props":2105,"children":2106},{"class":621},[2107],{"type":24,"value":711},{"type":18,"tag":614,"props":2109,"children":2110},{"class":627},[2111],{"type":24,"value":630},{"type":18,"tag":614,"props":2113,"children":2114},{"class":671},[2115],{"type":24,"value":2116},"1.0\n",{"type":18,"tag":614,"props":2118,"children":2119},{"class":616,"line":950},[2120],{"type":18,"tag":614,"props":2121,"children":2122},{},[2123],{"type":24,"value":650},{"type":18,"tag":614,"props":2125,"children":2126},{"class":616,"line":984},[2127,2131],{"type":18,"tag":614,"props":2128,"children":2129},{"class":627},[2130],{"type":24,"value":696},{"type":18,"tag":614,"props":2132,"children":2133},{"class":1851},[2134],{"type":24,"value":2135},"### Matrix\n",{"type":18,"tag":614,"props":2137,"children":2138},{"class":616,"line":992},[2139],{"type":18,"tag":614,"props":2140,"children":2141},{},[2142],{"type":24,"value":650},{"type":18,"tag":614,"props":2144,"children":2145},{"class":616,"line":1018},[2146,2150,2154,2158,2162,2166],{"type":18,"tag":614,"props":2147,"children":2148},{"class":627},[2149],{"type":24,"value":696},{"type":18,"tag":614,"props":2151,"children":2152},{"class":671},[2153],{"type":24,"value":701},{"type":18,"tag":614,"props":2155,"children":2156},{"class":627},[2157],{"type":24,"value":706},{"type":18,"tag":614,"props":2159,"children":2160},{"class":621},[2161],{"type":24,"value":711},{"type":18,"tag":614,"props":2163,"children":2164},{"class":627},[2165],{"type":24,"value":630},{"type":18,"tag":614,"props":2167,"children":2168},{"class":671},[2169],{"type":24,"value":2170},"1\n",{"type":18,"tag":614,"props":2172,"children":2173},{"class":616,"line":1026},[2174,2178,2182,2186,2190,2194],{"type":18,"tag":614,"props":2175,"children":2176},{"class":627},[2177],{"type":24,"value":696},{"type":18,"tag":614,"props":2179,"children":2180},{"class":671},[2181],{"type":24,"value":701},{"type":18,"tag":614,"props":2183,"children":2184},{"class":627},[2185],{"type":24,"value":733},{"type":18,"tag":614,"props":2187,"children":2188},{"class":621},[2189],{"type":24,"value":711},{"type":18,"tag":614,"props":2191,"children":2192},{"class":627},[2193],{"type":24,"value":630},{"type":18,"tag":614,"props":2195,"children":2196},{"class":671},[2197],{"type":24,"value":2198},"6\n",{"type":18,"tag":614,"props":2200,"children":2201},{"class":616,"line":1068},[2202,2206,2210,2214,2218,2222],{"type":18,"tag":614,"props":2203,"children":2204},{"class":627},[2205],{"type":24,"value":696},{"type":18,"tag":614,"props":2207,"children":2208},{"class":671},[2209],{"type":24,"value":701},{"type":18,"tag":614,"props":2211,"children":2212},{"class":627},[2213],{"type":24,"value":759},{"type":18,"tag":614,"props":2215,"children":2216},{"class":621},[2217],{"type":24,"value":711},{"type":18,"tag":614,"props":2219,"children":2220},{"class":627},[2221],{"type":24,"value":630},{"type":18,"tag":614,"props":2223,"children":2224},{"class":671},[2225],{"type":24,"value":2170},{"type":18,"tag":614,"props":2227,"children":2228},{"class":616,"line":1108},[2229,2233,2237,2241,2245,2249],{"type":18,"tag":614,"props":2230,"children":2231},{"class":627},[2232],{"type":24,"value":696},{"type":18,"tag":614,"props":2234,"children":2235},{"class":671},[2236],{"type":24,"value":701},{"type":18,"tag":614,"props":2238,"children":2239},{"class":627},[2240],{"type":24,"value":793},{"type":18,"tag":614,"props":2242,"children":2243},{"class":621},[2244],{"type":24,"value":711},{"type":18,"tag":614,"props":2246,"children":2247},{"class":627},[2248],{"type":24,"value":630},{"type":18,"tag":614,"props":2250,"children":2251},{"class":671},[2252],{"type":24,"value":2170},{"type":18,"tag":614,"props":2254,"children":2255},{"class":616,"line":1202},[2256,2260,2264,2268,2272,2276],{"type":18,"tag":614,"props":2257,"children":2258},{"class":627},[2259],{"type":24,"value":696},{"type":18,"tag":614,"props":2261,"children":2262},{"class":671},[2263],{"type":24,"value":701},{"type":18,"tag":614,"props":2265,"children":2266},{"class":627},[2267],{"type":24,"value":819},{"type":18,"tag":614,"props":2269,"children":2270},{"class":621},[2271],{"type":24,"value":711},{"type":18,"tag":614,"props":2273,"children":2274},{"class":627},[2275],{"type":24,"value":630},{"type":18,"tag":614,"props":2277,"children":2278},{"class":671},[2279],{"type":24,"value":2280},"0.1\n",{"type":18,"tag":614,"props":2282,"children":2283},{"class":616,"line":1210},[2284],{"type":18,"tag":614,"props":2285,"children":2286},{},[2287],{"type":24,"value":650},{"type":18,"tag":614,"props":2289,"children":2290},{"class":616,"line":1228},[2291,2295],{"type":18,"tag":614,"props":2292,"children":2293},{"class":627},[2294],{"type":24,"value":696},{"type":18,"tag":614,"props":2296,"children":2297},{"class":1851},[2298],{"type":24,"value":2299},"### Constraint\n",{"type":18,"tag":614,"props":2301,"children":2302},{"class":616,"line":1236},[2303,2307,2311,2316,2320,2325,2329,2334,2338],{"type":18,"tag":614,"props":2304,"children":2305},{"class":627},[2306],{"type":24,"value":696},{"type":18,"tag":614,"props":2308,"children":2309},{"class":671},[2310],{"type":24,"value":701},{"type":18,"tag":614,"props":2312,"children":2313},{"class":627},[2314],{"type":24,"value":2315},".u_min ",{"type":18,"tag":614,"props":2317,"children":2318},{"class":621},[2319],{"type":24,"value":711},{"type":18,"tag":614,"props":2321,"children":2322},{"class":627},[2323],{"type":24,"value":2324}," [ ",{"type":18,"tag":614,"props":2326,"children":2327},{"class":671},[2328],{"type":24,"value":867},{"type":18,"tag":614,"props":2330,"children":2331},{"class":627},[2332],{"type":24,"value":2333},",  ",{"type":18,"tag":614,"props":2335,"children":2336},{"class":671},[2337],{"type":24,"value":867},{"type":18,"tag":614,"props":2339,"children":2340},{"class":627},[2341],{"type":24,"value":872},{"type":18,"tag":614,"props":2343,"children":2344},{"class":616,"line":1262},[2345,2349,2353,2358,2362,2366,2370,2374,2379],{"type":18,"tag":614,"props":2346,"children":2347},{"class":627},[2348],{"type":24,"value":696},{"type":18,"tag":614,"props":2350,"children":2351},{"class":671},[2352],{"type":24,"value":701},{"type":18,"tag":614,"props":2354,"children":2355},{"class":627},[2356],{"type":24,"value":2357},".u_max ",{"type":18,"tag":614,"props":2359,"children":2360},{"class":621},[2361],{"type":24,"value":711},{"type":18,"tag":614,"props":2363,"children":2364},{"class":627},[2365],{"type":24,"value":2324},{"type":18,"tag":614,"props":2367,"children":2368},{"class":671},[2369],{"type":24,"value":1353},{"type":18,"tag":614,"props":2371,"children":2372},{"class":627},[2373],{"type":24,"value":2333},{"type":18,"tag":614,"props":2375,"children":2376},{"class":671},[2377],{"type":24,"value":2378},"1.57",{"type":18,"tag":614,"props":2380,"children":2381},{"class":627},[2382],{"type":24,"value":872},{"type":18,"tag":614,"props":2384,"children":2385},{"class":616,"line":1270},[2386,2390,2394,2399,2403,2408,2413,2418,2422],{"type":18,"tag":614,"props":2387,"children":2388},{"class":627},[2389],{"type":24,"value":696},{"type":18,"tag":614,"props":2391,"children":2392},{"class":671},[2393],{"type":24,"value":701},{"type":18,"tag":614,"props":2395,"children":2396},{"class":627},[2397],{"type":24,"value":2398},".u_dummy ",{"type":18,"tag":614,"props":2400,"children":2401},{"class":621},[2402],{"type":24,"value":711},{"type":18,"tag":614,"props":2404,"children":2405},{"class":627},[2406],{"type":24,"value":2407}," [",{"type":18,"tag":614,"props":2409,"children":2410},{"class":671},[2411],{"type":24,"value":2412},"0.01",{"type":18,"tag":614,"props":2414,"children":2415},{"class":627},[2416],{"type":24,"value":2417},", ",{"type":18,"tag":614,"props":2419,"children":2420},{"class":671},[2421],{"type":24,"value":2412},{"type":18,"tag":614,"props":2423,"children":2424},{"class":627},[2425],{"type":24,"value":872},{"type":18,"tag":614,"props":2427,"children":2428},{"class":616,"line":1426},[2429],{"type":18,"tag":614,"props":2430,"children":2431},{},[2432],{"type":24,"value":650},{"type":18,"tag":614,"props":2434,"children":2435},{"class":616,"line":1546},[2436,2440],{"type":18,"tag":614,"props":2437,"children":2438},{"class":627},[2439],{"type":24,"value":696},{"type":18,"tag":614,"props":2441,"children":2442},{"class":1851},[2443],{"type":24,"value":2444},"### Initialize matrix solution\n",{"type":18,"tag":614,"props":2446,"children":2447},{"class":616,"line":1554},[2448,2452,2456,2461,2465,2470,2474,2479,2483],{"type":18,"tag":614,"props":2449,"children":2450},{"class":627},[2451],{"type":24,"value":696},{"type":18,"tag":614,"props":2453,"children":2454},{"class":671},[2455],{"type":24,"value":701},{"type":18,"tag":614,"props":2457,"children":2458},{"class":627},[2459],{"type":24,"value":2460},".dU ",{"type":18,"tag":614,"props":2462,"children":2463},{"class":621},[2464],{"type":24,"value":711},{"type":18,"tag":614,"props":2466,"children":2467},{"class":627},[2468],{"type":24,"value":2469}," np.zeros((",{"type":18,"tag":614,"props":2471,"children":2472},{"class":671},[2473],{"type":24,"value":701},{"type":18,"tag":614,"props":2475,"children":2476},{"class":627},[2477],{"type":24,"value":2478},".u_dim, ",{"type":18,"tag":614,"props":2480,"children":2481},{"class":671},[2482],{"type":24,"value":701},{"type":18,"tag":614,"props":2484,"children":2485},{"class":627},[2486],{"type":24,"value":2487},".pred_horizons))\n",{"type":18,"tag":614,"props":2489,"children":2490},{"class":616,"line":1571},[2491],{"type":18,"tag":614,"props":2492,"children":2493},{},[2494],{"type":24,"value":650},{"type":18,"tag":614,"props":2496,"children":2497},{"class":616,"line":1579},[2498,2502],{"type":18,"tag":614,"props":2499,"children":2500},{"class":627},[2501],{"type":24,"value":696},{"type":18,"tag":614,"props":2503,"children":2504},{"class":1851},[2505],{"type":24,"value":2506},"### Reference point\n",{"type":18,"tag":614,"props":2508,"children":2509},{"class":616,"line":1605},[2510,2514,2518,2523,2527,2531,2536,2540,2544,2548,2553],{"type":18,"tag":614,"props":2511,"children":2512},{"class":627},[2513],{"type":24,"value":696},{"type":18,"tag":614,"props":2515,"children":2516},{"class":671},[2517],{"type":24,"value":701},{"type":18,"tag":614,"props":2519,"children":2520},{"class":627},[2521],{"type":24,"value":2522},".X_r ",{"type":18,"tag":614,"props":2524,"children":2525},{"class":621},[2526],{"type":24,"value":711},{"type":18,"tag":614,"props":2528,"children":2529},{"class":627},[2530],{"type":24,"value":2407},{"type":18,"tag":614,"props":2532,"children":2533},{"class":671},[2534],{"type":24,"value":2535},"3",{"type":18,"tag":614,"props":2537,"children":2538},{"class":627},[2539],{"type":24,"value":2417},{"type":18,"tag":614,"props":2541,"children":2542},{"class":671},[2543],{"type":24,"value":1353},{"type":18,"tag":614,"props":2545,"children":2546},{"class":627},[2547],{"type":24,"value":2417},{"type":18,"tag":614,"props":2549,"children":2550},{"class":671},[2551],{"type":24,"value":2552},"0.0",{"type":18,"tag":614,"props":2554,"children":2555},{"class":627},[2556],{"type":24,"value":872},{"type":18,"tag":614,"props":2558,"children":2559},{"class":616,"line":1649},[2560,2564,2568,2573,2577,2581,2585,2589,2593],{"type":18,"tag":614,"props":2561,"children":2562},{"class":627},[2563],{"type":24,"value":696},{"type":18,"tag":614,"props":2565,"children":2566},{"class":671},[2567],{"type":24,"value":701},{"type":18,"tag":614,"props":2569,"children":2570},{"class":627},[2571],{"type":24,"value":2572},".U_r ",{"type":18,"tag":614,"props":2574,"children":2575},{"class":621},[2576],{"type":24,"value":711},{"type":18,"tag":614,"props":2578,"children":2579},{"class":627},[2580],{"type":24,"value":2407},{"type":18,"tag":614,"props":2582,"children":2583},{"class":671},[2584],{"type":24,"value":867},{"type":18,"tag":614,"props":2586,"children":2587},{"class":627},[2588],{"type":24,"value":2417},{"type":18,"tag":614,"props":2590,"children":2591},{"class":671},[2592],{"type":24,"value":867},{"type":18,"tag":614,"props":2594,"children":2595},{"class":627},[2596],{"type":24,"value":2597},"]",{"type":18,"tag":27,"props":2599,"children":2600},{},[2601],{"type":24,"value":2602},"These are just for tuning parameters and initialize parameters, let's focus on CGMRES method. As the expression above at equation (1).\nLet's denote that",{"type":18,"tag":599,"props":2604,"children":2607},{"className":2605,"code":2606,"language":604,"meta":8},[602],"X = np.zeros((x_dim, pred_horizons+1))      ## State for N-prediction+1\nU = np.zeros((u_dim, pred_horizons))        ## Input Control for N-prediction\nLambda = np.zeros((x_dim, pred_horizons+1)) ## Costate vector for N-prediction+1\ndt = 0.01                                   ## Sampling Time\n",[2608],{"type":18,"tag":607,"props":2609,"children":2610},{},[2611],{"type":18,"tag":599,"props":2612,"children":2613},{"__ignoreMap":8},[2614,2649,2671,2705],{"type":18,"tag":614,"props":2615,"children":2616},{"class":616,"line":617},[2617,2622,2626,2631,2635,2639,2644],{"type":18,"tag":614,"props":2618,"children":2619},{"class":627},[2620],{"type":24,"value":2621},"X ",{"type":18,"tag":614,"props":2623,"children":2624},{"class":621},[2625],{"type":24,"value":711},{"type":18,"tag":614,"props":2627,"children":2628},{"class":627},[2629],{"type":24,"value":2630}," np.zeros((x_dim, pred_horizons",{"type":18,"tag":614,"props":2632,"children":2633},{"class":621},[2634],{"type":24,"value":1177},{"type":18,"tag":614,"props":2636,"children":2637},{"class":671},[2638],{"type":24,"value":977},{"type":18,"tag":614,"props":2640,"children":2641},{"class":627},[2642],{"type":24,"value":2643},"))      ",{"type":18,"tag":614,"props":2645,"children":2646},{"class":1851},[2647],{"type":24,"value":2648},"## State for N-prediction+1\n",{"type":18,"tag":614,"props":2650,"children":2651},{"class":616,"line":644},[2652,2657,2661,2666],{"type":18,"tag":614,"props":2653,"children":2654},{"class":627},[2655],{"type":24,"value":2656},"U ",{"type":18,"tag":614,"props":2658,"children":2659},{"class":621},[2660],{"type":24,"value":711},{"type":18,"tag":614,"props":2662,"children":2663},{"class":627},[2664],{"type":24,"value":2665}," np.zeros((u_dim, pred_horizons))        ",{"type":18,"tag":614,"props":2667,"children":2668},{"class":1851},[2669],{"type":24,"value":2670},"## Input Control for N-prediction\n",{"type":18,"tag":614,"props":2672,"children":2673},{"class":616,"line":653},[2674,2679,2683,2687,2691,2695,2700],{"type":18,"tag":614,"props":2675,"children":2676},{"class":627},[2677],{"type":24,"value":2678},"Lambda ",{"type":18,"tag":614,"props":2680,"children":2681},{"class":621},[2682],{"type":24,"value":711},{"type":18,"tag":614,"props":2684,"children":2685},{"class":627},[2686],{"type":24,"value":2630},{"type":18,"tag":614,"props":2688,"children":2689},{"class":621},[2690],{"type":24,"value":1177},{"type":18,"tag":614,"props":2692,"children":2693},{"class":671},[2694],{"type":24,"value":977},{"type":18,"tag":614,"props":2696,"children":2697},{"class":627},[2698],{"type":24,"value":2699},")) ",{"type":18,"tag":614,"props":2701,"children":2702},{"class":1851},[2703],{"type":24,"value":2704},"## Costate vector for N-prediction+1\n",{"type":18,"tag":614,"props":2706,"children":2707},{"class":616,"line":682},[2708,2713,2717,2721,2725,2730],{"type":18,"tag":614,"props":2709,"children":2710},{"class":627},[2711],{"type":24,"value":2712},"dt ",{"type":18,"tag":614,"props":2714,"children":2715},{"class":621},[2716],{"type":24,"value":711},{"type":18,"tag":614,"props":2718,"children":2719},{"class":627},[2720],{"type":24,"value":630},{"type":18,"tag":614,"props":2722,"children":2723},{"class":671},[2724],{"type":24,"value":2412},{"type":18,"tag":614,"props":2726,"children":2727},{"class":627},[2728],{"type":24,"value":2729},"                                   ",{"type":18,"tag":614,"props":2731,"children":2732},{"class":1851},[2733],{"type":24,"value":2734},"## Sampling Time",{"type":18,"tag":27,"props":2736,"children":2737},{},[2738],{"type":24,"value":2739},"Then, we can perform equation (1) as",{"type":18,"tag":599,"props":2741,"children":2744},{"className":2742,"code":2743,"language":604,"meta":8},[602],"def calc_state(self, X, U, dt):\n\n        for i in range(self.pred_horizons):\n            x_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, i], U[0, i], U[1, i])\n            \n            X[0, i+1] = X[0, i] + x_dot * dt\n            X[1, i+1] = X[1, i] + y_dot * dt\n            X[2, i+1] = X[2, i] + yaw_dot * dt\n\n        return X\n",[2745],{"type":18,"tag":607,"props":2746,"children":2747},{},[2748],{"type":18,"tag":599,"props":2749,"children":2750},{"__ignoreMap":8},[2751,2772,2779,2823,2874,2882,2948,3008,3068,3075],{"type":18,"tag":614,"props":2752,"children":2753},{"class":616,"line":617},[2754,2758,2762,2767],{"type":18,"tag":614,"props":2755,"children":2756},{"class":621},[2757],{"type":24,"value":664},{"type":18,"tag":614,"props":2759,"children":2760},{"class":627},[2761],{"type":24,"value":630},{"type":18,"tag":614,"props":2763,"children":2764},{"class":633},[2765],{"type":24,"value":2766},"calc_state",{"type":18,"tag":614,"props":2768,"children":2769},{"class":627},[2770],{"type":24,"value":2771},"(self, X, U, dt):\n",{"type":18,"tag":614,"props":2773,"children":2774},{"class":616,"line":644},[2775],{"type":18,"tag":614,"props":2776,"children":2777},{},[2778],{"type":24,"value":650},{"type":18,"tag":614,"props":2780,"children":2781},{"class":616,"line":653},[2782,2786,2791,2796,2801,2805,2810,2814,2818],{"type":18,"tag":614,"props":2783,"children":2784},{"class":627},[2785],{"type":24,"value":696},{"type":18,"tag":614,"props":2787,"children":2788},{"class":621},[2789],{"type":24,"value":2790},"for",{"type":18,"tag":614,"props":2792,"children":2793},{"class":627},[2794],{"type":24,"value":2795}," i ",{"type":18,"tag":614,"props":2797,"children":2798},{"class":621},[2799],{"type":24,"value":2800},"in",{"type":18,"tag":614,"props":2802,"children":2803},{"class":627},[2804],{"type":24,"value":630},{"type":18,"tag":614,"props":2806,"children":2807},{"class":671},[2808],{"type":24,"value":2809},"range",{"type":18,"tag":614,"props":2811,"children":2812},{"class":627},[2813],{"type":24,"value":1387},{"type":18,"tag":614,"props":2815,"children":2816},{"class":671},[2817],{"type":24,"value":701},{"type":18,"tag":614,"props":2819,"children":2820},{"class":627},[2821],{"type":24,"value":2822},".pred_horizons):\n",{"type":18,"tag":614,"props":2824,"children":2825},{"class":616,"line":682},[2826,2831,2835,2839,2843,2848,2852,2857,2861,2865,2869],{"type":18,"tag":614,"props":2827,"children":2828},{"class":627},[2829],{"type":24,"value":2830},"            x_dot, y_dot, yaw_dot ",{"type":18,"tag":614,"props":2832,"children":2833},{"class":621},[2834],{"type":24,"value":711},{"type":18,"tag":614,"props":2836,"children":2837},{"class":627},[2838],{"type":24,"value":630},{"type":18,"tag":614,"props":2840,"children":2841},{"class":671},[2842],{"type":24,"value":701},{"type":18,"tag":614,"props":2844,"children":2845},{"class":627},[2846],{"type":24,"value":2847},".robot_model.forward_kinematic(X[",{"type":18,"tag":614,"props":2849,"children":2850},{"class":671},[2851],{"type":24,"value":1353},{"type":18,"tag":614,"props":2853,"children":2854},{"class":627},[2855],{"type":24,"value":2856},", i], U[",{"type":18,"tag":614,"props":2858,"children":2859},{"class":671},[2860],{"type":24,"value":867},{"type":18,"tag":614,"props":2862,"children":2863},{"class":627},[2864],{"type":24,"value":2856},{"type":18,"tag":614,"props":2866,"children":2867},{"class":671},[2868],{"type":24,"value":977},{"type":18,"tag":614,"props":2870,"children":2871},{"class":627},[2872],{"type":24,"value":2873},", i])\n",{"type":18,"tag":614,"props":2875,"children":2876},{"class":616,"line":690},[2877],{"type":18,"tag":614,"props":2878,"children":2879},{"class":627},[2880],{"type":24,"value":2881},"            \n",{"type":18,"tag":614,"props":2883,"children":2884},{"class":616,"line":719},[2885,2890,2894,2899,2903,2907,2912,2916,2921,2925,2930,2934,2939,2943],{"type":18,"tag":614,"props":2886,"children":2887},{"class":627},[2888],{"type":24,"value":2889},"            X[",{"type":18,"tag":614,"props":2891,"children":2892},{"class":671},[2893],{"type":24,"value":867},{"type":18,"tag":614,"props":2895,"children":2896},{"class":627},[2897],{"type":24,"value":2898},", i",{"type":18,"tag":614,"props":2900,"children":2901},{"class":621},[2902],{"type":24,"value":1177},{"type":18,"tag":614,"props":2904,"children":2905},{"class":671},[2906],{"type":24,"value":977},{"type":18,"tag":614,"props":2908,"children":2909},{"class":627},[2910],{"type":24,"value":2911},"] ",{"type":18,"tag":614,"props":2913,"children":2914},{"class":621},[2915],{"type":24,"value":711},{"type":18,"tag":614,"props":2917,"children":2918},{"class":627},[2919],{"type":24,"value":2920}," X[",{"type":18,"tag":614,"props":2922,"children":2923},{"class":671},[2924],{"type":24,"value":867},{"type":18,"tag":614,"props":2926,"children":2927},{"class":627},[2928],{"type":24,"value":2929},", i] ",{"type":18,"tag":614,"props":2931,"children":2932},{"class":621},[2933],{"type":24,"value":1177},{"type":18,"tag":614,"props":2935,"children":2936},{"class":627},[2937],{"type":24,"value":2938}," x_dot ",{"type":18,"tag":614,"props":2940,"children":2941},{"class":621},[2942],{"type":24,"value":1056},{"type":18,"tag":614,"props":2944,"children":2945},{"class":627},[2946],{"type":24,"value":2947}," dt\n",{"type":18,"tag":614,"props":2949,"children":2950},{"class":616,"line":745},[2951,2955,2959,2963,2967,2971,2975,2979,2983,2987,2991,2995,3000,3004],{"type":18,"tag":614,"props":2952,"children":2953},{"class":627},[2954],{"type":24,"value":2889},{"type":18,"tag":614,"props":2956,"children":2957},{"class":671},[2958],{"type":24,"value":977},{"type":18,"tag":614,"props":2960,"children":2961},{"class":627},[2962],{"type":24,"value":2898},{"type":18,"tag":614,"props":2964,"children":2965},{"class":621},[2966],{"type":24,"value":1177},{"type":18,"tag":614,"props":2968,"children":2969},{"class":671},[2970],{"type":24,"value":977},{"type":18,"tag":614,"props":2972,"children":2973},{"class":627},[2974],{"type":24,"value":2911},{"type":18,"tag":614,"props":2976,"children":2977},{"class":621},[2978],{"type":24,"value":711},{"type":18,"tag":614,"props":2980,"children":2981},{"class":627},[2982],{"type":24,"value":2920},{"type":18,"tag":614,"props":2984,"children":2985},{"class":671},[2986],{"type":24,"value":977},{"type":18,"tag":614,"props":2988,"children":2989},{"class":627},[2990],{"type":24,"value":2929},{"type":18,"tag":614,"props":2992,"children":2993},{"class":621},[2994],{"type":24,"value":1177},{"type":18,"tag":614,"props":2996,"children":2997},{"class":627},[2998],{"type":24,"value":2999}," y_dot ",{"type":18,"tag":614,"props":3001,"children":3002},{"class":621},[3003],{"type":24,"value":1056},{"type":18,"tag":614,"props":3005,"children":3006},{"class":627},[3007],{"type":24,"value":2947},{"type":18,"tag":614,"props":3009,"children":3010},{"class":616,"line":771},[3011,3015,3019,3023,3027,3031,3035,3039,3043,3047,3051,3055,3060,3064],{"type":18,"tag":614,"props":3012,"children":3013},{"class":627},[3014],{"type":24,"value":2889},{"type":18,"tag":614,"props":3016,"children":3017},{"class":671},[3018],{"type":24,"value":1353},{"type":18,"tag":614,"props":3020,"children":3021},{"class":627},[3022],{"type":24,"value":2898},{"type":18,"tag":614,"props":3024,"children":3025},{"class":621},[3026],{"type":24,"value":1177},{"type":18,"tag":614,"props":3028,"children":3029},{"class":671},[3030],{"type":24,"value":977},{"type":18,"tag":614,"props":3032,"children":3033},{"class":627},[3034],{"type":24,"value":2911},{"type":18,"tag":614,"props":3036,"children":3037},{"class":621},[3038],{"type":24,"value":711},{"type":18,"tag":614,"props":3040,"children":3041},{"class":627},[3042],{"type":24,"value":2920},{"type":18,"tag":614,"props":3044,"children":3045},{"class":671},[3046],{"type":24,"value":1353},{"type":18,"tag":614,"props":3048,"children":3049},{"class":627},[3050],{"type":24,"value":2929},{"type":18,"tag":614,"props":3052,"children":3053},{"class":621},[3054],{"type":24,"value":1177},{"type":18,"tag":614,"props":3056,"children":3057},{"class":627},[3058],{"type":24,"value":3059}," yaw_dot ",{"type":18,"tag":614,"props":3061,"children":3062},{"class":621},[3063],{"type":24,"value":1056},{"type":18,"tag":614,"props":3065,"children":3066},{"class":627},[3067],{"type":24,"value":2947},{"type":18,"tag":614,"props":3069,"children":3070},{"class":616,"line":779},[3071],{"type":18,"tag":614,"props":3072,"children":3073},{},[3074],{"type":24,"value":650},{"type":18,"tag":614,"props":3076,"children":3077},{"class":616,"line":805},[3078,3082,3086],{"type":18,"tag":614,"props":3079,"children":3080},{"class":627},[3081],{"type":24,"value":696},{"type":18,"tag":614,"props":3083,"children":3084},{"class":621},[3085],{"type":24,"value":1220},{"type":18,"tag":614,"props":3087,"children":3088},{"class":627},[3089],{"type":24,"value":3090}," X",{"type":18,"tag":27,"props":3092,"children":3093},{},[3094],{"type":24,"value":3095},"Next we calculating costate, we are going in backward direction",{"type":18,"tag":599,"props":3097,"children":3100},{"className":3098,"code":3099,"language":604,"meta":8},[602],"def calc_costate(self, X, U, Lambda, dt):\n\n        x_N, y_N, yaw_N = self.hjb_equation.dphidx(X[0, -1], X[1, -1], X[2, -1],\n                                                   self.X_r[0], self.X_r[1], self.X_r[2])\n        Lambda[0, -1] = x_N\n        Lambda[1, -1] = y_N\n        Lambda[2, -1] = yaw_N\n\n\n        for i in reversed(range(1, self.pred_horizons)):\n\n            dhdx1, dhdx2, dhdx3 = self.hjb_equation.dhdx(\n                X[0, i], X[1, i], X[2, i],\n                self.X_r[0], self.X_r[1], self.X_r[2],\n                U[0, i], Lambda[0, i+1], Lambda[1, i+1]\n            )\n\n            Lambda[0, i] = Lambda[0, i+1] + dhdx1 * dt\n            Lambda[1, i] = Lambda[1, i+1] + dhdx2 * dt\n            Lambda[2, i] = Lambda[2, i+1] + dhdx3 * dt\n    \n\n        return Lambda\n",[3101],{"type":18,"tag":607,"props":3102,"children":3103},{},[3104],{"type":18,"tag":599,"props":3105,"children":3106},{"__ignoreMap":8},[3107,3128,3135,3222,3281,3318,3354,3390,3397,3404,3461,3468,3493,3527,3583,3641,3649,3656,3718,3778,3838,3846,3853],{"type":18,"tag":614,"props":3108,"children":3109},{"class":616,"line":617},[3110,3114,3118,3123],{"type":18,"tag":614,"props":3111,"children":3112},{"class":621},[3113],{"type":24,"value":664},{"type":18,"tag":614,"props":3115,"children":3116},{"class":627},[3117],{"type":24,"value":630},{"type":18,"tag":614,"props":3119,"children":3120},{"class":633},[3121],{"type":24,"value":3122},"calc_costate",{"type":18,"tag":614,"props":3124,"children":3125},{"class":627},[3126],{"type":24,"value":3127},"(self, X, U, Lambda, dt):\n",{"type":18,"tag":614,"props":3129,"children":3130},{"class":616,"line":644},[3131],{"type":18,"tag":614,"props":3132,"children":3133},{},[3134],{"type":24,"value":650},{"type":18,"tag":614,"props":3136,"children":3137},{"class":616,"line":653},[3138,3143,3147,3151,3155,3160,3164,3168,3172,3176,3181,3185,3189,3193,3197,3201,3205,3209,3213,3217],{"type":18,"tag":614,"props":3139,"children":3140},{"class":627},[3141],{"type":24,"value":3142},"        x_N, y_N, yaw_N ",{"type":18,"tag":614,"props":3144,"children":3145},{"class":621},[3146],{"type":24,"value":711},{"type":18,"tag":614,"props":3148,"children":3149},{"class":627},[3150],{"type":24,"value":630},{"type":18,"tag":614,"props":3152,"children":3153},{"class":671},[3154],{"type":24,"value":701},{"type":18,"tag":614,"props":3156,"children":3157},{"class":627},[3158],{"type":24,"value":3159},".hjb_equation.dphidx(X[",{"type":18,"tag":614,"props":3161,"children":3162},{"class":671},[3163],{"type":24,"value":867},{"type":18,"tag":614,"props":3165,"children":3166},{"class":627},[3167],{"type":24,"value":2417},{"type":18,"tag":614,"props":3169,"children":3170},{"class":621},[3171],{"type":24,"value":1046},{"type":18,"tag":614,"props":3173,"children":3174},{"class":671},[3175],{"type":24,"value":977},{"type":18,"tag":614,"props":3177,"children":3178},{"class":627},[3179],{"type":24,"value":3180},"], X[",{"type":18,"tag":614,"props":3182,"children":3183},{"class":671},[3184],{"type":24,"value":977},{"type":18,"tag":614,"props":3186,"children":3187},{"class":627},[3188],{"type":24,"value":2417},{"type":18,"tag":614,"props":3190,"children":3191},{"class":621},[3192],{"type":24,"value":1046},{"type":18,"tag":614,"props":3194,"children":3195},{"class":671},[3196],{"type":24,"value":977},{"type":18,"tag":614,"props":3198,"children":3199},{"class":627},[3200],{"type":24,"value":3180},{"type":18,"tag":614,"props":3202,"children":3203},{"class":671},[3204],{"type":24,"value":1353},{"type":18,"tag":614,"props":3206,"children":3207},{"class":627},[3208],{"type":24,"value":2417},{"type":18,"tag":614,"props":3210,"children":3211},{"class":621},[3212],{"type":24,"value":1046},{"type":18,"tag":614,"props":3214,"children":3215},{"class":671},[3216],{"type":24,"value":977},{"type":18,"tag":614,"props":3218,"children":3219},{"class":627},[3220],{"type":24,"value":3221},"],\n",{"type":18,"tag":614,"props":3223,"children":3224},{"class":616,"line":682},[3225,3230,3234,3239,3243,3248,3252,3256,3260,3264,3268,3272,3276],{"type":18,"tag":614,"props":3226,"children":3227},{"class":627},[3228],{"type":24,"value":3229},"                                                   ",{"type":18,"tag":614,"props":3231,"children":3232},{"class":671},[3233],{"type":24,"value":701},{"type":18,"tag":614,"props":3235,"children":3236},{"class":627},[3237],{"type":24,"value":3238},".X_r[",{"type":18,"tag":614,"props":3240,"children":3241},{"class":671},[3242],{"type":24,"value":867},{"type":18,"tag":614,"props":3244,"children":3245},{"class":627},[3246],{"type":24,"value":3247},"], ",{"type":18,"tag":614,"props":3249,"children":3250},{"class":671},[3251],{"type":24,"value":701},{"type":18,"tag":614,"props":3253,"children":3254},{"class":627},[3255],{"type":24,"value":3238},{"type":18,"tag":614,"props":3257,"children":3258},{"class":671},[3259],{"type":24,"value":977},{"type":18,"tag":614,"props":3261,"children":3262},{"class":627},[3263],{"type":24,"value":3247},{"type":18,"tag":614,"props":3265,"children":3266},{"class":671},[3267],{"type":24,"value":701},{"type":18,"tag":614,"props":3269,"children":3270},{"class":627},[3271],{"type":24,"value":3238},{"type":18,"tag":614,"props":3273,"children":3274},{"class":671},[3275],{"type":24,"value":1353},{"type":18,"tag":614,"props":3277,"children":3278},{"class":627},[3279],{"type":24,"value":3280},"])\n",{"type":18,"tag":614,"props":3282,"children":3283},{"class":616,"line":690},[3284,3289,3293,3297,3301,3305,3309,3313],{"type":18,"tag":614,"props":3285,"children":3286},{"class":627},[3287],{"type":24,"value":3288},"        Lambda[",{"type":18,"tag":614,"props":3290,"children":3291},{"class":671},[3292],{"type":24,"value":867},{"type":18,"tag":614,"props":3294,"children":3295},{"class":627},[3296],{"type":24,"value":2417},{"type":18,"tag":614,"props":3298,"children":3299},{"class":621},[3300],{"type":24,"value":1046},{"type":18,"tag":614,"props":3302,"children":3303},{"class":671},[3304],{"type":24,"value":977},{"type":18,"tag":614,"props":3306,"children":3307},{"class":627},[3308],{"type":24,"value":2911},{"type":18,"tag":614,"props":3310,"children":3311},{"class":621},[3312],{"type":24,"value":711},{"type":18,"tag":614,"props":3314,"children":3315},{"class":627},[3316],{"type":24,"value":3317}," x_N\n",{"type":18,"tag":614,"props":3319,"children":3320},{"class":616,"line":719},[3321,3325,3329,3333,3337,3341,3345,3349],{"type":18,"tag":614,"props":3322,"children":3323},{"class":627},[3324],{"type":24,"value":3288},{"type":18,"tag":614,"props":3326,"children":3327},{"class":671},[3328],{"type":24,"value":977},{"type":18,"tag":614,"props":3330,"children":3331},{"class":627},[3332],{"type":24,"value":2417},{"type":18,"tag":614,"props":3334,"children":3335},{"class":621},[3336],{"type":24,"value":1046},{"type":18,"tag":614,"props":3338,"children":3339},{"class":671},[3340],{"type":24,"value":977},{"type":18,"tag":614,"props":3342,"children":3343},{"class":627},[3344],{"type":24,"value":2911},{"type":18,"tag":614,"props":3346,"children":3347},{"class":621},[3348],{"type":24,"value":711},{"type":18,"tag":614,"props":3350,"children":3351},{"class":627},[3352],{"type":24,"value":3353}," y_N\n",{"type":18,"tag":614,"props":3355,"children":3356},{"class":616,"line":745},[3357,3361,3365,3369,3373,3377,3381,3385],{"type":18,"tag":614,"props":3358,"children":3359},{"class":627},[3360],{"type":24,"value":3288},{"type":18,"tag":614,"props":3362,"children":3363},{"class":671},[3364],{"type":24,"value":1353},{"type":18,"tag":614,"props":3366,"children":3367},{"class":627},[3368],{"type":24,"value":2417},{"type":18,"tag":614,"props":3370,"children":3371},{"class":621},[3372],{"type":24,"value":1046},{"type":18,"tag":614,"props":3374,"children":3375},{"class":671},[3376],{"type":24,"value":977},{"type":18,"tag":614,"props":3378,"children":3379},{"class":627},[3380],{"type":24,"value":2911},{"type":18,"tag":614,"props":3382,"children":3383},{"class":621},[3384],{"type":24,"value":711},{"type":18,"tag":614,"props":3386,"children":3387},{"class":627},[3388],{"type":24,"value":3389}," yaw_N\n",{"type":18,"tag":614,"props":3391,"children":3392},{"class":616,"line":771},[3393],{"type":18,"tag":614,"props":3394,"children":3395},{},[3396],{"type":24,"value":650},{"type":18,"tag":614,"props":3398,"children":3399},{"class":616,"line":779},[3400],{"type":18,"tag":614,"props":3401,"children":3402},{},[3403],{"type":24,"value":650},{"type":18,"tag":614,"props":3405,"children":3406},{"class":616,"line":805},[3407,3411,3415,3419,3423,3427,3432,3436,3440,3444,3448,3452,3456],{"type":18,"tag":614,"props":3408,"children":3409},{"class":627},[3410],{"type":24,"value":696},{"type":18,"tag":614,"props":3412,"children":3413},{"class":621},[3414],{"type":24,"value":2790},{"type":18,"tag":614,"props":3416,"children":3417},{"class":627},[3418],{"type":24,"value":2795},{"type":18,"tag":614,"props":3420,"children":3421},{"class":621},[3422],{"type":24,"value":2800},{"type":18,"tag":614,"props":3424,"children":3425},{"class":627},[3426],{"type":24,"value":630},{"type":18,"tag":614,"props":3428,"children":3429},{"class":671},[3430],{"type":24,"value":3431},"reversed",{"type":18,"tag":614,"props":3433,"children":3434},{"class":627},[3435],{"type":24,"value":1387},{"type":18,"tag":614,"props":3437,"children":3438},{"class":671},[3439],{"type":24,"value":2809},{"type":18,"tag":614,"props":3441,"children":3442},{"class":627},[3443],{"type":24,"value":1387},{"type":18,"tag":614,"props":3445,"children":3446},{"class":671},[3447],{"type":24,"value":977},{"type":18,"tag":614,"props":3449,"children":3450},{"class":627},[3451],{"type":24,"value":2417},{"type":18,"tag":614,"props":3453,"children":3454},{"class":671},[3455],{"type":24,"value":701},{"type":18,"tag":614,"props":3457,"children":3458},{"class":627},[3459],{"type":24,"value":3460},".pred_horizons)):\n",{"type":18,"tag":614,"props":3462,"children":3463},{"class":616,"line":831},[3464],{"type":18,"tag":614,"props":3465,"children":3466},{},[3467],{"type":24,"value":650},{"type":18,"tag":614,"props":3469,"children":3470},{"class":616,"line":839},[3471,3476,3480,3484,3488],{"type":18,"tag":614,"props":3472,"children":3473},{"class":627},[3474],{"type":24,"value":3475},"            dhdx1, dhdx2, dhdx3 ",{"type":18,"tag":614,"props":3477,"children":3478},{"class":621},[3479],{"type":24,"value":711},{"type":18,"tag":614,"props":3481,"children":3482},{"class":627},[3483],{"type":24,"value":630},{"type":18,"tag":614,"props":3485,"children":3486},{"class":671},[3487],{"type":24,"value":701},{"type":18,"tag":614,"props":3489,"children":3490},{"class":627},[3491],{"type":24,"value":3492},".hjb_equation.dhdx(\n",{"type":18,"tag":614,"props":3494,"children":3495},{"class":616,"line":875},[3496,3501,3505,3510,3514,3518,3522],{"type":18,"tag":614,"props":3497,"children":3498},{"class":627},[3499],{"type":24,"value":3500},"                X[",{"type":18,"tag":614,"props":3502,"children":3503},{"class":671},[3504],{"type":24,"value":867},{"type":18,"tag":614,"props":3506,"children":3507},{"class":627},[3508],{"type":24,"value":3509},", i], X[",{"type":18,"tag":614,"props":3511,"children":3512},{"class":671},[3513],{"type":24,"value":977},{"type":18,"tag":614,"props":3515,"children":3516},{"class":627},[3517],{"type":24,"value":3509},{"type":18,"tag":614,"props":3519,"children":3520},{"class":671},[3521],{"type":24,"value":1353},{"type":18,"tag":614,"props":3523,"children":3524},{"class":627},[3525],{"type":24,"value":3526},", i],\n",{"type":18,"tag":614,"props":3528,"children":3529},{"class":616,"line":908},[3530,3535,3539,3543,3547,3551,3555,3559,3563,3567,3571,3575,3579],{"type":18,"tag":614,"props":3531,"children":3532},{"class":627},[3533],{"type":24,"value":3534},"                ",{"type":18,"tag":614,"props":3536,"children":3537},{"class":671},[3538],{"type":24,"value":701},{"type":18,"tag":614,"props":3540,"children":3541},{"class":627},[3542],{"type":24,"value":3238},{"type":18,"tag":614,"props":3544,"children":3545},{"class":671},[3546],{"type":24,"value":867},{"type":18,"tag":614,"props":3548,"children":3549},{"class":627},[3550],{"type":24,"value":3247},{"type":18,"tag":614,"props":3552,"children":3553},{"class":671},[3554],{"type":24,"value":701},{"type":18,"tag":614,"props":3556,"children":3557},{"class":627},[3558],{"type":24,"value":3238},{"type":18,"tag":614,"props":3560,"children":3561},{"class":671},[3562],{"type":24,"value":977},{"type":18,"tag":614,"props":3564,"children":3565},{"class":627},[3566],{"type":24,"value":3247},{"type":18,"tag":614,"props":3568,"children":3569},{"class":671},[3570],{"type":24,"value":701},{"type":18,"tag":614,"props":3572,"children":3573},{"class":627},[3574],{"type":24,"value":3238},{"type":18,"tag":614,"props":3576,"children":3577},{"class":671},[3578],{"type":24,"value":1353},{"type":18,"tag":614,"props":3580,"children":3581},{"class":627},[3582],{"type":24,"value":3221},{"type":18,"tag":614,"props":3584,"children":3585},{"class":616,"line":916},[3586,3591,3595,3600,3604,3608,3612,3616,3621,3625,3629,3633,3637],{"type":18,"tag":614,"props":3587,"children":3588},{"class":627},[3589],{"type":24,"value":3590},"                U[",{"type":18,"tag":614,"props":3592,"children":3593},{"class":671},[3594],{"type":24,"value":867},{"type":18,"tag":614,"props":3596,"children":3597},{"class":627},[3598],{"type":24,"value":3599},", i], Lambda[",{"type":18,"tag":614,"props":3601,"children":3602},{"class":671},[3603],{"type":24,"value":867},{"type":18,"tag":614,"props":3605,"children":3606},{"class":627},[3607],{"type":24,"value":2898},{"type":18,"tag":614,"props":3609,"children":3610},{"class":621},[3611],{"type":24,"value":1177},{"type":18,"tag":614,"props":3613,"children":3614},{"class":671},[3615],{"type":24,"value":977},{"type":18,"tag":614,"props":3617,"children":3618},{"class":627},[3619],{"type":24,"value":3620},"], Lambda[",{"type":18,"tag":614,"props":3622,"children":3623},{"class":671},[3624],{"type":24,"value":977},{"type":18,"tag":614,"props":3626,"children":3627},{"class":627},[3628],{"type":24,"value":2898},{"type":18,"tag":614,"props":3630,"children":3631},{"class":621},[3632],{"type":24,"value":1177},{"type":18,"tag":614,"props":3634,"children":3635},{"class":671},[3636],{"type":24,"value":977},{"type":18,"tag":614,"props":3638,"children":3639},{"class":627},[3640],{"type":24,"value":872},{"type":18,"tag":614,"props":3642,"children":3643},{"class":616,"line":950},[3644],{"type":18,"tag":614,"props":3645,"children":3646},{"class":627},[3647],{"type":24,"value":3648},"            )\n",{"type":18,"tag":614,"props":3650,"children":3651},{"class":616,"line":984},[3652],{"type":18,"tag":614,"props":3653,"children":3654},{},[3655],{"type":24,"value":650},{"type":18,"tag":614,"props":3657,"children":3658},{"class":616,"line":992},[3659,3664,3668,3672,3676,3681,3685,3689,3693,3697,3701,3705,3710,3714],{"type":18,"tag":614,"props":3660,"children":3661},{"class":627},[3662],{"type":24,"value":3663},"            Lambda[",{"type":18,"tag":614,"props":3665,"children":3666},{"class":671},[3667],{"type":24,"value":867},{"type":18,"tag":614,"props":3669,"children":3670},{"class":627},[3671],{"type":24,"value":2929},{"type":18,"tag":614,"props":3673,"children":3674},{"class":621},[3675],{"type":24,"value":711},{"type":18,"tag":614,"props":3677,"children":3678},{"class":627},[3679],{"type":24,"value":3680}," Lambda[",{"type":18,"tag":614,"props":3682,"children":3683},{"class":671},[3684],{"type":24,"value":867},{"type":18,"tag":614,"props":3686,"children":3687},{"class":627},[3688],{"type":24,"value":2898},{"type":18,"tag":614,"props":3690,"children":3691},{"class":621},[3692],{"type":24,"value":1177},{"type":18,"tag":614,"props":3694,"children":3695},{"class":671},[3696],{"type":24,"value":977},{"type":18,"tag":614,"props":3698,"children":3699},{"class":627},[3700],{"type":24,"value":2911},{"type":18,"tag":614,"props":3702,"children":3703},{"class":621},[3704],{"type":24,"value":1177},{"type":18,"tag":614,"props":3706,"children":3707},{"class":627},[3708],{"type":24,"value":3709}," dhdx1 ",{"type":18,"tag":614,"props":3711,"children":3712},{"class":621},[3713],{"type":24,"value":1056},{"type":18,"tag":614,"props":3715,"children":3716},{"class":627},[3717],{"type":24,"value":2947},{"type":18,"tag":614,"props":3719,"children":3720},{"class":616,"line":1018},[3721,3725,3729,3733,3737,3741,3745,3749,3753,3757,3761,3765,3770,3774],{"type":18,"tag":614,"props":3722,"children":3723},{"class":627},[3724],{"type":24,"value":3663},{"type":18,"tag":614,"props":3726,"children":3727},{"class":671},[3728],{"type":24,"value":977},{"type":18,"tag":614,"props":3730,"children":3731},{"class":627},[3732],{"type":24,"value":2929},{"type":18,"tag":614,"props":3734,"children":3735},{"class":621},[3736],{"type":24,"value":711},{"type":18,"tag":614,"props":3738,"children":3739},{"class":627},[3740],{"type":24,"value":3680},{"type":18,"tag":614,"props":3742,"children":3743},{"class":671},[3744],{"type":24,"value":977},{"type":18,"tag":614,"props":3746,"children":3747},{"class":627},[3748],{"type":24,"value":2898},{"type":18,"tag":614,"props":3750,"children":3751},{"class":621},[3752],{"type":24,"value":1177},{"type":18,"tag":614,"props":3754,"children":3755},{"class":671},[3756],{"type":24,"value":977},{"type":18,"tag":614,"props":3758,"children":3759},{"class":627},[3760],{"type":24,"value":2911},{"type":18,"tag":614,"props":3762,"children":3763},{"class":621},[3764],{"type":24,"value":1177},{"type":18,"tag":614,"props":3766,"children":3767},{"class":627},[3768],{"type":24,"value":3769}," dhdx2 ",{"type":18,"tag":614,"props":3771,"children":3772},{"class":621},[3773],{"type":24,"value":1056},{"type":18,"tag":614,"props":3775,"children":3776},{"class":627},[3777],{"type":24,"value":2947},{"type":18,"tag":614,"props":3779,"children":3780},{"class":616,"line":1026},[3781,3785,3789,3793,3797,3801,3805,3809,3813,3817,3821,3825,3830,3834],{"type":18,"tag":614,"props":3782,"children":3783},{"class":627},[3784],{"type":24,"value":3663},{"type":18,"tag":614,"props":3786,"children":3787},{"class":671},[3788],{"type":24,"value":1353},{"type":18,"tag":614,"props":3790,"children":3791},{"class":627},[3792],{"type":24,"value":2929},{"type":18,"tag":614,"props":3794,"children":3795},{"class":621},[3796],{"type":24,"value":711},{"type":18,"tag":614,"props":3798,"children":3799},{"class":627},[3800],{"type":24,"value":3680},{"type":18,"tag":614,"props":3802,"children":3803},{"class":671},[3804],{"type":24,"value":1353},{"type":18,"tag":614,"props":3806,"children":3807},{"class":627},[3808],{"type":24,"value":2898},{"type":18,"tag":614,"props":3810,"children":3811},{"class":621},[3812],{"type":24,"value":1177},{"type":18,"tag":614,"props":3814,"children":3815},{"class":671},[3816],{"type":24,"value":977},{"type":18,"tag":614,"props":3818,"children":3819},{"class":627},[3820],{"type":24,"value":2911},{"type":18,"tag":614,"props":3822,"children":3823},{"class":621},[3824],{"type":24,"value":1177},{"type":18,"tag":614,"props":3826,"children":3827},{"class":627},[3828],{"type":24,"value":3829}," dhdx3 ",{"type":18,"tag":614,"props":3831,"children":3832},{"class":621},[3833],{"type":24,"value":1056},{"type":18,"tag":614,"props":3835,"children":3836},{"class":627},[3837],{"type":24,"value":2947},{"type":18,"tag":614,"props":3839,"children":3840},{"class":616,"line":1068},[3841],{"type":18,"tag":614,"props":3842,"children":3843},{"class":627},[3844],{"type":24,"value":3845},"    \n",{"type":18,"tag":614,"props":3847,"children":3848},{"class":616,"line":1108},[3849],{"type":18,"tag":614,"props":3850,"children":3851},{},[3852],{"type":24,"value":650},{"type":18,"tag":614,"props":3854,"children":3855},{"class":616,"line":1202},[3856,3860,3864],{"type":18,"tag":614,"props":3857,"children":3858},{"class":627},[3859],{"type":24,"value":696},{"type":18,"tag":614,"props":3861,"children":3862},{"class":621},[3863],{"type":24,"value":1220},{"type":18,"tag":614,"props":3865,"children":3866},{"class":627},[3867],{"type":24,"value":3868}," Lambda",{"type":18,"tag":27,"props":3870,"children":3871},{},[3872],{"type":24,"value":3873},"And finally, calculating Newton F Function",{"type":18,"tag":599,"props":3875,"children":3878},{"className":3876,"code":3877,"language":604,"meta":8},[602],"def calc_f(self, X, U, Lambda, Mu, dt):\n\n        X_new = self.calc_state(X, U, dt)\n\n        Lambda_new = self.calc_costate(X_new, U, Lambda, dt)\n\n        F = np.zeros((self.u_dim, self.pred_horizons))\n\n        for i in range(self.pred_horizons):\n            dhdu1, dhdu2 = self.hjb_equation.dhdu(X_new[2, i], U[0, i], U[1, i],\n                                                  self.U_r[0], self.U_r[1],\n                                                  Lambda_new[0, i+1], Lambda_new[1, i+1], Lambda_new[2, i+1],\n                                                  Mu[0, i], Mu[1, i])\n            F[0, i] = dhdu1\n            F[1, i] = dhdu2\n            \n        F = F.T.ravel().reshape(-1, 1)\n\n        return F\n",[3879],{"type":18,"tag":607,"props":3880,"children":3881},{},[3882],{"type":18,"tag":599,"props":3883,"children":3884},{"__ignoreMap":8},[3885,3906,3913,3938,3945,3970,3977,4009,4016,4055,4104,4145,4214,4239,4264,4288,4295,4331,4338],{"type":18,"tag":614,"props":3886,"children":3887},{"class":616,"line":617},[3888,3892,3896,3901],{"type":18,"tag":614,"props":3889,"children":3890},{"class":621},[3891],{"type":24,"value":664},{"type":18,"tag":614,"props":3893,"children":3894},{"class":627},[3895],{"type":24,"value":630},{"type":18,"tag":614,"props":3897,"children":3898},{"class":633},[3899],{"type":24,"value":3900},"calc_f",{"type":18,"tag":614,"props":3902,"children":3903},{"class":627},[3904],{"type":24,"value":3905},"(self, X, U, Lambda, Mu, dt):\n",{"type":18,"tag":614,"props":3907,"children":3908},{"class":616,"line":644},[3909],{"type":18,"tag":614,"props":3910,"children":3911},{},[3912],{"type":24,"value":650},{"type":18,"tag":614,"props":3914,"children":3915},{"class":616,"line":653},[3916,3921,3925,3929,3933],{"type":18,"tag":614,"props":3917,"children":3918},{"class":627},[3919],{"type":24,"value":3920},"        X_new ",{"type":18,"tag":614,"props":3922,"children":3923},{"class":621},[3924],{"type":24,"value":711},{"type":18,"tag":614,"props":3926,"children":3927},{"class":627},[3928],{"type":24,"value":630},{"type":18,"tag":614,"props":3930,"children":3931},{"class":671},[3932],{"type":24,"value":701},{"type":18,"tag":614,"props":3934,"children":3935},{"class":627},[3936],{"type":24,"value":3937},".calc_state(X, U, dt)\n",{"type":18,"tag":614,"props":3939,"children":3940},{"class":616,"line":682},[3941],{"type":18,"tag":614,"props":3942,"children":3943},{},[3944],{"type":24,"value":650},{"type":18,"tag":614,"props":3946,"children":3947},{"class":616,"line":690},[3948,3953,3957,3961,3965],{"type":18,"tag":614,"props":3949,"children":3950},{"class":627},[3951],{"type":24,"value":3952},"        Lambda_new ",{"type":18,"tag":614,"props":3954,"children":3955},{"class":621},[3956],{"type":24,"value":711},{"type":18,"tag":614,"props":3958,"children":3959},{"class":627},[3960],{"type":24,"value":630},{"type":18,"tag":614,"props":3962,"children":3963},{"class":671},[3964],{"type":24,"value":701},{"type":18,"tag":614,"props":3966,"children":3967},{"class":627},[3968],{"type":24,"value":3969},".calc_costate(X_new, U, Lambda, dt)\n",{"type":18,"tag":614,"props":3971,"children":3972},{"class":616,"line":719},[3973],{"type":18,"tag":614,"props":3974,"children":3975},{},[3976],{"type":24,"value":650},{"type":18,"tag":614,"props":3978,"children":3979},{"class":616,"line":745},[3980,3985,3989,3993,3997,4001,4005],{"type":18,"tag":614,"props":3981,"children":3982},{"class":627},[3983],{"type":24,"value":3984},"        F ",{"type":18,"tag":614,"props":3986,"children":3987},{"class":621},[3988],{"type":24,"value":711},{"type":18,"tag":614,"props":3990,"children":3991},{"class":627},[3992],{"type":24,"value":2469},{"type":18,"tag":614,"props":3994,"children":3995},{"class":671},[3996],{"type":24,"value":701},{"type":18,"tag":614,"props":3998,"children":3999},{"class":627},[4000],{"type":24,"value":2478},{"type":18,"tag":614,"props":4002,"children":4003},{"class":671},[4004],{"type":24,"value":701},{"type":18,"tag":614,"props":4006,"children":4007},{"class":627},[4008],{"type":24,"value":2487},{"type":18,"tag":614,"props":4010,"children":4011},{"class":616,"line":771},[4012],{"type":18,"tag":614,"props":4013,"children":4014},{},[4015],{"type":24,"value":650},{"type":18,"tag":614,"props":4017,"children":4018},{"class":616,"line":779},[4019,4023,4027,4031,4035,4039,4043,4047,4051],{"type":18,"tag":614,"props":4020,"children":4021},{"class":627},[4022],{"type":24,"value":696},{"type":18,"tag":614,"props":4024,"children":4025},{"class":621},[4026],{"type":24,"value":2790},{"type":18,"tag":614,"props":4028,"children":4029},{"class":627},[4030],{"type":24,"value":2795},{"type":18,"tag":614,"props":4032,"children":4033},{"class":621},[4034],{"type":24,"value":2800},{"type":18,"tag":614,"props":4036,"children":4037},{"class":627},[4038],{"type":24,"value":630},{"type":18,"tag":614,"props":4040,"children":4041},{"class":671},[4042],{"type":24,"value":2809},{"type":18,"tag":614,"props":4044,"children":4045},{"class":627},[4046],{"type":24,"value":1387},{"type":18,"tag":614,"props":4048,"children":4049},{"class":671},[4050],{"type":24,"value":701},{"type":18,"tag":614,"props":4052,"children":4053},{"class":627},[4054],{"type":24,"value":2822},{"type":18,"tag":614,"props":4056,"children":4057},{"class":616,"line":805},[4058,4063,4067,4071,4075,4080,4084,4088,4092,4096,4100],{"type":18,"tag":614,"props":4059,"children":4060},{"class":627},[4061],{"type":24,"value":4062},"            dhdu1, dhdu2 ",{"type":18,"tag":614,"props":4064,"children":4065},{"class":621},[4066],{"type":24,"value":711},{"type":18,"tag":614,"props":4068,"children":4069},{"class":627},[4070],{"type":24,"value":630},{"type":18,"tag":614,"props":4072,"children":4073},{"class":671},[4074],{"type":24,"value":701},{"type":18,"tag":614,"props":4076,"children":4077},{"class":627},[4078],{"type":24,"value":4079},".hjb_equation.dhdu(X_new[",{"type":18,"tag":614,"props":4081,"children":4082},{"class":671},[4083],{"type":24,"value":1353},{"type":18,"tag":614,"props":4085,"children":4086},{"class":627},[4087],{"type":24,"value":2856},{"type":18,"tag":614,"props":4089,"children":4090},{"class":671},[4091],{"type":24,"value":867},{"type":18,"tag":614,"props":4093,"children":4094},{"class":627},[4095],{"type":24,"value":2856},{"type":18,"tag":614,"props":4097,"children":4098},{"class":671},[4099],{"type":24,"value":977},{"type":18,"tag":614,"props":4101,"children":4102},{"class":627},[4103],{"type":24,"value":3526},{"type":18,"tag":614,"props":4105,"children":4106},{"class":616,"line":831},[4107,4112,4116,4121,4125,4129,4133,4137,4141],{"type":18,"tag":614,"props":4108,"children":4109},{"class":627},[4110],{"type":24,"value":4111},"                                                  ",{"type":18,"tag":614,"props":4113,"children":4114},{"class":671},[4115],{"type":24,"value":701},{"type":18,"tag":614,"props":4117,"children":4118},{"class":627},[4119],{"type":24,"value":4120},".U_r[",{"type":18,"tag":614,"props":4122,"children":4123},{"class":671},[4124],{"type":24,"value":867},{"type":18,"tag":614,"props":4126,"children":4127},{"class":627},[4128],{"type":24,"value":3247},{"type":18,"tag":614,"props":4130,"children":4131},{"class":671},[4132],{"type":24,"value":701},{"type":18,"tag":614,"props":4134,"children":4135},{"class":627},[4136],{"type":24,"value":4120},{"type":18,"tag":614,"props":4138,"children":4139},{"class":671},[4140],{"type":24,"value":977},{"type":18,"tag":614,"props":4142,"children":4143},{"class":627},[4144],{"type":24,"value":3221},{"type":18,"tag":614,"props":4146,"children":4147},{"class":616,"line":839},[4148,4153,4157,4161,4165,4169,4174,4178,4182,4186,4190,4194,4198,4202,4206,4210],{"type":18,"tag":614,"props":4149,"children":4150},{"class":627},[4151],{"type":24,"value":4152},"                                                  Lambda_new[",{"type":18,"tag":614,"props":4154,"children":4155},{"class":671},[4156],{"type":24,"value":867},{"type":18,"tag":614,"props":4158,"children":4159},{"class":627},[4160],{"type":24,"value":2898},{"type":18,"tag":614,"props":4162,"children":4163},{"class":621},[4164],{"type":24,"value":1177},{"type":18,"tag":614,"props":4166,"children":4167},{"class":671},[4168],{"type":24,"value":977},{"type":18,"tag":614,"props":4170,"children":4171},{"class":627},[4172],{"type":24,"value":4173},"], Lambda_new[",{"type":18,"tag":614,"props":4175,"children":4176},{"class":671},[4177],{"type":24,"value":977},{"type":18,"tag":614,"props":4179,"children":4180},{"class":627},[4181],{"type":24,"value":2898},{"type":18,"tag":614,"props":4183,"children":4184},{"class":621},[4185],{"type":24,"value":1177},{"type":18,"tag":614,"props":4187,"children":4188},{"class":671},[4189],{"type":24,"value":977},{"type":18,"tag":614,"props":4191,"children":4192},{"class":627},[4193],{"type":24,"value":4173},{"type":18,"tag":614,"props":4195,"children":4196},{"class":671},[4197],{"type":24,"value":1353},{"type":18,"tag":614,"props":4199,"children":4200},{"class":627},[4201],{"type":24,"value":2898},{"type":18,"tag":614,"props":4203,"children":4204},{"class":621},[4205],{"type":24,"value":1177},{"type":18,"tag":614,"props":4207,"children":4208},{"class":671},[4209],{"type":24,"value":977},{"type":18,"tag":614,"props":4211,"children":4212},{"class":627},[4213],{"type":24,"value":3221},{"type":18,"tag":614,"props":4215,"children":4216},{"class":616,"line":875},[4217,4222,4226,4231,4235],{"type":18,"tag":614,"props":4218,"children":4219},{"class":627},[4220],{"type":24,"value":4221},"                                                  Mu[",{"type":18,"tag":614,"props":4223,"children":4224},{"class":671},[4225],{"type":24,"value":867},{"type":18,"tag":614,"props":4227,"children":4228},{"class":627},[4229],{"type":24,"value":4230},", i], Mu[",{"type":18,"tag":614,"props":4232,"children":4233},{"class":671},[4234],{"type":24,"value":977},{"type":18,"tag":614,"props":4236,"children":4237},{"class":627},[4238],{"type":24,"value":2873},{"type":18,"tag":614,"props":4240,"children":4241},{"class":616,"line":908},[4242,4247,4251,4255,4259],{"type":18,"tag":614,"props":4243,"children":4244},{"class":627},[4245],{"type":24,"value":4246},"            F[",{"type":18,"tag":614,"props":4248,"children":4249},{"class":671},[4250],{"type":24,"value":867},{"type":18,"tag":614,"props":4252,"children":4253},{"class":627},[4254],{"type":24,"value":2929},{"type":18,"tag":614,"props":4256,"children":4257},{"class":621},[4258],{"type":24,"value":711},{"type":18,"tag":614,"props":4260,"children":4261},{"class":627},[4262],{"type":24,"value":4263}," dhdu1\n",{"type":18,"tag":614,"props":4265,"children":4266},{"class":616,"line":916},[4267,4271,4275,4279,4283],{"type":18,"tag":614,"props":4268,"children":4269},{"class":627},[4270],{"type":24,"value":4246},{"type":18,"tag":614,"props":4272,"children":4273},{"class":671},[4274],{"type":24,"value":977},{"type":18,"tag":614,"props":4276,"children":4277},{"class":627},[4278],{"type":24,"value":2929},{"type":18,"tag":614,"props":4280,"children":4281},{"class":621},[4282],{"type":24,"value":711},{"type":18,"tag":614,"props":4284,"children":4285},{"class":627},[4286],{"type":24,"value":4287}," dhdu2\n",{"type":18,"tag":614,"props":4289,"children":4290},{"class":616,"line":950},[4291],{"type":18,"tag":614,"props":4292,"children":4293},{"class":627},[4294],{"type":24,"value":2881},{"type":18,"tag":614,"props":4296,"children":4297},{"class":616,"line":984},[4298,4302,4306,4311,4315,4319,4323,4327],{"type":18,"tag":614,"props":4299,"children":4300},{"class":627},[4301],{"type":24,"value":3984},{"type":18,"tag":614,"props":4303,"children":4304},{"class":621},[4305],{"type":24,"value":711},{"type":18,"tag":614,"props":4307,"children":4308},{"class":627},[4309],{"type":24,"value":4310}," F.T.ravel().reshape(",{"type":18,"tag":614,"props":4312,"children":4313},{"class":621},[4314],{"type":24,"value":1046},{"type":18,"tag":614,"props":4316,"children":4317},{"class":671},[4318],{"type":24,"value":977},{"type":18,"tag":614,"props":4320,"children":4321},{"class":627},[4322],{"type":24,"value":2417},{"type":18,"tag":614,"props":4324,"children":4325},{"class":671},[4326],{"type":24,"value":977},{"type":18,"tag":614,"props":4328,"children":4329},{"class":627},[4330],{"type":24,"value":1423},{"type":18,"tag":614,"props":4332,"children":4333},{"class":616,"line":992},[4334],{"type":18,"tag":614,"props":4335,"children":4336},{},[4337],{"type":24,"value":650},{"type":18,"tag":614,"props":4339,"children":4340},{"class":616,"line":1018},[4341,4345,4349],{"type":18,"tag":614,"props":4342,"children":4343},{"class":627},[4344],{"type":24,"value":696},{"type":18,"tag":614,"props":4346,"children":4347},{"class":621},[4348],{"type":24,"value":1220},{"type":18,"tag":614,"props":4350,"children":4351},{"class":627},[4352],{"type":24,"value":4353}," F",{"type":18,"tag":27,"props":4355,"children":4356},{},[4357,4359,4365,4367,4372],{"type":24,"value":4358},"Now let's introduce Continuation method for Function ",{"type":18,"tag":4360,"props":4361,"children":4362},"code-inline",{},[4363],{"type":24,"value":4364},"F",{"type":24,"value":4366},", you can look at the ",{"type":18,"tag":170,"props":4368,"children":4369},{},[4370],{"type":24,"value":4371}," Continuation ",{"type":24,"value":4373}," part.",{"type":18,"tag":599,"props":4375,"children":4378},{"className":4376,"code":4377,"language":604,"meta":8},[602],"# Time step horizons\ndt = self.tf * (1-np.exp(-self.alpha*time)) / self.pred_horizons\n# F(x,u,t+h)\nF = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u,t+h)\nx_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, 0], U[0, 0], U[1, 0])\nX[:, 0] = X[:, 0] + np.array([x_dot, y_dot, yaw_dot]) * self.ht\nFxt = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u+hdx,t+h)\nFuxt = self.calc_f(X, U + self.dU*self.ht, Lambda, Mu , dt)\n\n# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n",[4379],{"type":18,"tag":607,"props":4380,"children":4381},{},[4382],{"type":18,"tag":599,"props":4383,"children":4384},{"__ignoreMap":8},[4385,4393,4477,4485,4510,4518,4591,4649,4673,4681,4736,4743,4751,4793],{"type":18,"tag":614,"props":4386,"children":4387},{"class":616,"line":617},[4388],{"type":18,"tag":614,"props":4389,"children":4390},{"class":1851},[4391],{"type":24,"value":4392},"# Time step horizons\n",{"type":18,"tag":614,"props":4394,"children":4395},{"class":616,"line":644},[4396,4400,4404,4408,4412,4416,4420,4425,4429,4433,4438,4442,4446,4451,4455,4460,4464,4468,4472],{"type":18,"tag":614,"props":4397,"children":4398},{"class":627},[4399],{"type":24,"value":2712},{"type":18,"tag":614,"props":4401,"children":4402},{"class":621},[4403],{"type":24,"value":711},{"type":18,"tag":614,"props":4405,"children":4406},{"class":627},[4407],{"type":24,"value":630},{"type":18,"tag":614,"props":4409,"children":4410},{"class":671},[4411],{"type":24,"value":701},{"type":18,"tag":614,"props":4413,"children":4414},{"class":627},[4415],{"type":24,"value":2103},{"type":18,"tag":614,"props":4417,"children":4418},{"class":621},[4419],{"type":24,"value":1056},{"type":18,"tag":614,"props":4421,"children":4422},{"class":627},[4423],{"type":24,"value":4424}," (",{"type":18,"tag":614,"props":4426,"children":4427},{"class":671},[4428],{"type":24,"value":977},{"type":18,"tag":614,"props":4430,"children":4431},{"class":621},[4432],{"type":24,"value":1046},{"type":18,"tag":614,"props":4434,"children":4435},{"class":627},[4436],{"type":24,"value":4437},"np.exp(",{"type":18,"tag":614,"props":4439,"children":4440},{"class":621},[4441],{"type":24,"value":1046},{"type":18,"tag":614,"props":4443,"children":4444},{"class":671},[4445],{"type":24,"value":701},{"type":18,"tag":614,"props":4447,"children":4448},{"class":627},[4449],{"type":24,"value":4450},".alpha",{"type":18,"tag":614,"props":4452,"children":4453},{"class":621},[4454],{"type":24,"value":1056},{"type":18,"tag":614,"props":4456,"children":4457},{"class":627},[4458],{"type":24,"value":4459},"time)) ",{"type":18,"tag":614,"props":4461,"children":4462},{"class":621},[4463],{"type":24,"value":1414},{"type":18,"tag":614,"props":4465,"children":4466},{"class":627},[4467],{"type":24,"value":630},{"type":18,"tag":614,"props":4469,"children":4470},{"class":671},[4471],{"type":24,"value":701},{"type":18,"tag":614,"props":4473,"children":4474},{"class":627},[4475],{"type":24,"value":4476},".pred_horizons\n",{"type":18,"tag":614,"props":4478,"children":4479},{"class":616,"line":653},[4480],{"type":18,"tag":614,"props":4481,"children":4482},{"class":1851},[4483],{"type":24,"value":4484},"# F(x,u,t+h)\n",{"type":18,"tag":614,"props":4486,"children":4487},{"class":616,"line":682},[4488,4493,4497,4501,4505],{"type":18,"tag":614,"props":4489,"children":4490},{"class":627},[4491],{"type":24,"value":4492},"F ",{"type":18,"tag":614,"props":4494,"children":4495},{"class":621},[4496],{"type":24,"value":711},{"type":18,"tag":614,"props":4498,"children":4499},{"class":627},[4500],{"type":24,"value":630},{"type":18,"tag":614,"props":4502,"children":4503},{"class":671},[4504],{"type":24,"value":701},{"type":18,"tag":614,"props":4506,"children":4507},{"class":627},[4508],{"type":24,"value":4509},".calc_f(X, U, Lambda, Mu, dt)\n",{"type":18,"tag":614,"props":4511,"children":4512},{"class":616,"line":690},[4513],{"type":18,"tag":614,"props":4514,"children":4515},{"class":1851},[4516],{"type":24,"value":4517},"# F(x+hdx,u,t+h)\n",{"type":18,"tag":614,"props":4519,"children":4520},{"class":616,"line":719},[4521,4526,4530,4534,4538,4542,4546,4550,4554,4559,4563,4567,4571,4575,4579,4583,4587],{"type":18,"tag":614,"props":4522,"children":4523},{"class":627},[4524],{"type":24,"value":4525},"x_dot, y_dot, yaw_dot ",{"type":18,"tag":614,"props":4527,"children":4528},{"class":621},[4529],{"type":24,"value":711},{"type":18,"tag":614,"props":4531,"children":4532},{"class":627},[4533],{"type":24,"value":630},{"type":18,"tag":614,"props":4535,"children":4536},{"class":671},[4537],{"type":24,"value":701},{"type":18,"tag":614,"props":4539,"children":4540},{"class":627},[4541],{"type":24,"value":2847},{"type":18,"tag":614,"props":4543,"children":4544},{"class":671},[4545],{"type":24,"value":1353},{"type":18,"tag":614,"props":4547,"children":4548},{"class":627},[4549],{"type":24,"value":2417},{"type":18,"tag":614,"props":4551,"children":4552},{"class":671},[4553],{"type":24,"value":867},{"type":18,"tag":614,"props":4555,"children":4556},{"class":627},[4557],{"type":24,"value":4558},"], U[",{"type":18,"tag":614,"props":4560,"children":4561},{"class":671},[4562],{"type":24,"value":867},{"type":18,"tag":614,"props":4564,"children":4565},{"class":627},[4566],{"type":24,"value":2417},{"type":18,"tag":614,"props":4568,"children":4569},{"class":671},[4570],{"type":24,"value":867},{"type":18,"tag":614,"props":4572,"children":4573},{"class":627},[4574],{"type":24,"value":4558},{"type":18,"tag":614,"props":4576,"children":4577},{"class":671},[4578],{"type":24,"value":977},{"type":18,"tag":614,"props":4580,"children":4581},{"class":627},[4582],{"type":24,"value":2417},{"type":18,"tag":614,"props":4584,"children":4585},{"class":671},[4586],{"type":24,"value":867},{"type":18,"tag":614,"props":4588,"children":4589},{"class":627},[4590],{"type":24,"value":3280},{"type":18,"tag":614,"props":4592,"children":4593},{"class":616,"line":745},[4594,4599,4603,4607,4611,4616,4620,4624,4628,4633,4637,4641,4645],{"type":18,"tag":614,"props":4595,"children":4596},{"class":627},[4597],{"type":24,"value":4598},"X[:, ",{"type":18,"tag":614,"props":4600,"children":4601},{"class":671},[4602],{"type":24,"value":867},{"type":18,"tag":614,"props":4604,"children":4605},{"class":627},[4606],{"type":24,"value":2911},{"type":18,"tag":614,"props":4608,"children":4609},{"class":621},[4610],{"type":24,"value":711},{"type":18,"tag":614,"props":4612,"children":4613},{"class":627},[4614],{"type":24,"value":4615}," X[:, ",{"type":18,"tag":614,"props":4617,"children":4618},{"class":671},[4619],{"type":24,"value":867},{"type":18,"tag":614,"props":4621,"children":4622},{"class":627},[4623],{"type":24,"value":2911},{"type":18,"tag":614,"props":4625,"children":4626},{"class":621},[4627],{"type":24,"value":1177},{"type":18,"tag":614,"props":4629,"children":4630},{"class":627},[4631],{"type":24,"value":4632}," np.array([x_dot, y_dot, yaw_dot]) ",{"type":18,"tag":614,"props":4634,"children":4635},{"class":621},[4636],{"type":24,"value":1056},{"type":18,"tag":614,"props":4638,"children":4639},{"class":627},[4640],{"type":24,"value":630},{"type":18,"tag":614,"props":4642,"children":4643},{"class":671},[4644],{"type":24,"value":701},{"type":18,"tag":614,"props":4646,"children":4647},{"class":627},[4648],{"type":24,"value":2058},{"type":18,"tag":614,"props":4650,"children":4651},{"class":616,"line":771},[4652,4657,4661,4665,4669],{"type":18,"tag":614,"props":4653,"children":4654},{"class":627},[4655],{"type":24,"value":4656},"Fxt ",{"type":18,"tag":614,"props":4658,"children":4659},{"class":621},[4660],{"type":24,"value":711},{"type":18,"tag":614,"props":4662,"children":4663},{"class":627},[4664],{"type":24,"value":630},{"type":18,"tag":614,"props":4666,"children":4667},{"class":671},[4668],{"type":24,"value":701},{"type":18,"tag":614,"props":4670,"children":4671},{"class":627},[4672],{"type":24,"value":4509},{"type":18,"tag":614,"props":4674,"children":4675},{"class":616,"line":779},[4676],{"type":18,"tag":614,"props":4677,"children":4678},{"class":1851},[4679],{"type":24,"value":4680},"# F(x+hdx,u+hdx,t+h)\n",{"type":18,"tag":614,"props":4682,"children":4683},{"class":616,"line":805},[4684,4689,4693,4697,4701,4706,4710,4714,4718,4723,4727,4731],{"type":18,"tag":614,"props":4685,"children":4686},{"class":627},[4687],{"type":24,"value":4688},"Fuxt ",{"type":18,"tag":614,"props":4690,"children":4691},{"class":621},[4692],{"type":24,"value":711},{"type":18,"tag":614,"props":4694,"children":4695},{"class":627},[4696],{"type":24,"value":630},{"type":18,"tag":614,"props":4698,"children":4699},{"class":671},[4700],{"type":24,"value":701},{"type":18,"tag":614,"props":4702,"children":4703},{"class":627},[4704],{"type":24,"value":4705},".calc_f(X, U ",{"type":18,"tag":614,"props":4707,"children":4708},{"class":621},[4709],{"type":24,"value":1177},{"type":18,"tag":614,"props":4711,"children":4712},{"class":627},[4713],{"type":24,"value":630},{"type":18,"tag":614,"props":4715,"children":4716},{"class":671},[4717],{"type":24,"value":701},{"type":18,"tag":614,"props":4719,"children":4720},{"class":627},[4721],{"type":24,"value":4722},".dU",{"type":18,"tag":614,"props":4724,"children":4725},{"class":621},[4726],{"type":24,"value":1056},{"type":18,"tag":614,"props":4728,"children":4729},{"class":671},[4730],{"type":24,"value":701},{"type":18,"tag":614,"props":4732,"children":4733},{"class":627},[4734],{"type":24,"value":4735},".ht, Lambda, Mu , dt)\n",{"type":18,"tag":614,"props":4737,"children":4738},{"class":616,"line":831},[4739],{"type":18,"tag":614,"props":4740,"children":4741},{},[4742],{"type":24,"value":650},{"type":18,"tag":614,"props":4744,"children":4745},{"class":616,"line":839},[4746],{"type":18,"tag":614,"props":4747,"children":4748},{"class":1851},[4749],{"type":24,"value":4750},"# Define right-left handside equation\n",{"type":18,"tag":614,"props":4752,"children":4753},{"class":616,"line":875},[4754,4759,4763,4768,4772,4777,4781,4785,4789],{"type":18,"tag":614,"props":4755,"children":4756},{"class":627},[4757],{"type":24,"value":4758},"left ",{"type":18,"tag":614,"props":4760,"children":4761},{"class":621},[4762],{"type":24,"value":711},{"type":18,"tag":614,"props":4764,"children":4765},{"class":627},[4766],{"type":24,"value":4767}," (Fuxt ",{"type":18,"tag":614,"props":4769,"children":4770},{"class":621},[4771],{"type":24,"value":1046},{"type":18,"tag":614,"props":4773,"children":4774},{"class":627},[4775],{"type":24,"value":4776}," Fxt) ",{"type":18,"tag":614,"props":4778,"children":4779},{"class":621},[4780],{"type":24,"value":1414},{"type":18,"tag":614,"props":4782,"children":4783},{"class":627},[4784],{"type":24,"value":630},{"type":18,"tag":614,"props":4786,"children":4787},{"class":671},[4788],{"type":24,"value":701},{"type":18,"tag":614,"props":4790,"children":4791},{"class":627},[4792],{"type":24,"value":2058},{"type":18,"tag":614,"props":4794,"children":4795},{"class":616,"line":908},[4796,4801,4805,4809,4813,4817,4821,4825,4830,4834,4839,4843,4848,4852,4856],{"type":18,"tag":614,"props":4797,"children":4798},{"class":627},[4799],{"type":24,"value":4800},"right ",{"type":18,"tag":614,"props":4802,"children":4803},{"class":621},[4804],{"type":24,"value":711},{"type":18,"tag":614,"props":4806,"children":4807},{"class":627},[4808],{"type":24,"value":630},{"type":18,"tag":614,"props":4810,"children":4811},{"class":621},[4812],{"type":24,"value":1046},{"type":18,"tag":614,"props":4814,"children":4815},{"class":671},[4816],{"type":24,"value":701},{"type":18,"tag":614,"props":4818,"children":4819},{"class":627},[4820],{"type":24,"value":2033},{"type":18,"tag":614,"props":4822,"children":4823},{"class":621},[4824],{"type":24,"value":1056},{"type":18,"tag":614,"props":4826,"children":4827},{"class":627},[4828],{"type":24,"value":4829}," F ",{"type":18,"tag":614,"props":4831,"children":4832},{"class":621},[4833],{"type":24,"value":1046},{"type":18,"tag":614,"props":4835,"children":4836},{"class":627},[4837],{"type":24,"value":4838}," (Fxt ",{"type":18,"tag":614,"props":4840,"children":4841},{"class":621},[4842],{"type":24,"value":1046},{"type":18,"tag":614,"props":4844,"children":4845},{"class":627},[4846],{"type":24,"value":4847}," F)",{"type":18,"tag":614,"props":4849,"children":4850},{"class":621},[4851],{"type":24,"value":1414},{"type":18,"tag":614,"props":4853,"children":4854},{"class":671},[4855],{"type":24,"value":701},{"type":18,"tag":614,"props":4857,"children":4858},{"class":627},[4859],{"type":24,"value":4860},".ht",{"type":18,"tag":27,"props":4862,"children":4863},{},[4864,4866,4870],{"type":24,"value":4865},"Here is the crucial part, we need to implement GMRES solver for our ",{"type":18,"tag":4360,"props":4867,"children":4868},{},[4869],{"type":24,"value":4364},{"type":24,"value":4871}," function to obtain solution vector.",{"type":18,"tag":599,"props":4873,"children":4876},{"className":4874,"code":4875,"language":604,"meta":8},[602],"# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n\n# Define iterations\nm = (self.u_dim ) * self.pred_horizons\n# Define r0\nr0 = right - left\n# print(r0)\n\n# GMRES\nVm = np.zeros((m, m+1))\nVm[:, 0:1] = r0 / np.linalg.norm(r0)\n# print(\"Vm\", Vm[:, 0])\nHm = np.zeros((m+1, m))\n# print(Vm[:, 0])\n\n\nfor i in range(m):\n    Fuxt = self.calc_f(\n        X, U + Vm[:, i:i+1].reshape(self.u_dim, self.pred_horizons, order='F') * self.ht,\n        Lambda, Mu,\n        dt\n    )\n\n    Av = (Fuxt - Fxt) / self.ht\n\n    for k in range(i+1):\n        Hm[k, i] = np.dot(Av.T, Vm[:, k:k+1])\n\n    temp_vec = np.zeros((m, 1))\n\n    for k in range(i+1):\n        temp_vec = temp_vec + np.dot(Hm[k, i], Vm[:, k:k+1])\n\n    v_hat = Av - temp_vec\n\n    Hm[i+1, i] = np.linalg.norm(v_hat)\n\n    Vm[:,i+1:i+2] = v_hat/Hm[i+1, i]\n\ne = np.zeros((m+1, 1))\ne[0, 0] = 1.0\ngm = np.linalg.norm(r0) * e\n# print(gm)\n\nUTMat, gm = self.ToUTMat(Hm, gm, m)\n\nmin_y = np.zeros((m, 1))\n\nfor i in range(m):\n    min_y[i][0] = (gm[i, 0] - np.dot(UTMat[i:i+1 ,:] ,min_y))/UTMat[i, i]\n\ndU_new = self.dU + np.dot(Vm[:, 0:m], min_y).reshape(self.u_dim, self.pred_horizons, order='F')\n\nself.dU = dU_new\n\nU = U + self.dU * self.ht\n",[4877],{"type":18,"tag":607,"props":4878,"children":4879},{},[4880],{"type":18,"tag":599,"props":4881,"children":4882},{"__ignoreMap":8},[4883,4890,4929,4992,4999,5007,5048,5056,5082,5090,5097,5105,5135,5177,5185,5215,5223,5230,5237,5265,5290,5375,5383,5391,5399,5406,5446,5453,5499,5528,5535,5560,5567,5610,5648,5655,5681,5688,5717,5725,5790,5798,5835,5872,5899,5908,5916,5942,5950,5975,5983,6011,6076,6084,6159,6167,6188,6196],{"type":18,"tag":614,"props":4884,"children":4885},{"class":616,"line":617},[4886],{"type":18,"tag":614,"props":4887,"children":4888},{"class":1851},[4889],{"type":24,"value":4750},{"type":18,"tag":614,"props":4891,"children":4892},{"class":616,"line":644},[4893,4897,4901,4905,4909,4913,4917,4921,4925],{"type":18,"tag":614,"props":4894,"children":4895},{"class":627},[4896],{"type":24,"value":4758},{"type":18,"tag":614,"props":4898,"children":4899},{"class":621},[4900],{"type":24,"value":711},{"type":18,"tag":614,"props":4902,"children":4903},{"class":627},[4904],{"type":24,"value":4767},{"type":18,"tag":614,"props":4906,"children":4907},{"class":621},[4908],{"type":24,"value":1046},{"type":18,"tag":614,"props":4910,"children":4911},{"class":627},[4912],{"type":24,"value":4776},{"type":18,"tag":614,"props":4914,"children":4915},{"class":621},[4916],{"type":24,"value":1414},{"type":18,"tag":614,"props":4918,"children":4919},{"class":627},[4920],{"type":24,"value":630},{"type":18,"tag":614,"props":4922,"children":4923},{"class":671},[4924],{"type":24,"value":701},{"type":18,"tag":614,"props":4926,"children":4927},{"class":627},[4928],{"type":24,"value":2058},{"type":18,"tag":614,"props":4930,"children":4931},{"class":616,"line":653},[4932,4936,4940,4944,4948,4952,4956,4960,4964,4968,4972,4976,4980,4984,4988],{"type":18,"tag":614,"props":4933,"children":4934},{"class":627},[4935],{"type":24,"value":4800},{"type":18,"tag":614,"props":4937,"children":4938},{"class":621},[4939],{"type":24,"value":711},{"type":18,"tag":614,"props":4941,"children":4942},{"class":627},[4943],{"type":24,"value":630},{"type":18,"tag":614,"props":4945,"children":4946},{"class":621},[4947],{"type":24,"value":1046},{"type":18,"tag":614,"props":4949,"children":4950},{"class":671},[4951],{"type":24,"value":701},{"type":18,"tag":614,"props":4953,"children":4954},{"class":627},[4955],{"type":24,"value":2033},{"type":18,"tag":614,"props":4957,"children":4958},{"class":621},[4959],{"type":24,"value":1056},{"type":18,"tag":614,"props":4961,"children":4962},{"class":627},[4963],{"type":24,"value":4829},{"type":18,"tag":614,"props":4965,"children":4966},{"class":621},[4967],{"type":24,"value":1046},{"type":18,"tag":614,"props":4969,"children":4970},{"class":627},[4971],{"type":24,"value":4838},{"type":18,"tag":614,"props":4973,"children":4974},{"class":621},[4975],{"type":24,"value":1046},{"type":18,"tag":614,"props":4977,"children":4978},{"class":627},[4979],{"type":24,"value":4847},{"type":18,"tag":614,"props":4981,"children":4982},{"class":621},[4983],{"type":24,"value":1414},{"type":18,"tag":614,"props":4985,"children":4986},{"class":671},[4987],{"type":24,"value":701},{"type":18,"tag":614,"props":4989,"children":4990},{"class":627},[4991],{"type":24,"value":2058},{"type":18,"tag":614,"props":4993,"children":4994},{"class":616,"line":682},[4995],{"type":18,"tag":614,"props":4996,"children":4997},{},[4998],{"type":24,"value":650},{"type":18,"tag":614,"props":5000,"children":5001},{"class":616,"line":690},[5002],{"type":18,"tag":614,"props":5003,"children":5004},{"class":1851},[5005],{"type":24,"value":5006},"# Define iterations\n",{"type":18,"tag":614,"props":5008,"children":5009},{"class":616,"line":719},[5010,5015,5019,5023,5027,5032,5036,5040,5044],{"type":18,"tag":614,"props":5011,"children":5012},{"class":627},[5013],{"type":24,"value":5014},"m ",{"type":18,"tag":614,"props":5016,"children":5017},{"class":621},[5018],{"type":24,"value":711},{"type":18,"tag":614,"props":5020,"children":5021},{"class":627},[5022],{"type":24,"value":4424},{"type":18,"tag":614,"props":5024,"children":5025},{"class":671},[5026],{"type":24,"value":701},{"type":18,"tag":614,"props":5028,"children":5029},{"class":627},[5030],{"type":24,"value":5031},".u_dim ) ",{"type":18,"tag":614,"props":5033,"children":5034},{"class":621},[5035],{"type":24,"value":1056},{"type":18,"tag":614,"props":5037,"children":5038},{"class":627},[5039],{"type":24,"value":630},{"type":18,"tag":614,"props":5041,"children":5042},{"class":671},[5043],{"type":24,"value":701},{"type":18,"tag":614,"props":5045,"children":5046},{"class":627},[5047],{"type":24,"value":4476},{"type":18,"tag":614,"props":5049,"children":5050},{"class":616,"line":745},[5051],{"type":18,"tag":614,"props":5052,"children":5053},{"class":1851},[5054],{"type":24,"value":5055},"# Define r0\n",{"type":18,"tag":614,"props":5057,"children":5058},{"class":616,"line":771},[5059,5064,5068,5073,5077],{"type":18,"tag":614,"props":5060,"children":5061},{"class":627},[5062],{"type":24,"value":5063},"r0 ",{"type":18,"tag":614,"props":5065,"children":5066},{"class":621},[5067],{"type":24,"value":711},{"type":18,"tag":614,"props":5069,"children":5070},{"class":627},[5071],{"type":24,"value":5072}," right ",{"type":18,"tag":614,"props":5074,"children":5075},{"class":621},[5076],{"type":24,"value":1046},{"type":18,"tag":614,"props":5078,"children":5079},{"class":627},[5080],{"type":24,"value":5081}," left\n",{"type":18,"tag":614,"props":5083,"children":5084},{"class":616,"line":779},[5085],{"type":18,"tag":614,"props":5086,"children":5087},{"class":1851},[5088],{"type":24,"value":5089},"# print(r0)\n",{"type":18,"tag":614,"props":5091,"children":5092},{"class":616,"line":805},[5093],{"type":18,"tag":614,"props":5094,"children":5095},{},[5096],{"type":24,"value":650},{"type":18,"tag":614,"props":5098,"children":5099},{"class":616,"line":831},[5100],{"type":18,"tag":614,"props":5101,"children":5102},{"class":1851},[5103],{"type":24,"value":5104},"# GMRES\n",{"type":18,"tag":614,"props":5106,"children":5107},{"class":616,"line":839},[5108,5113,5117,5122,5126,5130],{"type":18,"tag":614,"props":5109,"children":5110},{"class":627},[5111],{"type":24,"value":5112},"Vm ",{"type":18,"tag":614,"props":5114,"children":5115},{"class":621},[5116],{"type":24,"value":711},{"type":18,"tag":614,"props":5118,"children":5119},{"class":627},[5120],{"type":24,"value":5121}," np.zeros((m, m",{"type":18,"tag":614,"props":5123,"children":5124},{"class":621},[5125],{"type":24,"value":1177},{"type":18,"tag":614,"props":5127,"children":5128},{"class":671},[5129],{"type":24,"value":977},{"type":18,"tag":614,"props":5131,"children":5132},{"class":627},[5133],{"type":24,"value":5134},"))\n",{"type":18,"tag":614,"props":5136,"children":5137},{"class":616,"line":875},[5138,5143,5147,5151,5155,5159,5163,5168,5172],{"type":18,"tag":614,"props":5139,"children":5140},{"class":627},[5141],{"type":24,"value":5142},"Vm[:, ",{"type":18,"tag":614,"props":5144,"children":5145},{"class":671},[5146],{"type":24,"value":867},{"type":18,"tag":614,"props":5148,"children":5149},{"class":627},[5150],{"type":24,"value":296},{"type":18,"tag":614,"props":5152,"children":5153},{"class":671},[5154],{"type":24,"value":977},{"type":18,"tag":614,"props":5156,"children":5157},{"class":627},[5158],{"type":24,"value":2911},{"type":18,"tag":614,"props":5160,"children":5161},{"class":621},[5162],{"type":24,"value":711},{"type":18,"tag":614,"props":5164,"children":5165},{"class":627},[5166],{"type":24,"value":5167}," r0 ",{"type":18,"tag":614,"props":5169,"children":5170},{"class":621},[5171],{"type":24,"value":1414},{"type":18,"tag":614,"props":5173,"children":5174},{"class":627},[5175],{"type":24,"value":5176}," np.linalg.norm(r0)\n",{"type":18,"tag":614,"props":5178,"children":5179},{"class":616,"line":908},[5180],{"type":18,"tag":614,"props":5181,"children":5182},{"class":1851},[5183],{"type":24,"value":5184},"# print(\"Vm\", Vm[:, 0])\n",{"type":18,"tag":614,"props":5186,"children":5187},{"class":616,"line":916},[5188,5193,5197,5202,5206,5210],{"type":18,"tag":614,"props":5189,"children":5190},{"class":627},[5191],{"type":24,"value":5192},"Hm ",{"type":18,"tag":614,"props":5194,"children":5195},{"class":621},[5196],{"type":24,"value":711},{"type":18,"tag":614,"props":5198,"children":5199},{"class":627},[5200],{"type":24,"value":5201}," np.zeros((m",{"type":18,"tag":614,"props":5203,"children":5204},{"class":621},[5205],{"type":24,"value":1177},{"type":18,"tag":614,"props":5207,"children":5208},{"class":671},[5209],{"type":24,"value":977},{"type":18,"tag":614,"props":5211,"children":5212},{"class":627},[5213],{"type":24,"value":5214},", m))\n",{"type":18,"tag":614,"props":5216,"children":5217},{"class":616,"line":950},[5218],{"type":18,"tag":614,"props":5219,"children":5220},{"class":1851},[5221],{"type":24,"value":5222},"# print(Vm[:, 0])\n",{"type":18,"tag":614,"props":5224,"children":5225},{"class":616,"line":984},[5226],{"type":18,"tag":614,"props":5227,"children":5228},{},[5229],{"type":24,"value":650},{"type":18,"tag":614,"props":5231,"children":5232},{"class":616,"line":992},[5233],{"type":18,"tag":614,"props":5234,"children":5235},{},[5236],{"type":24,"value":650},{"type":18,"tag":614,"props":5238,"children":5239},{"class":616,"line":1018},[5240,5244,5248,5252,5256,5260],{"type":18,"tag":614,"props":5241,"children":5242},{"class":621},[5243],{"type":24,"value":2790},{"type":18,"tag":614,"props":5245,"children":5246},{"class":627},[5247],{"type":24,"value":2795},{"type":18,"tag":614,"props":5249,"children":5250},{"class":621},[5251],{"type":24,"value":2800},{"type":18,"tag":614,"props":5253,"children":5254},{"class":627},[5255],{"type":24,"value":630},{"type":18,"tag":614,"props":5257,"children":5258},{"class":671},[5259],{"type":24,"value":2809},{"type":18,"tag":614,"props":5261,"children":5262},{"class":627},[5263],{"type":24,"value":5264},"(m):\n",{"type":18,"tag":614,"props":5266,"children":5267},{"class":616,"line":1026},[5268,5273,5277,5281,5285],{"type":18,"tag":614,"props":5269,"children":5270},{"class":627},[5271],{"type":24,"value":5272},"    Fuxt ",{"type":18,"tag":614,"props":5274,"children":5275},{"class":621},[5276],{"type":24,"value":711},{"type":18,"tag":614,"props":5278,"children":5279},{"class":627},[5280],{"type":24,"value":630},{"type":18,"tag":614,"props":5282,"children":5283},{"class":671},[5284],{"type":24,"value":701},{"type":18,"tag":614,"props":5286,"children":5287},{"class":627},[5288],{"type":24,"value":5289},".calc_f(\n",{"type":18,"tag":614,"props":5291,"children":5292},{"class":616,"line":1068},[5293,5298,5302,5307,5311,5315,5320,5324,5328,5332,5337,5343,5347,5353,5358,5362,5366,5370],{"type":18,"tag":614,"props":5294,"children":5295},{"class":627},[5296],{"type":24,"value":5297},"        X, U ",{"type":18,"tag":614,"props":5299,"children":5300},{"class":621},[5301],{"type":24,"value":1177},{"type":18,"tag":614,"props":5303,"children":5304},{"class":627},[5305],{"type":24,"value":5306}," Vm[:, i:i",{"type":18,"tag":614,"props":5308,"children":5309},{"class":621},[5310],{"type":24,"value":1177},{"type":18,"tag":614,"props":5312,"children":5313},{"class":671},[5314],{"type":24,"value":977},{"type":18,"tag":614,"props":5316,"children":5317},{"class":627},[5318],{"type":24,"value":5319},"].reshape(",{"type":18,"tag":614,"props":5321,"children":5322},{"class":671},[5323],{"type":24,"value":701},{"type":18,"tag":614,"props":5325,"children":5326},{"class":627},[5327],{"type":24,"value":2478},{"type":18,"tag":614,"props":5329,"children":5330},{"class":671},[5331],{"type":24,"value":701},{"type":18,"tag":614,"props":5333,"children":5334},{"class":627},[5335],{"type":24,"value":5336},".pred_horizons, ",{"type":18,"tag":614,"props":5338,"children":5340},{"class":5339},"ct-657843",[5341],{"type":24,"value":5342},"order",{"type":18,"tag":614,"props":5344,"children":5345},{"class":621},[5346],{"type":24,"value":711},{"type":18,"tag":614,"props":5348,"children":5350},{"class":5349},"ct-244866",[5351],{"type":24,"value":5352},"'F'",{"type":18,"tag":614,"props":5354,"children":5355},{"class":627},[5356],{"type":24,"value":5357},") ",{"type":18,"tag":614,"props":5359,"children":5360},{"class":621},[5361],{"type":24,"value":1056},{"type":18,"tag":614,"props":5363,"children":5364},{"class":627},[5365],{"type":24,"value":630},{"type":18,"tag":614,"props":5367,"children":5368},{"class":671},[5369],{"type":24,"value":701},{"type":18,"tag":614,"props":5371,"children":5372},{"class":627},[5373],{"type":24,"value":5374},".ht,\n",{"type":18,"tag":614,"props":5376,"children":5377},{"class":616,"line":1108},[5378],{"type":18,"tag":614,"props":5379,"children":5380},{"class":627},[5381],{"type":24,"value":5382},"        Lambda, Mu,\n",{"type":18,"tag":614,"props":5384,"children":5385},{"class":616,"line":1202},[5386],{"type":18,"tag":614,"props":5387,"children":5388},{"class":627},[5389],{"type":24,"value":5390},"        dt\n",{"type":18,"tag":614,"props":5392,"children":5393},{"class":616,"line":1210},[5394],{"type":18,"tag":614,"props":5395,"children":5396},{"class":627},[5397],{"type":24,"value":5398},"    )\n",{"type":18,"tag":614,"props":5400,"children":5401},{"class":616,"line":1228},[5402],{"type":18,"tag":614,"props":5403,"children":5404},{},[5405],{"type":24,"value":650},{"type":18,"tag":614,"props":5407,"children":5408},{"class":616,"line":1236},[5409,5414,5418,5422,5426,5430,5434,5438,5442],{"type":18,"tag":614,"props":5410,"children":5411},{"class":627},[5412],{"type":24,"value":5413},"    Av ",{"type":18,"tag":614,"props":5415,"children":5416},{"class":621},[5417],{"type":24,"value":711},{"type":18,"tag":614,"props":5419,"children":5420},{"class":627},[5421],{"type":24,"value":4767},{"type":18,"tag":614,"props":5423,"children":5424},{"class":621},[5425],{"type":24,"value":1046},{"type":18,"tag":614,"props":5427,"children":5428},{"class":627},[5429],{"type":24,"value":4776},{"type":18,"tag":614,"props":5431,"children":5432},{"class":621},[5433],{"type":24,"value":1414},{"type":18,"tag":614,"props":5435,"children":5436},{"class":627},[5437],{"type":24,"value":630},{"type":18,"tag":614,"props":5439,"children":5440},{"class":671},[5441],{"type":24,"value":701},{"type":18,"tag":614,"props":5443,"children":5444},{"class":627},[5445],{"type":24,"value":2058},{"type":18,"tag":614,"props":5447,"children":5448},{"class":616,"line":1262},[5449],{"type":18,"tag":614,"props":5450,"children":5451},{},[5452],{"type":24,"value":650},{"type":18,"tag":614,"props":5454,"children":5455},{"class":616,"line":1270},[5456,5460,5464,5469,5473,5477,5481,5486,5490,5494],{"type":18,"tag":614,"props":5457,"children":5458},{"class":627},[5459],{"type":24,"value":659},{"type":18,"tag":614,"props":5461,"children":5462},{"class":621},[5463],{"type":24,"value":2790},{"type":18,"tag":614,"props":5465,"children":5466},{"class":627},[5467],{"type":24,"value":5468}," k ",{"type":18,"tag":614,"props":5470,"children":5471},{"class":621},[5472],{"type":24,"value":2800},{"type":18,"tag":614,"props":5474,"children":5475},{"class":627},[5476],{"type":24,"value":630},{"type":18,"tag":614,"props":5478,"children":5479},{"class":671},[5480],{"type":24,"value":2809},{"type":18,"tag":614,"props":5482,"children":5483},{"class":627},[5484],{"type":24,"value":5485},"(i",{"type":18,"tag":614,"props":5487,"children":5488},{"class":621},[5489],{"type":24,"value":1177},{"type":18,"tag":614,"props":5491,"children":5492},{"class":671},[5493],{"type":24,"value":977},{"type":18,"tag":614,"props":5495,"children":5496},{"class":627},[5497],{"type":24,"value":5498},"):\n",{"type":18,"tag":614,"props":5500,"children":5501},{"class":616,"line":1426},[5502,5507,5511,5516,5520,5524],{"type":18,"tag":614,"props":5503,"children":5504},{"class":627},[5505],{"type":24,"value":5506},"        Hm[k, i] ",{"type":18,"tag":614,"props":5508,"children":5509},{"class":621},[5510],{"type":24,"value":711},{"type":18,"tag":614,"props":5512,"children":5513},{"class":627},[5514],{"type":24,"value":5515}," np.dot(Av.T, Vm[:, k:k",{"type":18,"tag":614,"props":5517,"children":5518},{"class":621},[5519],{"type":24,"value":1177},{"type":18,"tag":614,"props":5521,"children":5522},{"class":671},[5523],{"type":24,"value":977},{"type":18,"tag":614,"props":5525,"children":5526},{"class":627},[5527],{"type":24,"value":3280},{"type":18,"tag":614,"props":5529,"children":5530},{"class":616,"line":1546},[5531],{"type":18,"tag":614,"props":5532,"children":5533},{},[5534],{"type":24,"value":650},{"type":18,"tag":614,"props":5536,"children":5537},{"class":616,"line":1554},[5538,5543,5547,5552,5556],{"type":18,"tag":614,"props":5539,"children":5540},{"class":627},[5541],{"type":24,"value":5542},"    temp_vec ",{"type":18,"tag":614,"props":5544,"children":5545},{"class":621},[5546],{"type":24,"value":711},{"type":18,"tag":614,"props":5548,"children":5549},{"class":627},[5550],{"type":24,"value":5551}," np.zeros((m, ",{"type":18,"tag":614,"props":5553,"children":5554},{"class":671},[5555],{"type":24,"value":977},{"type":18,"tag":614,"props":5557,"children":5558},{"class":627},[5559],{"type":24,"value":5134},{"type":18,"tag":614,"props":5561,"children":5562},{"class":616,"line":1571},[5563],{"type":18,"tag":614,"props":5564,"children":5565},{},[5566],{"type":24,"value":650},{"type":18,"tag":614,"props":5568,"children":5569},{"class":616,"line":1579},[5570,5574,5578,5582,5586,5590,5594,5598,5602,5606],{"type":18,"tag":614,"props":5571,"children":5572},{"class":627},[5573],{"type":24,"value":659},{"type":18,"tag":614,"props":5575,"children":5576},{"class":621},[5577],{"type":24,"value":2790},{"type":18,"tag":614,"props":5579,"children":5580},{"class":627},[5581],{"type":24,"value":5468},{"type":18,"tag":614,"props":5583,"children":5584},{"class":621},[5585],{"type":24,"value":2800},{"type":18,"tag":614,"props":5587,"children":5588},{"class":627},[5589],{"type":24,"value":630},{"type":18,"tag":614,"props":5591,"children":5592},{"class":671},[5593],{"type":24,"value":2809},{"type":18,"tag":614,"props":5595,"children":5596},{"class":627},[5597],{"type":24,"value":5485},{"type":18,"tag":614,"props":5599,"children":5600},{"class":621},[5601],{"type":24,"value":1177},{"type":18,"tag":614,"props":5603,"children":5604},{"class":671},[5605],{"type":24,"value":977},{"type":18,"tag":614,"props":5607,"children":5608},{"class":627},[5609],{"type":24,"value":5498},{"type":18,"tag":614,"props":5611,"children":5612},{"class":616,"line":1605},[5613,5618,5622,5627,5631,5636,5640,5644],{"type":18,"tag":614,"props":5614,"children":5615},{"class":627},[5616],{"type":24,"value":5617},"        temp_vec ",{"type":18,"tag":614,"props":5619,"children":5620},{"class":621},[5621],{"type":24,"value":711},{"type":18,"tag":614,"props":5623,"children":5624},{"class":627},[5625],{"type":24,"value":5626}," temp_vec ",{"type":18,"tag":614,"props":5628,"children":5629},{"class":621},[5630],{"type":24,"value":1177},{"type":18,"tag":614,"props":5632,"children":5633},{"class":627},[5634],{"type":24,"value":5635}," np.dot(Hm[k, i], Vm[:, k:k",{"type":18,"tag":614,"props":5637,"children":5638},{"class":621},[5639],{"type":24,"value":1177},{"type":18,"tag":614,"props":5641,"children":5642},{"class":671},[5643],{"type":24,"value":977},{"type":18,"tag":614,"props":5645,"children":5646},{"class":627},[5647],{"type":24,"value":3280},{"type":18,"tag":614,"props":5649,"children":5650},{"class":616,"line":1649},[5651],{"type":18,"tag":614,"props":5652,"children":5653},{},[5654],{"type":24,"value":650},{"type":18,"tag":614,"props":5656,"children":5657},{"class":616,"line":1693},[5658,5663,5667,5672,5676],{"type":18,"tag":614,"props":5659,"children":5660},{"class":627},[5661],{"type":24,"value":5662},"    v_hat ",{"type":18,"tag":614,"props":5664,"children":5665},{"class":621},[5666],{"type":24,"value":711},{"type":18,"tag":614,"props":5668,"children":5669},{"class":627},[5670],{"type":24,"value":5671}," Av ",{"type":18,"tag":614,"props":5673,"children":5674},{"class":621},[5675],{"type":24,"value":1046},{"type":18,"tag":614,"props":5677,"children":5678},{"class":627},[5679],{"type":24,"value":5680}," temp_vec\n",{"type":18,"tag":614,"props":5682,"children":5683},{"class":616,"line":1736},[5684],{"type":18,"tag":614,"props":5685,"children":5686},{},[5687],{"type":24,"value":650},{"type":18,"tag":614,"props":5689,"children":5690},{"class":616,"line":1744},[5691,5696,5700,5704,5708,5712],{"type":18,"tag":614,"props":5692,"children":5693},{"class":627},[5694],{"type":24,"value":5695},"    Hm[i",{"type":18,"tag":614,"props":5697,"children":5698},{"class":621},[5699],{"type":24,"value":1177},{"type":18,"tag":614,"props":5701,"children":5702},{"class":671},[5703],{"type":24,"value":977},{"type":18,"tag":614,"props":5705,"children":5706},{"class":627},[5707],{"type":24,"value":2929},{"type":18,"tag":614,"props":5709,"children":5710},{"class":621},[5711],{"type":24,"value":711},{"type":18,"tag":614,"props":5713,"children":5714},{"class":627},[5715],{"type":24,"value":5716}," np.linalg.norm(v_hat)\n",{"type":18,"tag":614,"props":5718,"children":5720},{"class":616,"line":5719},39,[5721],{"type":18,"tag":614,"props":5722,"children":5723},{},[5724],{"type":24,"value":650},{"type":18,"tag":614,"props":5726,"children":5728},{"class":616,"line":5727},40,[5729,5734,5738,5742,5747,5751,5755,5759,5763,5768,5772,5777,5781,5785],{"type":18,"tag":614,"props":5730,"children":5731},{"class":627},[5732],{"type":24,"value":5733},"    Vm[:,i",{"type":18,"tag":614,"props":5735,"children":5736},{"class":621},[5737],{"type":24,"value":1177},{"type":18,"tag":614,"props":5739,"children":5740},{"class":671},[5741],{"type":24,"value":977},{"type":18,"tag":614,"props":5743,"children":5744},{"class":627},[5745],{"type":24,"value":5746},":i",{"type":18,"tag":614,"props":5748,"children":5749},{"class":621},[5750],{"type":24,"value":1177},{"type":18,"tag":614,"props":5752,"children":5753},{"class":671},[5754],{"type":24,"value":1353},{"type":18,"tag":614,"props":5756,"children":5757},{"class":627},[5758],{"type":24,"value":2911},{"type":18,"tag":614,"props":5760,"children":5761},{"class":621},[5762],{"type":24,"value":711},{"type":18,"tag":614,"props":5764,"children":5765},{"class":627},[5766],{"type":24,"value":5767}," v_hat",{"type":18,"tag":614,"props":5769,"children":5770},{"class":621},[5771],{"type":24,"value":1414},{"type":18,"tag":614,"props":5773,"children":5774},{"class":627},[5775],{"type":24,"value":5776},"Hm[i",{"type":18,"tag":614,"props":5778,"children":5779},{"class":621},[5780],{"type":24,"value":1177},{"type":18,"tag":614,"props":5782,"children":5783},{"class":671},[5784],{"type":24,"value":977},{"type":18,"tag":614,"props":5786,"children":5787},{"class":627},[5788],{"type":24,"value":5789},", i]\n",{"type":18,"tag":614,"props":5791,"children":5793},{"class":616,"line":5792},41,[5794],{"type":18,"tag":614,"props":5795,"children":5796},{},[5797],{"type":24,"value":650},{"type":18,"tag":614,"props":5799,"children":5801},{"class":616,"line":5800},42,[5802,5807,5811,5815,5819,5823,5827,5831],{"type":18,"tag":614,"props":5803,"children":5804},{"class":627},[5805],{"type":24,"value":5806},"e ",{"type":18,"tag":614,"props":5808,"children":5809},{"class":621},[5810],{"type":24,"value":711},{"type":18,"tag":614,"props":5812,"children":5813},{"class":627},[5814],{"type":24,"value":5201},{"type":18,"tag":614,"props":5816,"children":5817},{"class":621},[5818],{"type":24,"value":1177},{"type":18,"tag":614,"props":5820,"children":5821},{"class":671},[5822],{"type":24,"value":977},{"type":18,"tag":614,"props":5824,"children":5825},{"class":627},[5826],{"type":24,"value":2417},{"type":18,"tag":614,"props":5828,"children":5829},{"class":671},[5830],{"type":24,"value":977},{"type":18,"tag":614,"props":5832,"children":5833},{"class":627},[5834],{"type":24,"value":5134},{"type":18,"tag":614,"props":5836,"children":5838},{"class":616,"line":5837},43,[5839,5844,5848,5852,5856,5860,5864,5868],{"type":18,"tag":614,"props":5840,"children":5841},{"class":627},[5842],{"type":24,"value":5843},"e[",{"type":18,"tag":614,"props":5845,"children":5846},{"class":671},[5847],{"type":24,"value":867},{"type":18,"tag":614,"props":5849,"children":5850},{"class":627},[5851],{"type":24,"value":2417},{"type":18,"tag":614,"props":5853,"children":5854},{"class":671},[5855],{"type":24,"value":867},{"type":18,"tag":614,"props":5857,"children":5858},{"class":627},[5859],{"type":24,"value":2911},{"type":18,"tag":614,"props":5861,"children":5862},{"class":621},[5863],{"type":24,"value":711},{"type":18,"tag":614,"props":5865,"children":5866},{"class":627},[5867],{"type":24,"value":630},{"type":18,"tag":614,"props":5869,"children":5870},{"class":671},[5871],{"type":24,"value":2116},{"type":18,"tag":614,"props":5873,"children":5875},{"class":616,"line":5874},44,[5876,5881,5885,5890,5894],{"type":18,"tag":614,"props":5877,"children":5878},{"class":627},[5879],{"type":24,"value":5880},"gm ",{"type":18,"tag":614,"props":5882,"children":5883},{"class":621},[5884],{"type":24,"value":711},{"type":18,"tag":614,"props":5886,"children":5887},{"class":627},[5888],{"type":24,"value":5889}," np.linalg.norm(r0) ",{"type":18,"tag":614,"props":5891,"children":5892},{"class":621},[5893],{"type":24,"value":1056},{"type":18,"tag":614,"props":5895,"children":5896},{"class":627},[5897],{"type":24,"value":5898}," e\n",{"type":18,"tag":614,"props":5900,"children":5902},{"class":616,"line":5901},45,[5903],{"type":18,"tag":614,"props":5904,"children":5905},{"class":1851},[5906],{"type":24,"value":5907},"# print(gm)\n",{"type":18,"tag":614,"props":5909,"children":5911},{"class":616,"line":5910},46,[5912],{"type":18,"tag":614,"props":5913,"children":5914},{},[5915],{"type":24,"value":650},{"type":18,"tag":614,"props":5917,"children":5919},{"class":616,"line":5918},47,[5920,5925,5929,5933,5937],{"type":18,"tag":614,"props":5921,"children":5922},{"class":627},[5923],{"type":24,"value":5924},"UTMat, gm ",{"type":18,"tag":614,"props":5926,"children":5927},{"class":621},[5928],{"type":24,"value":711},{"type":18,"tag":614,"props":5930,"children":5931},{"class":627},[5932],{"type":24,"value":630},{"type":18,"tag":614,"props":5934,"children":5935},{"class":671},[5936],{"type":24,"value":701},{"type":18,"tag":614,"props":5938,"children":5939},{"class":627},[5940],{"type":24,"value":5941},".ToUTMat(Hm, gm, m)\n",{"type":18,"tag":614,"props":5943,"children":5945},{"class":616,"line":5944},48,[5946],{"type":18,"tag":614,"props":5947,"children":5948},{},[5949],{"type":24,"value":650},{"type":18,"tag":614,"props":5951,"children":5953},{"class":616,"line":5952},49,[5954,5959,5963,5967,5971],{"type":18,"tag":614,"props":5955,"children":5956},{"class":627},[5957],{"type":24,"value":5958},"min_y ",{"type":18,"tag":614,"props":5960,"children":5961},{"class":621},[5962],{"type":24,"value":711},{"type":18,"tag":614,"props":5964,"children":5965},{"class":627},[5966],{"type":24,"value":5551},{"type":18,"tag":614,"props":5968,"children":5969},{"class":671},[5970],{"type":24,"value":977},{"type":18,"tag":614,"props":5972,"children":5973},{"class":627},[5974],{"type":24,"value":5134},{"type":18,"tag":614,"props":5976,"children":5978},{"class":616,"line":5977},50,[5979],{"type":18,"tag":614,"props":5980,"children":5981},{},[5982],{"type":24,"value":650},{"type":18,"tag":614,"props":5984,"children":5986},{"class":616,"line":5985},51,[5987,5991,5995,5999,6003,6007],{"type":18,"tag":614,"props":5988,"children":5989},{"class":621},[5990],{"type":24,"value":2790},{"type":18,"tag":614,"props":5992,"children":5993},{"class":627},[5994],{"type":24,"value":2795},{"type":18,"tag":614,"props":5996,"children":5997},{"class":621},[5998],{"type":24,"value":2800},{"type":18,"tag":614,"props":6000,"children":6001},{"class":627},[6002],{"type":24,"value":630},{"type":18,"tag":614,"props":6004,"children":6005},{"class":671},[6006],{"type":24,"value":2809},{"type":18,"tag":614,"props":6008,"children":6009},{"class":627},[6010],{"type":24,"value":5264},{"type":18,"tag":614,"props":6012,"children":6014},{"class":616,"line":6013},52,[6015,6020,6024,6028,6032,6037,6041,6045,6049,6054,6058,6062,6067,6071],{"type":18,"tag":614,"props":6016,"children":6017},{"class":627},[6018],{"type":24,"value":6019},"    min_y[i][",{"type":18,"tag":614,"props":6021,"children":6022},{"class":671},[6023],{"type":24,"value":867},{"type":18,"tag":614,"props":6025,"children":6026},{"class":627},[6027],{"type":24,"value":2911},{"type":18,"tag":614,"props":6029,"children":6030},{"class":621},[6031],{"type":24,"value":711},{"type":18,"tag":614,"props":6033,"children":6034},{"class":627},[6035],{"type":24,"value":6036}," (gm[i, ",{"type":18,"tag":614,"props":6038,"children":6039},{"class":671},[6040],{"type":24,"value":867},{"type":18,"tag":614,"props":6042,"children":6043},{"class":627},[6044],{"type":24,"value":2911},{"type":18,"tag":614,"props":6046,"children":6047},{"class":621},[6048],{"type":24,"value":1046},{"type":18,"tag":614,"props":6050,"children":6051},{"class":627},[6052],{"type":24,"value":6053}," np.dot(UTMat[i:i",{"type":18,"tag":614,"props":6055,"children":6056},{"class":621},[6057],{"type":24,"value":1177},{"type":18,"tag":614,"props":6059,"children":6060},{"class":671},[6061],{"type":24,"value":977},{"type":18,"tag":614,"props":6063,"children":6064},{"class":627},[6065],{"type":24,"value":6066}," ,:] ,min_y))",{"type":18,"tag":614,"props":6068,"children":6069},{"class":621},[6070],{"type":24,"value":1414},{"type":18,"tag":614,"props":6072,"children":6073},{"class":627},[6074],{"type":24,"value":6075},"UTMat[i, i]\n",{"type":18,"tag":614,"props":6077,"children":6079},{"class":616,"line":6078},53,[6080],{"type":18,"tag":614,"props":6081,"children":6082},{},[6083],{"type":24,"value":650},{"type":18,"tag":614,"props":6085,"children":6087},{"class":616,"line":6086},54,[6088,6093,6097,6101,6105,6109,6113,6118,6122,6127,6131,6135,6139,6143,6147,6151,6155],{"type":18,"tag":614,"props":6089,"children":6090},{"class":627},[6091],{"type":24,"value":6092},"dU_new ",{"type":18,"tag":614,"props":6094,"children":6095},{"class":621},[6096],{"type":24,"value":711},{"type":18,"tag":614,"props":6098,"children":6099},{"class":627},[6100],{"type":24,"value":630},{"type":18,"tag":614,"props":6102,"children":6103},{"class":671},[6104],{"type":24,"value":701},{"type":18,"tag":614,"props":6106,"children":6107},{"class":627},[6108],{"type":24,"value":2460},{"type":18,"tag":614,"props":6110,"children":6111},{"class":621},[6112],{"type":24,"value":1177},{"type":18,"tag":614,"props":6114,"children":6115},{"class":627},[6116],{"type":24,"value":6117}," np.dot(Vm[:, ",{"type":18,"tag":614,"props":6119,"children":6120},{"class":671},[6121],{"type":24,"value":867},{"type":18,"tag":614,"props":6123,"children":6124},{"class":627},[6125],{"type":24,"value":6126},":m], min_y).reshape(",{"type":18,"tag":614,"props":6128,"children":6129},{"class":671},[6130],{"type":24,"value":701},{"type":18,"tag":614,"props":6132,"children":6133},{"class":627},[6134],{"type":24,"value":2478},{"type":18,"tag":614,"props":6136,"children":6137},{"class":671},[6138],{"type":24,"value":701},{"type":18,"tag":614,"props":6140,"children":6141},{"class":627},[6142],{"type":24,"value":5336},{"type":18,"tag":614,"props":6144,"children":6145},{"class":5339},[6146],{"type":24,"value":5342},{"type":18,"tag":614,"props":6148,"children":6149},{"class":621},[6150],{"type":24,"value":711},{"type":18,"tag":614,"props":6152,"children":6153},{"class":5349},[6154],{"type":24,"value":5352},{"type":18,"tag":614,"props":6156,"children":6157},{"class":627},[6158],{"type":24,"value":1423},{"type":18,"tag":614,"props":6160,"children":6162},{"class":616,"line":6161},55,[6163],{"type":18,"tag":614,"props":6164,"children":6165},{},[6166],{"type":24,"value":650},{"type":18,"tag":614,"props":6168,"children":6170},{"class":616,"line":6169},56,[6171,6175,6179,6183],{"type":18,"tag":614,"props":6172,"children":6173},{"class":671},[6174],{"type":24,"value":701},{"type":18,"tag":614,"props":6176,"children":6177},{"class":627},[6178],{"type":24,"value":2460},{"type":18,"tag":614,"props":6180,"children":6181},{"class":621},[6182],{"type":24,"value":711},{"type":18,"tag":614,"props":6184,"children":6185},{"class":627},[6186],{"type":24,"value":6187}," dU_new\n",{"type":18,"tag":614,"props":6189,"children":6191},{"class":616,"line":6190},57,[6192],{"type":18,"tag":614,"props":6193,"children":6194},{},[6195],{"type":24,"value":650},{"type":18,"tag":614,"props":6197,"children":6199},{"class":616,"line":6198},58,[6200,6204,6208,6213,6217,6221,6225,6229,6233,6237,6241],{"type":18,"tag":614,"props":6201,"children":6202},{"class":627},[6203],{"type":24,"value":2656},{"type":18,"tag":614,"props":6205,"children":6206},{"class":621},[6207],{"type":24,"value":711},{"type":18,"tag":614,"props":6209,"children":6210},{"class":627},[6211],{"type":24,"value":6212}," U ",{"type":18,"tag":614,"props":6214,"children":6215},{"class":621},[6216],{"type":24,"value":1177},{"type":18,"tag":614,"props":6218,"children":6219},{"class":627},[6220],{"type":24,"value":630},{"type":18,"tag":614,"props":6222,"children":6223},{"class":671},[6224],{"type":24,"value":701},{"type":18,"tag":614,"props":6226,"children":6227},{"class":627},[6228],{"type":24,"value":2460},{"type":18,"tag":614,"props":6230,"children":6231},{"class":621},[6232],{"type":24,"value":1056},{"type":18,"tag":614,"props":6234,"children":6235},{"class":627},[6236],{"type":24,"value":630},{"type":18,"tag":614,"props":6238,"children":6239},{"class":671},[6240],{"type":24,"value":701},{"type":18,"tag":614,"props":6242,"children":6243},{"class":627},[6244],{"type":24,"value":4860},{"type":18,"tag":27,"props":6246,"children":6247},{},[6248,6250,6255],{"type":24,"value":6249},"You can look in my code inside function ",{"type":18,"tag":170,"props":6251,"children":6252},{},[6253],{"type":24,"value":6254}," solve_nmpc ",{"type":24,"value":197},{"type":18,"tag":19,"props":6257,"children":6259},{"id":6258},"experiment-in-python",[6260],{"type":24,"value":6261},"Experiment in Python",{"type":18,"tag":27,"props":6263,"children":6264},{},[6265,6267,6270,6272,6275,6277,6281,6283,6287,6289,6293],{"type":24,"value":6266},"GMRES was consider one of the fastest solver for sparse linear algebra problem, so I will include the link for the GMRES algorithms. ",{"type":18,"tag":56,"props":6268,"children":6269},{},[],{"type":24,"value":6271},"\nIn my experiment, I use differential drive robot. ",{"type":18,"tag":56,"props":6273,"children":6274},{},[],{"type":24,"value":6276},"\nConsider as our state representation ",{"type":18,"tag":84,"props":6278,"children":6280},{"latex-express":6279,"styles":87}," x = \\begin{bmatrix} x \\\\ y \\\\ \\phi \\end{bmatrix} ",[],{"type":24,"value":6282}," and of course setting initialization ",{"type":18,"tag":84,"props":6284,"children":6286},{"latex-express":6285,"styles":87}," x_{0} = [0.0, 0.0, 0.0] ",[],{"type":24,"value":6288},", also ",{"type":18,"tag":84,"props":6290,"children":6292},{"latex-express":6291,"styles":87}," u_{0} = [0.0, 0.0] ",[],{"type":24,"value":197},{"type":18,"tag":6295,"props":6296,"children":6301},"figure",{"className":6297},[6298,6299,6300],"mb-4","inline-block","max-w-sm",[6302,6304],{"type":24,"value":6303},"\n  ",{"type":18,"tag":6305,"props":6306,"children":6312},"img",{"className":6307,"src":6309,"width":6310,"height":6311},[6308],"mx-auto","/topics/robotics/nmpc/nmpc_cgmres.gif",700,350,[],{"type":18,"tag":6314,"props":6315,"children":6320},"figcaption",{"className":6316},[68,6317,6318,6319],"text-sm","text-neutral-600","dark:text-neutral-400",[6321],{"type":24,"value":6322},"\n    Animation of Differential Drive robot on optimal trajectory !!!\n",{"type":18,"tag":27,"props":6324,"children":6325},{},[6326],{"type":24,"value":6327},"And here are the optimal data for all state and input control.",{"type":18,"tag":6295,"props":6329,"children":6331},{"className":6330},[6298,6299,6300],[6332,6333],{"type":24,"value":6303},{"type":18,"tag":6305,"props":6334,"children":6339},{"className":6335,"src":6336,"width":6337,"height":6338},[6308],"/topics/robotics/nmpc/cgmreDat1.png",600,300,[],{"type":18,"tag":6314,"props":6341,"children":6343},{"className":6342},[68,6317,6318,6319],[6344],{"type":24,"value":6345},"\n    All data obtained after simulation.\n",{"type":18,"tag":27,"props":6347,"children":6348},{},[6349,6351],{"type":24,"value":6350},"You can find all the code of NMPC even with CasAdi and CGMRES here in my github: ",{"type":18,"tag":6352,"props":6353,"children":6357},"a",{"href":6354,"rel":6355},"https://github.com/SokhengDin/Path-Tracking/tree/main",[6356],"nofollow",[6358],{"type":24,"value":6359},"Path-Tracking",{"type":18,"tag":19,"props":6361,"children":6363},{"id":6362},"in-conclusion",[6364],{"type":24,"value":6365},"In Conclusion",{"type":18,"tag":27,"props":6367,"children":6368},{},[6369],{"type":24,"value":6370},"Nonlinear Model Predictive Control with CGMRES is one of the great NMPC method that you should try, since it provides a very fast numerical calculation thank to the GMRES algorithms with Given Rotation method. Even though compare to another NMPC solver, NMPC with CGMRES sometime is hard for finding the optimal parameters in order to not cause unstable numerical calculation. Next time, I will bring the multiple shooting method which is consider in the promise of more robust numerical stability tha single shooting method.",{"type":18,"tag":19,"props":6372,"children":6374},{"id":6373},"references",[6375],{"type":24,"value":6376},"References",{"type":18,"tag":284,"props":6378,"children":6379},{},[6380,6390,6400,6410,6420],{"type":18,"tag":80,"props":6381,"children":6382},{},[6383],{"type":18,"tag":6352,"props":6384,"children":6387},{"href":6385,"rel":6386},"https://www.researchgate.net/publication/228007717_A_real-time_algorithm_for_nonlinear_receding_horizon_control_using_multiple_shooting_and_continuationKrylov_method",[6356],[6388],{"type":24,"value":6389},"A realtime algorithm for nonlinear receding horizon control using multiple shooting and continuation/Krylov method",{"type":18,"tag":80,"props":6391,"children":6392},{},[6393],{"type":18,"tag":6352,"props":6394,"children":6397},{"href":6395,"rel":6396},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathTracking/cgmres_nmpc",[6356],[6398],{"type":24,"value":6399},"Nonlinear Model Predictive Control with CGMRES of Steering Car ",{"type":18,"tag":80,"props":6401,"children":6402},{},[6403],{"type":18,"tag":6352,"props":6404,"children":6407},{"href":6405,"rel":6406},"https://qiita.com/PozihameBaystar/items/650cc839da5d9c974f5d",[6356],[6408],{"type":24,"value":6409},"C/GMRES3",{"type":18,"tag":80,"props":6411,"children":6412},{},[6413],{"type":18,"tag":6352,"props":6414,"children":6417},{"href":6415,"rel":6416},"https://qiita.com/opticont/items/b3518b470d9e327144be",[6356],[6418],{"type":24,"value":6419},"KrylovGMRES",{"type":18,"tag":80,"props":6421,"children":6422},{},[6423],{"type":18,"tag":6352,"props":6424,"children":6427},{"href":6425,"rel":6426},"https://www.sciencedirect.com/science/article/pii/S2405896318326727",[6356],[6428],{"type":24,"value":6429},"Nonlinear Model Predictive Control of Position and Attitude in a Hexacopter with Three Failed Rotors",{"type":18,"tag":6431,"children":6432},"style",[6433],{"type":24,"value":6434},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-657843{color:#FFAB70;}\n.ct-244866{color:#9ECBFF;}",{"title":8,"searchDepth":644,"depth":644,"links":6436},[6437,6443,6444,6445,6446],{"id":21,"depth":644,"text":25,"children":6438},[6439,6440,6441,6442],{"id":35,"depth":653,"text":38},{"id":46,"depth":653,"text":49},{"id":229,"depth":653,"text":232},{"id":267,"depth":653,"text":270},{"id":574,"depth":644,"text":577},{"id":6258,"depth":644,"text":6261},{"id":6362,"depth":644,"text":6365},{"id":6373,"depth":644,"text":6376},"markdown","content:topics:robotics:nmpc-cgmres.md","content","topics/robotics/nmpc-cgmres.md","md",{"_path":6453,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":6454,"description":6455,"author":11,"slug":6456,"tag":6456,"img":6457,"body":6458,"_type":6447,"_id":10438,"_source":6449,"_file":10439,"_extension":6451},"/topics/robotics/nonlinear-mpc","Nonlinear Model Predictive Control","Introduction to Nonlinear Model Predictive Control","nonlinear-mpc","/topics/robotics/nmpc/predict_horizon.png",{"type":15,"children":6459,"toc":10427},[6460,6464,6468,6489,6495,6501,6514,6519,6524,6529,6533,6538,6577,6582,6586,6591,6639,6645,6657,6661,6666,6671,6676,6681,6685,6689,6694,7877,7883,7888,7892,7896,7901,7905,7911,7916,7920,7936,7940,7944,7948,7954,7966,7998,8003,8532,8537,8713,8722,8977,8982,9995,10000,10348,10354,10359,10369,10375,10380,10385,10391,10423],{"type":18,"tag":19,"props":6461,"children":6462},{"id":35},[6463],{"type":24,"value":38},{"type":18,"tag":27,"props":6465,"children":6466},{},[6467],{"type":24,"value":43},{"type":18,"tag":6469,"props":6470,"children":6477},"div",{"className":6471},[6472,6473,6474,6475,6476],"grid","grid-cols-2","space-x-10","justify-center","items-center",[6478,6479,6483,6484],{"type":24,"value":6303},{"type":18,"tag":6305,"props":6480,"children":6482},{"className":6481,"src":6457,"width":6337,"height":6338},[6308],[],{"type":24,"value":6303},{"type":18,"tag":6305,"props":6485,"children":6488},{"className":6486,"src":6487,"width":6337,"height":6338},[6308],"/topics/robotics/nmpc/set_points.png",[],{"type":18,"tag":6314,"props":6490,"children":6492},{"className":6491},[68,6317,6318,6319],[6493],{"type":24,"value":6494},"\n  A car with finite horizons prediction and set point prediction over finite horizons.\n",{"type":18,"tag":19,"props":6496,"children":6498},{"id":6497},"nonlinear-model-predictive-control",[6499],{"type":24,"value":6500},"Nonlinear Model Predictive Control ?",{"type":18,"tag":27,"props":6502,"children":6503},{},[6504,6506,6509,6511],{"type":24,"value":6505},"Nonlinear Model Predictive Control has the same basic core of its control algorithms. The different is about the mathematical solving over the system. ",{"type":18,"tag":56,"props":6507,"children":6508},{},[],{"type":24,"value":6510},"\nIn the real-life application, most of the system certainly nonlinear and it's more complex than linear model. Linear systems are mostly time-invariant, meaning that the response of the system input is time-independent. Nonlinear systems are time-varying meaning that the response of the system to any input is time-dependent.",{"type":18,"tag":56,"props":6512,"children":6513},{},[],{"type":18,"tag":27,"props":6515,"children":6516},{},[6517],{"type":24,"value":6518},"The system model can be represent as state-space model",{"type":18,"tag":27,"props":6520,"children":6521},{},[6522],{"type":24,"value":6523},"$$ \\dot{X} = f(X,U) $$",{"type":18,"tag":27,"props":6525,"children":6526},{},[6527],{"type":24,"value":6528},"Nonlinear Model Predictive Control also works by solving the quardratic cost subject to the nonlinear function over a future finite horizons. The quadractic cost can be define as",{"type":18,"tag":65,"props":6530,"children":6532},{"latex-express":6531,"styles":68},"J(x,u) = \\displaystyle\\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})",[],{"type":18,"tag":27,"props":6534,"children":6535},{},[6536],{"type":24,"value":6537},"Notation",{"type":18,"tag":76,"props":6539,"children":6540},{},[6541,6550,6559,6568],{"type":18,"tag":80,"props":6542,"children":6543},{},[6544,6548],{"type":18,"tag":84,"props":6545,"children":6547},{"latex-express":6546,"styles":87},"X",[],{"type":24,"value":6549}," is the state of the system. This shall be obtained from the optimiztion problem.",{"type":18,"tag":80,"props":6551,"children":6552},{},[6553,6557],{"type":18,"tag":84,"props":6554,"children":6556},{"latex-express":6555,"styles":87},"X_{ref}",[],{"type":24,"value":6558}," is the reference state of the system or desired input state.",{"type":18,"tag":80,"props":6560,"children":6561},{},[6562,6566],{"type":18,"tag":84,"props":6563,"children":6565},{"latex-express":6564,"styles":87},"U",[],{"type":24,"value":6567}," is the input control of the system. This is a solution obtained from the optimization problem.",{"type":18,"tag":80,"props":6569,"children":6570},{},[6571,6575],{"type":18,"tag":84,"props":6572,"children":6574},{"latex-express":6573,"styles":87},"U_{ref}",[],{"type":24,"value":6576}," is the reference control of the system or desired input control.",{"type":18,"tag":27,"props":6578,"children":6579},{},[6580],{"type":24,"value":6581},"Rewrite the optimization of NMPC problem.",{"type":18,"tag":65,"props":6583,"children":6585},{"latex-express":6584,"styles":68},"\n      \\begin{align*}\n            \\min_{u_{0}, u_{1}, ..., u_{N-1} } \\quad \\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}&Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})\\\\\n            \\text{subject to} \\quad & x_{k+1} = f(x_k, u_k) \\quad \\text{(System dynamics)} \\\\\n            & g(x_k, x_k) \\leq 0 \\quad \\text{(State constraints)} \\\\\n            & h(x_k, x_k) \\leq 0 \\quad \\text{(Input constraints)} \\\\\n            & p(x_k) \\leq 0 \\quad \\text{(Path constraints)} \\\\\n            & x_0=x(0)  \\quad \\text{(Initial condition)}\n      \\end{align*}\n            ",[],{"type":18,"tag":27,"props":6587,"children":6588},{},[6589],{"type":24,"value":6590},"Which,",{"type":18,"tag":76,"props":6592,"children":6593},{},[6594,6603,6612,6621,6629],{"type":18,"tag":80,"props":6595,"children":6596},{},[6597,6601],{"type":18,"tag":84,"props":6598,"children":6600},{"latex-express":6599,"styles":87},"f",[],{"type":24,"value":6602}," is the system dynamics model.",{"type":18,"tag":80,"props":6604,"children":6605},{},[6606,6610],{"type":18,"tag":84,"props":6607,"children":6609},{"latex-express":6608,"styles":87},"g",[],{"type":24,"value":6611}," is the state constraints of the system.",{"type":18,"tag":80,"props":6613,"children":6614},{},[6615,6619],{"type":18,"tag":84,"props":6616,"children":6618},{"latex-express":6617,"styles":87},"h",[],{"type":24,"value":6620}," is the input constraints of the system.",{"type":18,"tag":80,"props":6622,"children":6623},{},[6624,6627],{"type":18,"tag":84,"props":6625,"children":6626},{"latex-express":27,"styles":87},[],{"type":24,"value":6628}," is the path constraint, it help to ensure the safety following path of our system.",{"type":18,"tag":80,"props":6630,"children":6631},{},[6632,6637],{"type":18,"tag":84,"props":6633,"children":6636},{"latex-express":6634,"styles":87,"dist-cond":6635},"\\phi(X_{N})","false",[],{"type":24,"value":6638}," is the terminal cost of the system.",{"type":18,"tag":19,"props":6640,"children":6642},{"id":6641},"discretize-the-system-model-with-runge-kutta-4th-order",[6643],{"type":24,"value":6644},"Discretize the system model with Runge-Kutta 4th order",{"type":18,"tag":27,"props":6646,"children":6647},{},[6648,6650,6655],{"type":24,"value":6649},"I will choose a simple system mode robot ",{"type":18,"tag":170,"props":6651,"children":6652},{},[6653],{"type":24,"value":6654}," DifferentialDrive ",{"type":24,"value":6656},".\nThe forward kinematic equation",{"type":18,"tag":65,"props":6658,"children":6660},{"latex-express":6659,"styles":68},"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix}\n ",[],{"type":18,"tag":27,"props":6662,"children":6663},{},[6664],{"type":24,"value":6665},"State constraints are the restriction imposed on the state variable of the system. It helps our optimizer not to obtain the solution that is outside the boundary region and also ensure the system to always perform the minimal action control in any critical condition.",{"type":18,"tag":27,"props":6667,"children":6668},{},[6669],{"type":24,"value":6670},"We, then can do the approximation",{"type":18,"tag":65,"props":6672,"children":6675},{"latex-express":6673,"styles":68,"dist-cond":6674},"\n    \\begin{align*}\n        k_{1} &= f(x^{*}, u^{*}) \\\\\n        k_{2} &= f(x^{*}+k_{1}\\frac{dt}{2}, u^{*}) \\\\ \n        k_{3} &= f(x^{*}+k_{2}\\frac{dt}{2}, u^{*}) \\\\\n        k_{4} &= f(x^{*}+k_{3}dt, u^{*}) \\\\ \n        \\Rightarrow{x_{k+1} } &= x_{k} + (k_{1}+2k_{2}+2k_{3}+k_{4})\\frac{dt}{6}\n    \\end{align*}\n","true",[],{"type":18,"tag":27,"props":6677,"children":6678},{},[6679],{"type":24,"value":6680},"Let's evaluate it with our model.",{"type":18,"tag":65,"props":6682,"children":6684},{"latex-express":6683,"styles":68},"\n      \\begin{align*}\n        k_{1} &= \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n        k_{2} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{3} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{4} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n    \\end{align*}\n      ",[],{"type":18,"tag":65,"props":6686,"children":6688},{"latex-express":6687,"styles":68},"\n      \\Rightarrow{x_{k+1} } = x_{k} + \\left( \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} + \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix}   \\right) \\frac{dt}{6}\n",[],{"type":18,"tag":27,"props":6690,"children":6691},{},[6692],{"type":24,"value":6693},"How to implement it in Python ???",{"type":18,"tag":599,"props":6695,"children":6698},{"className":6696,"code":6697,"language":604,"meta":8},[602],"import numpy as np\n\n## Define sampling time dt 100Hz\ndt = 0.01\n## Define the num steps for function approximation \nnum_steps = 100\n## Define initial states\nx = 0.0\ny = 0.0\nyaw = 0.0\n## Define input control\nv = 1.5 #m/s\nomega = 1.57 #rad/s\n## Define state represent model\n### define lambda function take variable x\nf = lambda x, u :  np.array([\n      [u[0]*np.cos(x[2])],\n      [u[0]*np.sin(x[2])],\n      [u[1]]\n])\n\nfor _ in range(num_steps):\n    k1 = f([x, y, yaw], [v, omega])\n    k2 = f([x + (dt / 2) * k1[0], y + (dt / 2) * k1[1], yaw + (dt / 2) * k1[2]], [v, omega])\n    k3 = f([x + (dt / 2) * k2[0], y + (dt / 2) * k2[1], yaw + (dt / 2) * k2[2]], [v, omega])\n    k4 = f([x + dt * k3[0], y + dt * k3[1], yaw + dt * k3[2]], [v, omega])\n\n    # Update state of the robot\n    x += (k1[0] + 2 * k2[0] + 2 * k3[0] + k4[0]) * dt / 6\n    y += (k1[1] + 2 * k2[1] + 2 * k3[1] + k4[1]) * dt / 6\n    yaw += (k1[2] + 2 * k2[2] + 2 * k3[2] + k4[2]) * dt / 6\n",[6699],{"type":18,"tag":607,"props":6700,"children":6701},{},[6702],{"type":18,"tag":599,"props":6703,"children":6704},{"__ignoreMap":8},[6705,6728,6735,6743,6763,6771,6792,6800,6821,6841,6861,6869,6899,6928,6936,6944,6970,7004,7036,7052,7059,7066,7095,7112,7254,7391,7481,7488,7500,7628,7752],{"type":18,"tag":614,"props":6706,"children":6707},{"class":616,"line":617},[6708,6713,6718,6723],{"type":18,"tag":614,"props":6709,"children":6710},{"class":621},[6711],{"type":24,"value":6712},"import",{"type":18,"tag":614,"props":6714,"children":6715},{"class":627},[6716],{"type":24,"value":6717}," numpy ",{"type":18,"tag":614,"props":6719,"children":6720},{"class":621},[6721],{"type":24,"value":6722},"as",{"type":18,"tag":614,"props":6724,"children":6725},{"class":627},[6726],{"type":24,"value":6727}," np\n",{"type":18,"tag":614,"props":6729,"children":6730},{"class":616,"line":644},[6731],{"type":18,"tag":614,"props":6732,"children":6733},{},[6734],{"type":24,"value":650},{"type":18,"tag":614,"props":6736,"children":6737},{"class":616,"line":653},[6738],{"type":18,"tag":614,"props":6739,"children":6740},{"class":1851},[6741],{"type":24,"value":6742},"## Define sampling time dt 100Hz\n",{"type":18,"tag":614,"props":6744,"children":6745},{"class":616,"line":682},[6746,6750,6754,6758],{"type":18,"tag":614,"props":6747,"children":6748},{"class":627},[6749],{"type":24,"value":2712},{"type":18,"tag":614,"props":6751,"children":6752},{"class":621},[6753],{"type":24,"value":711},{"type":18,"tag":614,"props":6755,"children":6756},{"class":627},[6757],{"type":24,"value":630},{"type":18,"tag":614,"props":6759,"children":6760},{"class":671},[6761],{"type":24,"value":6762},"0.01\n",{"type":18,"tag":614,"props":6764,"children":6765},{"class":616,"line":690},[6766],{"type":18,"tag":614,"props":6767,"children":6768},{"class":1851},[6769],{"type":24,"value":6770},"## Define the num steps for function approximation \n",{"type":18,"tag":614,"props":6772,"children":6773},{"class":616,"line":719},[6774,6779,6783,6787],{"type":18,"tag":614,"props":6775,"children":6776},{"class":627},[6777],{"type":24,"value":6778},"num_steps ",{"type":18,"tag":614,"props":6780,"children":6781},{"class":621},[6782],{"type":24,"value":711},{"type":18,"tag":614,"props":6784,"children":6785},{"class":627},[6786],{"type":24,"value":630},{"type":18,"tag":614,"props":6788,"children":6789},{"class":671},[6790],{"type":24,"value":6791},"100\n",{"type":18,"tag":614,"props":6793,"children":6794},{"class":616,"line":745},[6795],{"type":18,"tag":614,"props":6796,"children":6797},{"class":1851},[6798],{"type":24,"value":6799},"## Define initial states\n",{"type":18,"tag":614,"props":6801,"children":6802},{"class":616,"line":771},[6803,6808,6812,6816],{"type":18,"tag":614,"props":6804,"children":6805},{"class":627},[6806],{"type":24,"value":6807},"x ",{"type":18,"tag":614,"props":6809,"children":6810},{"class":621},[6811],{"type":24,"value":711},{"type":18,"tag":614,"props":6813,"children":6814},{"class":627},[6815],{"type":24,"value":630},{"type":18,"tag":614,"props":6817,"children":6818},{"class":671},[6819],{"type":24,"value":6820},"0.0\n",{"type":18,"tag":614,"props":6822,"children":6823},{"class":616,"line":779},[6824,6829,6833,6837],{"type":18,"tag":614,"props":6825,"children":6826},{"class":627},[6827],{"type":24,"value":6828},"y ",{"type":18,"tag":614,"props":6830,"children":6831},{"class":621},[6832],{"type":24,"value":711},{"type":18,"tag":614,"props":6834,"children":6835},{"class":627},[6836],{"type":24,"value":630},{"type":18,"tag":614,"props":6838,"children":6839},{"class":671},[6840],{"type":24,"value":6820},{"type":18,"tag":614,"props":6842,"children":6843},{"class":616,"line":805},[6844,6849,6853,6857],{"type":18,"tag":614,"props":6845,"children":6846},{"class":627},[6847],{"type":24,"value":6848},"yaw ",{"type":18,"tag":614,"props":6850,"children":6851},{"class":621},[6852],{"type":24,"value":711},{"type":18,"tag":614,"props":6854,"children":6855},{"class":627},[6856],{"type":24,"value":630},{"type":18,"tag":614,"props":6858,"children":6859},{"class":671},[6860],{"type":24,"value":6820},{"type":18,"tag":614,"props":6862,"children":6863},{"class":616,"line":831},[6864],{"type":18,"tag":614,"props":6865,"children":6866},{"class":1851},[6867],{"type":24,"value":6868},"## Define input control\n",{"type":18,"tag":614,"props":6870,"children":6871},{"class":616,"line":839},[6872,6877,6881,6885,6890,6894],{"type":18,"tag":614,"props":6873,"children":6874},{"class":627},[6875],{"type":24,"value":6876},"v ",{"type":18,"tag":614,"props":6878,"children":6879},{"class":621},[6880],{"type":24,"value":711},{"type":18,"tag":614,"props":6882,"children":6883},{"class":627},[6884],{"type":24,"value":630},{"type":18,"tag":614,"props":6886,"children":6887},{"class":671},[6888],{"type":24,"value":6889},"1.5",{"type":18,"tag":614,"props":6891,"children":6892},{"class":627},[6893],{"type":24,"value":630},{"type":18,"tag":614,"props":6895,"children":6896},{"class":1851},[6897],{"type":24,"value":6898},"#m/s\n",{"type":18,"tag":614,"props":6900,"children":6901},{"class":616,"line":875},[6902,6907,6911,6915,6919,6923],{"type":18,"tag":614,"props":6903,"children":6904},{"class":627},[6905],{"type":24,"value":6906},"omega ",{"type":18,"tag":614,"props":6908,"children":6909},{"class":621},[6910],{"type":24,"value":711},{"type":18,"tag":614,"props":6912,"children":6913},{"class":627},[6914],{"type":24,"value":630},{"type":18,"tag":614,"props":6916,"children":6917},{"class":671},[6918],{"type":24,"value":2378},{"type":18,"tag":614,"props":6920,"children":6921},{"class":627},[6922],{"type":24,"value":630},{"type":18,"tag":614,"props":6924,"children":6925},{"class":1851},[6926],{"type":24,"value":6927},"#rad/s\n",{"type":18,"tag":614,"props":6929,"children":6930},{"class":616,"line":908},[6931],{"type":18,"tag":614,"props":6932,"children":6933},{"class":1851},[6934],{"type":24,"value":6935},"## Define state represent model\n",{"type":18,"tag":614,"props":6937,"children":6938},{"class":616,"line":916},[6939],{"type":18,"tag":614,"props":6940,"children":6941},{"class":1851},[6942],{"type":24,"value":6943},"### define lambda function take variable x\n",{"type":18,"tag":614,"props":6945,"children":6946},{"class":616,"line":950},[6947,6952,6956,6960,6965],{"type":18,"tag":614,"props":6948,"children":6949},{"class":627},[6950],{"type":24,"value":6951},"f ",{"type":18,"tag":614,"props":6953,"children":6954},{"class":621},[6955],{"type":24,"value":711},{"type":18,"tag":614,"props":6957,"children":6958},{"class":627},[6959],{"type":24,"value":630},{"type":18,"tag":614,"props":6961,"children":6962},{"class":621},[6963],{"type":24,"value":6964},"lambda",{"type":18,"tag":614,"props":6966,"children":6967},{"class":627},[6968],{"type":24,"value":6969}," x, u :  np.array([\n",{"type":18,"tag":614,"props":6971,"children":6972},{"class":616,"line":984},[6973,6978,6982,6986,6990,6995,6999],{"type":18,"tag":614,"props":6974,"children":6975},{"class":627},[6976],{"type":24,"value":6977},"      [u[",{"type":18,"tag":614,"props":6979,"children":6980},{"class":671},[6981],{"type":24,"value":867},{"type":18,"tag":614,"props":6983,"children":6984},{"class":627},[6985],{"type":24,"value":2597},{"type":18,"tag":614,"props":6987,"children":6988},{"class":621},[6989],{"type":24,"value":1056},{"type":18,"tag":614,"props":6991,"children":6992},{"class":627},[6993],{"type":24,"value":6994},"np.cos(x[",{"type":18,"tag":614,"props":6996,"children":6997},{"class":671},[6998],{"type":24,"value":1353},{"type":18,"tag":614,"props":7000,"children":7001},{"class":627},[7002],{"type":24,"value":7003},"])],\n",{"type":18,"tag":614,"props":7005,"children":7006},{"class":616,"line":992},[7007,7011,7015,7019,7023,7028,7032],{"type":18,"tag":614,"props":7008,"children":7009},{"class":627},[7010],{"type":24,"value":6977},{"type":18,"tag":614,"props":7012,"children":7013},{"class":671},[7014],{"type":24,"value":867},{"type":18,"tag":614,"props":7016,"children":7017},{"class":627},[7018],{"type":24,"value":2597},{"type":18,"tag":614,"props":7020,"children":7021},{"class":621},[7022],{"type":24,"value":1056},{"type":18,"tag":614,"props":7024,"children":7025},{"class":627},[7026],{"type":24,"value":7027},"np.sin(x[",{"type":18,"tag":614,"props":7029,"children":7030},{"class":671},[7031],{"type":24,"value":1353},{"type":18,"tag":614,"props":7033,"children":7034},{"class":627},[7035],{"type":24,"value":7003},{"type":18,"tag":614,"props":7037,"children":7038},{"class":616,"line":1018},[7039,7043,7047],{"type":18,"tag":614,"props":7040,"children":7041},{"class":627},[7042],{"type":24,"value":6977},{"type":18,"tag":614,"props":7044,"children":7045},{"class":671},[7046],{"type":24,"value":977},{"type":18,"tag":614,"props":7048,"children":7049},{"class":627},[7050],{"type":24,"value":7051},"]]\n",{"type":18,"tag":614,"props":7053,"children":7054},{"class":616,"line":1026},[7055],{"type":18,"tag":614,"props":7056,"children":7057},{"class":627},[7058],{"type":24,"value":3280},{"type":18,"tag":614,"props":7060,"children":7061},{"class":616,"line":1068},[7062],{"type":18,"tag":614,"props":7063,"children":7064},{},[7065],{"type":24,"value":650},{"type":18,"tag":614,"props":7067,"children":7068},{"class":616,"line":1108},[7069,7073,7078,7082,7086,7090],{"type":18,"tag":614,"props":7070,"children":7071},{"class":621},[7072],{"type":24,"value":2790},{"type":18,"tag":614,"props":7074,"children":7075},{"class":627},[7076],{"type":24,"value":7077}," _ ",{"type":18,"tag":614,"props":7079,"children":7080},{"class":621},[7081],{"type":24,"value":2800},{"type":18,"tag":614,"props":7083,"children":7084},{"class":627},[7085],{"type":24,"value":630},{"type":18,"tag":614,"props":7087,"children":7088},{"class":671},[7089],{"type":24,"value":2809},{"type":18,"tag":614,"props":7091,"children":7092},{"class":627},[7093],{"type":24,"value":7094},"(num_steps):\n",{"type":18,"tag":614,"props":7096,"children":7097},{"class":616,"line":1202},[7098,7103,7107],{"type":18,"tag":614,"props":7099,"children":7100},{"class":627},[7101],{"type":24,"value":7102},"    k1 ",{"type":18,"tag":614,"props":7104,"children":7105},{"class":621},[7106],{"type":24,"value":711},{"type":18,"tag":614,"props":7108,"children":7109},{"class":627},[7110],{"type":24,"value":7111}," f([x, y, yaw], [v, omega])\n",{"type":18,"tag":614,"props":7113,"children":7114},{"class":616,"line":1210},[7115,7120,7124,7129,7133,7138,7142,7146,7150,7154,7158,7163,7167,7172,7176,7180,7184,7188,7192,7196,7200,7204,7208,7213,7217,7221,7225,7229,7233,7237,7241,7245,7249],{"type":18,"tag":614,"props":7116,"children":7117},{"class":627},[7118],{"type":24,"value":7119},"    k2 ",{"type":18,"tag":614,"props":7121,"children":7122},{"class":621},[7123],{"type":24,"value":711},{"type":18,"tag":614,"props":7125,"children":7126},{"class":627},[7127],{"type":24,"value":7128}," f([x ",{"type":18,"tag":614,"props":7130,"children":7131},{"class":621},[7132],{"type":24,"value":1177},{"type":18,"tag":614,"props":7134,"children":7135},{"class":627},[7136],{"type":24,"value":7137}," (dt ",{"type":18,"tag":614,"props":7139,"children":7140},{"class":621},[7141],{"type":24,"value":1414},{"type":18,"tag":614,"props":7143,"children":7144},{"class":627},[7145],{"type":24,"value":630},{"type":18,"tag":614,"props":7147,"children":7148},{"class":671},[7149],{"type":24,"value":1353},{"type":18,"tag":614,"props":7151,"children":7152},{"class":627},[7153],{"type":24,"value":5357},{"type":18,"tag":614,"props":7155,"children":7156},{"class":621},[7157],{"type":24,"value":1056},{"type":18,"tag":614,"props":7159,"children":7160},{"class":627},[7161],{"type":24,"value":7162}," k1[",{"type":18,"tag":614,"props":7164,"children":7165},{"class":671},[7166],{"type":24,"value":867},{"type":18,"tag":614,"props":7168,"children":7169},{"class":627},[7170],{"type":24,"value":7171},"], y ",{"type":18,"tag":614,"props":7173,"children":7174},{"class":621},[7175],{"type":24,"value":1177},{"type":18,"tag":614,"props":7177,"children":7178},{"class":627},[7179],{"type":24,"value":7137},{"type":18,"tag":614,"props":7181,"children":7182},{"class":621},[7183],{"type":24,"value":1414},{"type":18,"tag":614,"props":7185,"children":7186},{"class":627},[7187],{"type":24,"value":630},{"type":18,"tag":614,"props":7189,"children":7190},{"class":671},[7191],{"type":24,"value":1353},{"type":18,"tag":614,"props":7193,"children":7194},{"class":627},[7195],{"type":24,"value":5357},{"type":18,"tag":614,"props":7197,"children":7198},{"class":621},[7199],{"type":24,"value":1056},{"type":18,"tag":614,"props":7201,"children":7202},{"class":627},[7203],{"type":24,"value":7162},{"type":18,"tag":614,"props":7205,"children":7206},{"class":671},[7207],{"type":24,"value":977},{"type":18,"tag":614,"props":7209,"children":7210},{"class":627},[7211],{"type":24,"value":7212},"], yaw ",{"type":18,"tag":614,"props":7214,"children":7215},{"class":621},[7216],{"type":24,"value":1177},{"type":18,"tag":614,"props":7218,"children":7219},{"class":627},[7220],{"type":24,"value":7137},{"type":18,"tag":614,"props":7222,"children":7223},{"class":621},[7224],{"type":24,"value":1414},{"type":18,"tag":614,"props":7226,"children":7227},{"class":627},[7228],{"type":24,"value":630},{"type":18,"tag":614,"props":7230,"children":7231},{"class":671},[7232],{"type":24,"value":1353},{"type":18,"tag":614,"props":7234,"children":7235},{"class":627},[7236],{"type":24,"value":5357},{"type":18,"tag":614,"props":7238,"children":7239},{"class":621},[7240],{"type":24,"value":1056},{"type":18,"tag":614,"props":7242,"children":7243},{"class":627},[7244],{"type":24,"value":7162},{"type":18,"tag":614,"props":7246,"children":7247},{"class":671},[7248],{"type":24,"value":1353},{"type":18,"tag":614,"props":7250,"children":7251},{"class":627},[7252],{"type":24,"value":7253},"]], [v, omega])\n",{"type":18,"tag":614,"props":7255,"children":7256},{"class":616,"line":1228},[7257,7262,7266,7270,7274,7278,7282,7286,7290,7294,7298,7303,7307,7311,7315,7319,7323,7327,7331,7335,7339,7343,7347,7351,7355,7359,7363,7367,7371,7375,7379,7383,7387],{"type":18,"tag":614,"props":7258,"children":7259},{"class":627},[7260],{"type":24,"value":7261},"    k3 ",{"type":18,"tag":614,"props":7263,"children":7264},{"class":621},[7265],{"type":24,"value":711},{"type":18,"tag":614,"props":7267,"children":7268},{"class":627},[7269],{"type":24,"value":7128},{"type":18,"tag":614,"props":7271,"children":7272},{"class":621},[7273],{"type":24,"value":1177},{"type":18,"tag":614,"props":7275,"children":7276},{"class":627},[7277],{"type":24,"value":7137},{"type":18,"tag":614,"props":7279,"children":7280},{"class":621},[7281],{"type":24,"value":1414},{"type":18,"tag":614,"props":7283,"children":7284},{"class":627},[7285],{"type":24,"value":630},{"type":18,"tag":614,"props":7287,"children":7288},{"class":671},[7289],{"type":24,"value":1353},{"type":18,"tag":614,"props":7291,"children":7292},{"class":627},[7293],{"type":24,"value":5357},{"type":18,"tag":614,"props":7295,"children":7296},{"class":621},[7297],{"type":24,"value":1056},{"type":18,"tag":614,"props":7299,"children":7300},{"class":627},[7301],{"type":24,"value":7302}," k2[",{"type":18,"tag":614,"props":7304,"children":7305},{"class":671},[7306],{"type":24,"value":867},{"type":18,"tag":614,"props":7308,"children":7309},{"class":627},[7310],{"type":24,"value":7171},{"type":18,"tag":614,"props":7312,"children":7313},{"class":621},[7314],{"type":24,"value":1177},{"type":18,"tag":614,"props":7316,"children":7317},{"class":627},[7318],{"type":24,"value":7137},{"type":18,"tag":614,"props":7320,"children":7321},{"class":621},[7322],{"type":24,"value":1414},{"type":18,"tag":614,"props":7324,"children":7325},{"class":627},[7326],{"type":24,"value":630},{"type":18,"tag":614,"props":7328,"children":7329},{"class":671},[7330],{"type":24,"value":1353},{"type":18,"tag":614,"props":7332,"children":7333},{"class":627},[7334],{"type":24,"value":5357},{"type":18,"tag":614,"props":7336,"children":7337},{"class":621},[7338],{"type":24,"value":1056},{"type":18,"tag":614,"props":7340,"children":7341},{"class":627},[7342],{"type":24,"value":7302},{"type":18,"tag":614,"props":7344,"children":7345},{"class":671},[7346],{"type":24,"value":977},{"type":18,"tag":614,"props":7348,"children":7349},{"class":627},[7350],{"type":24,"value":7212},{"type":18,"tag":614,"props":7352,"children":7353},{"class":621},[7354],{"type":24,"value":1177},{"type":18,"tag":614,"props":7356,"children":7357},{"class":627},[7358],{"type":24,"value":7137},{"type":18,"tag":614,"props":7360,"children":7361},{"class":621},[7362],{"type":24,"value":1414},{"type":18,"tag":614,"props":7364,"children":7365},{"class":627},[7366],{"type":24,"value":630},{"type":18,"tag":614,"props":7368,"children":7369},{"class":671},[7370],{"type":24,"value":1353},{"type":18,"tag":614,"props":7372,"children":7373},{"class":627},[7374],{"type":24,"value":5357},{"type":18,"tag":614,"props":7376,"children":7377},{"class":621},[7378],{"type":24,"value":1056},{"type":18,"tag":614,"props":7380,"children":7381},{"class":627},[7382],{"type":24,"value":7302},{"type":18,"tag":614,"props":7384,"children":7385},{"class":671},[7386],{"type":24,"value":1353},{"type":18,"tag":614,"props":7388,"children":7389},{"class":627},[7390],{"type":24,"value":7253},{"type":18,"tag":614,"props":7392,"children":7393},{"class":616,"line":1236},[7394,7399,7403,7407,7411,7416,7420,7425,7429,7433,7437,7441,7445,7449,7453,7457,7461,7465,7469,7473,7477],{"type":18,"tag":614,"props":7395,"children":7396},{"class":627},[7397],{"type":24,"value":7398},"    k4 ",{"type":18,"tag":614,"props":7400,"children":7401},{"class":621},[7402],{"type":24,"value":711},{"type":18,"tag":614,"props":7404,"children":7405},{"class":627},[7406],{"type":24,"value":7128},{"type":18,"tag":614,"props":7408,"children":7409},{"class":621},[7410],{"type":24,"value":1177},{"type":18,"tag":614,"props":7412,"children":7413},{"class":627},[7414],{"type":24,"value":7415}," dt ",{"type":18,"tag":614,"props":7417,"children":7418},{"class":621},[7419],{"type":24,"value":1056},{"type":18,"tag":614,"props":7421,"children":7422},{"class":627},[7423],{"type":24,"value":7424}," k3[",{"type":18,"tag":614,"props":7426,"children":7427},{"class":671},[7428],{"type":24,"value":867},{"type":18,"tag":614,"props":7430,"children":7431},{"class":627},[7432],{"type":24,"value":7171},{"type":18,"tag":614,"props":7434,"children":7435},{"class":621},[7436],{"type":24,"value":1177},{"type":18,"tag":614,"props":7438,"children":7439},{"class":627},[7440],{"type":24,"value":7415},{"type":18,"tag":614,"props":7442,"children":7443},{"class":621},[7444],{"type":24,"value":1056},{"type":18,"tag":614,"props":7446,"children":7447},{"class":627},[7448],{"type":24,"value":7424},{"type":18,"tag":614,"props":7450,"children":7451},{"class":671},[7452],{"type":24,"value":977},{"type":18,"tag":614,"props":7454,"children":7455},{"class":627},[7456],{"type":24,"value":7212},{"type":18,"tag":614,"props":7458,"children":7459},{"class":621},[7460],{"type":24,"value":1177},{"type":18,"tag":614,"props":7462,"children":7463},{"class":627},[7464],{"type":24,"value":7415},{"type":18,"tag":614,"props":7466,"children":7467},{"class":621},[7468],{"type":24,"value":1056},{"type":18,"tag":614,"props":7470,"children":7471},{"class":627},[7472],{"type":24,"value":7424},{"type":18,"tag":614,"props":7474,"children":7475},{"class":671},[7476],{"type":24,"value":1353},{"type":18,"tag":614,"props":7478,"children":7479},{"class":627},[7480],{"type":24,"value":7253},{"type":18,"tag":614,"props":7482,"children":7483},{"class":616,"line":1262},[7484],{"type":18,"tag":614,"props":7485,"children":7486},{},[7487],{"type":24,"value":650},{"type":18,"tag":614,"props":7489,"children":7490},{"class":616,"line":1270},[7491,7495],{"type":18,"tag":614,"props":7492,"children":7493},{"class":627},[7494],{"type":24,"value":659},{"type":18,"tag":614,"props":7496,"children":7497},{"class":1851},[7498],{"type":24,"value":7499},"# Update state of the robot\n",{"type":18,"tag":614,"props":7501,"children":7502},{"class":616,"line":1426},[7503,7508,7513,7518,7522,7526,7530,7534,7538,7542,7546,7550,7554,7558,7562,7566,7570,7574,7578,7582,7586,7590,7594,7599,7603,7608,7612,7616,7620,7624],{"type":18,"tag":614,"props":7504,"children":7505},{"class":627},[7506],{"type":24,"value":7507},"    x ",{"type":18,"tag":614,"props":7509,"children":7510},{"class":621},[7511],{"type":24,"value":7512},"+=",{"type":18,"tag":614,"props":7514,"children":7515},{"class":627},[7516],{"type":24,"value":7517}," (k1[",{"type":18,"tag":614,"props":7519,"children":7520},{"class":671},[7521],{"type":24,"value":867},{"type":18,"tag":614,"props":7523,"children":7524},{"class":627},[7525],{"type":24,"value":2911},{"type":18,"tag":614,"props":7527,"children":7528},{"class":621},[7529],{"type":24,"value":1177},{"type":18,"tag":614,"props":7531,"children":7532},{"class":627},[7533],{"type":24,"value":630},{"type":18,"tag":614,"props":7535,"children":7536},{"class":671},[7537],{"type":24,"value":1353},{"type":18,"tag":614,"props":7539,"children":7540},{"class":627},[7541],{"type":24,"value":630},{"type":18,"tag":614,"props":7543,"children":7544},{"class":621},[7545],{"type":24,"value":1056},{"type":18,"tag":614,"props":7547,"children":7548},{"class":627},[7549],{"type":24,"value":7302},{"type":18,"tag":614,"props":7551,"children":7552},{"class":671},[7553],{"type":24,"value":867},{"type":18,"tag":614,"props":7555,"children":7556},{"class":627},[7557],{"type":24,"value":2911},{"type":18,"tag":614,"props":7559,"children":7560},{"class":621},[7561],{"type":24,"value":1177},{"type":18,"tag":614,"props":7563,"children":7564},{"class":627},[7565],{"type":24,"value":630},{"type":18,"tag":614,"props":7567,"children":7568},{"class":671},[7569],{"type":24,"value":1353},{"type":18,"tag":614,"props":7571,"children":7572},{"class":627},[7573],{"type":24,"value":630},{"type":18,"tag":614,"props":7575,"children":7576},{"class":621},[7577],{"type":24,"value":1056},{"type":18,"tag":614,"props":7579,"children":7580},{"class":627},[7581],{"type":24,"value":7424},{"type":18,"tag":614,"props":7583,"children":7584},{"class":671},[7585],{"type":24,"value":867},{"type":18,"tag":614,"props":7587,"children":7588},{"class":627},[7589],{"type":24,"value":2911},{"type":18,"tag":614,"props":7591,"children":7592},{"class":621},[7593],{"type":24,"value":1177},{"type":18,"tag":614,"props":7595,"children":7596},{"class":627},[7597],{"type":24,"value":7598}," k4[",{"type":18,"tag":614,"props":7600,"children":7601},{"class":671},[7602],{"type":24,"value":867},{"type":18,"tag":614,"props":7604,"children":7605},{"class":627},[7606],{"type":24,"value":7607},"]) ",{"type":18,"tag":614,"props":7609,"children":7610},{"class":621},[7611],{"type":24,"value":1056},{"type":18,"tag":614,"props":7613,"children":7614},{"class":627},[7615],{"type":24,"value":7415},{"type":18,"tag":614,"props":7617,"children":7618},{"class":621},[7619],{"type":24,"value":1414},{"type":18,"tag":614,"props":7621,"children":7622},{"class":627},[7623],{"type":24,"value":630},{"type":18,"tag":614,"props":7625,"children":7626},{"class":671},[7627],{"type":24,"value":2198},{"type":18,"tag":614,"props":7629,"children":7630},{"class":616,"line":1546},[7631,7636,7640,7644,7648,7652,7656,7660,7664,7668,7672,7676,7680,7684,7688,7692,7696,7700,7704,7708,7712,7716,7720,7724,7728,7732,7736,7740,7744,7748],{"type":18,"tag":614,"props":7632,"children":7633},{"class":627},[7634],{"type":24,"value":7635},"    y ",{"type":18,"tag":614,"props":7637,"children":7638},{"class":621},[7639],{"type":24,"value":7512},{"type":18,"tag":614,"props":7641,"children":7642},{"class":627},[7643],{"type":24,"value":7517},{"type":18,"tag":614,"props":7645,"children":7646},{"class":671},[7647],{"type":24,"value":977},{"type":18,"tag":614,"props":7649,"children":7650},{"class":627},[7651],{"type":24,"value":2911},{"type":18,"tag":614,"props":7653,"children":7654},{"class":621},[7655],{"type":24,"value":1177},{"type":18,"tag":614,"props":7657,"children":7658},{"class":627},[7659],{"type":24,"value":630},{"type":18,"tag":614,"props":7661,"children":7662},{"class":671},[7663],{"type":24,"value":1353},{"type":18,"tag":614,"props":7665,"children":7666},{"class":627},[7667],{"type":24,"value":630},{"type":18,"tag":614,"props":7669,"children":7670},{"class":621},[7671],{"type":24,"value":1056},{"type":18,"tag":614,"props":7673,"children":7674},{"class":627},[7675],{"type":24,"value":7302},{"type":18,"tag":614,"props":7677,"children":7678},{"class":671},[7679],{"type":24,"value":977},{"type":18,"tag":614,"props":7681,"children":7682},{"class":627},[7683],{"type":24,"value":2911},{"type":18,"tag":614,"props":7685,"children":7686},{"class":621},[7687],{"type":24,"value":1177},{"type":18,"tag":614,"props":7689,"children":7690},{"class":627},[7691],{"type":24,"value":630},{"type":18,"tag":614,"props":7693,"children":7694},{"class":671},[7695],{"type":24,"value":1353},{"type":18,"tag":614,"props":7697,"children":7698},{"class":627},[7699],{"type":24,"value":630},{"type":18,"tag":614,"props":7701,"children":7702},{"class":621},[7703],{"type":24,"value":1056},{"type":18,"tag":614,"props":7705,"children":7706},{"class":627},[7707],{"type":24,"value":7424},{"type":18,"tag":614,"props":7709,"children":7710},{"class":671},[7711],{"type":24,"value":977},{"type":18,"tag":614,"props":7713,"children":7714},{"class":627},[7715],{"type":24,"value":2911},{"type":18,"tag":614,"props":7717,"children":7718},{"class":621},[7719],{"type":24,"value":1177},{"type":18,"tag":614,"props":7721,"children":7722},{"class":627},[7723],{"type":24,"value":7598},{"type":18,"tag":614,"props":7725,"children":7726},{"class":671},[7727],{"type":24,"value":977},{"type":18,"tag":614,"props":7729,"children":7730},{"class":627},[7731],{"type":24,"value":7607},{"type":18,"tag":614,"props":7733,"children":7734},{"class":621},[7735],{"type":24,"value":1056},{"type":18,"tag":614,"props":7737,"children":7738},{"class":627},[7739],{"type":24,"value":7415},{"type":18,"tag":614,"props":7741,"children":7742},{"class":621},[7743],{"type":24,"value":1414},{"type":18,"tag":614,"props":7745,"children":7746},{"class":627},[7747],{"type":24,"value":630},{"type":18,"tag":614,"props":7749,"children":7750},{"class":671},[7751],{"type":24,"value":2198},{"type":18,"tag":614,"props":7753,"children":7754},{"class":616,"line":1554},[7755,7760,7764,7768,7772,7776,7780,7784,7788,7792,7796,7800,7804,7808,7812,7816,7820,7824,7828,7832,7836,7840,7844,7848,7852,7856,7860,7864,7868,7872],{"type":18,"tag":614,"props":7756,"children":7757},{"class":627},[7758],{"type":24,"value":7759},"    yaw ",{"type":18,"tag":614,"props":7761,"children":7762},{"class":621},[7763],{"type":24,"value":7512},{"type":18,"tag":614,"props":7765,"children":7766},{"class":627},[7767],{"type":24,"value":7517},{"type":18,"tag":614,"props":7769,"children":7770},{"class":671},[7771],{"type":24,"value":1353},{"type":18,"tag":614,"props":7773,"children":7774},{"class":627},[7775],{"type":24,"value":2911},{"type":18,"tag":614,"props":7777,"children":7778},{"class":621},[7779],{"type":24,"value":1177},{"type":18,"tag":614,"props":7781,"children":7782},{"class":627},[7783],{"type":24,"value":630},{"type":18,"tag":614,"props":7785,"children":7786},{"class":671},[7787],{"type":24,"value":1353},{"type":18,"tag":614,"props":7789,"children":7790},{"class":627},[7791],{"type":24,"value":630},{"type":18,"tag":614,"props":7793,"children":7794},{"class":621},[7795],{"type":24,"value":1056},{"type":18,"tag":614,"props":7797,"children":7798},{"class":627},[7799],{"type":24,"value":7302},{"type":18,"tag":614,"props":7801,"children":7802},{"class":671},[7803],{"type":24,"value":1353},{"type":18,"tag":614,"props":7805,"children":7806},{"class":627},[7807],{"type":24,"value":2911},{"type":18,"tag":614,"props":7809,"children":7810},{"class":621},[7811],{"type":24,"value":1177},{"type":18,"tag":614,"props":7813,"children":7814},{"class":627},[7815],{"type":24,"value":630},{"type":18,"tag":614,"props":7817,"children":7818},{"class":671},[7819],{"type":24,"value":1353},{"type":18,"tag":614,"props":7821,"children":7822},{"class":627},[7823],{"type":24,"value":630},{"type":18,"tag":614,"props":7825,"children":7826},{"class":621},[7827],{"type":24,"value":1056},{"type":18,"tag":614,"props":7829,"children":7830},{"class":627},[7831],{"type":24,"value":7424},{"type":18,"tag":614,"props":7833,"children":7834},{"class":671},[7835],{"type":24,"value":1353},{"type":18,"tag":614,"props":7837,"children":7838},{"class":627},[7839],{"type":24,"value":2911},{"type":18,"tag":614,"props":7841,"children":7842},{"class":621},[7843],{"type":24,"value":1177},{"type":18,"tag":614,"props":7845,"children":7846},{"class":627},[7847],{"type":24,"value":7598},{"type":18,"tag":614,"props":7849,"children":7850},{"class":671},[7851],{"type":24,"value":1353},{"type":18,"tag":614,"props":7853,"children":7854},{"class":627},[7855],{"type":24,"value":7607},{"type":18,"tag":614,"props":7857,"children":7858},{"class":621},[7859],{"type":24,"value":1056},{"type":18,"tag":614,"props":7861,"children":7862},{"class":627},[7863],{"type":24,"value":7415},{"type":18,"tag":614,"props":7865,"children":7866},{"class":621},[7867],{"type":24,"value":1414},{"type":18,"tag":614,"props":7869,"children":7870},{"class":627},[7871],{"type":24,"value":630},{"type":18,"tag":614,"props":7873,"children":7874},{"class":671},[7875],{"type":24,"value":7876},"6",{"type":18,"tag":19,"props":7878,"children":7880},{"id":7879},"single-shooting-method",[7881],{"type":24,"value":7882},"Single Shooting Method",{"type":18,"tag":27,"props":7884,"children":7885},{},[7886],{"type":24,"value":7887},"Single Shooting Method is a method that we transform the optimal control problem to the nonlinear programming problem with just one decision variable.",{"type":18,"tag":65,"props":7889,"children":7891},{"latex-express":7890,"styles":68},"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}\\right]\n        \\end{align*}\n",[],{"type":18,"tag":65,"props":7893,"children":7895},{"latex-express":7894,"styles":68},"\n      \\begin{align*}\n            x_{u} &= F(w,x_{0},t_{k}) \\\\\n            F(w,x_{0},t_{0}) &= x_{0} \\\\\n        \\end{align*}\n",[],{"type":18,"tag":27,"props":7897,"children":7898},{},[7899],{"type":24,"value":7900},"Then solve the NLP",{"type":18,"tag":65,"props":7902,"children":7904},{"latex-express":7903,"styles":68},"\n      \\begin{align*}\n            \\min_{w}\\Phi(F(w,x_{0},t_{k}), w) \\\\ \n            \\text{Subject to} \\hspace{1cm}  g_{1}(F(w,x_{0},t_{k}),w) \\leq{0}\n        \\end{align*}\n",[],{"type":18,"tag":19,"props":7906,"children":7908},{"id":7907},"multiple-shooting-method",[7909],{"type":24,"value":7910},"Multiple Shooting Method",{"type":18,"tag":27,"props":7912,"children":7913},{},[7914],{"type":24,"value":7915},"Multiple Shooting Method is a method that consist of transforming of optimal control problem to the nonlinear programming problem with multiple decision variables.",{"type":18,"tag":65,"props":7917,"children":7919},{"latex-express":7918,"styles":68},"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}, x_{0}, ..., x_{N}\\right]\n        \\end{align*}\n",[],{"type":18,"tag":76,"props":7921,"children":7922},{},[7923,7931],{"type":18,"tag":80,"props":7924,"children":7925},{},[7926,7929],{"type":18,"tag":84,"props":7927,"children":7928},{"latex-express":6546,"styles":87},[],{"type":24,"value":7930}," becoming decision variable in the opimization problem as well as u",{"type":18,"tag":80,"props":7932,"children":7933},{},[7934],{"type":24,"value":7935},"We apply path constraint at each iteration step",{"type":18,"tag":65,"props":7937,"children":7939},{"latex-express":7938,"styles":68},"\n      \\begin{equation*}\n                x_{k+1}-f(x_{k},u_{k}) = 0\n            \\end{equation*}\n",[],{"type":18,"tag":27,"props":7941,"children":7942},{},[7943],{"type":24,"value":7900},{"type":18,"tag":65,"props":7945,"children":7947},{"latex-express":7946,"styles":68},"\n      \\begin{align*}\n            \\min_{w}  \\Phi(F(w,x_{0},t_{k}),& w) \\\\ \n            \\text{s.t}\\hspace{0.5cm}  g_{1}(F(w,x_{0},t_{k}),w) &\\leq{0} \\\\ \n                               g_{2}(w) = \\begin{bmatrix}\n                                  \\bar{x}_{0}-x_{0} \\\\\n                                  f(x_{0},u_{0})-x_{1} \\\\ \n                                  \\vdots \\\\\n                                  f(x_{N-1}, u_{N-1}-x_{N})\n                              \\end{bmatrix} &= 0\n        \\end{align*}\n",[],{"type":18,"tag":19,"props":7949,"children":7951},{"id":7950},"full-implement-in-python",[7952],{"type":24,"value":7953},"Full Implement in Python",{"type":18,"tag":27,"props":7955,"children":7956},{},[7957,7959,7964],{"type":24,"value":7958},"We will use ",{"type":18,"tag":4360,"props":7960,"children":7961},{},[7962],{"type":24,"value":7963},"Casadi",{"type":24,"value":7965}," as a numerical optimization framework.",{"type":18,"tag":599,"props":7967,"children":7970},{"className":7968,"code":7969,"language":604,"meta":8},[602],"import casadi as ca\n",[7971],{"type":18,"tag":607,"props":7972,"children":7973},{},[7974],{"type":18,"tag":599,"props":7975,"children":7976},{"__ignoreMap":8},[7977],{"type":18,"tag":614,"props":7978,"children":7979},{"class":616,"line":617},[7980,7984,7989,7993],{"type":18,"tag":614,"props":7981,"children":7982},{"class":621},[7983],{"type":24,"value":6712},{"type":18,"tag":614,"props":7985,"children":7986},{"class":627},[7987],{"type":24,"value":7988}," casadi ",{"type":18,"tag":614,"props":7990,"children":7991},{"class":621},[7992],{"type":24,"value":6722},{"type":18,"tag":614,"props":7994,"children":7995},{"class":627},[7996],{"type":24,"value":7997}," ca",{"type":18,"tag":27,"props":7999,"children":8000},{},[8001],{"type":24,"value":8002},"Define state representation and input control of our nonlinear model.",{"type":18,"tag":599,"props":8004,"children":8007},{"className":8005,"code":8006,"language":604,"meta":8},[602],"# Symbolic Variables\n## States\nx = ca.SX.sym(\"x\")\ny = ca.SX.sym(\"y\")\ntheta = ca.SX.sym(\"theta\")\nstates = ca.vertcat(x, y, theta)\nnum_states = states.numel()\n\n## Control\nu1 = ca.SX.sym(\"u1\")\nu2 = ca.SX.sym(\"u2\")\ncontrols = ca.vertcat(u1, u2)\nnum_controls = controls.numel()\n\n# Define Nonlinear model\n## Rotation Matrix\nrot_mat = ca.vertcat(\n    ca.horzcat(ca.cos(theta), ca.sin(theta), 0),\n    ca.horzcat(-ca.sin(theta), ca.cos(theta), 0),\n    ca.horzcat(0, 0, 1)\n)\n\nvx = u1 * ca.cos(theta)\nvy = u1 * ca.sin(theta)\nvyaw = u2\n\nrhs = ca.vertcat(vx, vy, vyaw)\n## Define mapped nonlinear function f(x,u) -> rhs\nf = ca.Function('f', [states, controls], [rhs])\n",[8008],{"type":18,"tag":607,"props":8009,"children":8010},{},[8011],{"type":18,"tag":599,"props":8012,"children":8013},{"__ignoreMap":8},[8014,8022,8030,8065,8097,8130,8147,8164,8171,8179,8212,8245,8262,8279,8286,8294,8302,8319,8336,8361,8392,8399,8406,8432,8457,8474,8481,8498,8506],{"type":18,"tag":614,"props":8015,"children":8016},{"class":616,"line":617},[8017],{"type":18,"tag":614,"props":8018,"children":8019},{"class":1851},[8020],{"type":24,"value":8021},"# Symbolic Variables\n",{"type":18,"tag":614,"props":8023,"children":8024},{"class":616,"line":644},[8025],{"type":18,"tag":614,"props":8026,"children":8027},{"class":1851},[8028],{"type":24,"value":8029},"## States\n",{"type":18,"tag":614,"props":8031,"children":8032},{"class":616,"line":653},[8033,8037,8041,8046,8051,8056,8061],{"type":18,"tag":614,"props":8034,"children":8035},{"class":627},[8036],{"type":24,"value":6807},{"type":18,"tag":614,"props":8038,"children":8039},{"class":621},[8040],{"type":24,"value":711},{"type":18,"tag":614,"props":8042,"children":8043},{"class":627},[8044],{"type":24,"value":8045}," ca.",{"type":18,"tag":614,"props":8047,"children":8048},{"class":671},[8049],{"type":24,"value":8050},"SX",{"type":18,"tag":614,"props":8052,"children":8053},{"class":627},[8054],{"type":24,"value":8055},".sym(",{"type":18,"tag":614,"props":8057,"children":8058},{"class":5349},[8059],{"type":24,"value":8060},"\"x\"",{"type":18,"tag":614,"props":8062,"children":8063},{"class":627},[8064],{"type":24,"value":1423},{"type":18,"tag":614,"props":8066,"children":8067},{"class":616,"line":682},[8068,8072,8076,8080,8084,8088,8093],{"type":18,"tag":614,"props":8069,"children":8070},{"class":627},[8071],{"type":24,"value":6828},{"type":18,"tag":614,"props":8073,"children":8074},{"class":621},[8075],{"type":24,"value":711},{"type":18,"tag":614,"props":8077,"children":8078},{"class":627},[8079],{"type":24,"value":8045},{"type":18,"tag":614,"props":8081,"children":8082},{"class":671},[8083],{"type":24,"value":8050},{"type":18,"tag":614,"props":8085,"children":8086},{"class":627},[8087],{"type":24,"value":8055},{"type":18,"tag":614,"props":8089,"children":8090},{"class":5349},[8091],{"type":24,"value":8092},"\"y\"",{"type":18,"tag":614,"props":8094,"children":8095},{"class":627},[8096],{"type":24,"value":1423},{"type":18,"tag":614,"props":8098,"children":8099},{"class":616,"line":690},[8100,8105,8109,8113,8117,8121,8126],{"type":18,"tag":614,"props":8101,"children":8102},{"class":627},[8103],{"type":24,"value":8104},"theta ",{"type":18,"tag":614,"props":8106,"children":8107},{"class":621},[8108],{"type":24,"value":711},{"type":18,"tag":614,"props":8110,"children":8111},{"class":627},[8112],{"type":24,"value":8045},{"type":18,"tag":614,"props":8114,"children":8115},{"class":671},[8116],{"type":24,"value":8050},{"type":18,"tag":614,"props":8118,"children":8119},{"class":627},[8120],{"type":24,"value":8055},{"type":18,"tag":614,"props":8122,"children":8123},{"class":5349},[8124],{"type":24,"value":8125},"\"theta\"",{"type":18,"tag":614,"props":8127,"children":8128},{"class":627},[8129],{"type":24,"value":1423},{"type":18,"tag":614,"props":8131,"children":8132},{"class":616,"line":719},[8133,8138,8142],{"type":18,"tag":614,"props":8134,"children":8135},{"class":627},[8136],{"type":24,"value":8137},"states ",{"type":18,"tag":614,"props":8139,"children":8140},{"class":621},[8141],{"type":24,"value":711},{"type":18,"tag":614,"props":8143,"children":8144},{"class":627},[8145],{"type":24,"value":8146}," ca.vertcat(x, y, theta)\n",{"type":18,"tag":614,"props":8148,"children":8149},{"class":616,"line":745},[8150,8155,8159],{"type":18,"tag":614,"props":8151,"children":8152},{"class":627},[8153],{"type":24,"value":8154},"num_states ",{"type":18,"tag":614,"props":8156,"children":8157},{"class":621},[8158],{"type":24,"value":711},{"type":18,"tag":614,"props":8160,"children":8161},{"class":627},[8162],{"type":24,"value":8163}," states.numel()\n",{"type":18,"tag":614,"props":8165,"children":8166},{"class":616,"line":771},[8167],{"type":18,"tag":614,"props":8168,"children":8169},{},[8170],{"type":24,"value":650},{"type":18,"tag":614,"props":8172,"children":8173},{"class":616,"line":779},[8174],{"type":18,"tag":614,"props":8175,"children":8176},{"class":1851},[8177],{"type":24,"value":8178},"## Control\n",{"type":18,"tag":614,"props":8180,"children":8181},{"class":616,"line":805},[8182,8187,8191,8195,8199,8203,8208],{"type":18,"tag":614,"props":8183,"children":8184},{"class":627},[8185],{"type":24,"value":8186},"u1 ",{"type":18,"tag":614,"props":8188,"children":8189},{"class":621},[8190],{"type":24,"value":711},{"type":18,"tag":614,"props":8192,"children":8193},{"class":627},[8194],{"type":24,"value":8045},{"type":18,"tag":614,"props":8196,"children":8197},{"class":671},[8198],{"type":24,"value":8050},{"type":18,"tag":614,"props":8200,"children":8201},{"class":627},[8202],{"type":24,"value":8055},{"type":18,"tag":614,"props":8204,"children":8205},{"class":5349},[8206],{"type":24,"value":8207},"\"u1\"",{"type":18,"tag":614,"props":8209,"children":8210},{"class":627},[8211],{"type":24,"value":1423},{"type":18,"tag":614,"props":8213,"children":8214},{"class":616,"line":831},[8215,8220,8224,8228,8232,8236,8241],{"type":18,"tag":614,"props":8216,"children":8217},{"class":627},[8218],{"type":24,"value":8219},"u2 ",{"type":18,"tag":614,"props":8221,"children":8222},{"class":621},[8223],{"type":24,"value":711},{"type":18,"tag":614,"props":8225,"children":8226},{"class":627},[8227],{"type":24,"value":8045},{"type":18,"tag":614,"props":8229,"children":8230},{"class":671},[8231],{"type":24,"value":8050},{"type":18,"tag":614,"props":8233,"children":8234},{"class":627},[8235],{"type":24,"value":8055},{"type":18,"tag":614,"props":8237,"children":8238},{"class":5349},[8239],{"type":24,"value":8240},"\"u2\"",{"type":18,"tag":614,"props":8242,"children":8243},{"class":627},[8244],{"type":24,"value":1423},{"type":18,"tag":614,"props":8246,"children":8247},{"class":616,"line":839},[8248,8253,8257],{"type":18,"tag":614,"props":8249,"children":8250},{"class":627},[8251],{"type":24,"value":8252},"controls ",{"type":18,"tag":614,"props":8254,"children":8255},{"class":621},[8256],{"type":24,"value":711},{"type":18,"tag":614,"props":8258,"children":8259},{"class":627},[8260],{"type":24,"value":8261}," ca.vertcat(u1, u2)\n",{"type":18,"tag":614,"props":8263,"children":8264},{"class":616,"line":875},[8265,8270,8274],{"type":18,"tag":614,"props":8266,"children":8267},{"class":627},[8268],{"type":24,"value":8269},"num_controls ",{"type":18,"tag":614,"props":8271,"children":8272},{"class":621},[8273],{"type":24,"value":711},{"type":18,"tag":614,"props":8275,"children":8276},{"class":627},[8277],{"type":24,"value":8278}," controls.numel()\n",{"type":18,"tag":614,"props":8280,"children":8281},{"class":616,"line":908},[8282],{"type":18,"tag":614,"props":8283,"children":8284},{},[8285],{"type":24,"value":650},{"type":18,"tag":614,"props":8287,"children":8288},{"class":616,"line":916},[8289],{"type":18,"tag":614,"props":8290,"children":8291},{"class":1851},[8292],{"type":24,"value":8293},"# Define Nonlinear model\n",{"type":18,"tag":614,"props":8295,"children":8296},{"class":616,"line":950},[8297],{"type":18,"tag":614,"props":8298,"children":8299},{"class":1851},[8300],{"type":24,"value":8301},"## Rotation Matrix\n",{"type":18,"tag":614,"props":8303,"children":8304},{"class":616,"line":984},[8305,8310,8314],{"type":18,"tag":614,"props":8306,"children":8307},{"class":627},[8308],{"type":24,"value":8309},"rot_mat ",{"type":18,"tag":614,"props":8311,"children":8312},{"class":621},[8313],{"type":24,"value":711},{"type":18,"tag":614,"props":8315,"children":8316},{"class":627},[8317],{"type":24,"value":8318}," ca.vertcat(\n",{"type":18,"tag":614,"props":8320,"children":8321},{"class":616,"line":992},[8322,8327,8331],{"type":18,"tag":614,"props":8323,"children":8324},{"class":627},[8325],{"type":24,"value":8326},"    ca.horzcat(ca.cos(theta), ca.sin(theta), ",{"type":18,"tag":614,"props":8328,"children":8329},{"class":671},[8330],{"type":24,"value":867},{"type":18,"tag":614,"props":8332,"children":8333},{"class":627},[8334],{"type":24,"value":8335},"),\n",{"type":18,"tag":614,"props":8337,"children":8338},{"class":616,"line":1018},[8339,8344,8348,8353,8357],{"type":18,"tag":614,"props":8340,"children":8341},{"class":627},[8342],{"type":24,"value":8343},"    ca.horzcat(",{"type":18,"tag":614,"props":8345,"children":8346},{"class":621},[8347],{"type":24,"value":1046},{"type":18,"tag":614,"props":8349,"children":8350},{"class":627},[8351],{"type":24,"value":8352},"ca.sin(theta), ca.cos(theta), ",{"type":18,"tag":614,"props":8354,"children":8355},{"class":671},[8356],{"type":24,"value":867},{"type":18,"tag":614,"props":8358,"children":8359},{"class":627},[8360],{"type":24,"value":8335},{"type":18,"tag":614,"props":8362,"children":8363},{"class":616,"line":1026},[8364,8368,8372,8376,8380,8384,8388],{"type":18,"tag":614,"props":8365,"children":8366},{"class":627},[8367],{"type":24,"value":8343},{"type":18,"tag":614,"props":8369,"children":8370},{"class":671},[8371],{"type":24,"value":867},{"type":18,"tag":614,"props":8373,"children":8374},{"class":627},[8375],{"type":24,"value":2417},{"type":18,"tag":614,"props":8377,"children":8378},{"class":671},[8379],{"type":24,"value":867},{"type":18,"tag":614,"props":8381,"children":8382},{"class":627},[8383],{"type":24,"value":2417},{"type":18,"tag":614,"props":8385,"children":8386},{"class":671},[8387],{"type":24,"value":977},{"type":18,"tag":614,"props":8389,"children":8390},{"class":627},[8391],{"type":24,"value":1423},{"type":18,"tag":614,"props":8393,"children":8394},{"class":616,"line":1068},[8395],{"type":18,"tag":614,"props":8396,"children":8397},{"class":627},[8398],{"type":24,"value":1423},{"type":18,"tag":614,"props":8400,"children":8401},{"class":616,"line":1108},[8402],{"type":18,"tag":614,"props":8403,"children":8404},{},[8405],{"type":24,"value":650},{"type":18,"tag":614,"props":8407,"children":8408},{"class":616,"line":1202},[8409,8414,8418,8423,8427],{"type":18,"tag":614,"props":8410,"children":8411},{"class":627},[8412],{"type":24,"value":8413},"vx ",{"type":18,"tag":614,"props":8415,"children":8416},{"class":621},[8417],{"type":24,"value":711},{"type":18,"tag":614,"props":8419,"children":8420},{"class":627},[8421],{"type":24,"value":8422}," u1 ",{"type":18,"tag":614,"props":8424,"children":8425},{"class":621},[8426],{"type":24,"value":1056},{"type":18,"tag":614,"props":8428,"children":8429},{"class":627},[8430],{"type":24,"value":8431}," ca.cos(theta)\n",{"type":18,"tag":614,"props":8433,"children":8434},{"class":616,"line":1210},[8435,8440,8444,8448,8452],{"type":18,"tag":614,"props":8436,"children":8437},{"class":627},[8438],{"type":24,"value":8439},"vy ",{"type":18,"tag":614,"props":8441,"children":8442},{"class":621},[8443],{"type":24,"value":711},{"type":18,"tag":614,"props":8445,"children":8446},{"class":627},[8447],{"type":24,"value":8422},{"type":18,"tag":614,"props":8449,"children":8450},{"class":621},[8451],{"type":24,"value":1056},{"type":18,"tag":614,"props":8453,"children":8454},{"class":627},[8455],{"type":24,"value":8456}," ca.sin(theta)\n",{"type":18,"tag":614,"props":8458,"children":8459},{"class":616,"line":1228},[8460,8465,8469],{"type":18,"tag":614,"props":8461,"children":8462},{"class":627},[8463],{"type":24,"value":8464},"vyaw ",{"type":18,"tag":614,"props":8466,"children":8467},{"class":621},[8468],{"type":24,"value":711},{"type":18,"tag":614,"props":8470,"children":8471},{"class":627},[8472],{"type":24,"value":8473}," u2\n",{"type":18,"tag":614,"props":8475,"children":8476},{"class":616,"line":1236},[8477],{"type":18,"tag":614,"props":8478,"children":8479},{},[8480],{"type":24,"value":650},{"type":18,"tag":614,"props":8482,"children":8483},{"class":616,"line":1262},[8484,8489,8493],{"type":18,"tag":614,"props":8485,"children":8486},{"class":627},[8487],{"type":24,"value":8488},"rhs ",{"type":18,"tag":614,"props":8490,"children":8491},{"class":621},[8492],{"type":24,"value":711},{"type":18,"tag":614,"props":8494,"children":8495},{"class":627},[8496],{"type":24,"value":8497}," ca.vertcat(vx, vy, vyaw)\n",{"type":18,"tag":614,"props":8499,"children":8500},{"class":616,"line":1270},[8501],{"type":18,"tag":614,"props":8502,"children":8503},{"class":1851},[8504],{"type":24,"value":8505},"## Define mapped nonlinear function f(x,u) -> rhs\n",{"type":18,"tag":614,"props":8507,"children":8508},{"class":616,"line":1426},[8509,8513,8517,8522,8527],{"type":18,"tag":614,"props":8510,"children":8511},{"class":627},[8512],{"type":24,"value":6951},{"type":18,"tag":614,"props":8514,"children":8515},{"class":621},[8516],{"type":24,"value":711},{"type":18,"tag":614,"props":8518,"children":8519},{"class":627},[8520],{"type":24,"value":8521}," ca.Function(",{"type":18,"tag":614,"props":8523,"children":8524},{"class":5349},[8525],{"type":24,"value":8526},"'f'",{"type":18,"tag":614,"props":8528,"children":8529},{"class":627},[8530],{"type":24,"value":8531},", [states, controls], [rhs])",{"type":18,"tag":27,"props":8533,"children":8534},{},[8535],{"type":24,"value":8536},"Declare symbolic matrix",{"type":18,"tag":599,"props":8538,"children":8541},{"className":8539,"code":8540,"language":604,"meta":8},[602],"X = ca.SX.sym('X', num_states, prediction_horizons + 1)\nX_ref = ca.SX.sym('X_ref', num_states, prediction_horizons + 1)\nU = ca.SX.sym('U', num_controls, prediction_horizons)\nU_ref = ca.SX.sym('U_ref', num_controls, prediction_horizons)\n",[8542],{"type":18,"tag":607,"props":8543,"children":8544},{},[8545],{"type":18,"tag":599,"props":8546,"children":8547},{"__ignoreMap":8},[8548,8597,8646,8679],{"type":18,"tag":614,"props":8549,"children":8550},{"class":616,"line":617},[8551,8555,8559,8563,8567,8571,8576,8581,8585,8589,8593],{"type":18,"tag":614,"props":8552,"children":8553},{"class":627},[8554],{"type":24,"value":2621},{"type":18,"tag":614,"props":8556,"children":8557},{"class":621},[8558],{"type":24,"value":711},{"type":18,"tag":614,"props":8560,"children":8561},{"class":627},[8562],{"type":24,"value":8045},{"type":18,"tag":614,"props":8564,"children":8565},{"class":671},[8566],{"type":24,"value":8050},{"type":18,"tag":614,"props":8568,"children":8569},{"class":627},[8570],{"type":24,"value":8055},{"type":18,"tag":614,"props":8572,"children":8573},{"class":5349},[8574],{"type":24,"value":8575},"'X'",{"type":18,"tag":614,"props":8577,"children":8578},{"class":627},[8579],{"type":24,"value":8580},", num_states, prediction_horizons ",{"type":18,"tag":614,"props":8582,"children":8583},{"class":621},[8584],{"type":24,"value":1177},{"type":18,"tag":614,"props":8586,"children":8587},{"class":627},[8588],{"type":24,"value":630},{"type":18,"tag":614,"props":8590,"children":8591},{"class":671},[8592],{"type":24,"value":977},{"type":18,"tag":614,"props":8594,"children":8595},{"class":627},[8596],{"type":24,"value":1423},{"type":18,"tag":614,"props":8598,"children":8599},{"class":616,"line":644},[8600,8605,8609,8613,8617,8621,8626,8630,8634,8638,8642],{"type":18,"tag":614,"props":8601,"children":8602},{"class":627},[8603],{"type":24,"value":8604},"X_ref ",{"type":18,"tag":614,"props":8606,"children":8607},{"class":621},[8608],{"type":24,"value":711},{"type":18,"tag":614,"props":8610,"children":8611},{"class":627},[8612],{"type":24,"value":8045},{"type":18,"tag":614,"props":8614,"children":8615},{"class":671},[8616],{"type":24,"value":8050},{"type":18,"tag":614,"props":8618,"children":8619},{"class":627},[8620],{"type":24,"value":8055},{"type":18,"tag":614,"props":8622,"children":8623},{"class":5349},[8624],{"type":24,"value":8625},"'X_ref'",{"type":18,"tag":614,"props":8627,"children":8628},{"class":627},[8629],{"type":24,"value":8580},{"type":18,"tag":614,"props":8631,"children":8632},{"class":621},[8633],{"type":24,"value":1177},{"type":18,"tag":614,"props":8635,"children":8636},{"class":627},[8637],{"type":24,"value":630},{"type":18,"tag":614,"props":8639,"children":8640},{"class":671},[8641],{"type":24,"value":977},{"type":18,"tag":614,"props":8643,"children":8644},{"class":627},[8645],{"type":24,"value":1423},{"type":18,"tag":614,"props":8647,"children":8648},{"class":616,"line":653},[8649,8653,8657,8661,8665,8669,8674],{"type":18,"tag":614,"props":8650,"children":8651},{"class":627},[8652],{"type":24,"value":2656},{"type":18,"tag":614,"props":8654,"children":8655},{"class":621},[8656],{"type":24,"value":711},{"type":18,"tag":614,"props":8658,"children":8659},{"class":627},[8660],{"type":24,"value":8045},{"type":18,"tag":614,"props":8662,"children":8663},{"class":671},[8664],{"type":24,"value":8050},{"type":18,"tag":614,"props":8666,"children":8667},{"class":627},[8668],{"type":24,"value":8055},{"type":18,"tag":614,"props":8670,"children":8671},{"class":5349},[8672],{"type":24,"value":8673},"'U'",{"type":18,"tag":614,"props":8675,"children":8676},{"class":627},[8677],{"type":24,"value":8678},", num_controls, prediction_horizons)\n",{"type":18,"tag":614,"props":8680,"children":8681},{"class":616,"line":682},[8682,8687,8691,8695,8699,8703,8708],{"type":18,"tag":614,"props":8683,"children":8684},{"class":627},[8685],{"type":24,"value":8686},"U_ref ",{"type":18,"tag":614,"props":8688,"children":8689},{"class":621},[8690],{"type":24,"value":711},{"type":18,"tag":614,"props":8692,"children":8693},{"class":627},[8694],{"type":24,"value":8045},{"type":18,"tag":614,"props":8696,"children":8697},{"class":671},[8698],{"type":24,"value":8050},{"type":18,"tag":614,"props":8700,"children":8701},{"class":627},[8702],{"type":24,"value":8055},{"type":18,"tag":614,"props":8704,"children":8705},{"class":5349},[8706],{"type":24,"value":8707},"'U_ref'",{"type":18,"tag":614,"props":8709,"children":8710},{"class":627},[8711],{"type":24,"value":8712},", num_controls, prediction_horizons)",{"type":18,"tag":27,"props":8714,"children":8715},{},[8716,8718],{"type":24,"value":8717},"Define nonlinear programming and options for ",{"type":18,"tag":4360,"props":8719,"children":8720},{},[8721],{"type":24,"value":7963},{"type":18,"tag":599,"props":8723,"children":8726},{"className":8724,"code":8725,"language":604,"meta":8},[602],"nlp_prob = {\n    'f': cost_fn,\n    'x': opt_var,\n    'p': opt_dec,\n    'g': g\n}\n\nnlp_opts = {\n    'ipopt.max_iter': 5000,\n    'ipopt.print_level': 0,\n    'ipopt.acceptable_tol': 1e-6,\n    'ipopt.acceptable_obj_change_tol': 1e-4,\n    'print_time': 0\n}\n",[8727],{"type":18,"tag":607,"props":8728,"children":8729},{},[8730],{"type":18,"tag":599,"props":8731,"children":8732},{"__ignoreMap":8},[8733,8750,8766,8783,8800,8817,8825,8832,8848,8874,8898,8923,8948,8969],{"type":18,"tag":614,"props":8734,"children":8735},{"class":616,"line":617},[8736,8741,8745],{"type":18,"tag":614,"props":8737,"children":8738},{"class":627},[8739],{"type":24,"value":8740},"nlp_prob ",{"type":18,"tag":614,"props":8742,"children":8743},{"class":621},[8744],{"type":24,"value":711},{"type":18,"tag":614,"props":8746,"children":8747},{"class":627},[8748],{"type":24,"value":8749}," {\n",{"type":18,"tag":614,"props":8751,"children":8752},{"class":616,"line":644},[8753,8757,8761],{"type":18,"tag":614,"props":8754,"children":8755},{"class":627},[8756],{"type":24,"value":659},{"type":18,"tag":614,"props":8758,"children":8759},{"class":5349},[8760],{"type":24,"value":8526},{"type":18,"tag":614,"props":8762,"children":8763},{"class":627},[8764],{"type":24,"value":8765},": cost_fn,\n",{"type":18,"tag":614,"props":8767,"children":8768},{"class":616,"line":653},[8769,8773,8778],{"type":18,"tag":614,"props":8770,"children":8771},{"class":627},[8772],{"type":24,"value":659},{"type":18,"tag":614,"props":8774,"children":8775},{"class":5349},[8776],{"type":24,"value":8777},"'x'",{"type":18,"tag":614,"props":8779,"children":8780},{"class":627},[8781],{"type":24,"value":8782},": opt_var,\n",{"type":18,"tag":614,"props":8784,"children":8785},{"class":616,"line":682},[8786,8790,8795],{"type":18,"tag":614,"props":8787,"children":8788},{"class":627},[8789],{"type":24,"value":659},{"type":18,"tag":614,"props":8791,"children":8792},{"class":5349},[8793],{"type":24,"value":8794},"'p'",{"type":18,"tag":614,"props":8796,"children":8797},{"class":627},[8798],{"type":24,"value":8799},": opt_dec,\n",{"type":18,"tag":614,"props":8801,"children":8802},{"class":616,"line":690},[8803,8807,8812],{"type":18,"tag":614,"props":8804,"children":8805},{"class":627},[8806],{"type":24,"value":659},{"type":18,"tag":614,"props":8808,"children":8809},{"class":5349},[8810],{"type":24,"value":8811},"'g'",{"type":18,"tag":614,"props":8813,"children":8814},{"class":627},[8815],{"type":24,"value":8816},": g\n",{"type":18,"tag":614,"props":8818,"children":8819},{"class":616,"line":719},[8820],{"type":18,"tag":614,"props":8821,"children":8822},{"class":627},[8823],{"type":24,"value":8824},"}\n",{"type":18,"tag":614,"props":8826,"children":8827},{"class":616,"line":745},[8828],{"type":18,"tag":614,"props":8829,"children":8830},{},[8831],{"type":24,"value":650},{"type":18,"tag":614,"props":8833,"children":8834},{"class":616,"line":771},[8835,8840,8844],{"type":18,"tag":614,"props":8836,"children":8837},{"class":627},[8838],{"type":24,"value":8839},"nlp_opts ",{"type":18,"tag":614,"props":8841,"children":8842},{"class":621},[8843],{"type":24,"value":711},{"type":18,"tag":614,"props":8845,"children":8846},{"class":627},[8847],{"type":24,"value":8749},{"type":18,"tag":614,"props":8849,"children":8850},{"class":616,"line":779},[8851,8855,8860,8864,8869],{"type":18,"tag":614,"props":8852,"children":8853},{"class":627},[8854],{"type":24,"value":659},{"type":18,"tag":614,"props":8856,"children":8857},{"class":5349},[8858],{"type":24,"value":8859},"'ipopt.max_iter'",{"type":18,"tag":614,"props":8861,"children":8862},{"class":627},[8863],{"type":24,"value":477},{"type":18,"tag":614,"props":8865,"children":8866},{"class":671},[8867],{"type":24,"value":8868},"5000",{"type":18,"tag":614,"props":8870,"children":8871},{"class":627},[8872],{"type":24,"value":8873},",\n",{"type":18,"tag":614,"props":8875,"children":8876},{"class":616,"line":805},[8877,8881,8886,8890,8894],{"type":18,"tag":614,"props":8878,"children":8879},{"class":627},[8880],{"type":24,"value":659},{"type":18,"tag":614,"props":8882,"children":8883},{"class":5349},[8884],{"type":24,"value":8885},"'ipopt.print_level'",{"type":18,"tag":614,"props":8887,"children":8888},{"class":627},[8889],{"type":24,"value":477},{"type":18,"tag":614,"props":8891,"children":8892},{"class":671},[8893],{"type":24,"value":867},{"type":18,"tag":614,"props":8895,"children":8896},{"class":627},[8897],{"type":24,"value":8873},{"type":18,"tag":614,"props":8899,"children":8900},{"class":616,"line":831},[8901,8905,8910,8914,8919],{"type":18,"tag":614,"props":8902,"children":8903},{"class":627},[8904],{"type":24,"value":659},{"type":18,"tag":614,"props":8906,"children":8907},{"class":5349},[8908],{"type":24,"value":8909},"'ipopt.acceptable_tol'",{"type":18,"tag":614,"props":8911,"children":8912},{"class":627},[8913],{"type":24,"value":477},{"type":18,"tag":614,"props":8915,"children":8916},{"class":671},[8917],{"type":24,"value":8918},"1e-6",{"type":18,"tag":614,"props":8920,"children":8921},{"class":627},[8922],{"type":24,"value":8873},{"type":18,"tag":614,"props":8924,"children":8925},{"class":616,"line":839},[8926,8930,8935,8939,8944],{"type":18,"tag":614,"props":8927,"children":8928},{"class":627},[8929],{"type":24,"value":659},{"type":18,"tag":614,"props":8931,"children":8932},{"class":5349},[8933],{"type":24,"value":8934},"'ipopt.acceptable_obj_change_tol'",{"type":18,"tag":614,"props":8936,"children":8937},{"class":627},[8938],{"type":24,"value":477},{"type":18,"tag":614,"props":8940,"children":8941},{"class":671},[8942],{"type":24,"value":8943},"1e-4",{"type":18,"tag":614,"props":8945,"children":8946},{"class":627},[8947],{"type":24,"value":8873},{"type":18,"tag":614,"props":8949,"children":8950},{"class":616,"line":875},[8951,8955,8960,8964],{"type":18,"tag":614,"props":8952,"children":8953},{"class":627},[8954],{"type":24,"value":659},{"type":18,"tag":614,"props":8956,"children":8957},{"class":5349},[8958],{"type":24,"value":8959},"'print_time'",{"type":18,"tag":614,"props":8961,"children":8962},{"class":627},[8963],{"type":24,"value":477},{"type":18,"tag":614,"props":8965,"children":8966},{"class":671},[8967],{"type":24,"value":8968},"0\n",{"type":18,"tag":614,"props":8970,"children":8971},{"class":616,"line":908},[8972],{"type":18,"tag":614,"props":8973,"children":8974},{"class":627},[8975],{"type":24,"value":8976},"}",{"type":18,"tag":27,"props":8978,"children":8979},{},[8980],{"type":24,"value":8981},"Determine boundary and constraint for our optimizer",{"type":18,"tag":599,"props":8983,"children":8986},{"className":8984,"code":8985,"language":604,"meta":8},[602],"lbx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\nubx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\n\nlbx[0: num_states * (prediction_horizons + 1): num_states] = x_min\nlbx[1: num_states * (prediction_horizons + 1): num_states] = y_min\nlbx[2: num_states * (prediction_horizons + 1): num_states] = theta_min\n\nubx[0: num_states * (prediction_horizons + 1): num_states] = x_max\nubx[1: num_states * (prediction_horizons + 1): num_states] = y_max\nubx[2: num_states * (prediction_horizons + 1): num_states] = theta_max\n\nlbx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\nlbx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\n\nubx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\nubx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\n\nargs = {\n    'lbg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'ubg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'lbx': lbx,\n    'ubx': ubx\n}\n",[8987],{"type":18,"tag":607,"props":8988,"children":8989},{},[8990],{"type":18,"tag":599,"props":8991,"children":8992},{"__ignoreMap":8},[8993,9070,9142,9149,9200,9248,9296,9303,9352,9400,9448,9455,9538,9633,9640,9721,9816,9823,9839,9898,9954,9971,9988],{"type":18,"tag":614,"props":8994,"children":8995},{"class":616,"line":617},[8996,9001,9005,9009,9014,9019,9023,9028,9032,9036,9040,9044,9048,9053,9057,9062,9066],{"type":18,"tag":614,"props":8997,"children":8998},{"class":627},[8999],{"type":24,"value":9000},"lbx ",{"type":18,"tag":614,"props":9002,"children":9003},{"class":621},[9004],{"type":24,"value":711},{"type":18,"tag":614,"props":9006,"children":9007},{"class":627},[9008],{"type":24,"value":8045},{"type":18,"tag":614,"props":9010,"children":9011},{"class":671},[9012],{"type":24,"value":9013},"DM",{"type":18,"tag":614,"props":9015,"children":9016},{"class":627},[9017],{"type":24,"value":9018},".zeros((num_states ",{"type":18,"tag":614,"props":9020,"children":9021},{"class":621},[9022],{"type":24,"value":1056},{"type":18,"tag":614,"props":9024,"children":9025},{"class":627},[9026],{"type":24,"value":9027}," (prediction_horizons ",{"type":18,"tag":614,"props":9029,"children":9030},{"class":621},[9031],{"type":24,"value":1177},{"type":18,"tag":614,"props":9033,"children":9034},{"class":627},[9035],{"type":24,"value":630},{"type":18,"tag":614,"props":9037,"children":9038},{"class":671},[9039],{"type":24,"value":977},{"type":18,"tag":614,"props":9041,"children":9042},{"class":627},[9043],{"type":24,"value":5357},{"type":18,"tag":614,"props":9045,"children":9046},{"class":621},[9047],{"type":24,"value":1177},{"type":18,"tag":614,"props":9049,"children":9050},{"class":627},[9051],{"type":24,"value":9052}," num_controls ",{"type":18,"tag":614,"props":9054,"children":9055},{"class":621},[9056],{"type":24,"value":1056},{"type":18,"tag":614,"props":9058,"children":9059},{"class":627},[9060],{"type":24,"value":9061}," prediction_horizons, ",{"type":18,"tag":614,"props":9063,"children":9064},{"class":671},[9065],{"type":24,"value":977},{"type":18,"tag":614,"props":9067,"children":9068},{"class":627},[9069],{"type":24,"value":5134},{"type":18,"tag":614,"props":9071,"children":9072},{"class":616,"line":644},[9073,9078,9082,9086,9090,9094,9098,9102,9106,9110,9114,9118,9122,9126,9130,9134,9138],{"type":18,"tag":614,"props":9074,"children":9075},{"class":627},[9076],{"type":24,"value":9077},"ubx ",{"type":18,"tag":614,"props":9079,"children":9080},{"class":621},[9081],{"type":24,"value":711},{"type":18,"tag":614,"props":9083,"children":9084},{"class":627},[9085],{"type":24,"value":8045},{"type":18,"tag":614,"props":9087,"children":9088},{"class":671},[9089],{"type":24,"value":9013},{"type":18,"tag":614,"props":9091,"children":9092},{"class":627},[9093],{"type":24,"value":9018},{"type":18,"tag":614,"props":9095,"children":9096},{"class":621},[9097],{"type":24,"value":1056},{"type":18,"tag":614,"props":9099,"children":9100},{"class":627},[9101],{"type":24,"value":9027},{"type":18,"tag":614,"props":9103,"children":9104},{"class":621},[9105],{"type":24,"value":1177},{"type":18,"tag":614,"props":9107,"children":9108},{"class":627},[9109],{"type":24,"value":630},{"type":18,"tag":614,"props":9111,"children":9112},{"class":671},[9113],{"type":24,"value":977},{"type":18,"tag":614,"props":9115,"children":9116},{"class":627},[9117],{"type":24,"value":5357},{"type":18,"tag":614,"props":9119,"children":9120},{"class":621},[9121],{"type":24,"value":1177},{"type":18,"tag":614,"props":9123,"children":9124},{"class":627},[9125],{"type":24,"value":9052},{"type":18,"tag":614,"props":9127,"children":9128},{"class":621},[9129],{"type":24,"value":1056},{"type":18,"tag":614,"props":9131,"children":9132},{"class":627},[9133],{"type":24,"value":9061},{"type":18,"tag":614,"props":9135,"children":9136},{"class":671},[9137],{"type":24,"value":977},{"type":18,"tag":614,"props":9139,"children":9140},{"class":627},[9141],{"type":24,"value":5134},{"type":18,"tag":614,"props":9143,"children":9144},{"class":616,"line":653},[9145],{"type":18,"tag":614,"props":9146,"children":9147},{},[9148],{"type":24,"value":650},{"type":18,"tag":614,"props":9150,"children":9151},{"class":616,"line":682},[9152,9157,9161,9166,9170,9174,9178,9182,9186,9191,9195],{"type":18,"tag":614,"props":9153,"children":9154},{"class":627},[9155],{"type":24,"value":9156},"lbx[",{"type":18,"tag":614,"props":9158,"children":9159},{"class":671},[9160],{"type":24,"value":867},{"type":18,"tag":614,"props":9162,"children":9163},{"class":627},[9164],{"type":24,"value":9165},": num_states ",{"type":18,"tag":614,"props":9167,"children":9168},{"class":621},[9169],{"type":24,"value":1056},{"type":18,"tag":614,"props":9171,"children":9172},{"class":627},[9173],{"type":24,"value":9027},{"type":18,"tag":614,"props":9175,"children":9176},{"class":621},[9177],{"type":24,"value":1177},{"type":18,"tag":614,"props":9179,"children":9180},{"class":627},[9181],{"type":24,"value":630},{"type":18,"tag":614,"props":9183,"children":9184},{"class":671},[9185],{"type":24,"value":977},{"type":18,"tag":614,"props":9187,"children":9188},{"class":627},[9189],{"type":24,"value":9190},"): num_states] ",{"type":18,"tag":614,"props":9192,"children":9193},{"class":621},[9194],{"type":24,"value":711},{"type":18,"tag":614,"props":9196,"children":9197},{"class":627},[9198],{"type":24,"value":9199}," x_min\n",{"type":18,"tag":614,"props":9201,"children":9202},{"class":616,"line":690},[9203,9207,9211,9215,9219,9223,9227,9231,9235,9239,9243],{"type":18,"tag":614,"props":9204,"children":9205},{"class":627},[9206],{"type":24,"value":9156},{"type":18,"tag":614,"props":9208,"children":9209},{"class":671},[9210],{"type":24,"value":977},{"type":18,"tag":614,"props":9212,"children":9213},{"class":627},[9214],{"type":24,"value":9165},{"type":18,"tag":614,"props":9216,"children":9217},{"class":621},[9218],{"type":24,"value":1056},{"type":18,"tag":614,"props":9220,"children":9221},{"class":627},[9222],{"type":24,"value":9027},{"type":18,"tag":614,"props":9224,"children":9225},{"class":621},[9226],{"type":24,"value":1177},{"type":18,"tag":614,"props":9228,"children":9229},{"class":627},[9230],{"type":24,"value":630},{"type":18,"tag":614,"props":9232,"children":9233},{"class":671},[9234],{"type":24,"value":977},{"type":18,"tag":614,"props":9236,"children":9237},{"class":627},[9238],{"type":24,"value":9190},{"type":18,"tag":614,"props":9240,"children":9241},{"class":621},[9242],{"type":24,"value":711},{"type":18,"tag":614,"props":9244,"children":9245},{"class":627},[9246],{"type":24,"value":9247}," y_min\n",{"type":18,"tag":614,"props":9249,"children":9250},{"class":616,"line":719},[9251,9255,9259,9263,9267,9271,9275,9279,9283,9287,9291],{"type":18,"tag":614,"props":9252,"children":9253},{"class":627},[9254],{"type":24,"value":9156},{"type":18,"tag":614,"props":9256,"children":9257},{"class":671},[9258],{"type":24,"value":1353},{"type":18,"tag":614,"props":9260,"children":9261},{"class":627},[9262],{"type":24,"value":9165},{"type":18,"tag":614,"props":9264,"children":9265},{"class":621},[9266],{"type":24,"value":1056},{"type":18,"tag":614,"props":9268,"children":9269},{"class":627},[9270],{"type":24,"value":9027},{"type":18,"tag":614,"props":9272,"children":9273},{"class":621},[9274],{"type":24,"value":1177},{"type":18,"tag":614,"props":9276,"children":9277},{"class":627},[9278],{"type":24,"value":630},{"type":18,"tag":614,"props":9280,"children":9281},{"class":671},[9282],{"type":24,"value":977},{"type":18,"tag":614,"props":9284,"children":9285},{"class":627},[9286],{"type":24,"value":9190},{"type":18,"tag":614,"props":9288,"children":9289},{"class":621},[9290],{"type":24,"value":711},{"type":18,"tag":614,"props":9292,"children":9293},{"class":627},[9294],{"type":24,"value":9295}," theta_min\n",{"type":18,"tag":614,"props":9297,"children":9298},{"class":616,"line":745},[9299],{"type":18,"tag":614,"props":9300,"children":9301},{},[9302],{"type":24,"value":650},{"type":18,"tag":614,"props":9304,"children":9305},{"class":616,"line":771},[9306,9311,9315,9319,9323,9327,9331,9335,9339,9343,9347],{"type":18,"tag":614,"props":9307,"children":9308},{"class":627},[9309],{"type":24,"value":9310},"ubx[",{"type":18,"tag":614,"props":9312,"children":9313},{"class":671},[9314],{"type":24,"value":867},{"type":18,"tag":614,"props":9316,"children":9317},{"class":627},[9318],{"type":24,"value":9165},{"type":18,"tag":614,"props":9320,"children":9321},{"class":621},[9322],{"type":24,"value":1056},{"type":18,"tag":614,"props":9324,"children":9325},{"class":627},[9326],{"type":24,"value":9027},{"type":18,"tag":614,"props":9328,"children":9329},{"class":621},[9330],{"type":24,"value":1177},{"type":18,"tag":614,"props":9332,"children":9333},{"class":627},[9334],{"type":24,"value":630},{"type":18,"tag":614,"props":9336,"children":9337},{"class":671},[9338],{"type":24,"value":977},{"type":18,"tag":614,"props":9340,"children":9341},{"class":627},[9342],{"type":24,"value":9190},{"type":18,"tag":614,"props":9344,"children":9345},{"class":621},[9346],{"type":24,"value":711},{"type":18,"tag":614,"props":9348,"children":9349},{"class":627},[9350],{"type":24,"value":9351}," x_max\n",{"type":18,"tag":614,"props":9353,"children":9354},{"class":616,"line":779},[9355,9359,9363,9367,9371,9375,9379,9383,9387,9391,9395],{"type":18,"tag":614,"props":9356,"children":9357},{"class":627},[9358],{"type":24,"value":9310},{"type":18,"tag":614,"props":9360,"children":9361},{"class":671},[9362],{"type":24,"value":977},{"type":18,"tag":614,"props":9364,"children":9365},{"class":627},[9366],{"type":24,"value":9165},{"type":18,"tag":614,"props":9368,"children":9369},{"class":621},[9370],{"type":24,"value":1056},{"type":18,"tag":614,"props":9372,"children":9373},{"class":627},[9374],{"type":24,"value":9027},{"type":18,"tag":614,"props":9376,"children":9377},{"class":621},[9378],{"type":24,"value":1177},{"type":18,"tag":614,"props":9380,"children":9381},{"class":627},[9382],{"type":24,"value":630},{"type":18,"tag":614,"props":9384,"children":9385},{"class":671},[9386],{"type":24,"value":977},{"type":18,"tag":614,"props":9388,"children":9389},{"class":627},[9390],{"type":24,"value":9190},{"type":18,"tag":614,"props":9392,"children":9393},{"class":621},[9394],{"type":24,"value":711},{"type":18,"tag":614,"props":9396,"children":9397},{"class":627},[9398],{"type":24,"value":9399}," y_max\n",{"type":18,"tag":614,"props":9401,"children":9402},{"class":616,"line":805},[9403,9407,9411,9415,9419,9423,9427,9431,9435,9439,9443],{"type":18,"tag":614,"props":9404,"children":9405},{"class":627},[9406],{"type":24,"value":9310},{"type":18,"tag":614,"props":9408,"children":9409},{"class":671},[9410],{"type":24,"value":1353},{"type":18,"tag":614,"props":9412,"children":9413},{"class":627},[9414],{"type":24,"value":9165},{"type":18,"tag":614,"props":9416,"children":9417},{"class":621},[9418],{"type":24,"value":1056},{"type":18,"tag":614,"props":9420,"children":9421},{"class":627},[9422],{"type":24,"value":9027},{"type":18,"tag":614,"props":9424,"children":9425},{"class":621},[9426],{"type":24,"value":1177},{"type":18,"tag":614,"props":9428,"children":9429},{"class":627},[9430],{"type":24,"value":630},{"type":18,"tag":614,"props":9432,"children":9433},{"class":671},[9434],{"type":24,"value":977},{"type":18,"tag":614,"props":9436,"children":9437},{"class":627},[9438],{"type":24,"value":9190},{"type":18,"tag":614,"props":9440,"children":9441},{"class":621},[9442],{"type":24,"value":711},{"type":18,"tag":614,"props":9444,"children":9445},{"class":627},[9446],{"type":24,"value":9447}," theta_max\n",{"type":18,"tag":614,"props":9449,"children":9450},{"class":616,"line":831},[9451],{"type":18,"tag":614,"props":9452,"children":9453},{},[9454],{"type":24,"value":650},{"type":18,"tag":614,"props":9456,"children":9457},{"class":616,"line":839},[9458,9463,9467,9471,9475,9479,9483,9488,9492,9496,9500,9504,9508,9512,9516,9520,9524,9529,9533],{"type":18,"tag":614,"props":9459,"children":9460},{"class":627},[9461],{"type":24,"value":9462},"lbx[num_states ",{"type":18,"tag":614,"props":9464,"children":9465},{"class":621},[9466],{"type":24,"value":1056},{"type":18,"tag":614,"props":9468,"children":9469},{"class":627},[9470],{"type":24,"value":9027},{"type":18,"tag":614,"props":9472,"children":9473},{"class":621},[9474],{"type":24,"value":1177},{"type":18,"tag":614,"props":9476,"children":9477},{"class":627},[9478],{"type":24,"value":630},{"type":18,"tag":614,"props":9480,"children":9481},{"class":671},[9482],{"type":24,"value":977},{"type":18,"tag":614,"props":9484,"children":9485},{"class":627},[9486],{"type":24,"value":9487},"): num_states ",{"type":18,"tag":614,"props":9489,"children":9490},{"class":621},[9491],{"type":24,"value":1056},{"type":18,"tag":614,"props":9493,"children":9494},{"class":627},[9495],{"type":24,"value":9027},{"type":18,"tag":614,"props":9497,"children":9498},{"class":621},[9499],{"type":24,"value":1177},{"type":18,"tag":614,"props":9501,"children":9502},{"class":627},[9503],{"type":24,"value":630},{"type":18,"tag":614,"props":9505,"children":9506},{"class":671},[9507],{"type":24,"value":977},{"type":18,"tag":614,"props":9509,"children":9510},{"class":627},[9511],{"type":24,"value":5357},{"type":18,"tag":614,"props":9513,"children":9514},{"class":621},[9515],{"type":24,"value":1177},{"type":18,"tag":614,"props":9517,"children":9518},{"class":627},[9519],{"type":24,"value":9052},{"type":18,"tag":614,"props":9521,"children":9522},{"class":621},[9523],{"type":24,"value":1056},{"type":18,"tag":614,"props":9525,"children":9526},{"class":627},[9527],{"type":24,"value":9528}," prediction_horizons: num_controls] ",{"type":18,"tag":614,"props":9530,"children":9531},{"class":621},[9532],{"type":24,"value":711},{"type":18,"tag":614,"props":9534,"children":9535},{"class":627},[9536],{"type":24,"value":9537}," u_min\n",{"type":18,"tag":614,"props":9539,"children":9540},{"class":616,"line":875},[9541,9545,9549,9553,9557,9561,9565,9569,9573,9577,9581,9585,9589,9593,9597,9601,9605,9609,9613,9617,9621,9625,9629],{"type":18,"tag":614,"props":9542,"children":9543},{"class":627},[9544],{"type":24,"value":9462},{"type":18,"tag":614,"props":9546,"children":9547},{"class":621},[9548],{"type":24,"value":1056},{"type":18,"tag":614,"props":9550,"children":9551},{"class":627},[9552],{"type":24,"value":9027},{"type":18,"tag":614,"props":9554,"children":9555},{"class":621},[9556],{"type":24,"value":1177},{"type":18,"tag":614,"props":9558,"children":9559},{"class":627},[9560],{"type":24,"value":630},{"type":18,"tag":614,"props":9562,"children":9563},{"class":671},[9564],{"type":24,"value":977},{"type":18,"tag":614,"props":9566,"children":9567},{"class":627},[9568],{"type":24,"value":5357},{"type":18,"tag":614,"props":9570,"children":9571},{"class":621},[9572],{"type":24,"value":1177},{"type":18,"tag":614,"props":9574,"children":9575},{"class":627},[9576],{"type":24,"value":630},{"type":18,"tag":614,"props":9578,"children":9579},{"class":671},[9580],{"type":24,"value":977},{"type":18,"tag":614,"props":9582,"children":9583},{"class":627},[9584],{"type":24,"value":9165},{"type":18,"tag":614,"props":9586,"children":9587},{"class":621},[9588],{"type":24,"value":1056},{"type":18,"tag":614,"props":9590,"children":9591},{"class":627},[9592],{"type":24,"value":9027},{"type":18,"tag":614,"props":9594,"children":9595},{"class":621},[9596],{"type":24,"value":1177},{"type":18,"tag":614,"props":9598,"children":9599},{"class":627},[9600],{"type":24,"value":630},{"type":18,"tag":614,"props":9602,"children":9603},{"class":671},[9604],{"type":24,"value":977},{"type":18,"tag":614,"props":9606,"children":9607},{"class":627},[9608],{"type":24,"value":5357},{"type":18,"tag":614,"props":9610,"children":9611},{"class":621},[9612],{"type":24,"value":1177},{"type":18,"tag":614,"props":9614,"children":9615},{"class":627},[9616],{"type":24,"value":9052},{"type":18,"tag":614,"props":9618,"children":9619},{"class":621},[9620],{"type":24,"value":1056},{"type":18,"tag":614,"props":9622,"children":9623},{"class":627},[9624],{"type":24,"value":9528},{"type":18,"tag":614,"props":9626,"children":9627},{"class":621},[9628],{"type":24,"value":711},{"type":18,"tag":614,"props":9630,"children":9631},{"class":627},[9632],{"type":24,"value":9537},{"type":18,"tag":614,"props":9634,"children":9635},{"class":616,"line":908},[9636],{"type":18,"tag":614,"props":9637,"children":9638},{},[9639],{"type":24,"value":650},{"type":18,"tag":614,"props":9641,"children":9642},{"class":616,"line":916},[9643,9648,9652,9656,9660,9664,9668,9672,9676,9680,9684,9688,9692,9696,9700,9704,9708,9712,9716],{"type":18,"tag":614,"props":9644,"children":9645},{"class":627},[9646],{"type":24,"value":9647},"ubx[num_states ",{"type":18,"tag":614,"props":9649,"children":9650},{"class":621},[9651],{"type":24,"value":1056},{"type":18,"tag":614,"props":9653,"children":9654},{"class":627},[9655],{"type":24,"value":9027},{"type":18,"tag":614,"props":9657,"children":9658},{"class":621},[9659],{"type":24,"value":1177},{"type":18,"tag":614,"props":9661,"children":9662},{"class":627},[9663],{"type":24,"value":630},{"type":18,"tag":614,"props":9665,"children":9666},{"class":671},[9667],{"type":24,"value":977},{"type":18,"tag":614,"props":9669,"children":9670},{"class":627},[9671],{"type":24,"value":9487},{"type":18,"tag":614,"props":9673,"children":9674},{"class":621},[9675],{"type":24,"value":1056},{"type":18,"tag":614,"props":9677,"children":9678},{"class":627},[9679],{"type":24,"value":9027},{"type":18,"tag":614,"props":9681,"children":9682},{"class":621},[9683],{"type":24,"value":1177},{"type":18,"tag":614,"props":9685,"children":9686},{"class":627},[9687],{"type":24,"value":630},{"type":18,"tag":614,"props":9689,"children":9690},{"class":671},[9691],{"type":24,"value":977},{"type":18,"tag":614,"props":9693,"children":9694},{"class":627},[9695],{"type":24,"value":5357},{"type":18,"tag":614,"props":9697,"children":9698},{"class":621},[9699],{"type":24,"value":1177},{"type":18,"tag":614,"props":9701,"children":9702},{"class":627},[9703],{"type":24,"value":9052},{"type":18,"tag":614,"props":9705,"children":9706},{"class":621},[9707],{"type":24,"value":1056},{"type":18,"tag":614,"props":9709,"children":9710},{"class":627},[9711],{"type":24,"value":9528},{"type":18,"tag":614,"props":9713,"children":9714},{"class":621},[9715],{"type":24,"value":711},{"type":18,"tag":614,"props":9717,"children":9718},{"class":627},[9719],{"type":24,"value":9720}," u_max\n",{"type":18,"tag":614,"props":9722,"children":9723},{"class":616,"line":950},[9724,9728,9732,9736,9740,9744,9748,9752,9756,9760,9764,9768,9772,9776,9780,9784,9788,9792,9796,9800,9804,9808,9812],{"type":18,"tag":614,"props":9725,"children":9726},{"class":627},[9727],{"type":24,"value":9647},{"type":18,"tag":614,"props":9729,"children":9730},{"class":621},[9731],{"type":24,"value":1056},{"type":18,"tag":614,"props":9733,"children":9734},{"class":627},[9735],{"type":24,"value":9027},{"type":18,"tag":614,"props":9737,"children":9738},{"class":621},[9739],{"type":24,"value":1177},{"type":18,"tag":614,"props":9741,"children":9742},{"class":627},[9743],{"type":24,"value":630},{"type":18,"tag":614,"props":9745,"children":9746},{"class":671},[9747],{"type":24,"value":977},{"type":18,"tag":614,"props":9749,"children":9750},{"class":627},[9751],{"type":24,"value":5357},{"type":18,"tag":614,"props":9753,"children":9754},{"class":621},[9755],{"type":24,"value":1177},{"type":18,"tag":614,"props":9757,"children":9758},{"class":627},[9759],{"type":24,"value":630},{"type":18,"tag":614,"props":9761,"children":9762},{"class":671},[9763],{"type":24,"value":977},{"type":18,"tag":614,"props":9765,"children":9766},{"class":627},[9767],{"type":24,"value":9165},{"type":18,"tag":614,"props":9769,"children":9770},{"class":621},[9771],{"type":24,"value":1056},{"type":18,"tag":614,"props":9773,"children":9774},{"class":627},[9775],{"type":24,"value":9027},{"type":18,"tag":614,"props":9777,"children":9778},{"class":621},[9779],{"type":24,"value":1177},{"type":18,"tag":614,"props":9781,"children":9782},{"class":627},[9783],{"type":24,"value":630},{"type":18,"tag":614,"props":9785,"children":9786},{"class":671},[9787],{"type":24,"value":977},{"type":18,"tag":614,"props":9789,"children":9790},{"class":627},[9791],{"type":24,"value":5357},{"type":18,"tag":614,"props":9793,"children":9794},{"class":621},[9795],{"type":24,"value":1177},{"type":18,"tag":614,"props":9797,"children":9798},{"class":627},[9799],{"type":24,"value":9052},{"type":18,"tag":614,"props":9801,"children":9802},{"class":621},[9803],{"type":24,"value":1056},{"type":18,"tag":614,"props":9805,"children":9806},{"class":627},[9807],{"type":24,"value":9528},{"type":18,"tag":614,"props":9809,"children":9810},{"class":621},[9811],{"type":24,"value":711},{"type":18,"tag":614,"props":9813,"children":9814},{"class":627},[9815],{"type":24,"value":9720},{"type":18,"tag":614,"props":9817,"children":9818},{"class":616,"line":984},[9819],{"type":18,"tag":614,"props":9820,"children":9821},{},[9822],{"type":24,"value":650},{"type":18,"tag":614,"props":9824,"children":9825},{"class":616,"line":992},[9826,9831,9835],{"type":18,"tag":614,"props":9827,"children":9828},{"class":627},[9829],{"type":24,"value":9830},"args ",{"type":18,"tag":614,"props":9832,"children":9833},{"class":621},[9834],{"type":24,"value":711},{"type":18,"tag":614,"props":9836,"children":9837},{"class":627},[9838],{"type":24,"value":8749},{"type":18,"tag":614,"props":9840,"children":9841},{"class":616,"line":1018},[9842,9846,9851,9856,9860,9864,9868,9872,9876,9880,9884,9889,9893],{"type":18,"tag":614,"props":9843,"children":9844},{"class":627},[9845],{"type":24,"value":659},{"type":18,"tag":614,"props":9847,"children":9848},{"class":5349},[9849],{"type":24,"value":9850},"'lbg'",{"type":18,"tag":614,"props":9852,"children":9853},{"class":627},[9854],{"type":24,"value":9855},": ca.",{"type":18,"tag":614,"props":9857,"children":9858},{"class":671},[9859],{"type":24,"value":9013},{"type":18,"tag":614,"props":9861,"children":9862},{"class":627},[9863],{"type":24,"value":9018},{"type":18,"tag":614,"props":9865,"children":9866},{"class":621},[9867],{"type":24,"value":1056},{"type":18,"tag":614,"props":9869,"children":9870},{"class":627},[9871],{"type":24,"value":9027},{"type":18,"tag":614,"props":9873,"children":9874},{"class":621},[9875],{"type":24,"value":1177},{"type":18,"tag":614,"props":9877,"children":9878},{"class":627},[9879],{"type":24,"value":630},{"type":18,"tag":614,"props":9881,"children":9882},{"class":671},[9883],{"type":24,"value":977},{"type":18,"tag":614,"props":9885,"children":9886},{"class":627},[9887],{"type":24,"value":9888},"), ",{"type":18,"tag":614,"props":9890,"children":9891},{"class":671},[9892],{"type":24,"value":977},{"type":18,"tag":614,"props":9894,"children":9895},{"class":627},[9896],{"type":24,"value":9897},")),\n",{"type":18,"tag":614,"props":9899,"children":9900},{"class":616,"line":1026},[9901,9905,9910,9914,9918,9922,9926,9930,9934,9938,9942,9946,9950],{"type":18,"tag":614,"props":9902,"children":9903},{"class":627},[9904],{"type":24,"value":659},{"type":18,"tag":614,"props":9906,"children":9907},{"class":5349},[9908],{"type":24,"value":9909},"'ubg'",{"type":18,"tag":614,"props":9911,"children":9912},{"class":627},[9913],{"type":24,"value":9855},{"type":18,"tag":614,"props":9915,"children":9916},{"class":671},[9917],{"type":24,"value":9013},{"type":18,"tag":614,"props":9919,"children":9920},{"class":627},[9921],{"type":24,"value":9018},{"type":18,"tag":614,"props":9923,"children":9924},{"class":621},[9925],{"type":24,"value":1056},{"type":18,"tag":614,"props":9927,"children":9928},{"class":627},[9929],{"type":24,"value":9027},{"type":18,"tag":614,"props":9931,"children":9932},{"class":621},[9933],{"type":24,"value":1177},{"type":18,"tag":614,"props":9935,"children":9936},{"class":627},[9937],{"type":24,"value":630},{"type":18,"tag":614,"props":9939,"children":9940},{"class":671},[9941],{"type":24,"value":977},{"type":18,"tag":614,"props":9943,"children":9944},{"class":627},[9945],{"type":24,"value":9888},{"type":18,"tag":614,"props":9947,"children":9948},{"class":671},[9949],{"type":24,"value":977},{"type":18,"tag":614,"props":9951,"children":9952},{"class":627},[9953],{"type":24,"value":9897},{"type":18,"tag":614,"props":9955,"children":9956},{"class":616,"line":1068},[9957,9961,9966],{"type":18,"tag":614,"props":9958,"children":9959},{"class":627},[9960],{"type":24,"value":659},{"type":18,"tag":614,"props":9962,"children":9963},{"class":5349},[9964],{"type":24,"value":9965},"'lbx'",{"type":18,"tag":614,"props":9967,"children":9968},{"class":627},[9969],{"type":24,"value":9970},": lbx,\n",{"type":18,"tag":614,"props":9972,"children":9973},{"class":616,"line":1108},[9974,9978,9983],{"type":18,"tag":614,"props":9975,"children":9976},{"class":627},[9977],{"type":24,"value":659},{"type":18,"tag":614,"props":9979,"children":9980},{"class":5349},[9981],{"type":24,"value":9982},"'ubx'",{"type":18,"tag":614,"props":9984,"children":9985},{"class":627},[9986],{"type":24,"value":9987},": ubx\n",{"type":18,"tag":614,"props":9989,"children":9990},{"class":616,"line":1202},[9991],{"type":18,"tag":614,"props":9992,"children":9993},{"class":627},[9994],{"type":24,"value":8976},{"type":18,"tag":27,"props":9996,"children":9997},{},[9998],{"type":24,"value":9999},"Obtain the solution from the solver at each iteration",{"type":18,"tag":599,"props":10001,"children":10004},{"className":10002,"code":10003,"language":604,"meta":8},[602],"sol = solver(\n            x0=args['x0'],\n            p=args['p'],\n            lbx=args['lbx'],\n            ubx=args['ubx'],\n            lbg=args['lbg'],\n            ubg=args['ubg'],\n        )\n\n        sol_x = ca.reshape(sol['x'][:num_states * (prediction_horizons + 1)], 3, prediction_horizons + 1)\n        sol_u = ca.reshape(sol['x'][num_states * (prediction_horizons + 1):], 2, prediction_horizons)\n",[10005],{"type":18,"tag":607,"props":10006,"children":10007},{},[10008],{"type":18,"tag":599,"props":10009,"children":10010},{"__ignoreMap":8},[10011,10028,10059,10086,10114,10142,10170,10198,10206,10213,10289],{"type":18,"tag":614,"props":10012,"children":10013},{"class":616,"line":617},[10014,10019,10023],{"type":18,"tag":614,"props":10015,"children":10016},{"class":627},[10017],{"type":24,"value":10018},"sol ",{"type":18,"tag":614,"props":10020,"children":10021},{"class":621},[10022],{"type":24,"value":711},{"type":18,"tag":614,"props":10024,"children":10025},{"class":627},[10026],{"type":24,"value":10027}," solver(\n",{"type":18,"tag":614,"props":10029,"children":10030},{"class":616,"line":644},[10031,10036,10041,10045,10050,10055],{"type":18,"tag":614,"props":10032,"children":10033},{"class":627},[10034],{"type":24,"value":10035},"            ",{"type":18,"tag":614,"props":10037,"children":10038},{"class":5339},[10039],{"type":24,"value":10040},"x0",{"type":18,"tag":614,"props":10042,"children":10043},{"class":621},[10044],{"type":24,"value":711},{"type":18,"tag":614,"props":10046,"children":10047},{"class":627},[10048],{"type":24,"value":10049},"args[",{"type":18,"tag":614,"props":10051,"children":10052},{"class":5349},[10053],{"type":24,"value":10054},"'x0'",{"type":18,"tag":614,"props":10056,"children":10057},{"class":627},[10058],{"type":24,"value":3221},{"type":18,"tag":614,"props":10060,"children":10061},{"class":616,"line":653},[10062,10066,10070,10074,10078,10082],{"type":18,"tag":614,"props":10063,"children":10064},{"class":627},[10065],{"type":24,"value":10035},{"type":18,"tag":614,"props":10067,"children":10068},{"class":5339},[10069],{"type":24,"value":27},{"type":18,"tag":614,"props":10071,"children":10072},{"class":621},[10073],{"type":24,"value":711},{"type":18,"tag":614,"props":10075,"children":10076},{"class":627},[10077],{"type":24,"value":10049},{"type":18,"tag":614,"props":10079,"children":10080},{"class":5349},[10081],{"type":24,"value":8794},{"type":18,"tag":614,"props":10083,"children":10084},{"class":627},[10085],{"type":24,"value":3221},{"type":18,"tag":614,"props":10087,"children":10088},{"class":616,"line":682},[10089,10093,10098,10102,10106,10110],{"type":18,"tag":614,"props":10090,"children":10091},{"class":627},[10092],{"type":24,"value":10035},{"type":18,"tag":614,"props":10094,"children":10095},{"class":5339},[10096],{"type":24,"value":10097},"lbx",{"type":18,"tag":614,"props":10099,"children":10100},{"class":621},[10101],{"type":24,"value":711},{"type":18,"tag":614,"props":10103,"children":10104},{"class":627},[10105],{"type":24,"value":10049},{"type":18,"tag":614,"props":10107,"children":10108},{"class":5349},[10109],{"type":24,"value":9965},{"type":18,"tag":614,"props":10111,"children":10112},{"class":627},[10113],{"type":24,"value":3221},{"type":18,"tag":614,"props":10115,"children":10116},{"class":616,"line":690},[10117,10121,10126,10130,10134,10138],{"type":18,"tag":614,"props":10118,"children":10119},{"class":627},[10120],{"type":24,"value":10035},{"type":18,"tag":614,"props":10122,"children":10123},{"class":5339},[10124],{"type":24,"value":10125},"ubx",{"type":18,"tag":614,"props":10127,"children":10128},{"class":621},[10129],{"type":24,"value":711},{"type":18,"tag":614,"props":10131,"children":10132},{"class":627},[10133],{"type":24,"value":10049},{"type":18,"tag":614,"props":10135,"children":10136},{"class":5349},[10137],{"type":24,"value":9982},{"type":18,"tag":614,"props":10139,"children":10140},{"class":627},[10141],{"type":24,"value":3221},{"type":18,"tag":614,"props":10143,"children":10144},{"class":616,"line":719},[10145,10149,10154,10158,10162,10166],{"type":18,"tag":614,"props":10146,"children":10147},{"class":627},[10148],{"type":24,"value":10035},{"type":18,"tag":614,"props":10150,"children":10151},{"class":5339},[10152],{"type":24,"value":10153},"lbg",{"type":18,"tag":614,"props":10155,"children":10156},{"class":621},[10157],{"type":24,"value":711},{"type":18,"tag":614,"props":10159,"children":10160},{"class":627},[10161],{"type":24,"value":10049},{"type":18,"tag":614,"props":10163,"children":10164},{"class":5349},[10165],{"type":24,"value":9850},{"type":18,"tag":614,"props":10167,"children":10168},{"class":627},[10169],{"type":24,"value":3221},{"type":18,"tag":614,"props":10171,"children":10172},{"class":616,"line":745},[10173,10177,10182,10186,10190,10194],{"type":18,"tag":614,"props":10174,"children":10175},{"class":627},[10176],{"type":24,"value":10035},{"type":18,"tag":614,"props":10178,"children":10179},{"class":5339},[10180],{"type":24,"value":10181},"ubg",{"type":18,"tag":614,"props":10183,"children":10184},{"class":621},[10185],{"type":24,"value":711},{"type":18,"tag":614,"props":10187,"children":10188},{"class":627},[10189],{"type":24,"value":10049},{"type":18,"tag":614,"props":10191,"children":10192},{"class":5349},[10193],{"type":24,"value":9909},{"type":18,"tag":614,"props":10195,"children":10196},{"class":627},[10197],{"type":24,"value":3221},{"type":18,"tag":614,"props":10199,"children":10200},{"class":616,"line":771},[10201],{"type":18,"tag":614,"props":10202,"children":10203},{"class":627},[10204],{"type":24,"value":10205},"        )\n",{"type":18,"tag":614,"props":10207,"children":10208},{"class":616,"line":779},[10209],{"type":18,"tag":614,"props":10210,"children":10211},{},[10212],{"type":24,"value":650},{"type":18,"tag":614,"props":10214,"children":10215},{"class":616,"line":805},[10216,10221,10225,10230,10234,10239,10243,10247,10251,10255,10259,10264,10268,10273,10277,10281,10285],{"type":18,"tag":614,"props":10217,"children":10218},{"class":627},[10219],{"type":24,"value":10220},"        sol_x ",{"type":18,"tag":614,"props":10222,"children":10223},{"class":621},[10224],{"type":24,"value":711},{"type":18,"tag":614,"props":10226,"children":10227},{"class":627},[10228],{"type":24,"value":10229}," ca.reshape(sol[",{"type":18,"tag":614,"props":10231,"children":10232},{"class":5349},[10233],{"type":24,"value":8777},{"type":18,"tag":614,"props":10235,"children":10236},{"class":627},[10237],{"type":24,"value":10238},"][:num_states ",{"type":18,"tag":614,"props":10240,"children":10241},{"class":621},[10242],{"type":24,"value":1056},{"type":18,"tag":614,"props":10244,"children":10245},{"class":627},[10246],{"type":24,"value":9027},{"type":18,"tag":614,"props":10248,"children":10249},{"class":621},[10250],{"type":24,"value":1177},{"type":18,"tag":614,"props":10252,"children":10253},{"class":627},[10254],{"type":24,"value":630},{"type":18,"tag":614,"props":10256,"children":10257},{"class":671},[10258],{"type":24,"value":977},{"type":18,"tag":614,"props":10260,"children":10261},{"class":627},[10262],{"type":24,"value":10263},")], ",{"type":18,"tag":614,"props":10265,"children":10266},{"class":671},[10267],{"type":24,"value":2535},{"type":18,"tag":614,"props":10269,"children":10270},{"class":627},[10271],{"type":24,"value":10272},", prediction_horizons ",{"type":18,"tag":614,"props":10274,"children":10275},{"class":621},[10276],{"type":24,"value":1177},{"type":18,"tag":614,"props":10278,"children":10279},{"class":627},[10280],{"type":24,"value":630},{"type":18,"tag":614,"props":10282,"children":10283},{"class":671},[10284],{"type":24,"value":977},{"type":18,"tag":614,"props":10286,"children":10287},{"class":627},[10288],{"type":24,"value":1423},{"type":18,"tag":614,"props":10290,"children":10291},{"class":616,"line":831},[10292,10297,10301,10305,10309,10314,10318,10322,10326,10330,10334,10339,10343],{"type":18,"tag":614,"props":10293,"children":10294},{"class":627},[10295],{"type":24,"value":10296},"        sol_u ",{"type":18,"tag":614,"props":10298,"children":10299},{"class":621},[10300],{"type":24,"value":711},{"type":18,"tag":614,"props":10302,"children":10303},{"class":627},[10304],{"type":24,"value":10229},{"type":18,"tag":614,"props":10306,"children":10307},{"class":5349},[10308],{"type":24,"value":8777},{"type":18,"tag":614,"props":10310,"children":10311},{"class":627},[10312],{"type":24,"value":10313},"][num_states ",{"type":18,"tag":614,"props":10315,"children":10316},{"class":621},[10317],{"type":24,"value":1056},{"type":18,"tag":614,"props":10319,"children":10320},{"class":627},[10321],{"type":24,"value":9027},{"type":18,"tag":614,"props":10323,"children":10324},{"class":621},[10325],{"type":24,"value":1177},{"type":18,"tag":614,"props":10327,"children":10328},{"class":627},[10329],{"type":24,"value":630},{"type":18,"tag":614,"props":10331,"children":10332},{"class":671},[10333],{"type":24,"value":977},{"type":18,"tag":614,"props":10335,"children":10336},{"class":627},[10337],{"type":24,"value":10338},"):], ",{"type":18,"tag":614,"props":10340,"children":10341},{"class":671},[10342],{"type":24,"value":1353},{"type":18,"tag":614,"props":10344,"children":10345},{"class":627},[10346],{"type":24,"value":10347},", prediction_horizons)",{"type":18,"tag":19,"props":10349,"children":10351},{"id":10350},"result",[10352],{"type":24,"value":10353},"Result",{"type":18,"tag":27,"props":10355,"children":10356},{},[10357],{"type":24,"value":10358},"I use MPC to control the differential drive robot to move from it zero position the the desired postion that I want to follow !.\nI generate a circle trajectory and I fit this curve into my beautiful and robustness cost and then volia !!!.",{"type":18,"tag":6295,"props":10360,"children":10362},{"className":10361},[6298,6299,6300],[10363,10364],{"type":24,"value":6303},{"type":18,"tag":6305,"props":10365,"children":10368},{"className":10366,"src":10367,"width":6337,"height":6338},[6308],"/topics/robotics/nmpc/diff_mpc.png",[],{"type":18,"tag":6314,"props":10370,"children":10372},{"className":10371},[68,6317,6318,6319],[10373],{"type":24,"value":10374},"\n    Plot of differential drive robot follow the circle trajectory !!!.\n",{"type":18,"tag":19,"props":10376,"children":10377},{"id":6362},[10378],{"type":24,"value":10379},"In conclusion",{"type":18,"tag":27,"props":10381,"children":10382},{},[10383],{"type":24,"value":10384},"In my opinion, I think MPC is suitable for the control system, since it can provide the significant control input that was predicted over the finite future of time. This can ensure the safety of the system and also can provide a quick look or reaction to the control action of the system too.",{"type":18,"tag":19,"props":10386,"children":10388},{"id":10387},"reference",[10389],{"type":24,"value":10390},"Reference",{"type":18,"tag":284,"props":10392,"children":10393},{},[10394,10404,10414],{"type":18,"tag":80,"props":10395,"children":10396},{},[10397],{"type":18,"tag":6352,"props":10398,"children":10401},{"href":10399,"rel":10400},"https://github.com/MMehrez/MPC-and-MHE-implementation-in-MATLAB-using-Casadi",[6356],[10402],{"type":24,"value":10403},"MPC-and-MHE-implementation-in-MATLAB-using-Casadi",{"type":18,"tag":80,"props":10405,"children":10406},{},[10407],{"type":18,"tag":6352,"props":10408,"children":10411},{"href":10409,"rel":10410},"https://web.casadi.org",[6356],[10412],{"type":24,"value":10413},"CasAdi",{"type":18,"tag":80,"props":10415,"children":10416},{},[10417],{"type":18,"tag":6352,"props":10418,"children":10421},{"href":10419,"rel":10420},"https://github.com/SokhengDin/PathTracking",[6356],[10422],{"type":24,"value":6359},{"type":18,"tag":6431,"children":10424},[10425],{"type":24,"value":10426},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-326375{color:#6A737D;}\n.ct-533739{color:#79B8FF;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":644,"depth":644,"links":10428},[10429,10430,10431,10432,10433,10434,10435,10436,10437],{"id":35,"depth":644,"text":38},{"id":6497,"depth":644,"text":6500},{"id":6641,"depth":644,"text":6644},{"id":7879,"depth":644,"text":7882},{"id":7907,"depth":644,"text":7910},{"id":7950,"depth":644,"text":7953},{"id":10350,"depth":644,"text":10353},{"id":6362,"depth":644,"text":10379},{"id":10387,"depth":644,"text":10390},"content:topics:robotics:nonlinear-mpc.md","topics/robotics/nonlinear-mpc.md",{"_path":10441,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":10442,"description":10443,"author":10444,"slug":10445,"tag":10445,"img":10446,"body":10447,"_type":6447,"_id":12339,"_source":6449,"_file":12340,"_extension":6451},"/topics/robotics/pid-controller","Introduction to PID Controller in Python","PID Control is a feedback control","DIN SOKHENG","pid","/topics/robotics/nmpc/PID.png",{"type":15,"children":10448,"toc":12325},[10449,10455,10465,10471,10476,10482,10486,10525,10534,10540,10546,10556,10562,10567,10601,10607,10612,10617,10627,10633,10638,10642,10647,10651,10656,11058,11075,11621,11626,11632,11638,11656,11742,11747,11809,11814,11898,11910,12196,12202,12221,12235,12239,12249,12255,12265,12271,12275,12280,12284,12321],{"type":18,"tag":19,"props":10450,"children":10452},{"id":10451},"what-is-pid-controller",[10453],{"type":24,"value":10454},"What is PID Controller ?",{"type":18,"tag":27,"props":10456,"children":10457},{},[10458,10460,10464],{"type":24,"value":10459},"The Proportional Integral Derivative (PID) controller is a traditional method in control systems that has found widespread use in control system engineering and industrial applications since its emergence in the 1940s. A PID controller is considered a feedback controller, aiming to minimize the error between the system's feedback and the desired setpoint by manually or automatically fine-tuning the coefficients ",{"type":18,"tag":84,"props":10461,"children":10463},{"latex-express":10462,"styles":87},"K_{P}, K_{I}, K_{D}",[],{"type":24,"value":197},{"type":18,"tag":19,"props":10466,"children":10468},{"id":10467},"how-it-works",[10469],{"type":24,"value":10470},"How it works ?",{"type":18,"tag":27,"props":10472,"children":10473},{},[10474],{"type":24,"value":10475},"Imagine you want to control the speed of a DC motor to reach 300 RPM, but due to the natural response of the DC motor, it cannot reach the desired angular speed. PID offers a solution to this natural response by adjusting the system's time response using its three components, as shown in the formula below.",{"type":18,"tag":19,"props":10477,"children":10479},{"id":10478},"formulation",[10480],{"type":24,"value":10481},"Formulation",{"type":18,"tag":65,"props":10483,"children":10485},{"latex-express":10484,"styles":68},"u(t) = K_{p}e(t) + K_{I} \\int_{0}^{t} e(t) dt + K_{D} \\frac{d e(t)}{dt} ",[],{"type":18,"tag":76,"props":10487,"children":10488},{},[10489,10498,10507,10516],{"type":18,"tag":80,"props":10490,"children":10491},{},[10492,10496],{"type":18,"tag":84,"props":10493,"children":10495},{"latex-express":10494,"styles":87},"K_{P}",[],{"type":24,"value":10497}," represents the proportional gain.",{"type":18,"tag":80,"props":10499,"children":10500},{},[10501,10505],{"type":18,"tag":84,"props":10502,"children":10504},{"latex-express":10503,"styles":87},"K_{I}",[],{"type":24,"value":10506}," represents the integral gain.",{"type":18,"tag":80,"props":10508,"children":10509},{},[10510,10514],{"type":18,"tag":84,"props":10511,"children":10513},{"latex-express":10512,"styles":87},"K_{D}",[],{"type":24,"value":10515}," represents the derivative gain.",{"type":18,"tag":80,"props":10517,"children":10518},{},[10519,10523],{"type":18,"tag":84,"props":10520,"children":10522},{"latex-express":10521,"styles":87},"e(t)=target-feedback",[],{"type":24,"value":10524}," is the error between target point and feedback of the system",{"type":18,"tag":6295,"props":10526,"children":10528},{"className":10527},[6298,6299,6300],[10529,10530],{"type":24,"value":6303},{"type":18,"tag":6305,"props":10531,"children":10533},{"className":10532,"src":10446},[6308],[],{"type":18,"tag":6314,"props":10535,"children":10537},{"className":10536},[68,6317,6318,6319],[10538],{"type":24,"value":10539},"\n    The Block diagram of PID Controller\n",{"type":18,"tag":19,"props":10541,"children":10543},{"id":10542},"response-time",[10544],{"type":24,"value":10545},"Response Time",{"type":18,"tag":6295,"props":10547,"children":10549},{"className":10548},[6298,6299,6300],[10550,10551],{"type":24,"value":6303},{"type":18,"tag":6305,"props":10552,"children":10555},{"className":10553,"src":10554},[6308],"/topics/robotics/nmpc/response_timepid.png",[],{"type":18,"tag":6314,"props":10557,"children":10559},{"className":10558},[68,6317,6318,6319],[10560],{"type":24,"value":10561},"\n    The response time of the system with each K_P, K_I, K_D\n",{"type":18,"tag":27,"props":10563,"children":10564},{},[10565],{"type":24,"value":10566},"As you can see in the figure above, the response time of the system is difference.",{"type":18,"tag":76,"props":10568,"children":10569},{},[10570,10581,10591],{"type":18,"tag":80,"props":10571,"children":10572},{},[10573,10575,10579],{"type":24,"value":10574},"The response time with ",{"type":18,"tag":84,"props":10576,"children":10578},{"latex-express":10577,"styles":87},"K_{I}=2",[],{"type":24,"value":10580}," the system is likely to overshoot before reaching the steady-state, which may not be suitable for applications like controlling a DC motor.",{"type":18,"tag":80,"props":10582,"children":10583},{},[10584,10585,10589],{"type":24,"value":10574},{"type":18,"tag":84,"props":10586,"children":10588},{"latex-express":10587,"styles":87},"K_{i}=0.5, ",[],{"type":24,"value":10590},"  the response does not overshoot but has a slower response to reach the steady-state.",{"type":18,"tag":80,"props":10592,"children":10593},{},[10594,10595,10599],{"type":24,"value":10574},{"type":18,"tag":84,"props":10596,"children":10598},{"latex-express":10597,"styles":87},"K_{p}=1, K_{i}=1, K_{d}=1",[],{"type":24,"value":10600},"  there is a slight overshoot, but the steady-state is reached faster.",{"type":18,"tag":19,"props":10602,"children":10604},{"id":10603},"how-can-we-write-pid-code-in-python",[10605],{"type":24,"value":10606},"How can we write PID code in Python ?",{"type":18,"tag":27,"props":10608,"children":10609},{},[10610],{"type":24,"value":10611},"Let's use a differential drive robot as a case study system. A differential drive robot is commonly used in robotics and automation, making it an ideal choice for a demonstration.",{"type":18,"tag":27,"props":10613,"children":10614},{},[10615],{"type":24,"value":10616},"The configuration of Differential Drive Robot in axes OXY.",{"type":18,"tag":6295,"props":10618,"children":10620},{"className":10619},[6298,6299,6300],[10621,10622],{"type":24,"value":6303},{"type":18,"tag":6305,"props":10623,"children":10626},{"className":10624,"src":10625},[6308],"/topics/robotics/nmpc/diff_drive.png",[],{"type":18,"tag":6314,"props":10628,"children":10630},{"className":10629},[68,6317,6318,6319],[10631],{"type":24,"value":10632},"\n    The configuration of Differential Drive Robot in axes OXY.\n",{"type":18,"tag":27,"props":10634,"children":10635},{},[10636],{"type":24,"value":10637},"The forward kinematic equation",{"type":18,"tag":65,"props":10639,"children":10641},{"latex-express":10640,"styles":68},"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{\\theta} \\\\ \\omega \\end{bmatrix}\n ",[],{"type":18,"tag":27,"props":10643,"children":10644},{},[10645],{"type":24,"value":10646},"So, if we discretize the forward kinematic with a certain sampling time, we will get",{"type":18,"tag":84,"props":10648,"children":10650},{"latex-express":10649,"styles":68},"\n\\begin{bmatrix} x_{t+1} \\\\ y_{t+1} \\\\ \\theta_{t+1} \\end{bmatrix} = \\begin{bmatrix} x_{t} \\\\ y_{t} \\\\ \\theta_{t} \\end{bmatrix} +\\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix} \\times \\Delta t\n ",[],{"type":18,"tag":27,"props":10652,"children":10653},{},[10654],{"type":24,"value":10655},"In Python,",{"type":18,"tag":599,"props":10657,"children":10660},{"className":10658,"code":10659,"language":604,"meta":8},[602],"class DifferentialDrive:\n    def __init__(self):\n        self.r = 0.05\n        self.L = 0.25\n    def forward_kinematic(self, v, omega, yaw):\n        vx = v*np.cos(yaw)\n        vy = v*np.sin(yaw)\n        vyaw = omega\n\n        return vx, vy, vyaw\n    def discrete_state(self, x, y, yaw, v, omega, dt):\n        dx, dy, dyaw = self.forward_kinematic(v, omega, yaw)\n        x_next = x + dx * dt\n        y_next = y + dy * dt\n        yaw_next = yaw + dyaw * dt\n\n        return x_next, y_next, yaw_next\n",[10661],{"type":18,"tag":607,"props":10662,"children":10663},{},[10664],{"type":18,"tag":599,"props":10665,"children":10666},{"__ignoreMap":8},[10667,10687,10710,10739,10768,10793,10818,10843,10860,10867,10883,10908,10933,10967,11001,11035,11042],{"type":18,"tag":614,"props":10668,"children":10669},{"class":616,"line":617},[10670,10674,10678,10683],{"type":18,"tag":614,"props":10671,"children":10672},{"class":621},[10673],{"type":24,"value":624},{"type":18,"tag":614,"props":10675,"children":10676},{"class":627},[10677],{"type":24,"value":630},{"type":18,"tag":614,"props":10679,"children":10680},{"class":633},[10681],{"type":24,"value":10682},"DifferentialDrive",{"type":18,"tag":614,"props":10684,"children":10685},{"class":627},[10686],{"type":24,"value":641},{"type":18,"tag":614,"props":10688,"children":10689},{"class":616,"line":644},[10690,10694,10698,10702,10706],{"type":18,"tag":614,"props":10691,"children":10692},{"class":627},[10693],{"type":24,"value":659},{"type":18,"tag":614,"props":10695,"children":10696},{"class":621},[10697],{"type":24,"value":664},{"type":18,"tag":614,"props":10699,"children":10700},{"class":627},[10701],{"type":24,"value":630},{"type":18,"tag":614,"props":10703,"children":10704},{"class":671},[10705],{"type":24,"value":674},{"type":18,"tag":614,"props":10707,"children":10708},{"class":627},[10709],{"type":24,"value":1834},{"type":18,"tag":614,"props":10711,"children":10712},{"class":616,"line":653},[10713,10717,10721,10726,10730,10734],{"type":18,"tag":614,"props":10714,"children":10715},{"class":627},[10716],{"type":24,"value":696},{"type":18,"tag":614,"props":10718,"children":10719},{"class":671},[10720],{"type":24,"value":701},{"type":18,"tag":614,"props":10722,"children":10723},{"class":627},[10724],{"type":24,"value":10725},".r ",{"type":18,"tag":614,"props":10727,"children":10728},{"class":621},[10729],{"type":24,"value":711},{"type":18,"tag":614,"props":10731,"children":10732},{"class":627},[10733],{"type":24,"value":630},{"type":18,"tag":614,"props":10735,"children":10736},{"class":671},[10737],{"type":24,"value":10738},"0.05\n",{"type":18,"tag":614,"props":10740,"children":10741},{"class":616,"line":682},[10742,10746,10750,10755,10759,10763],{"type":18,"tag":614,"props":10743,"children":10744},{"class":627},[10745],{"type":24,"value":696},{"type":18,"tag":614,"props":10747,"children":10748},{"class":671},[10749],{"type":24,"value":701},{"type":18,"tag":614,"props":10751,"children":10752},{"class":627},[10753],{"type":24,"value":10754},".L ",{"type":18,"tag":614,"props":10756,"children":10757},{"class":621},[10758],{"type":24,"value":711},{"type":18,"tag":614,"props":10760,"children":10761},{"class":627},[10762],{"type":24,"value":630},{"type":18,"tag":614,"props":10764,"children":10765},{"class":671},[10766],{"type":24,"value":10767},"0.25\n",{"type":18,"tag":614,"props":10769,"children":10770},{"class":616,"line":690},[10771,10775,10779,10783,10788],{"type":18,"tag":614,"props":10772,"children":10773},{"class":627},[10774],{"type":24,"value":659},{"type":18,"tag":614,"props":10776,"children":10777},{"class":621},[10778],{"type":24,"value":664},{"type":18,"tag":614,"props":10780,"children":10781},{"class":627},[10782],{"type":24,"value":630},{"type":18,"tag":614,"props":10784,"children":10785},{"class":633},[10786],{"type":24,"value":10787},"forward_kinematic",{"type":18,"tag":614,"props":10789,"children":10790},{"class":627},[10791],{"type":24,"value":10792},"(self, v, omega, yaw):\n",{"type":18,"tag":614,"props":10794,"children":10795},{"class":616,"line":719},[10796,10801,10805,10810,10814],{"type":18,"tag":614,"props":10797,"children":10798},{"class":627},[10799],{"type":24,"value":10800},"        vx ",{"type":18,"tag":614,"props":10802,"children":10803},{"class":621},[10804],{"type":24,"value":711},{"type":18,"tag":614,"props":10806,"children":10807},{"class":627},[10808],{"type":24,"value":10809}," v",{"type":18,"tag":614,"props":10811,"children":10812},{"class":621},[10813],{"type":24,"value":1056},{"type":18,"tag":614,"props":10815,"children":10816},{"class":627},[10817],{"type":24,"value":1199},{"type":18,"tag":614,"props":10819,"children":10820},{"class":616,"line":745},[10821,10826,10830,10834,10838],{"type":18,"tag":614,"props":10822,"children":10823},{"class":627},[10824],{"type":24,"value":10825},"        vy ",{"type":18,"tag":614,"props":10827,"children":10828},{"class":621},[10829],{"type":24,"value":711},{"type":18,"tag":614,"props":10831,"children":10832},{"class":627},[10833],{"type":24,"value":10809},{"type":18,"tag":614,"props":10835,"children":10836},{"class":621},[10837],{"type":24,"value":1056},{"type":18,"tag":614,"props":10839,"children":10840},{"class":627},[10841],{"type":24,"value":10842},"np.sin(yaw)\n",{"type":18,"tag":614,"props":10844,"children":10845},{"class":616,"line":771},[10846,10851,10855],{"type":18,"tag":614,"props":10847,"children":10848},{"class":627},[10849],{"type":24,"value":10850},"        vyaw ",{"type":18,"tag":614,"props":10852,"children":10853},{"class":621},[10854],{"type":24,"value":711},{"type":18,"tag":614,"props":10856,"children":10857},{"class":627},[10858],{"type":24,"value":10859}," omega\n",{"type":18,"tag":614,"props":10861,"children":10862},{"class":616,"line":779},[10863],{"type":18,"tag":614,"props":10864,"children":10865},{},[10866],{"type":24,"value":650},{"type":18,"tag":614,"props":10868,"children":10869},{"class":616,"line":805},[10870,10874,10878],{"type":18,"tag":614,"props":10871,"children":10872},{"class":627},[10873],{"type":24,"value":696},{"type":18,"tag":614,"props":10875,"children":10876},{"class":621},[10877],{"type":24,"value":1220},{"type":18,"tag":614,"props":10879,"children":10880},{"class":627},[10881],{"type":24,"value":10882}," vx, vy, vyaw\n",{"type":18,"tag":614,"props":10884,"children":10885},{"class":616,"line":831},[10886,10890,10894,10898,10903],{"type":18,"tag":614,"props":10887,"children":10888},{"class":627},[10889],{"type":24,"value":659},{"type":18,"tag":614,"props":10891,"children":10892},{"class":621},[10893],{"type":24,"value":664},{"type":18,"tag":614,"props":10895,"children":10896},{"class":627},[10897],{"type":24,"value":630},{"type":18,"tag":614,"props":10899,"children":10900},{"class":633},[10901],{"type":24,"value":10902},"discrete_state",{"type":18,"tag":614,"props":10904,"children":10905},{"class":627},[10906],{"type":24,"value":10907},"(self, x, y, yaw, v, omega, dt):\n",{"type":18,"tag":614,"props":10909,"children":10910},{"class":616,"line":839},[10911,10916,10920,10924,10928],{"type":18,"tag":614,"props":10912,"children":10913},{"class":627},[10914],{"type":24,"value":10915},"        dx, dy, dyaw ",{"type":18,"tag":614,"props":10917,"children":10918},{"class":621},[10919],{"type":24,"value":711},{"type":18,"tag":614,"props":10921,"children":10922},{"class":627},[10923],{"type":24,"value":630},{"type":18,"tag":614,"props":10925,"children":10926},{"class":671},[10927],{"type":24,"value":701},{"type":18,"tag":614,"props":10929,"children":10930},{"class":627},[10931],{"type":24,"value":10932},".forward_kinematic(v, omega, yaw)\n",{"type":18,"tag":614,"props":10934,"children":10935},{"class":616,"line":875},[10936,10941,10945,10950,10954,10959,10963],{"type":18,"tag":614,"props":10937,"children":10938},{"class":627},[10939],{"type":24,"value":10940},"        x_next ",{"type":18,"tag":614,"props":10942,"children":10943},{"class":621},[10944],{"type":24,"value":711},{"type":18,"tag":614,"props":10946,"children":10947},{"class":627},[10948],{"type":24,"value":10949}," x ",{"type":18,"tag":614,"props":10951,"children":10952},{"class":621},[10953],{"type":24,"value":1177},{"type":18,"tag":614,"props":10955,"children":10956},{"class":627},[10957],{"type":24,"value":10958}," dx ",{"type":18,"tag":614,"props":10960,"children":10961},{"class":621},[10962],{"type":24,"value":1056},{"type":18,"tag":614,"props":10964,"children":10965},{"class":627},[10966],{"type":24,"value":2947},{"type":18,"tag":614,"props":10968,"children":10969},{"class":616,"line":908},[10970,10975,10979,10984,10988,10993,10997],{"type":18,"tag":614,"props":10971,"children":10972},{"class":627},[10973],{"type":24,"value":10974},"        y_next ",{"type":18,"tag":614,"props":10976,"children":10977},{"class":621},[10978],{"type":24,"value":711},{"type":18,"tag":614,"props":10980,"children":10981},{"class":627},[10982],{"type":24,"value":10983}," y ",{"type":18,"tag":614,"props":10985,"children":10986},{"class":621},[10987],{"type":24,"value":1177},{"type":18,"tag":614,"props":10989,"children":10990},{"class":627},[10991],{"type":24,"value":10992}," dy ",{"type":18,"tag":614,"props":10994,"children":10995},{"class":621},[10996],{"type":24,"value":1056},{"type":18,"tag":614,"props":10998,"children":10999},{"class":627},[11000],{"type":24,"value":2947},{"type":18,"tag":614,"props":11002,"children":11003},{"class":616,"line":916},[11004,11009,11013,11018,11022,11027,11031],{"type":18,"tag":614,"props":11005,"children":11006},{"class":627},[11007],{"type":24,"value":11008},"        yaw_next ",{"type":18,"tag":614,"props":11010,"children":11011},{"class":621},[11012],{"type":24,"value":711},{"type":18,"tag":614,"props":11014,"children":11015},{"class":627},[11016],{"type":24,"value":11017}," yaw ",{"type":18,"tag":614,"props":11019,"children":11020},{"class":621},[11021],{"type":24,"value":1177},{"type":18,"tag":614,"props":11023,"children":11024},{"class":627},[11025],{"type":24,"value":11026}," dyaw ",{"type":18,"tag":614,"props":11028,"children":11029},{"class":621},[11030],{"type":24,"value":1056},{"type":18,"tag":614,"props":11032,"children":11033},{"class":627},[11034],{"type":24,"value":2947},{"type":18,"tag":614,"props":11036,"children":11037},{"class":616,"line":950},[11038],{"type":18,"tag":614,"props":11039,"children":11040},{},[11041],{"type":24,"value":650},{"type":18,"tag":614,"props":11043,"children":11044},{"class":616,"line":984},[11045,11049,11053],{"type":18,"tag":614,"props":11046,"children":11047},{"class":627},[11048],{"type":24,"value":696},{"type":18,"tag":614,"props":11050,"children":11051},{"class":621},[11052],{"type":24,"value":1220},{"type":18,"tag":614,"props":11054,"children":11055},{"class":627},[11056],{"type":24,"value":11057}," x_next, y_next, yaw_next",{"type":18,"tag":27,"props":11059,"children":11060},{},[11061,11063,11067,11069,11074],{"type":24,"value":11062},"The ",{"type":18,"tag":170,"props":11064,"children":11065},{},[11066],{"type":24,"value":6654},{"type":24,"value":11068}," class that we defined, has all the need attribute to use for PID control !!. We just need to write another class for our ",{"type":18,"tag":170,"props":11070,"children":11071},{},[11072],{"type":24,"value":11073}," PID Controller ",{"type":24,"value":197},{"type":18,"tag":599,"props":11076,"children":11079},{"className":11077,"code":11078,"language":604,"meta":8},[602],"class PIDController:\n    def __init__(self, kp, ki, kd, dt):\n\n        self.kp = kp\n        self.ki = ki\n        self.kd = kd\n        self.dt = dt\n        self.integral = 0\n\n    def calculate_pid(self, errors):\n        # Calculate proportional error\n        proportional = self.kp * errors[-1]\n        # Calculate integration error\n        integral = self.integral + self.ki * (errors[-1]) * self.dt\n        self.integral = integral\n        # Calculate derivative error\n        derivative = self.kd * (errors[-1] - errors[-2])/self.dt\n\n        output = proportional + integral + derivative\n\n        return output\n",[11080],{"type":18,"tag":607,"props":11081,"children":11082},{},[11083],{"type":18,"tag":599,"props":11084,"children":11085},{"__ignoreMap":8},[11086,11106,11130,11137,11162,11187,11212,11236,11264,11271,11296,11308,11353,11365,11443,11467,11479,11556,11563,11598,11605],{"type":18,"tag":614,"props":11087,"children":11088},{"class":616,"line":617},[11089,11093,11097,11102],{"type":18,"tag":614,"props":11090,"children":11091},{"class":621},[11092],{"type":24,"value":624},{"type":18,"tag":614,"props":11094,"children":11095},{"class":627},[11096],{"type":24,"value":630},{"type":18,"tag":614,"props":11098,"children":11099},{"class":633},[11100],{"type":24,"value":11101},"PIDController",{"type":18,"tag":614,"props":11103,"children":11104},{"class":627},[11105],{"type":24,"value":641},{"type":18,"tag":614,"props":11107,"children":11108},{"class":616,"line":644},[11109,11113,11117,11121,11125],{"type":18,"tag":614,"props":11110,"children":11111},{"class":627},[11112],{"type":24,"value":659},{"type":18,"tag":614,"props":11114,"children":11115},{"class":621},[11116],{"type":24,"value":664},{"type":18,"tag":614,"props":11118,"children":11119},{"class":627},[11120],{"type":24,"value":630},{"type":18,"tag":614,"props":11122,"children":11123},{"class":671},[11124],{"type":24,"value":674},{"type":18,"tag":614,"props":11126,"children":11127},{"class":627},[11128],{"type":24,"value":11129},"(self, kp, ki, kd, dt):\n",{"type":18,"tag":614,"props":11131,"children":11132},{"class":616,"line":653},[11133],{"type":18,"tag":614,"props":11134,"children":11135},{},[11136],{"type":24,"value":650},{"type":18,"tag":614,"props":11138,"children":11139},{"class":616,"line":682},[11140,11144,11148,11153,11157],{"type":18,"tag":614,"props":11141,"children":11142},{"class":627},[11143],{"type":24,"value":696},{"type":18,"tag":614,"props":11145,"children":11146},{"class":671},[11147],{"type":24,"value":701},{"type":18,"tag":614,"props":11149,"children":11150},{"class":627},[11151],{"type":24,"value":11152},".kp ",{"type":18,"tag":614,"props":11154,"children":11155},{"class":621},[11156],{"type":24,"value":711},{"type":18,"tag":614,"props":11158,"children":11159},{"class":627},[11160],{"type":24,"value":11161}," kp\n",{"type":18,"tag":614,"props":11163,"children":11164},{"class":616,"line":690},[11165,11169,11173,11178,11182],{"type":18,"tag":614,"props":11166,"children":11167},{"class":627},[11168],{"type":24,"value":696},{"type":18,"tag":614,"props":11170,"children":11171},{"class":671},[11172],{"type":24,"value":701},{"type":18,"tag":614,"props":11174,"children":11175},{"class":627},[11176],{"type":24,"value":11177},".ki ",{"type":18,"tag":614,"props":11179,"children":11180},{"class":621},[11181],{"type":24,"value":711},{"type":18,"tag":614,"props":11183,"children":11184},{"class":627},[11185],{"type":24,"value":11186}," ki\n",{"type":18,"tag":614,"props":11188,"children":11189},{"class":616,"line":719},[11190,11194,11198,11203,11207],{"type":18,"tag":614,"props":11191,"children":11192},{"class":627},[11193],{"type":24,"value":696},{"type":18,"tag":614,"props":11195,"children":11196},{"class":671},[11197],{"type":24,"value":701},{"type":18,"tag":614,"props":11199,"children":11200},{"class":627},[11201],{"type":24,"value":11202},".kd ",{"type":18,"tag":614,"props":11204,"children":11205},{"class":621},[11206],{"type":24,"value":711},{"type":18,"tag":614,"props":11208,"children":11209},{"class":627},[11210],{"type":24,"value":11211}," kd\n",{"type":18,"tag":614,"props":11213,"children":11214},{"class":616,"line":745},[11215,11219,11223,11228,11232],{"type":18,"tag":614,"props":11216,"children":11217},{"class":627},[11218],{"type":24,"value":696},{"type":18,"tag":614,"props":11220,"children":11221},{"class":671},[11222],{"type":24,"value":701},{"type":18,"tag":614,"props":11224,"children":11225},{"class":627},[11226],{"type":24,"value":11227},".dt ",{"type":18,"tag":614,"props":11229,"children":11230},{"class":621},[11231],{"type":24,"value":711},{"type":18,"tag":614,"props":11233,"children":11234},{"class":627},[11235],{"type":24,"value":2947},{"type":18,"tag":614,"props":11237,"children":11238},{"class":616,"line":771},[11239,11243,11247,11252,11256,11260],{"type":18,"tag":614,"props":11240,"children":11241},{"class":627},[11242],{"type":24,"value":696},{"type":18,"tag":614,"props":11244,"children":11245},{"class":671},[11246],{"type":24,"value":701},{"type":18,"tag":614,"props":11248,"children":11249},{"class":627},[11250],{"type":24,"value":11251},".integral ",{"type":18,"tag":614,"props":11253,"children":11254},{"class":621},[11255],{"type":24,"value":711},{"type":18,"tag":614,"props":11257,"children":11258},{"class":627},[11259],{"type":24,"value":630},{"type":18,"tag":614,"props":11261,"children":11262},{"class":671},[11263],{"type":24,"value":8968},{"type":18,"tag":614,"props":11265,"children":11266},{"class":616,"line":779},[11267],{"type":18,"tag":614,"props":11268,"children":11269},{},[11270],{"type":24,"value":650},{"type":18,"tag":614,"props":11272,"children":11273},{"class":616,"line":805},[11274,11278,11282,11286,11291],{"type":18,"tag":614,"props":11275,"children":11276},{"class":627},[11277],{"type":24,"value":659},{"type":18,"tag":614,"props":11279,"children":11280},{"class":621},[11281],{"type":24,"value":664},{"type":18,"tag":614,"props":11283,"children":11284},{"class":627},[11285],{"type":24,"value":630},{"type":18,"tag":614,"props":11287,"children":11288},{"class":633},[11289],{"type":24,"value":11290},"calculate_pid",{"type":18,"tag":614,"props":11292,"children":11293},{"class":627},[11294],{"type":24,"value":11295},"(self, errors):\n",{"type":18,"tag":614,"props":11297,"children":11298},{"class":616,"line":831},[11299,11303],{"type":18,"tag":614,"props":11300,"children":11301},{"class":627},[11302],{"type":24,"value":696},{"type":18,"tag":614,"props":11304,"children":11305},{"class":1851},[11306],{"type":24,"value":11307},"# Calculate proportional error\n",{"type":18,"tag":614,"props":11309,"children":11310},{"class":616,"line":839},[11311,11316,11320,11324,11328,11332,11336,11341,11345,11349],{"type":18,"tag":614,"props":11312,"children":11313},{"class":627},[11314],{"type":24,"value":11315},"        proportional ",{"type":18,"tag":614,"props":11317,"children":11318},{"class":621},[11319],{"type":24,"value":711},{"type":18,"tag":614,"props":11321,"children":11322},{"class":627},[11323],{"type":24,"value":630},{"type":18,"tag":614,"props":11325,"children":11326},{"class":671},[11327],{"type":24,"value":701},{"type":18,"tag":614,"props":11329,"children":11330},{"class":627},[11331],{"type":24,"value":11152},{"type":18,"tag":614,"props":11333,"children":11334},{"class":621},[11335],{"type":24,"value":1056},{"type":18,"tag":614,"props":11337,"children":11338},{"class":627},[11339],{"type":24,"value":11340}," errors[",{"type":18,"tag":614,"props":11342,"children":11343},{"class":621},[11344],{"type":24,"value":1046},{"type":18,"tag":614,"props":11346,"children":11347},{"class":671},[11348],{"type":24,"value":977},{"type":18,"tag":614,"props":11350,"children":11351},{"class":627},[11352],{"type":24,"value":872},{"type":18,"tag":614,"props":11354,"children":11355},{"class":616,"line":875},[11356,11360],{"type":18,"tag":614,"props":11357,"children":11358},{"class":627},[11359],{"type":24,"value":696},{"type":18,"tag":614,"props":11361,"children":11362},{"class":1851},[11363],{"type":24,"value":11364},"# Calculate integration error\n",{"type":18,"tag":614,"props":11366,"children":11367},{"class":616,"line":908},[11368,11373,11377,11381,11385,11389,11393,11397,11401,11405,11409,11414,11418,11422,11426,11430,11434,11438],{"type":18,"tag":614,"props":11369,"children":11370},{"class":627},[11371],{"type":24,"value":11372},"        integral ",{"type":18,"tag":614,"props":11374,"children":11375},{"class":621},[11376],{"type":24,"value":711},{"type":18,"tag":614,"props":11378,"children":11379},{"class":627},[11380],{"type":24,"value":630},{"type":18,"tag":614,"props":11382,"children":11383},{"class":671},[11384],{"type":24,"value":701},{"type":18,"tag":614,"props":11386,"children":11387},{"class":627},[11388],{"type":24,"value":11251},{"type":18,"tag":614,"props":11390,"children":11391},{"class":621},[11392],{"type":24,"value":1177},{"type":18,"tag":614,"props":11394,"children":11395},{"class":627},[11396],{"type":24,"value":630},{"type":18,"tag":614,"props":11398,"children":11399},{"class":671},[11400],{"type":24,"value":701},{"type":18,"tag":614,"props":11402,"children":11403},{"class":627},[11404],{"type":24,"value":11177},{"type":18,"tag":614,"props":11406,"children":11407},{"class":621},[11408],{"type":24,"value":1056},{"type":18,"tag":614,"props":11410,"children":11411},{"class":627},[11412],{"type":24,"value":11413}," (errors[",{"type":18,"tag":614,"props":11415,"children":11416},{"class":621},[11417],{"type":24,"value":1046},{"type":18,"tag":614,"props":11419,"children":11420},{"class":671},[11421],{"type":24,"value":977},{"type":18,"tag":614,"props":11423,"children":11424},{"class":627},[11425],{"type":24,"value":7607},{"type":18,"tag":614,"props":11427,"children":11428},{"class":621},[11429],{"type":24,"value":1056},{"type":18,"tag":614,"props":11431,"children":11432},{"class":627},[11433],{"type":24,"value":630},{"type":18,"tag":614,"props":11435,"children":11436},{"class":671},[11437],{"type":24,"value":701},{"type":18,"tag":614,"props":11439,"children":11440},{"class":627},[11441],{"type":24,"value":11442},".dt\n",{"type":18,"tag":614,"props":11444,"children":11445},{"class":616,"line":916},[11446,11450,11454,11458,11462],{"type":18,"tag":614,"props":11447,"children":11448},{"class":627},[11449],{"type":24,"value":696},{"type":18,"tag":614,"props":11451,"children":11452},{"class":671},[11453],{"type":24,"value":701},{"type":18,"tag":614,"props":11455,"children":11456},{"class":627},[11457],{"type":24,"value":11251},{"type":18,"tag":614,"props":11459,"children":11460},{"class":621},[11461],{"type":24,"value":711},{"type":18,"tag":614,"props":11463,"children":11464},{"class":627},[11465],{"type":24,"value":11466}," integral\n",{"type":18,"tag":614,"props":11468,"children":11469},{"class":616,"line":950},[11470,11474],{"type":18,"tag":614,"props":11471,"children":11472},{"class":627},[11473],{"type":24,"value":696},{"type":18,"tag":614,"props":11475,"children":11476},{"class":1851},[11477],{"type":24,"value":11478},"# Calculate derivative error\n",{"type":18,"tag":614,"props":11480,"children":11481},{"class":616,"line":984},[11482,11487,11491,11495,11499,11503,11507,11511,11515,11519,11523,11527,11531,11535,11539,11544,11548,11552],{"type":18,"tag":614,"props":11483,"children":11484},{"class":627},[11485],{"type":24,"value":11486},"        derivative ",{"type":18,"tag":614,"props":11488,"children":11489},{"class":621},[11490],{"type":24,"value":711},{"type":18,"tag":614,"props":11492,"children":11493},{"class":627},[11494],{"type":24,"value":630},{"type":18,"tag":614,"props":11496,"children":11497},{"class":671},[11498],{"type":24,"value":701},{"type":18,"tag":614,"props":11500,"children":11501},{"class":627},[11502],{"type":24,"value":11202},{"type":18,"tag":614,"props":11504,"children":11505},{"class":621},[11506],{"type":24,"value":1056},{"type":18,"tag":614,"props":11508,"children":11509},{"class":627},[11510],{"type":24,"value":11413},{"type":18,"tag":614,"props":11512,"children":11513},{"class":621},[11514],{"type":24,"value":1046},{"type":18,"tag":614,"props":11516,"children":11517},{"class":671},[11518],{"type":24,"value":977},{"type":18,"tag":614,"props":11520,"children":11521},{"class":627},[11522],{"type":24,"value":2911},{"type":18,"tag":614,"props":11524,"children":11525},{"class":621},[11526],{"type":24,"value":1046},{"type":18,"tag":614,"props":11528,"children":11529},{"class":627},[11530],{"type":24,"value":11340},{"type":18,"tag":614,"props":11532,"children":11533},{"class":621},[11534],{"type":24,"value":1046},{"type":18,"tag":614,"props":11536,"children":11537},{"class":671},[11538],{"type":24,"value":1353},{"type":18,"tag":614,"props":11540,"children":11541},{"class":627},[11542],{"type":24,"value":11543},"])",{"type":18,"tag":614,"props":11545,"children":11546},{"class":621},[11547],{"type":24,"value":1414},{"type":18,"tag":614,"props":11549,"children":11550},{"class":671},[11551],{"type":24,"value":701},{"type":18,"tag":614,"props":11553,"children":11554},{"class":627},[11555],{"type":24,"value":11442},{"type":18,"tag":614,"props":11557,"children":11558},{"class":616,"line":992},[11559],{"type":18,"tag":614,"props":11560,"children":11561},{},[11562],{"type":24,"value":650},{"type":18,"tag":614,"props":11564,"children":11565},{"class":616,"line":1018},[11566,11571,11575,11580,11584,11589,11593],{"type":18,"tag":614,"props":11567,"children":11568},{"class":627},[11569],{"type":24,"value":11570},"        output ",{"type":18,"tag":614,"props":11572,"children":11573},{"class":621},[11574],{"type":24,"value":711},{"type":18,"tag":614,"props":11576,"children":11577},{"class":627},[11578],{"type":24,"value":11579}," proportional ",{"type":18,"tag":614,"props":11581,"children":11582},{"class":621},[11583],{"type":24,"value":1177},{"type":18,"tag":614,"props":11585,"children":11586},{"class":627},[11587],{"type":24,"value":11588}," integral ",{"type":18,"tag":614,"props":11590,"children":11591},{"class":621},[11592],{"type":24,"value":1177},{"type":18,"tag":614,"props":11594,"children":11595},{"class":627},[11596],{"type":24,"value":11597}," derivative\n",{"type":18,"tag":614,"props":11599,"children":11600},{"class":616,"line":1026},[11601],{"type":18,"tag":614,"props":11602,"children":11603},{},[11604],{"type":24,"value":650},{"type":18,"tag":614,"props":11606,"children":11607},{"class":616,"line":1068},[11608,11612,11616],{"type":18,"tag":614,"props":11609,"children":11610},{"class":627},[11611],{"type":24,"value":696},{"type":18,"tag":614,"props":11613,"children":11614},{"class":621},[11615],{"type":24,"value":1220},{"type":18,"tag":614,"props":11617,"children":11618},{"class":627},[11619],{"type":24,"value":11620}," output",{"type":18,"tag":27,"props":11622,"children":11623},{},[11624],{"type":24,"value":11625},"Don't worry, this class just defined as the PID formula. So, by doing this, we will be able to use all the characteristic of our PID controller.",{"type":18,"tag":19,"props":11627,"children":11629},{"id":11628},"experiment",[11630],{"type":24,"value":11631},"Experiment",{"type":18,"tag":33,"props":11633,"children":11635},{"id":11634},"pid-for-point-control",[11636],{"type":24,"value":11637},"PID for point control",{"type":18,"tag":27,"props":11639,"children":11640},{},[11641,11643,11647,11649,11654],{"type":24,"value":11642},"If I want my DifferentialDrive robot go to point ",{"type":18,"tag":84,"props":11644,"children":11646},{"latex-express":11645,"styles":87},"x_{ref}, y_{ref}, \\theta_{ref}",[],{"type":24,"value":11648},", Then I can calculate the error between the reference point and the feedback position of the robot. I simulated my robot in the  ",{"type":18,"tag":4360,"props":11650,"children":11651},{},[11652],{"type":24,"value":11653},"for loop",{"type":24,"value":11655}," and calculate this error recursively.",{"type":18,"tag":599,"props":11657,"children":11660},{"className":11658,"code":11659,"language":604,"meta":8},[602],"error_x.append(ref_path[0]-current_x)\nerror_y.append(ref_path[1]-current_y)\nerror_yaw.append(ref_path[2]-current_yaw)\n",[11661],{"type":18,"tag":607,"props":11662,"children":11663},{},[11664],{"type":18,"tag":599,"props":11665,"children":11666},{"__ignoreMap":8},[11667,11692,11717],{"type":18,"tag":614,"props":11668,"children":11669},{"class":616,"line":617},[11670,11675,11679,11683,11687],{"type":18,"tag":614,"props":11671,"children":11672},{"class":627},[11673],{"type":24,"value":11674},"error_x.append(ref_path[",{"type":18,"tag":614,"props":11676,"children":11677},{"class":671},[11678],{"type":24,"value":867},{"type":18,"tag":614,"props":11680,"children":11681},{"class":627},[11682],{"type":24,"value":2597},{"type":18,"tag":614,"props":11684,"children":11685},{"class":621},[11686],{"type":24,"value":1046},{"type":18,"tag":614,"props":11688,"children":11689},{"class":627},[11690],{"type":24,"value":11691},"current_x)\n",{"type":18,"tag":614,"props":11693,"children":11694},{"class":616,"line":644},[11695,11700,11704,11708,11712],{"type":18,"tag":614,"props":11696,"children":11697},{"class":627},[11698],{"type":24,"value":11699},"error_y.append(ref_path[",{"type":18,"tag":614,"props":11701,"children":11702},{"class":671},[11703],{"type":24,"value":977},{"type":18,"tag":614,"props":11705,"children":11706},{"class":627},[11707],{"type":24,"value":2597},{"type":18,"tag":614,"props":11709,"children":11710},{"class":621},[11711],{"type":24,"value":1046},{"type":18,"tag":614,"props":11713,"children":11714},{"class":627},[11715],{"type":24,"value":11716},"current_y)\n",{"type":18,"tag":614,"props":11718,"children":11719},{"class":616,"line":653},[11720,11725,11729,11733,11737],{"type":18,"tag":614,"props":11721,"children":11722},{"class":627},[11723],{"type":24,"value":11724},"error_yaw.append(ref_path[",{"type":18,"tag":614,"props":11726,"children":11727},{"class":671},[11728],{"type":24,"value":1353},{"type":18,"tag":614,"props":11730,"children":11731},{"class":627},[11732],{"type":24,"value":2597},{"type":18,"tag":614,"props":11734,"children":11735},{"class":621},[11736],{"type":24,"value":1046},{"type":18,"tag":614,"props":11738,"children":11739},{"class":627},[11740],{"type":24,"value":11741},"current_yaw)",{"type":18,"tag":27,"props":11743,"children":11744},{},[11745],{"type":24,"value":11746},"Then, let's apply PID",{"type":18,"tag":599,"props":11748,"children":11751},{"className":11749,"code":11750,"language":604,"meta":8},[602],"output_vx = pid_controller_x.calculate_pid(error_x)\noutput_vy = pid_controller_y.calculate_pid(error_y)\noutput_omega = pid_controller_yaw.calculate_pid(error_yaw)\n",[11752],{"type":18,"tag":607,"props":11753,"children":11754},{},[11755],{"type":18,"tag":599,"props":11756,"children":11757},{"__ignoreMap":8},[11758,11775,11792],{"type":18,"tag":614,"props":11759,"children":11760},{"class":616,"line":617},[11761,11766,11770],{"type":18,"tag":614,"props":11762,"children":11763},{"class":627},[11764],{"type":24,"value":11765},"output_vx ",{"type":18,"tag":614,"props":11767,"children":11768},{"class":621},[11769],{"type":24,"value":711},{"type":18,"tag":614,"props":11771,"children":11772},{"class":627},[11773],{"type":24,"value":11774}," pid_controller_x.calculate_pid(error_x)\n",{"type":18,"tag":614,"props":11776,"children":11777},{"class":616,"line":644},[11778,11783,11787],{"type":18,"tag":614,"props":11779,"children":11780},{"class":627},[11781],{"type":24,"value":11782},"output_vy ",{"type":18,"tag":614,"props":11784,"children":11785},{"class":621},[11786],{"type":24,"value":711},{"type":18,"tag":614,"props":11788,"children":11789},{"class":627},[11790],{"type":24,"value":11791}," pid_controller_y.calculate_pid(error_y)\n",{"type":18,"tag":614,"props":11793,"children":11794},{"class":616,"line":653},[11795,11800,11804],{"type":18,"tag":614,"props":11796,"children":11797},{"class":627},[11798],{"type":24,"value":11799},"output_omega ",{"type":18,"tag":614,"props":11801,"children":11802},{"class":621},[11803],{"type":24,"value":711},{"type":18,"tag":614,"props":11805,"children":11806},{"class":627},[11807],{"type":24,"value":11808}," pid_controller_yaw.calculate_pid(error_yaw)",{"type":18,"tag":27,"props":11810,"children":11811},{},[11812],{"type":24,"value":11813},"We will also need to update current position of the robot with the given optimal value from the PID controller.",{"type":18,"tag":599,"props":11815,"children":11818},{"className":11816,"code":11817,"language":604,"meta":8},[602],"x_next, y_next, yaw_next = diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) # Skip for omega we only look for x, y\ncurrent_x = x_next\ncurrent_y = y_next\ncurrent_yaw = yaw_next\n",[11819],{"type":18,"tag":607,"props":11820,"children":11821},{},[11822],{"type":18,"tag":599,"props":11823,"children":11824},{"__ignoreMap":8},[11825,11847,11864,11881],{"type":18,"tag":614,"props":11826,"children":11827},{"class":616,"line":617},[11828,11833,11837,11842],{"type":18,"tag":614,"props":11829,"children":11830},{"class":627},[11831],{"type":24,"value":11832},"x_next, y_next, yaw_next ",{"type":18,"tag":614,"props":11834,"children":11835},{"class":621},[11836],{"type":24,"value":711},{"type":18,"tag":614,"props":11838,"children":11839},{"class":627},[11840],{"type":24,"value":11841}," diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) ",{"type":18,"tag":614,"props":11843,"children":11844},{"class":1851},[11845],{"type":24,"value":11846},"# Skip for omega we only look for x, y\n",{"type":18,"tag":614,"props":11848,"children":11849},{"class":616,"line":644},[11850,11855,11859],{"type":18,"tag":614,"props":11851,"children":11852},{"class":627},[11853],{"type":24,"value":11854},"current_x ",{"type":18,"tag":614,"props":11856,"children":11857},{"class":621},[11858],{"type":24,"value":711},{"type":18,"tag":614,"props":11860,"children":11861},{"class":627},[11862],{"type":24,"value":11863}," x_next\n",{"type":18,"tag":614,"props":11865,"children":11866},{"class":616,"line":653},[11867,11872,11876],{"type":18,"tag":614,"props":11868,"children":11869},{"class":627},[11870],{"type":24,"value":11871},"current_y ",{"type":18,"tag":614,"props":11873,"children":11874},{"class":621},[11875],{"type":24,"value":711},{"type":18,"tag":614,"props":11877,"children":11878},{"class":627},[11879],{"type":24,"value":11880}," y_next\n",{"type":18,"tag":614,"props":11882,"children":11883},{"class":616,"line":682},[11884,11889,11893],{"type":18,"tag":614,"props":11885,"children":11886},{"class":627},[11887],{"type":24,"value":11888},"current_yaw ",{"type":18,"tag":614,"props":11890,"children":11891},{"class":621},[11892],{"type":24,"value":711},{"type":18,"tag":614,"props":11894,"children":11895},{"class":627},[11896],{"type":24,"value":11897}," yaw_next",{"type":18,"tag":27,"props":11899,"children":11900},{},[11901,11903,11908],{"type":24,"value":11902},"I use ",{"type":18,"tag":4360,"props":11904,"children":11905},{},[11906],{"type":24,"value":11907},"matplotlib",{"type":24,"value":11909}," library to simulate my robot.",{"type":18,"tag":599,"props":11911,"children":11914},{"className":11912,"code":11913,"language":604,"meta":8},[602],"plt.clf()\nplt.gcf().canvas.mpl_connect('key_release_event',\n            lambda event: [exit(0) if event.key == 'escape' else None])\nplot_arrow(current_x, current_y, current_yaw)\nplt.plot(5, 5)\nplt.plot(ref_path[0], ref_path[1], marker=\"x\", color=\"blue\", label=\"Input Trajectory\")\nplt.axis(\"equal\")\nplt.grid(True)\nplt.legend()\nplt.pause(0.0001)\n",[11915],{"type":18,"tag":607,"props":11916,"children":11917},{},[11918],{"type":18,"tag":599,"props":11919,"children":11920},{"__ignoreMap":8},[11921,11929,11946,12025,12033,12058,12136,12153,12170,12178],{"type":18,"tag":614,"props":11922,"children":11923},{"class":616,"line":617},[11924],{"type":18,"tag":614,"props":11925,"children":11926},{"class":627},[11927],{"type":24,"value":11928},"plt.clf()\n",{"type":18,"tag":614,"props":11930,"children":11931},{"class":616,"line":644},[11932,11937,11942],{"type":18,"tag":614,"props":11933,"children":11934},{"class":627},[11935],{"type":24,"value":11936},"plt.gcf().canvas.mpl_connect(",{"type":18,"tag":614,"props":11938,"children":11939},{"class":5349},[11940],{"type":24,"value":11941},"'key_release_event'",{"type":18,"tag":614,"props":11943,"children":11944},{"class":627},[11945],{"type":24,"value":8873},{"type":18,"tag":614,"props":11947,"children":11948},{"class":616,"line":653},[11949,11953,11957,11962,11967,11971,11975,11979,11984,11989,11994,11998,12003,12007,12012,12016,12021],{"type":18,"tag":614,"props":11950,"children":11951},{"class":627},[11952],{"type":24,"value":10035},{"type":18,"tag":614,"props":11954,"children":11955},{"class":621},[11956],{"type":24,"value":6964},{"type":18,"tag":614,"props":11958,"children":11959},{"class":627},[11960],{"type":24,"value":11961}," event: [",{"type":18,"tag":614,"props":11963,"children":11964},{"class":671},[11965],{"type":24,"value":11966},"exit",{"type":18,"tag":614,"props":11968,"children":11969},{"class":627},[11970],{"type":24,"value":1387},{"type":18,"tag":614,"props":11972,"children":11973},{"class":671},[11974],{"type":24,"value":867},{"type":18,"tag":614,"props":11976,"children":11977},{"class":627},[11978],{"type":24,"value":5357},{"type":18,"tag":614,"props":11980,"children":11981},{"class":621},[11982],{"type":24,"value":11983},"if",{"type":18,"tag":614,"props":11985,"children":11986},{"class":627},[11987],{"type":24,"value":11988}," event.key ",{"type":18,"tag":614,"props":11990,"children":11991},{"class":621},[11992],{"type":24,"value":11993},"==",{"type":18,"tag":614,"props":11995,"children":11996},{"class":627},[11997],{"type":24,"value":630},{"type":18,"tag":614,"props":11999,"children":12000},{"class":5349},[12001],{"type":24,"value":12002},"'escape'",{"type":18,"tag":614,"props":12004,"children":12005},{"class":627},[12006],{"type":24,"value":630},{"type":18,"tag":614,"props":12008,"children":12009},{"class":621},[12010],{"type":24,"value":12011},"else",{"type":18,"tag":614,"props":12013,"children":12014},{"class":627},[12015],{"type":24,"value":630},{"type":18,"tag":614,"props":12017,"children":12018},{"class":671},[12019],{"type":24,"value":12020},"None",{"type":18,"tag":614,"props":12022,"children":12023},{"class":627},[12024],{"type":24,"value":3280},{"type":18,"tag":614,"props":12026,"children":12027},{"class":616,"line":682},[12028],{"type":18,"tag":614,"props":12029,"children":12030},{"class":627},[12031],{"type":24,"value":12032},"plot_arrow(current_x, current_y, current_yaw)\n",{"type":18,"tag":614,"props":12034,"children":12035},{"class":616,"line":690},[12036,12041,12046,12050,12054],{"type":18,"tag":614,"props":12037,"children":12038},{"class":627},[12039],{"type":24,"value":12040},"plt.plot(",{"type":18,"tag":614,"props":12042,"children":12043},{"class":671},[12044],{"type":24,"value":12045},"5",{"type":18,"tag":614,"props":12047,"children":12048},{"class":627},[12049],{"type":24,"value":2417},{"type":18,"tag":614,"props":12051,"children":12052},{"class":671},[12053],{"type":24,"value":12045},{"type":18,"tag":614,"props":12055,"children":12056},{"class":627},[12057],{"type":24,"value":1423},{"type":18,"tag":614,"props":12059,"children":12060},{"class":616,"line":719},[12061,12066,12070,12075,12079,12083,12088,12092,12096,12100,12105,12109,12114,12118,12123,12127,12132],{"type":18,"tag":614,"props":12062,"children":12063},{"class":627},[12064],{"type":24,"value":12065},"plt.plot(ref_path[",{"type":18,"tag":614,"props":12067,"children":12068},{"class":671},[12069],{"type":24,"value":867},{"type":18,"tag":614,"props":12071,"children":12072},{"class":627},[12073],{"type":24,"value":12074},"], ref_path[",{"type":18,"tag":614,"props":12076,"children":12077},{"class":671},[12078],{"type":24,"value":977},{"type":18,"tag":614,"props":12080,"children":12081},{"class":627},[12082],{"type":24,"value":3247},{"type":18,"tag":614,"props":12084,"children":12085},{"class":5339},[12086],{"type":24,"value":12087},"marker",{"type":18,"tag":614,"props":12089,"children":12090},{"class":621},[12091],{"type":24,"value":711},{"type":18,"tag":614,"props":12093,"children":12094},{"class":5349},[12095],{"type":24,"value":8060},{"type":18,"tag":614,"props":12097,"children":12098},{"class":627},[12099],{"type":24,"value":2417},{"type":18,"tag":614,"props":12101,"children":12102},{"class":5339},[12103],{"type":24,"value":12104},"color",{"type":18,"tag":614,"props":12106,"children":12107},{"class":621},[12108],{"type":24,"value":711},{"type":18,"tag":614,"props":12110,"children":12111},{"class":5349},[12112],{"type":24,"value":12113},"\"blue\"",{"type":18,"tag":614,"props":12115,"children":12116},{"class":627},[12117],{"type":24,"value":2417},{"type":18,"tag":614,"props":12119,"children":12120},{"class":5339},[12121],{"type":24,"value":12122},"label",{"type":18,"tag":614,"props":12124,"children":12125},{"class":621},[12126],{"type":24,"value":711},{"type":18,"tag":614,"props":12128,"children":12129},{"class":5349},[12130],{"type":24,"value":12131},"\"Input Trajectory\"",{"type":18,"tag":614,"props":12133,"children":12134},{"class":627},[12135],{"type":24,"value":1423},{"type":18,"tag":614,"props":12137,"children":12138},{"class":616,"line":745},[12139,12144,12149],{"type":18,"tag":614,"props":12140,"children":12141},{"class":627},[12142],{"type":24,"value":12143},"plt.axis(",{"type":18,"tag":614,"props":12145,"children":12146},{"class":5349},[12147],{"type":24,"value":12148},"\"equal\"",{"type":18,"tag":614,"props":12150,"children":12151},{"class":627},[12152],{"type":24,"value":1423},{"type":18,"tag":614,"props":12154,"children":12155},{"class":616,"line":771},[12156,12161,12166],{"type":18,"tag":614,"props":12157,"children":12158},{"class":627},[12159],{"type":24,"value":12160},"plt.grid(",{"type":18,"tag":614,"props":12162,"children":12163},{"class":671},[12164],{"type":24,"value":12165},"True",{"type":18,"tag":614,"props":12167,"children":12168},{"class":627},[12169],{"type":24,"value":1423},{"type":18,"tag":614,"props":12171,"children":12172},{"class":616,"line":779},[12173],{"type":18,"tag":614,"props":12174,"children":12175},{"class":627},[12176],{"type":24,"value":12177},"plt.legend()\n",{"type":18,"tag":614,"props":12179,"children":12180},{"class":616,"line":805},[12181,12186,12191],{"type":18,"tag":614,"props":12182,"children":12183},{"class":627},[12184],{"type":24,"value":12185},"plt.pause(",{"type":18,"tag":614,"props":12187,"children":12188},{"class":671},[12189],{"type":24,"value":12190},"0.0001",{"type":18,"tag":614,"props":12192,"children":12193},{"class":627},[12194],{"type":24,"value":12195},")",{"type":18,"tag":33,"props":12197,"children":12199},{"id":12198},"path-tracking",[12200],{"type":24,"value":12201},"Path Tracking",{"type":18,"tag":27,"props":12203,"children":12204},{},[12205,12207,12212,12214,12219],{"type":24,"value":12206},"The code is all way the same. The different is that, I fit the continuous point into the robot instead of fixed goal point. I use ",{"type":18,"tag":4360,"props":12208,"children":12209},{},[12210],{"type":24,"value":12211},"BeizerCurve",{"type":24,"value":12213}," function to generate ",{"type":18,"tag":170,"props":12215,"children":12216},{},[12217],{"type":24,"value":12218}," Spline Trajectory ",{"type":24,"value":12220}," for the robot.",{"type":18,"tag":27,"props":12222,"children":12223},{},[12224,12226,12233],{"type":24,"value":12225},"The full code is published open-source on my Github. Link here ",{"type":18,"tag":6352,"props":12227,"children":12230},{"href":12228,"rel":12229},"https://github.com/SokhengDin/PathTracking/tree/main/PID",[6356],[12231],{"type":24,"value":12232},"Github",{"type":24,"value":12234},". Hit the star for me if you like my work .",{"type":18,"tag":33,"props":12236,"children":12237},{"id":10350},[12238],{"type":24,"value":10353},{"type":18,"tag":6295,"props":12240,"children":12242},{"className":12241},[6298,6299,6300],[12243,12244],{"type":24,"value":6303},{"type":18,"tag":6305,"props":12245,"children":12248},{"className":12246,"src":12247},[6308],"/topics/robotics/nmpc/Figure_pid_p.png",[],{"type":18,"tag":6314,"props":12250,"children":12252},{"className":12251},[68,6317,6318,6319],[12253],{"type":24,"value":12254},"\n    PID Controller with position control on Differential Drive Robot\n",{"type":18,"tag":6295,"props":12256,"children":12258},{"className":12257},[6298,6299,6300],[12259,12260],{"type":24,"value":6303},{"type":18,"tag":6305,"props":12261,"children":12264},{"className":12262,"src":12263},[6308],"/topics/robotics/nmpc/Figure_pid_t.png",[],{"type":18,"tag":6314,"props":12266,"children":12268},{"className":12267},[68,6317,6318,6319],[12269],{"type":24,"value":12270},"\n    PID Controller with path tracking control on Differential Drive Robot\n",{"type":18,"tag":19,"props":12272,"children":12273},{"id":6362},[12274],{"type":24,"value":6365},{"type":18,"tag":27,"props":12276,"children":12277},{},[12278],{"type":24,"value":12279},"In my opinion, the PID Controller is an excellent choice for most control system applications due to its simplicity and powerful capabilities in handling complex control challenges arising from various systems.",{"type":18,"tag":19,"props":12281,"children":12282},{"id":6373},[12283],{"type":24,"value":6376},{"type":18,"tag":284,"props":12285,"children":12286},{},[12287,12296,12301,12311],{"type":18,"tag":80,"props":12288,"children":12289},{},[12290],{"type":18,"tag":6352,"props":12291,"children":12294},{"href":12292,"rel":12293},"https://en.wikipedia.org/wiki/B%C3%A9zier_curve",[6356],[12295],{"type":24,"value":12211},{"type":18,"tag":80,"props":12297,"children":12298},{},[12299],{"type":24,"value":12300},"PID Controller: Control Systems Engineering by Normal S. Nise.",{"type":18,"tag":80,"props":12302,"children":12303},{},[12304],{"type":18,"tag":6352,"props":12305,"children":12308},{"href":12306,"rel":12307},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathPlanning/BezierPath",[6356],[12309],{"type":24,"value":12310},"Beizer Path",{"type":18,"tag":80,"props":12312,"children":12313},{},[12314],{"type":18,"tag":6352,"props":12315,"children":12318},{"href":12316,"rel":12317},"https://www.cds.caltech.edu/~murray/courses/cds101/fa02/caltech/astrom-ch6.pdf",[6356],[12319],{"type":24,"value":12320},"PID Lecture",{"type":18,"tag":6431,"children":12322},[12323],{"type":24,"value":12324},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":644,"depth":644,"links":12326},[12327,12328,12329,12330,12331,12332,12337,12338],{"id":10451,"depth":644,"text":10454},{"id":10467,"depth":644,"text":10470},{"id":10478,"depth":644,"text":10481},{"id":10542,"depth":644,"text":10545},{"id":10603,"depth":644,"text":10606},{"id":11628,"depth":644,"text":11631,"children":12333},[12334,12335,12336],{"id":11634,"depth":653,"text":11637},{"id":12198,"depth":653,"text":12201},{"id":10350,"depth":653,"text":10353},{"id":6362,"depth":644,"text":6365},{"id":6373,"depth":644,"text":6376},"content:topics:robotics:pid-controller.md","topics/robotics/pid-controller.md",{"_path":12342,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12343,"description":12344,"slug":12345,"tag":12345,"img":12346,"body":12347,"_type":6447,"_id":12579,"_source":6449,"_file":12580,"_extension":6451},"/topics/robotics/pure-pursuit","Pure Pursuit Controller","Introduction to Pure Pursuit Controller","pure-pursuit","/topics/robotics/nmpc/pure_pursuit.png",{"type":15,"children":12348,"toc":12572},[12349,12354,12364,12370,12375,12427,12433,12438,12490,12496,12501,12524,12529,12568],{"type":18,"tag":19,"props":12350,"children":12352},{"id":12351},"pure-pursuit-controller",[12353],{"type":24,"value":12343},{"type":18,"tag":27,"props":12355,"children":12356},{},[12357,12358,12362],{"type":24,"value":11062},{"type":18,"tag":170,"props":12359,"children":12360},{},[12361],{"type":24,"value":12343},{"type":24,"value":12363}," is a widely-used path-tracking algorithm in robotics and autonomous vehicle navigation. Its primary objective is to guide a vehicle or robot along a predefined path while ensuring precise path-following.",{"type":18,"tag":33,"props":12365,"children":12367},{"id":12366},"principle-of-operation",[12368],{"type":24,"value":12369},"Principle of Operation",{"type":18,"tag":27,"props":12371,"children":12372},{},[12373],{"type":24,"value":12374},"The operation of the Pure Pursuit Controller is based on a straightforward concept:",{"type":18,"tag":284,"props":12376,"children":12377},{},[12378,12388,12398,12408,12418],{"type":18,"tag":80,"props":12379,"children":12380},{},[12381,12386],{"type":18,"tag":170,"props":12382,"children":12383},{},[12384],{"type":24,"value":12385},"Path Definition",{"type":24,"value":12387},": The controller works with a defined path, often represented as a series of waypoints or a continuous curve, each associated with specific coordinates (x, y) and curvature information.",{"type":18,"tag":80,"props":12389,"children":12390},{},[12391,12396],{"type":18,"tag":170,"props":12392,"children":12393},{},[12394],{"type":24,"value":12395},"Target Point Selection",{"type":24,"value":12397},": The controller continuously selects a target point ahead of the vehicle. This target point is typically chosen as the point on the path that is a certain fixed distance (known as the \"lookahead distance\") in front of the vehicle.",{"type":18,"tag":80,"props":12399,"children":12400},{},[12401,12406],{"type":18,"tag":170,"props":12402,"children":12403},{},[12404],{"type":24,"value":12405},"Steering Command Calculation",{"type":24,"value":12407},": To navigate toward the target point, the controller calculates the steering command, often represented as the desired steering angle or curvature, required to reach the target point. Commonly, this involves computing the angle between the vehicle's current heading and the vector pointing from the current position to the target point.",{"type":18,"tag":80,"props":12409,"children":12410},{},[12411,12416],{"type":18,"tag":170,"props":12412,"children":12413},{},[12414],{"type":24,"value":12415},"Vehicle Control",{"type":24,"value":12417},": The calculated steering command is used to control the vehicle's steering mechanism (e.g., steering wheel or wheel angles) to guide it toward the target point.",{"type":18,"tag":80,"props":12419,"children":12420},{},[12421,12425],{"type":18,"tag":170,"props":12422,"children":12423},{},[12424],{"type":24,"value":349},{"type":24,"value":12426},": The process is iterative, with the controller continuously selecting new target points ahead as the vehicle advances along the path and adjusting its steering to reach them.",{"type":18,"tag":33,"props":12428,"children":12430},{"id":12429},"advantages",[12431],{"type":24,"value":12432},"Advantages",{"type":18,"tag":27,"props":12434,"children":12435},{},[12436],{"type":24,"value":12437},"The Pure Pursuit Controller offers several advantages:",{"type":18,"tag":76,"props":12439,"children":12440},{},[12441,12451,12460,12470,12480],{"type":18,"tag":80,"props":12442,"children":12443},{},[12444,12449],{"type":18,"tag":170,"props":12445,"children":12446},{},[12447],{"type":24,"value":12448},"Simplicity",{"type":24,"value":12450},": It is conceptually simple and easy to implement, making it suitable for a wide range of robotic and vehicle navigation applications.",{"type":18,"tag":80,"props":12452,"children":12453},{},[12454,12458],{"type":18,"tag":170,"props":12455,"children":12456},{},[12457],{"type":24,"value":12201},{"type":24,"value":12459},": The controller excels at accurate path tracking, even in complex environments with curves and turns.",{"type":18,"tag":80,"props":12461,"children":12462},{},[12463,12468],{"type":18,"tag":170,"props":12464,"children":12465},{},[12466],{"type":24,"value":12467},"Real-Time Operation",{"type":24,"value":12469},": It can operate in real-time, making it well-suited for dynamic environments where quick decision-making is crucial.",{"type":18,"tag":80,"props":12471,"children":12472},{},[12473,12478],{"type":18,"tag":170,"props":12474,"children":12475},{},[12476],{"type":24,"value":12477},"Adaptability",{"type":24,"value":12479},": The controller can adapt to changes in the path, such as deviations caused by obstacles or unexpected conditions, by continuously updating the target point.",{"type":18,"tag":80,"props":12481,"children":12482},{},[12483,12488],{"type":18,"tag":170,"props":12484,"children":12485},{},[12486],{"type":24,"value":12487},"Low Computational Overhead",{"type":24,"value":12489},": Compared to some other control algorithms, the Pure Pursuit Controller often has low computational requirements, which is advantageous for resource-constrained systems.",{"type":18,"tag":33,"props":12491,"children":12493},{"id":12492},"limitations",[12494],{"type":24,"value":12495},"Limitations",{"type":18,"tag":27,"props":12497,"children":12498},{},[12499],{"type":24,"value":12500},"Despite its advantages, the Pure Pursuit Controller has some limitations:",{"type":18,"tag":76,"props":12502,"children":12503},{},[12504,12514],{"type":18,"tag":80,"props":12505,"children":12506},{},[12507,12512],{"type":18,"tag":170,"props":12508,"children":12509},{},[12510],{"type":24,"value":12511},"Lookahead Distance Sensitivity",{"type":24,"value":12513},": Its performance can be sensitive to the choice of the lookahead distance, which requires careful tuning for optimal path tracking.",{"type":18,"tag":80,"props":12515,"children":12516},{},[12517,12522],{"type":18,"tag":170,"props":12518,"children":12519},{},[12520],{"type":24,"value":12521},"Non-Holonomic Assumption",{"type":24,"value":12523},": The controller assumes that the vehicle is non-holonomic, meaning it cannot move sideways. This assumption may not hold for certain types of vehicles, such as omnidirectional robots.",{"type":18,"tag":27,"props":12525,"children":12526},{},[12527],{"type":24,"value":12528},"In summary, the Pure Pursuit Controller is a straightforward yet effective algorithm for path tracking and navigation. Its ability to calculate a steering command based on a selected target point ahead of the vehicle makes it a valuable tool for applications ranging from autonomous cars to mobile robots.",{"type":18,"tag":599,"props":12530,"children":12535},{"className":12531,"code":12533,"language":12534,"meta":8},[12532],"language-js","console.log(\"Hello world\")\n\n","js",[12536],{"type":18,"tag":607,"props":12537,"children":12538},{},[12539],{"type":18,"tag":599,"props":12540,"children":12541},{"__ignoreMap":8},[12542],{"type":18,"tag":614,"props":12543,"children":12544},{"class":616,"line":617},[12545,12550,12555,12559,12564],{"type":18,"tag":614,"props":12546,"children":12547},{"class":627},[12548],{"type":24,"value":12549},"console.",{"type":18,"tag":614,"props":12551,"children":12552},{"class":633},[12553],{"type":24,"value":12554},"log",{"type":18,"tag":614,"props":12556,"children":12557},{"class":627},[12558],{"type":24,"value":1387},{"type":18,"tag":614,"props":12560,"children":12561},{"class":5349},[12562],{"type":24,"value":12563},"\"Hello world\"",{"type":18,"tag":614,"props":12565,"children":12566},{"class":627},[12567],{"type":24,"value":12195},{"type":18,"tag":6431,"children":12569},[12570],{"type":24,"value":12571},".ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-244866{color:#9ECBFF;}",{"title":8,"searchDepth":644,"depth":644,"links":12573},[12574],{"id":12351,"depth":644,"text":12343,"children":12575},[12576,12577,12578],{"id":12366,"depth":653,"text":12369},{"id":12429,"depth":653,"text":12432},{"id":12492,"depth":653,"text":12495},"content:topics:robotics:pure-pursuit.md","topics/robotics/pure-pursuit.md",{"_path":12582,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12583,"description":12584,"slug":12585,"tag":12585,"body":12586,"_type":6447,"_id":12787,"_source":6449,"_file":12788,"_extension":6451},"/topics/robotics/stanley-controller","Stanley Controller","Introduction to Stanley Controller","stanley",{"type":15,"children":12587,"toc":12780},[12588,12593,12603,12607,12612,12673,12677,12682,12733,12737,12742,12775],{"type":18,"tag":19,"props":12589,"children":12591},{"id":12590},"stanley-controller",[12592],{"type":24,"value":12583},{"type":18,"tag":27,"props":12594,"children":12595},{},[12596,12597,12601],{"type":24,"value":11062},{"type":18,"tag":170,"props":12598,"children":12599},{},[12600],{"type":24,"value":12583},{"type":24,"value":12602}," is an advanced path-tracking algorithm primarily used in the field of autonomous vehicle navigation. It is named after its creator, Professor John K. Hedrick, who developed it at Stanford University. The Stanley Controller is designed to enable a vehicle to follow a predefined path with high accuracy and stability.",{"type":18,"tag":33,"props":12604,"children":12605},{"id":12366},[12606],{"type":24,"value":12369},{"type":18,"tag":27,"props":12608,"children":12609},{},[12610],{"type":24,"value":12611},"The Stanley Controller operates based on a combination of control and feedback mechanisms:",{"type":18,"tag":284,"props":12613,"children":12614},{},[12615,12624,12634,12644,12654,12663],{"type":18,"tag":80,"props":12616,"children":12617},{},[12618,12622],{"type":18,"tag":170,"props":12619,"children":12620},{},[12621],{"type":24,"value":12385},{"type":24,"value":12623},": A predefined path is represented as a series of waypoints or a continuous curve. Each waypoint is associated with specific coordinates (x, y) and often includes additional information like desired speed and curvature.",{"type":18,"tag":80,"props":12625,"children":12626},{},[12627,12632],{"type":18,"tag":170,"props":12628,"children":12629},{},[12630],{"type":24,"value":12631},"Cross-Track Error (CTE) Calculation",{"type":24,"value":12633},": The controller calculates the cross-track error, which is the perpendicular distance between the vehicle's current position and the desired path. This error represents how far the vehicle has deviated from the path.",{"type":18,"tag":80,"props":12635,"children":12636},{},[12637,12642],{"type":18,"tag":170,"props":12638,"children":12639},{},[12640],{"type":24,"value":12641},"Heading Error Calculation",{"type":24,"value":12643},": The heading error, which is the difference between the vehicle's current heading (yaw angle) and the desired path's tangent angle at the nearest waypoint, is also computed.",{"type":18,"tag":80,"props":12645,"children":12646},{},[12647,12652],{"type":18,"tag":170,"props":12648,"children":12649},{},[12650],{"type":24,"value":12651},"Control Command Generation",{"type":24,"value":12653},": Using the calculated cross-track error and heading error, the Stanley Controller generates control commands. These commands typically include steering angle adjustments and throttle/brake control to minimize both errors.",{"type":18,"tag":80,"props":12655,"children":12656},{},[12657,12661],{"type":18,"tag":170,"props":12658,"children":12659},{},[12660],{"type":24,"value":12415},{"type":24,"value":12662},": The generated control commands are applied to the vehicle's steering and throttle/brake systems to guide it back to the desired path.",{"type":18,"tag":80,"props":12664,"children":12665},{},[12666,12671],{"type":18,"tag":170,"props":12667,"children":12668},{},[12669],{"type":24,"value":12670},"Iterative Feedback",{"type":24,"value":12672},": The process is iterative, with the controller continuously recalculating the cross-track and heading errors and adjusting the control commands to keep the vehicle on track.",{"type":18,"tag":33,"props":12674,"children":12675},{"id":12429},[12676],{"type":24,"value":12432},{"type":18,"tag":27,"props":12678,"children":12679},{},[12680],{"type":24,"value":12681},"The Stanley Controller offers several advantages:",{"type":18,"tag":76,"props":12683,"children":12684},{},[12685,12695,12705,12714,12723],{"type":18,"tag":80,"props":12686,"children":12687},{},[12688,12693],{"type":18,"tag":170,"props":12689,"children":12690},{},[12691],{"type":24,"value":12692},"High Accuracy",{"type":24,"value":12694},": It is known for its ability to achieve precise path-following, even in challenging conditions and complex road geometries.",{"type":18,"tag":80,"props":12696,"children":12697},{},[12698,12703],{"type":18,"tag":170,"props":12699,"children":12700},{},[12701],{"type":24,"value":12702},"Stability",{"type":24,"value":12704},": The controller's feedback mechanisms contribute to stable and smooth vehicle motion, reducing the risk of overshooting or oscillations.",{"type":18,"tag":80,"props":12706,"children":12707},{},[12708,12712],{"type":18,"tag":170,"props":12709,"children":12710},{},[12711],{"type":24,"value":12477},{"type":24,"value":12713},": The Stanley Controller can adapt to changes in the path, such as deviations caused by obstacles or dynamic road conditions.",{"type":18,"tag":80,"props":12715,"children":12716},{},[12717,12721],{"type":18,"tag":170,"props":12718,"children":12719},{},[12720],{"type":24,"value":12467},{"type":24,"value":12722},": It can operate in real-time, making it suitable for autonomous vehicle navigation in dynamic environments.",{"type":18,"tag":80,"props":12724,"children":12725},{},[12726,12731],{"type":18,"tag":170,"props":12727,"children":12728},{},[12729],{"type":24,"value":12730},"Versatility",{"type":24,"value":12732},": While primarily used in autonomous vehicles, the Stanley Controller's principles can be applied to various path-tracking tasks.",{"type":18,"tag":33,"props":12734,"children":12735},{"id":12492},[12736],{"type":24,"value":12495},{"type":18,"tag":27,"props":12738,"children":12739},{},[12740],{"type":24,"value":12741},"Despite its advantages, the Stanley Controller has some limitations:",{"type":18,"tag":76,"props":12743,"children":12744},{},[12745,12755,12765],{"type":18,"tag":80,"props":12746,"children":12747},{},[12748,12753],{"type":18,"tag":170,"props":12749,"children":12750},{},[12751],{"type":24,"value":12752},"Complexity",{"type":24,"value":12754},": Implementing the Stanley Controller can be more complex than some other control algorithms due to its mathematical calculations and tuning requirements.",{"type":18,"tag":80,"props":12756,"children":12757},{},[12758,12763],{"type":18,"tag":170,"props":12759,"children":12760},{},[12761],{"type":24,"value":12762},"Initialization",{"type":24,"value":12764},": It relies on accurate initialization, including knowledge of the vehicle's initial position and heading relative to the path.",{"type":18,"tag":80,"props":12766,"children":12767},{},[12768,12773],{"type":18,"tag":170,"props":12769,"children":12770},{},[12771],{"type":24,"value":12772},"Sensitivity to Noise",{"type":24,"value":12774},": Like many feedback-based controllers, the Stanley Controller can be sensitive to noisy sensor data and require robust sensor fusion techniques.",{"type":18,"tag":27,"props":12776,"children":12777},{},[12778],{"type":24,"value":12779},"In summary, the Stanley Controller is an advanced path-tracking algorithm known for its accuracy and stability, making it a valuable tool in the field of autonomous vehicle navigation. Proper implementation and tuning are essential to harness its full potential.",{"title":8,"searchDepth":644,"depth":644,"links":12781},[12782],{"id":12590,"depth":644,"text":12583,"children":12783},[12784,12785,12786],{"id":12366,"depth":653,"text":12369},{"id":12429,"depth":653,"text":12432},{"id":12492,"depth":653,"text":12495},"content:topics:robotics:stanley-controller.md","topics/robotics/stanley-controller.md",1697043608402]