[{"data":1,"prerenderedAt":6470},["Reactive",2],{"content-/topics/robotics/nmpc-cgmres":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"_empty":6,"title":8,"description":9,"author":10,"slug":11,"tag":11,"img":12,"body":13,"_type":6465,"_id":6466,"_source":6467,"_file":6468,"_extension":6469},"/topics/robotics/nmpc-cgmres","robotics",false,"","Nonlinear Model Predictive Control with C/GMRES","Optimal Control theory","Din Sokheng","nmpc-cgmres","/topics/robotics/nmpc/nmpc_cgmres.png",{"type":14,"children":15,"toc":6453},"root",[16,25,31,38,43,49,58,63,69,74,163,179,197,202,211,215,226,232,241,245,249,264,270,275,282,482,493,498,502,506,544,549,553,558,568,572,581,585,590,596,604,616,1777,1791,2616,2621,2753,2758,3109,3114,3887,3892,4372,4392,4879,4890,6263,6274,6280,6312,6331,6341,6346,6358,6364,6378,6384,6389,6395,6448],{"type":17,"tag":18,"props":19,"children":21},"element","h2",{"id":20},"the-optimal-control-theory-in-control-system",[22],{"type":23,"value":24},"text","The Optimal Control Theory in Control System",{"type":17,"tag":26,"props":27,"children":28},"p",{},[29],{"type":23,"value":30},"Optimal Control is a branch of control theory in control system, the theory works by solving the optimization problem of the dynamical system in order to find the optimal solution for the system",{"type":17,"tag":32,"props":33,"children":35},"h3",{"id":34},"what-is-model-predictive-control",[36],{"type":23,"value":37},"What is Model Predictive Control ?",{"type":17,"tag":26,"props":39,"children":40},{},[41],{"type":23,"value":42},"Model Predictive Control (MPC) is the optimal control method that use optimization algorithms to solve the cost function the occurs from the desired input and obtain back the optimal input control over the finite and infinite horizons. Recently, MPC is hyping up among the control system researcher, since it is fast, efficiency and robustness for any high complex system.",{"type":17,"tag":32,"props":44,"children":46},{"id":45},"hamilton-jacobian-bellman-equation-hjbe",[47],{"type":23,"value":48},"Hamilton Jacobian Bellman Equation (HJBE)",{"type":17,"tag":26,"props":50,"children":51},{},[52,54],{"type":23,"value":53},"Actually, the HJBE is a nonlinear partial differential equation that it consists necessary conditions for optimality of control by minimizing the loss function of the system. ",{"type":17,"tag":55,"props":56,"children":57},"br",{},[],{"type":17,"tag":26,"props":59,"children":60},{},[61],{"type":23,"value":62},"We have the Hamiltonian Jacobian Bellman Equation",{"type":17,"tag":64,"props":65,"children":68},"math-render-b",{"latex-express":66,"styles":67},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T} Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}","text-center",[],{"type":17,"tag":26,"props":70,"children":71},{},[72],{"type":23,"value":73},"Which",{"type":17,"tag":75,"props":76,"children":77},"ul",{},[78,90,105,118,127,136,145,154],{"type":17,"tag":79,"props":80,"children":81},"li",{},[82,88],{"type":17,"tag":83,"props":84,"children":87},"math-render",{"latex-express":85,"styles":86},"N","inline-flex",[],{"type":23,"value":89}," is the number of prediction future horizons or shooting node.",{"type":17,"tag":79,"props":91,"children":92},{},[93,97,99,103],{"type":17,"tag":83,"props":94,"children":96},{"latex-express":95,"styles":86},"x_{k}",[],{"type":23,"value":98}," is the state of the system at shooting node ",{"type":17,"tag":83,"props":100,"children":102},{"latex-express":101,"styles":86},"k",[],{"type":23,"value":104}," .",{"type":17,"tag":79,"props":106,"children":107},{},[108,112,114,117],{"type":17,"tag":83,"props":109,"children":111},{"latex-express":110,"styles":86},"u_{k}",[],{"type":23,"value":113}," is the input control of the system at shooting node ",{"type":17,"tag":83,"props":115,"children":116},{"latex-express":101,"styles":86},[],{"type":23,"value":104},{"type":17,"tag":79,"props":119,"children":120},{},[121,125],{"type":17,"tag":83,"props":122,"children":124},{"latex-express":123,"styles":86},"Q, R",[],{"type":23,"value":126}," are diagonal matrix which helps the optimization solving the nlp problem.",{"type":17,"tag":79,"props":128,"children":129},{},[130,134],{"type":17,"tag":83,"props":131,"children":133},{"latex-express":132,"styles":86},"f(x,u)",[],{"type":23,"value":135}," is the state representation of the system.",{"type":17,"tag":79,"props":137,"children":138},{},[139,143],{"type":17,"tag":83,"props":140,"children":142},{"latex-express":141,"styles":86},"C(x,u)",[],{"type":23,"value":144},"  is the constraint of the system.",{"type":17,"tag":79,"props":146,"children":147},{},[148,152],{"type":17,"tag":83,"props":149,"children":151},{"latex-express":150,"styles":86},"\\lambda",[],{"type":23,"value":153},"  is the costate vector for state representation.",{"type":17,"tag":79,"props":155,"children":156},{},[157,161],{"type":17,"tag":83,"props":158,"children":160},{"latex-express":159,"styles":86},"\\mu",[],{"type":23,"value":162},"  is the Lagrange multiplier vector for the equality constraint.",{"type":17,"tag":26,"props":164,"children":165},{},[166,168,174,176],{"type":23,"value":167},"Nonlinear Model Predictive Control has multiples solving method, but in this demonstration I will stick with the Continuation/GMRES method proposed by professor ",{"type":17,"tag":169,"props":170,"children":171},"strong",{},[172],{"type":23,"value":173}," Toshiyuki Ohtsuka ",{"type":23,"value":175},". ",{"type":17,"tag":55,"props":177,"children":178},{},[],{"type":17,"tag":26,"props":180,"children":181},{},[182,184,188,190,195],{"type":23,"value":183},"Supposed we want to obtain solution vector ",{"type":17,"tag":83,"props":185,"children":187},{"latex-express":186,"styles":86},"U(t) = [ u_{0}^{*}, \\mu_{0}^{*}, \\cdots, u_{N-1}^{*}, \\mu_{N-1}^{*} ]",[],{"type":23,"value":189},"   at sampling time $t$, we then define the discretization of ",{"type":17,"tag":169,"props":191,"children":192},{},[193],{"type":23,"value":194}," Euler Lagrangian Equation (ELE) ",{"type":23,"value":196},".",{"type":17,"tag":64,"props":198,"children":201},{"latex-express":199,"style":200},"\n\\begin{align}\n    x_{i+1}^{*}(t) &= x_{i}^{*}(t) + f(x_{i}^{*}(t), u_{i}^{*}(t))  \\\\\n    \\lambda_{i}^{*}(t) &= \\lambda_{i+1}^{*}(t) + \\frac{\\partial H}{\\partial x}\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) \\\\\n    \\lambda_{N}^{*}(t) &= \\frac{\\partial \\phi(x)}{\\partial x} \\\\\n    \\frac{\\partial H}{\\partial u} &\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) = 0 \\\\\n    C&(x_{i}^{*}(t),u_{i}^{*}(t)) = 0\n\\end{align}\n","text-ceneter",[],{"type":17,"tag":26,"props":203,"children":204},{},[205,207],{"type":23,"value":206},"To solve this nonlinear problem iteratively, we use Newton's method ",{"type":17,"tag":83,"props":208,"children":210},{"latex-express":209,"styles":86},"F(x,u)=0",[],{"type":17,"tag":64,"props":212,"children":214},{"latex-express":213,"styles":67},"\n\\begin{equation*}\n    F(x,u) = \\begin{bmatrix}\n        \\frac{\\partial H}{\\partial u} \\left( x_{0}^{*}, u_{0}^{*}(t), \\lambda_{1}^{*}(t), \\mu_{0}^{*}(t) \\right) \\\\\n        C(x_{0}^{*}(t),u_{0}^{*}(t))  \\\\\n        \\vdots \\\\\n        \\frac{\\partial H}{\\partial u} \\left( x_{N-1}^{*}, u_{N-1}^{*}(t), \\lambda_{N}^{*}(t), \\mu_{N-1}^{*}(t) \\right) \\\\\n        C(x_{N-1}^{*}(t),u_{N-1}^{*}(t)) \\\\\n    \\end{bmatrix} = 0\n\\end{equation*}",[],{"type":17,"tag":26,"props":216,"children":217},{},[218,220,224],{"type":23,"value":219},"Solving this problem directly will caused big computational complexity, hence we use Continuation to reduce the complexity of the ",{"type":17,"tag":83,"props":221,"children":223},{"latex-express":222,"styles":86},"F(x,u)",[],{"type":23,"value":225}," function and then solve it by using GMRES method.",{"type":17,"tag":32,"props":227,"children":229},{"id":228},"continuation",[230],{"type":23,"value":231},"Continuation",{"type":17,"tag":26,"props":233,"children":234},{},[235,237],{"type":23,"value":236},"Denote  ",{"type":17,"tag":83,"props":238,"children":240},{"latex-express":239,"styles":86},"\\zeta, \\alpha, h \\in{\\mathbb{R} }",[],{"type":17,"tag":64,"props":242,"children":244},{"latex-express":243,"styles":67},"\n\\begin{equation*}\n    \\frac{\\partial F}{\\partial u}(x,u) \\dot{u}(t) = -\\zeta F(x,u)(t)-\\frac{\\partial F}{\\partial x}(x,u)(t)\\dot{x}-\\frac{\\partial F}{\\partial t}(x,u)(t) \n\\end{equation*}",[],{"type":17,"tag":64,"props":246,"children":248},{"latex-express":247,"styles":67},"\n\\begin{equation*}\n    \\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h} = -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}\n\\end{equation*}",[],{"type":17,"tag":26,"props":250,"children":251},{},[252,254,258,260],{"type":23,"value":253},"Let ",{"type":17,"tag":64,"props":255,"children":257},{"latex-express":256,"styles":67},"right=\\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h}",[],{"type":23,"value":259}," and ",{"type":17,"tag":64,"props":261,"children":263},{"latex-express":262,"styles":67},"left =  -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}",[],{"type":17,"tag":32,"props":265,"children":267},{"id":266},"generalized-minimal-residue-method-gmres",[268],{"type":23,"value":269},"Generalized Minimal Residue Method (GMRES)",{"type":17,"tag":26,"props":271,"children":272},{},[273],{"type":23,"value":274},"The Generalized Minimal Residual (GMRES) algorithm is an iterative method for solving linear systems of equations. It is often used for large sparse linear systems.",{"type":17,"tag":276,"props":277,"children":279},"h4",{"id":278},"algorithm-description",[280],{"type":23,"value":281},"Algorithm Description",{"type":17,"tag":283,"props":284,"children":285},"ol",{},[286,341,448,467],{"type":17,"tag":79,"props":287,"children":288},{},[289,294,296],{"type":17,"tag":169,"props":290,"children":291},{},[292],{"type":23,"value":293},"Initialize",{"type":23,"value":295},":",{"type":17,"tag":75,"props":297,"children":298},{},[299,309,319],{"type":17,"tag":79,"props":300,"children":301},{},[302,304,308],{"type":23,"value":303},"Choose an initial guess for the solution, denoted as ",{"type":17,"tag":83,"props":305,"children":307},{"latex-express":306,"styles":86},"x_{0}",[],{"type":23,"value":196},{"type":17,"tag":79,"props":310,"children":311},{},[312,314,318],{"type":23,"value":313},"Set the residual vector ",{"type":17,"tag":83,"props":315,"children":317},{"latex-express":316,"styles":86},"r_{0}=\\left\\| Ax_{0}-b \\right\\|",[],{"type":23,"value":196},{"type":17,"tag":79,"props":320,"children":321},{},[322,324,328,330,334,336,340],{"type":23,"value":323},"Set ",{"type":17,"tag":83,"props":325,"children":327},{"latex-express":326,"styles":86},"v_{1}=\\frac{r_{0} }{\\left\\| r_{0} \\right\\|}",[],{"type":23,"value":329},", where ",{"type":17,"tag":83,"props":331,"children":333},{"latex-express":332,"styles":86},"\\left\\| r_{0} \\right\\|",[],{"type":23,"value":335},"  is the norm of ",{"type":17,"tag":83,"props":337,"children":339},{"latex-express":338,"styles":86},"r_{0}",[],{"type":23,"value":196},{"type":17,"tag":79,"props":342,"children":343},{},[344,349,350],{"type":17,"tag":169,"props":345,"children":346},{},[347],{"type":23,"value":348},"Iterative Process",{"type":23,"value":295},{"type":17,"tag":75,"props":351,"children":352},{},[353,363,437],{"type":17,"tag":79,"props":354,"children":355},{},[356,358,362],{"type":23,"value":357},"Choose a vector ",{"type":17,"tag":83,"props":359,"children":361},{"latex-express":360,"styles":86},"v_{1}",[],{"type":23,"value":196},{"type":17,"tag":79,"props":364,"children":365},{},[366,368,372,374,378,379],{"type":23,"value":367},"For ",{"type":17,"tag":83,"props":369,"children":371},{"latex-express":370,"styles":86},"k=0",[],{"type":23,"value":373}," to ",{"type":17,"tag":83,"props":375,"children":377},{"latex-express":376,"styles":86},"maxiteration",[],{"type":23,"value":295},{"type":17,"tag":75,"props":380,"children":381},{},[382,418],{"type":17,"tag":79,"props":383,"children":384},{},[385,387],{"type":23,"value":386},"Arnoldi process:",{"type":17,"tag":75,"props":388,"children":389},{},[390,397,404,411],{"type":17,"tag":79,"props":391,"children":392},{},[393],{"type":17,"tag":83,"props":394,"children":396},{"latex-express":395,"styles":86},"h_{i,j} = \\left(Av_{j}, v_{i} \\right)",[],{"type":17,"tag":79,"props":398,"children":399},{},[400],{"type":17,"tag":83,"props":401,"children":403},{"latex-express":402,"styles":86},"\\hat{v}_{j+1} = Av_{j} - \\sum_{i=1}^{j}h_{i,j}v_{i}",[],{"type":17,"tag":79,"props":405,"children":406},{},[407],{"type":17,"tag":83,"props":408,"children":410},{"latex-express":409,"styles":86},"h_{j+1,j} = \\left \\| \\hat{v}_{j+1}  \\right\\|_{2}",[],{"type":17,"tag":79,"props":412,"children":413},{},[414],{"type":17,"tag":83,"props":415,"children":417},{"latex-express":416,"styles":86},"v_{j+1} = \\frac{\\hat{v}_{j+1} }{h_{j+1,j} }",[],{"type":17,"tag":79,"props":419,"children":420},{},[421,423],{"type":23,"value":422},"Check for convergence:",{"type":17,"tag":75,"props":424,"children":425},{},[426],{"type":17,"tag":79,"props":427,"children":428},{},[429,431,435],{"type":23,"value":430},"If ",{"type":17,"tag":83,"props":432,"children":434},{"latex-express":433,"styles":86},"||r_k|| \u003C tolerance",[],{"type":23,"value":436},", exit the loop.",{"type":17,"tag":79,"props":438,"children":439},{},[440,442,446],{"type":23,"value":441},"If no convergence is achieved after ",{"type":17,"tag":83,"props":443,"children":445},{"latex-express":444,"styles":86},"maxiterations",[],{"type":23,"value":447},", exit with an error message.",{"type":17,"tag":79,"props":449,"children":450},{},[451,460,462,466],{"type":17,"tag":169,"props":452,"children":453},{},[454,456],{"type":23,"value":455},"Find ",{"type":17,"tag":83,"props":457,"children":459},{"latex-express":458,"styles":86},"y",[],{"type":23,"value":461},": which minimize ",{"type":17,"tag":83,"props":463,"children":465},{"latex-express":464,"styles":86},"\\left\\| r_{0}e_{1}-\\hat{H}_{m}y \\right \\|_{2}",[],{"type":23,"value":196},{"type":17,"tag":79,"props":468,"children":469},{},[470,475,477,481],{"type":17,"tag":169,"props":471,"children":472},{},[473],{"type":23,"value":474},"Compute",{"type":23,"value":476},": ",{"type":17,"tag":83,"props":478,"children":480},{"latex-express":479,"styles":86},"x_{m} = x_{0}+V_{m}y_{m}",[],{"type":23,"value":196},{"type":17,"tag":26,"props":483,"children":484},{},[485,487,491],{"type":23,"value":486},"For example differential model, let ",{"type":17,"tag":83,"props":488,"children":490},{"latex-express":489,"styles":86},"x, y, \\phi",[],{"type":23,"value":492}," is the state presentation of the model\n$$ \\dot{x} = f(x,u) $$",{"type":17,"tag":26,"props":494,"children":495},{},[496],{"type":23,"value":497},"Then the HJBE defined as",{"type":17,"tag":64,"props":499,"children":501},{"latex-express":500,"styles":67},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}\n",[],{"type":17,"tag":26,"props":503,"children":504},{},[505],{"type":23,"value":73},{"type":17,"tag":75,"props":507,"children":508},{},[509,516,523,530,537],{"type":17,"tag":79,"props":510,"children":511},{},[512],{"type":17,"tag":83,"props":513,"children":515},{"latex-express":514,"styles":86},"f(x,u) = \\begin{bmatrix} u_{1}*\\cos{(\\phi)} \\\\ u_{1}*\\sin{(\\phi)} \\\\ u_{2} \\end{bmatrix}",[],{"type":17,"tag":79,"props":517,"children":518},{},[519],{"type":17,"tag":83,"props":520,"children":522},{"latex-express":521,"styles":86},"C(x,u) = \\begin{bmatrix} \\left(u_{1}-\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min} }{2})^{2} \\\\\n          \\left(u_{2}-\\frac{u_{2max}+u_{2min} }{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2}\n\\end{bmatrix}",[],{"type":17,"tag":79,"props":524,"children":525},{},[526],{"type":17,"tag":83,"props":527,"children":529},{"latex-express":528,"styles":86},"\\phi(x) = (x_{N}-x_{N,ref})^{T}Q(x_{N}-x_{N,ref})",[],{"type":17,"tag":79,"props":531,"children":532},{},[533],{"type":17,"tag":83,"props":534,"children":536},{"latex-express":535,"styles":86},"\\lambda = \\begin{bmatrix} \\lambda_{1} & \\lambda_{2} & \\lambda_{3} \\end{bmatrix}",[],{"type":17,"tag":79,"props":538,"children":539},{},[540],{"type":17,"tag":83,"props":541,"children":543},{"latex-express":542,"styles":86}," \\mu = \\begin{bmatrix} \\mu_{1} & \\mu_{2} \\end{bmatrix}",[],{"type":17,"tag":26,"props":545,"children":546},{},[547],{"type":23,"value":548},"Subtitute all of these term into HJBE",{"type":17,"tag":64,"props":550,"children":552},{"latex-express":551,"styles":67},"\n\\begin{align*}\nH(x,u,\\lambda,\\mu) &= \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref})\n                     + (x_{N}-x_{N,ref})^{T}Q(x_{N}-x_{N,ref}) \\\\ & + \\begin{bmatrix} \\lambda_{1} \\\\ \\lambda_{2} \\\\ \\lambda_{3} \\end{bmatrix}^{T} \\begin{bmatrix} u_{1}*\\cos(\\phi) \\\\ u_{1}*\\sin(\\phi) \\\\ u_{2} \\end{bmatrix}\n                     + \\begin{bmatrix} \\mu_{1} \\\\ \\mu_{2} \\end{bmatrix}^{T} \\begin{bmatrix} \\left(u_{1}-\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min}}{2})^{2} \\\\\n            \\left(u_{2}\\frac{u_{2max}+u_{2min}}{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2} \n\\end{bmatrix}\n\\end{align*}",[],{"type":17,"tag":26,"props":554,"children":555},{},[556],{"type":23,"value":557},"By doing partial derivative of HJBE, we get",{"type":17,"tag":276,"props":559,"children":561},{"id":560},"hamiltonian-respect-to-states",[562,564],{"type":23,"value":563},"Hamiltonian respect to states ",{"type":17,"tag":83,"props":565,"children":567},{"latex-express":566,"styles":86},"\\frac{\\partial H}{\\partial x}",[],{"type":17,"tag":64,"props":569,"children":571},{"latex-express":570,"styles":67},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial x} = \\begin{bmatrix}\n     (x-x_{ref})q_{1} \\\\\n     (y-y_{ref})q_{2} \\\\ \n     (\\phi-\\phi_{ref})q_{3} - \\lambda_{1}\\sin{(\\phi)}u_{1} + \\lambda_{2}\\cos{(\\phi)}u_{1}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":17,"tag":276,"props":573,"children":575},{"id":574},"hamiltonian-respect-to-input-control",[576,578],{"type":23,"value":577},"Hamiltonian respect to input control ",{"type":17,"tag":83,"props":579,"children":580},{"latex-express":566,"styles":86},[],{"type":17,"tag":64,"props":582,"children":584},{"latex-express":583,"styles":67},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial u} = \\begin{bmatrix}\n      (u_{1}-u_{1,ref})r_{1}+\\lambda_{1}\\cos{(\\phi)}+\\lambda_{2}\\sin{(\\phi)} \\\\ \n      (u_{2}-u_{2,ref})r_{2}+\\lambda_{3}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":17,"tag":26,"props":586,"children":587},{},[588],{"type":23,"value":589},"I know this is quite complicated, this is just only input control without constraint and solver with single shooting method.",{"type":17,"tag":18,"props":591,"children":593},{"id":592},"implementing-in-python",[594],{"type":23,"value":595},"Implementing in Python",{"type":17,"tag":26,"props":597,"children":598},{},[599,601],{"type":23,"value":600},"It is safe to say that you will need to start from basic first. Like creating class for model representation, but for now I will just go with CGMRES implementing only, since I have done many demonstration of how to create class for model. ",{"type":17,"tag":55,"props":602,"children":603},{},[],{"type":17,"tag":26,"props":605,"children":606},{},[607,609,614],{"type":23,"value":608},"Let's create class for ",{"type":17,"tag":169,"props":610,"children":611},{},[612],{"type":23,"value":613}," Hamiltion Jacobian Bellman Equation ",{"type":23,"value":615}," which we already derived from above equation.",{"type":17,"tag":617,"props":618,"children":623},"code",{"className":619,"code":621,"language":622,"meta":7},[620],"language-python","class HJBEquation:\n\n    def __init__(self, q1, q2, q3, r1, r2, u_max, u_min):\n\n        self.q1 = q1\n        self.q2 = q2\n        self.q3 = q3\n\n        self.r1 = r1\n        self.r2 = r2\n\n        self.u1_min = u_min[0]\n        self.u2_min = u_min[0]\n\n        self.u1_max = u_max[0]\n        self.u2_max = u_max[1]\n\n    def dhdx(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n\n        dhdx1 = (x-x_r)*self.q1\n        dhdx2 = (y-y_r)*self.q2\n        dhdx3 = (yaw-yaw_r)*self.q3-u1*lam1*np.sin(yaw)+u1*lam2*np.cos(yaw)\n\n        return dhdx1, dhdx2, dhdx3\n\n    def dhdu(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n\n        dhdu1 = self.r1*(u1-u1_r)+lam1*np.cos(yaw)+lam2*np.sin(yaw)+2*mu1*u1*(u1+(self.u1_max+self.u1_min)/2)\n        dhdu2 = self.r2*(u2-u2_r)+lam3+2*mu2*(u2+(self.u2_max+self.u2_min)/2)\n\n        return dhdu1, dhdu2\n\n    def dphidx(self, x, y, yaw, x_r, y_r, yaw_r):\n        dphidx1 = self.q1*(x-x_r)\n        dphidx2 = self.q2*(y-y_r)\n        dphidx3 = self.q3*(yaw-yaw_r)\n\n        return dphidx1, dphidx2, dphidx3\n","python",[624],{"type":17,"tag":625,"props":626,"children":627},"pre",{},[628],{"type":17,"tag":617,"props":629,"children":630},{"__ignoreMap":7},[631,660,669,698,706,735,761,787,795,821,847,855,891,924,932,966,1000,1008,1034,1042,1084,1124,1218,1226,1244,1252,1278,1286,1442,1562,1570,1587,1595,1621,1665,1709,1752,1760],{"type":17,"tag":632,"props":633,"children":636},"span",{"class":634,"line":635},"line",1,[637,643,649,655],{"type":17,"tag":632,"props":638,"children":640},{"class":639},"ct-857441",[641],{"type":23,"value":642},"class",{"type":17,"tag":632,"props":644,"children":646},{"class":645},"ct-767297",[647],{"type":23,"value":648}," ",{"type":17,"tag":632,"props":650,"children":652},{"class":651},"ct-806137",[653],{"type":23,"value":654},"HJBEquation",{"type":17,"tag":632,"props":656,"children":657},{"class":645},[658],{"type":23,"value":659},":\n",{"type":17,"tag":632,"props":661,"children":663},{"class":634,"line":662},2,[664],{"type":17,"tag":632,"props":665,"children":666},{},[667],{"type":23,"value":668},"\n",{"type":17,"tag":632,"props":670,"children":672},{"class":634,"line":671},3,[673,678,683,687,693],{"type":17,"tag":632,"props":674,"children":675},{"class":645},[676],{"type":23,"value":677},"    ",{"type":17,"tag":632,"props":679,"children":680},{"class":639},[681],{"type":23,"value":682},"def",{"type":17,"tag":632,"props":684,"children":685},{"class":645},[686],{"type":23,"value":648},{"type":17,"tag":632,"props":688,"children":690},{"class":689},"ct-533739",[691],{"type":23,"value":692},"__init__",{"type":17,"tag":632,"props":694,"children":695},{"class":645},[696],{"type":23,"value":697},"(self, q1, q2, q3, r1, r2, u_max, u_min):\n",{"type":17,"tag":632,"props":699,"children":701},{"class":634,"line":700},4,[702],{"type":17,"tag":632,"props":703,"children":704},{},[705],{"type":23,"value":668},{"type":17,"tag":632,"props":707,"children":709},{"class":634,"line":708},5,[710,715,720,725,730],{"type":17,"tag":632,"props":711,"children":712},{"class":645},[713],{"type":23,"value":714},"        ",{"type":17,"tag":632,"props":716,"children":717},{"class":689},[718],{"type":23,"value":719},"self",{"type":17,"tag":632,"props":721,"children":722},{"class":645},[723],{"type":23,"value":724},".q1 ",{"type":17,"tag":632,"props":726,"children":727},{"class":639},[728],{"type":23,"value":729},"=",{"type":17,"tag":632,"props":731,"children":732},{"class":645},[733],{"type":23,"value":734}," q1\n",{"type":17,"tag":632,"props":736,"children":738},{"class":634,"line":737},6,[739,743,747,752,756],{"type":17,"tag":632,"props":740,"children":741},{"class":645},[742],{"type":23,"value":714},{"type":17,"tag":632,"props":744,"children":745},{"class":689},[746],{"type":23,"value":719},{"type":17,"tag":632,"props":748,"children":749},{"class":645},[750],{"type":23,"value":751},".q2 ",{"type":17,"tag":632,"props":753,"children":754},{"class":639},[755],{"type":23,"value":729},{"type":17,"tag":632,"props":757,"children":758},{"class":645},[759],{"type":23,"value":760}," q2\n",{"type":17,"tag":632,"props":762,"children":764},{"class":634,"line":763},7,[765,769,773,778,782],{"type":17,"tag":632,"props":766,"children":767},{"class":645},[768],{"type":23,"value":714},{"type":17,"tag":632,"props":770,"children":771},{"class":689},[772],{"type":23,"value":719},{"type":17,"tag":632,"props":774,"children":775},{"class":645},[776],{"type":23,"value":777},".q3 ",{"type":17,"tag":632,"props":779,"children":780},{"class":639},[781],{"type":23,"value":729},{"type":17,"tag":632,"props":783,"children":784},{"class":645},[785],{"type":23,"value":786}," q3\n",{"type":17,"tag":632,"props":788,"children":790},{"class":634,"line":789},8,[791],{"type":17,"tag":632,"props":792,"children":793},{},[794],{"type":23,"value":668},{"type":17,"tag":632,"props":796,"children":798},{"class":634,"line":797},9,[799,803,807,812,816],{"type":17,"tag":632,"props":800,"children":801},{"class":645},[802],{"type":23,"value":714},{"type":17,"tag":632,"props":804,"children":805},{"class":689},[806],{"type":23,"value":719},{"type":17,"tag":632,"props":808,"children":809},{"class":645},[810],{"type":23,"value":811},".r1 ",{"type":17,"tag":632,"props":813,"children":814},{"class":639},[815],{"type":23,"value":729},{"type":17,"tag":632,"props":817,"children":818},{"class":645},[819],{"type":23,"value":820}," r1\n",{"type":17,"tag":632,"props":822,"children":824},{"class":634,"line":823},10,[825,829,833,838,842],{"type":17,"tag":632,"props":826,"children":827},{"class":645},[828],{"type":23,"value":714},{"type":17,"tag":632,"props":830,"children":831},{"class":689},[832],{"type":23,"value":719},{"type":17,"tag":632,"props":834,"children":835},{"class":645},[836],{"type":23,"value":837},".r2 ",{"type":17,"tag":632,"props":839,"children":840},{"class":639},[841],{"type":23,"value":729},{"type":17,"tag":632,"props":843,"children":844},{"class":645},[845],{"type":23,"value":846}," r2\n",{"type":17,"tag":632,"props":848,"children":850},{"class":634,"line":849},11,[851],{"type":17,"tag":632,"props":852,"children":853},{},[854],{"type":23,"value":668},{"type":17,"tag":632,"props":856,"children":858},{"class":634,"line":857},12,[859,863,867,872,876,881,886],{"type":17,"tag":632,"props":860,"children":861},{"class":645},[862],{"type":23,"value":714},{"type":17,"tag":632,"props":864,"children":865},{"class":689},[866],{"type":23,"value":719},{"type":17,"tag":632,"props":868,"children":869},{"class":645},[870],{"type":23,"value":871},".u1_min ",{"type":17,"tag":632,"props":873,"children":874},{"class":639},[875],{"type":23,"value":729},{"type":17,"tag":632,"props":877,"children":878},{"class":645},[879],{"type":23,"value":880}," u_min[",{"type":17,"tag":632,"props":882,"children":883},{"class":689},[884],{"type":23,"value":885},"0",{"type":17,"tag":632,"props":887,"children":888},{"class":645},[889],{"type":23,"value":890},"]\n",{"type":17,"tag":632,"props":892,"children":894},{"class":634,"line":893},13,[895,899,903,908,912,916,920],{"type":17,"tag":632,"props":896,"children":897},{"class":645},[898],{"type":23,"value":714},{"type":17,"tag":632,"props":900,"children":901},{"class":689},[902],{"type":23,"value":719},{"type":17,"tag":632,"props":904,"children":905},{"class":645},[906],{"type":23,"value":907},".u2_min ",{"type":17,"tag":632,"props":909,"children":910},{"class":639},[911],{"type":23,"value":729},{"type":17,"tag":632,"props":913,"children":914},{"class":645},[915],{"type":23,"value":880},{"type":17,"tag":632,"props":917,"children":918},{"class":689},[919],{"type":23,"value":885},{"type":17,"tag":632,"props":921,"children":922},{"class":645},[923],{"type":23,"value":890},{"type":17,"tag":632,"props":925,"children":927},{"class":634,"line":926},14,[928],{"type":17,"tag":632,"props":929,"children":930},{},[931],{"type":23,"value":668},{"type":17,"tag":632,"props":933,"children":935},{"class":634,"line":934},15,[936,940,944,949,953,958,962],{"type":17,"tag":632,"props":937,"children":938},{"class":645},[939],{"type":23,"value":714},{"type":17,"tag":632,"props":941,"children":942},{"class":689},[943],{"type":23,"value":719},{"type":17,"tag":632,"props":945,"children":946},{"class":645},[947],{"type":23,"value":948},".u1_max ",{"type":17,"tag":632,"props":950,"children":951},{"class":639},[952],{"type":23,"value":729},{"type":17,"tag":632,"props":954,"children":955},{"class":645},[956],{"type":23,"value":957}," u_max[",{"type":17,"tag":632,"props":959,"children":960},{"class":689},[961],{"type":23,"value":885},{"type":17,"tag":632,"props":963,"children":964},{"class":645},[965],{"type":23,"value":890},{"type":17,"tag":632,"props":967,"children":969},{"class":634,"line":968},16,[970,974,978,983,987,991,996],{"type":17,"tag":632,"props":971,"children":972},{"class":645},[973],{"type":23,"value":714},{"type":17,"tag":632,"props":975,"children":976},{"class":689},[977],{"type":23,"value":719},{"type":17,"tag":632,"props":979,"children":980},{"class":645},[981],{"type":23,"value":982},".u2_max ",{"type":17,"tag":632,"props":984,"children":985},{"class":639},[986],{"type":23,"value":729},{"type":17,"tag":632,"props":988,"children":989},{"class":645},[990],{"type":23,"value":957},{"type":17,"tag":632,"props":992,"children":993},{"class":689},[994],{"type":23,"value":995},"1",{"type":17,"tag":632,"props":997,"children":998},{"class":645},[999],{"type":23,"value":890},{"type":17,"tag":632,"props":1001,"children":1003},{"class":634,"line":1002},17,[1004],{"type":17,"tag":632,"props":1005,"children":1006},{},[1007],{"type":23,"value":668},{"type":17,"tag":632,"props":1009,"children":1011},{"class":634,"line":1010},18,[1012,1016,1020,1024,1029],{"type":17,"tag":632,"props":1013,"children":1014},{"class":645},[1015],{"type":23,"value":677},{"type":17,"tag":632,"props":1017,"children":1018},{"class":639},[1019],{"type":23,"value":682},{"type":17,"tag":632,"props":1021,"children":1022},{"class":645},[1023],{"type":23,"value":648},{"type":17,"tag":632,"props":1025,"children":1026},{"class":651},[1027],{"type":23,"value":1028},"dhdx",{"type":17,"tag":632,"props":1030,"children":1031},{"class":645},[1032],{"type":23,"value":1033},"(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n",{"type":17,"tag":632,"props":1035,"children":1037},{"class":634,"line":1036},19,[1038],{"type":17,"tag":632,"props":1039,"children":1040},{},[1041],{"type":23,"value":668},{"type":17,"tag":632,"props":1043,"children":1045},{"class":634,"line":1044},20,[1046,1051,1055,1060,1065,1070,1075,1079],{"type":17,"tag":632,"props":1047,"children":1048},{"class":645},[1049],{"type":23,"value":1050},"        dhdx1 ",{"type":17,"tag":632,"props":1052,"children":1053},{"class":639},[1054],{"type":23,"value":729},{"type":17,"tag":632,"props":1056,"children":1057},{"class":645},[1058],{"type":23,"value":1059}," (x",{"type":17,"tag":632,"props":1061,"children":1062},{"class":639},[1063],{"type":23,"value":1064},"-",{"type":17,"tag":632,"props":1066,"children":1067},{"class":645},[1068],{"type":23,"value":1069},"x_r)",{"type":17,"tag":632,"props":1071,"children":1072},{"class":639},[1073],{"type":23,"value":1074},"*",{"type":17,"tag":632,"props":1076,"children":1077},{"class":689},[1078],{"type":23,"value":719},{"type":17,"tag":632,"props":1080,"children":1081},{"class":645},[1082],{"type":23,"value":1083},".q1\n",{"type":17,"tag":632,"props":1085,"children":1087},{"class":634,"line":1086},21,[1088,1093,1097,1102,1106,1111,1115,1119],{"type":17,"tag":632,"props":1089,"children":1090},{"class":645},[1091],{"type":23,"value":1092},"        dhdx2 ",{"type":17,"tag":632,"props":1094,"children":1095},{"class":639},[1096],{"type":23,"value":729},{"type":17,"tag":632,"props":1098,"children":1099},{"class":645},[1100],{"type":23,"value":1101}," (y",{"type":17,"tag":632,"props":1103,"children":1104},{"class":639},[1105],{"type":23,"value":1064},{"type":17,"tag":632,"props":1107,"children":1108},{"class":645},[1109],{"type":23,"value":1110},"y_r)",{"type":17,"tag":632,"props":1112,"children":1113},{"class":639},[1114],{"type":23,"value":1074},{"type":17,"tag":632,"props":1116,"children":1117},{"class":689},[1118],{"type":23,"value":719},{"type":17,"tag":632,"props":1120,"children":1121},{"class":645},[1122],{"type":23,"value":1123},".q2\n",{"type":17,"tag":632,"props":1125,"children":1127},{"class":634,"line":1126},22,[1128,1133,1137,1142,1146,1151,1155,1159,1164,1168,1173,1177,1182,1186,1191,1196,1200,1204,1209,1213],{"type":17,"tag":632,"props":1129,"children":1130},{"class":645},[1131],{"type":23,"value":1132},"        dhdx3 ",{"type":17,"tag":632,"props":1134,"children":1135},{"class":639},[1136],{"type":23,"value":729},{"type":17,"tag":632,"props":1138,"children":1139},{"class":645},[1140],{"type":23,"value":1141}," (yaw",{"type":17,"tag":632,"props":1143,"children":1144},{"class":639},[1145],{"type":23,"value":1064},{"type":17,"tag":632,"props":1147,"children":1148},{"class":645},[1149],{"type":23,"value":1150},"yaw_r)",{"type":17,"tag":632,"props":1152,"children":1153},{"class":639},[1154],{"type":23,"value":1074},{"type":17,"tag":632,"props":1156,"children":1157},{"class":689},[1158],{"type":23,"value":719},{"type":17,"tag":632,"props":1160,"children":1161},{"class":645},[1162],{"type":23,"value":1163},".q3",{"type":17,"tag":632,"props":1165,"children":1166},{"class":639},[1167],{"type":23,"value":1064},{"type":17,"tag":632,"props":1169,"children":1170},{"class":645},[1171],{"type":23,"value":1172},"u1",{"type":17,"tag":632,"props":1174,"children":1175},{"class":639},[1176],{"type":23,"value":1074},{"type":17,"tag":632,"props":1178,"children":1179},{"class":645},[1180],{"type":23,"value":1181},"lam1",{"type":17,"tag":632,"props":1183,"children":1184},{"class":639},[1185],{"type":23,"value":1074},{"type":17,"tag":632,"props":1187,"children":1188},{"class":645},[1189],{"type":23,"value":1190},"np.sin(yaw)",{"type":17,"tag":632,"props":1192,"children":1193},{"class":639},[1194],{"type":23,"value":1195},"+",{"type":17,"tag":632,"props":1197,"children":1198},{"class":645},[1199],{"type":23,"value":1172},{"type":17,"tag":632,"props":1201,"children":1202},{"class":639},[1203],{"type":23,"value":1074},{"type":17,"tag":632,"props":1205,"children":1206},{"class":645},[1207],{"type":23,"value":1208},"lam2",{"type":17,"tag":632,"props":1210,"children":1211},{"class":639},[1212],{"type":23,"value":1074},{"type":17,"tag":632,"props":1214,"children":1215},{"class":645},[1216],{"type":23,"value":1217},"np.cos(yaw)\n",{"type":17,"tag":632,"props":1219,"children":1221},{"class":634,"line":1220},23,[1222],{"type":17,"tag":632,"props":1223,"children":1224},{},[1225],{"type":23,"value":668},{"type":17,"tag":632,"props":1227,"children":1229},{"class":634,"line":1228},24,[1230,1234,1239],{"type":17,"tag":632,"props":1231,"children":1232},{"class":645},[1233],{"type":23,"value":714},{"type":17,"tag":632,"props":1235,"children":1236},{"class":639},[1237],{"type":23,"value":1238},"return",{"type":17,"tag":632,"props":1240,"children":1241},{"class":645},[1242],{"type":23,"value":1243}," dhdx1, dhdx2, dhdx3\n",{"type":17,"tag":632,"props":1245,"children":1247},{"class":634,"line":1246},25,[1248],{"type":17,"tag":632,"props":1249,"children":1250},{},[1251],{"type":23,"value":668},{"type":17,"tag":632,"props":1253,"children":1255},{"class":634,"line":1254},26,[1256,1260,1264,1268,1273],{"type":17,"tag":632,"props":1257,"children":1258},{"class":645},[1259],{"type":23,"value":677},{"type":17,"tag":632,"props":1261,"children":1262},{"class":639},[1263],{"type":23,"value":682},{"type":17,"tag":632,"props":1265,"children":1266},{"class":645},[1267],{"type":23,"value":648},{"type":17,"tag":632,"props":1269,"children":1270},{"class":651},[1271],{"type":23,"value":1272},"dhdu",{"type":17,"tag":632,"props":1274,"children":1275},{"class":645},[1276],{"type":23,"value":1277},"(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n",{"type":17,"tag":632,"props":1279,"children":1281},{"class":634,"line":1280},27,[1282],{"type":17,"tag":632,"props":1283,"children":1284},{},[1285],{"type":23,"value":668},{"type":17,"tag":632,"props":1287,"children":1289},{"class":634,"line":1288},28,[1290,1295,1299,1303,1307,1312,1316,1321,1325,1330,1334,1338,1342,1347,1351,1355,1359,1363,1367,1372,1376,1381,1385,1389,1393,1397,1401,1406,1410,1415,1419,1423,1428,1433,1437],{"type":17,"tag":632,"props":1291,"children":1292},{"class":645},[1293],{"type":23,"value":1294},"        dhdu1 ",{"type":17,"tag":632,"props":1296,"children":1297},{"class":639},[1298],{"type":23,"value":729},{"type":17,"tag":632,"props":1300,"children":1301},{"class":645},[1302],{"type":23,"value":648},{"type":17,"tag":632,"props":1304,"children":1305},{"class":689},[1306],{"type":23,"value":719},{"type":17,"tag":632,"props":1308,"children":1309},{"class":645},[1310],{"type":23,"value":1311},".r1",{"type":17,"tag":632,"props":1313,"children":1314},{"class":639},[1315],{"type":23,"value":1074},{"type":17,"tag":632,"props":1317,"children":1318},{"class":645},[1319],{"type":23,"value":1320},"(u1",{"type":17,"tag":632,"props":1322,"children":1323},{"class":639},[1324],{"type":23,"value":1064},{"type":17,"tag":632,"props":1326,"children":1327},{"class":645},[1328],{"type":23,"value":1329},"u1_r)",{"type":17,"tag":632,"props":1331,"children":1332},{"class":639},[1333],{"type":23,"value":1195},{"type":17,"tag":632,"props":1335,"children":1336},{"class":645},[1337],{"type":23,"value":1181},{"type":17,"tag":632,"props":1339,"children":1340},{"class":639},[1341],{"type":23,"value":1074},{"type":17,"tag":632,"props":1343,"children":1344},{"class":645},[1345],{"type":23,"value":1346},"np.cos(yaw)",{"type":17,"tag":632,"props":1348,"children":1349},{"class":639},[1350],{"type":23,"value":1195},{"type":17,"tag":632,"props":1352,"children":1353},{"class":645},[1354],{"type":23,"value":1208},{"type":17,"tag":632,"props":1356,"children":1357},{"class":639},[1358],{"type":23,"value":1074},{"type":17,"tag":632,"props":1360,"children":1361},{"class":645},[1362],{"type":23,"value":1190},{"type":17,"tag":632,"props":1364,"children":1365},{"class":639},[1366],{"type":23,"value":1195},{"type":17,"tag":632,"props":1368,"children":1369},{"class":689},[1370],{"type":23,"value":1371},"2",{"type":17,"tag":632,"props":1373,"children":1374},{"class":639},[1375],{"type":23,"value":1074},{"type":17,"tag":632,"props":1377,"children":1378},{"class":645},[1379],{"type":23,"value":1380},"mu1",{"type":17,"tag":632,"props":1382,"children":1383},{"class":639},[1384],{"type":23,"value":1074},{"type":17,"tag":632,"props":1386,"children":1387},{"class":645},[1388],{"type":23,"value":1172},{"type":17,"tag":632,"props":1390,"children":1391},{"class":639},[1392],{"type":23,"value":1074},{"type":17,"tag":632,"props":1394,"children":1395},{"class":645},[1396],{"type":23,"value":1320},{"type":17,"tag":632,"props":1398,"children":1399},{"class":639},[1400],{"type":23,"value":1195},{"type":17,"tag":632,"props":1402,"children":1403},{"class":645},[1404],{"type":23,"value":1405},"(",{"type":17,"tag":632,"props":1407,"children":1408},{"class":689},[1409],{"type":23,"value":719},{"type":17,"tag":632,"props":1411,"children":1412},{"class":645},[1413],{"type":23,"value":1414},".u1_max",{"type":17,"tag":632,"props":1416,"children":1417},{"class":639},[1418],{"type":23,"value":1195},{"type":17,"tag":632,"props":1420,"children":1421},{"class":689},[1422],{"type":23,"value":719},{"type":17,"tag":632,"props":1424,"children":1425},{"class":645},[1426],{"type":23,"value":1427},".u1_min)",{"type":17,"tag":632,"props":1429,"children":1430},{"class":639},[1431],{"type":23,"value":1432},"/",{"type":17,"tag":632,"props":1434,"children":1435},{"class":689},[1436],{"type":23,"value":1371},{"type":17,"tag":632,"props":1438,"children":1439},{"class":645},[1440],{"type":23,"value":1441},")\n",{"type":17,"tag":632,"props":1443,"children":1445},{"class":634,"line":1444},29,[1446,1451,1455,1459,1463,1468,1472,1477,1481,1486,1490,1495,1499,1503,1507,1512,1516,1520,1524,1528,1532,1537,1541,1545,1550,1554,1558],{"type":17,"tag":632,"props":1447,"children":1448},{"class":645},[1449],{"type":23,"value":1450},"        dhdu2 ",{"type":17,"tag":632,"props":1452,"children":1453},{"class":639},[1454],{"type":23,"value":729},{"type":17,"tag":632,"props":1456,"children":1457},{"class":645},[1458],{"type":23,"value":648},{"type":17,"tag":632,"props":1460,"children":1461},{"class":689},[1462],{"type":23,"value":719},{"type":17,"tag":632,"props":1464,"children":1465},{"class":645},[1466],{"type":23,"value":1467},".r2",{"type":17,"tag":632,"props":1469,"children":1470},{"class":639},[1471],{"type":23,"value":1074},{"type":17,"tag":632,"props":1473,"children":1474},{"class":645},[1475],{"type":23,"value":1476},"(u2",{"type":17,"tag":632,"props":1478,"children":1479},{"class":639},[1480],{"type":23,"value":1064},{"type":17,"tag":632,"props":1482,"children":1483},{"class":645},[1484],{"type":23,"value":1485},"u2_r)",{"type":17,"tag":632,"props":1487,"children":1488},{"class":639},[1489],{"type":23,"value":1195},{"type":17,"tag":632,"props":1491,"children":1492},{"class":645},[1493],{"type":23,"value":1494},"lam3",{"type":17,"tag":632,"props":1496,"children":1497},{"class":639},[1498],{"type":23,"value":1195},{"type":17,"tag":632,"props":1500,"children":1501},{"class":689},[1502],{"type":23,"value":1371},{"type":17,"tag":632,"props":1504,"children":1505},{"class":639},[1506],{"type":23,"value":1074},{"type":17,"tag":632,"props":1508,"children":1509},{"class":645},[1510],{"type":23,"value":1511},"mu2",{"type":17,"tag":632,"props":1513,"children":1514},{"class":639},[1515],{"type":23,"value":1074},{"type":17,"tag":632,"props":1517,"children":1518},{"class":645},[1519],{"type":23,"value":1476},{"type":17,"tag":632,"props":1521,"children":1522},{"class":639},[1523],{"type":23,"value":1195},{"type":17,"tag":632,"props":1525,"children":1526},{"class":645},[1527],{"type":23,"value":1405},{"type":17,"tag":632,"props":1529,"children":1530},{"class":689},[1531],{"type":23,"value":719},{"type":17,"tag":632,"props":1533,"children":1534},{"class":645},[1535],{"type":23,"value":1536},".u2_max",{"type":17,"tag":632,"props":1538,"children":1539},{"class":639},[1540],{"type":23,"value":1195},{"type":17,"tag":632,"props":1542,"children":1543},{"class":689},[1544],{"type":23,"value":719},{"type":17,"tag":632,"props":1546,"children":1547},{"class":645},[1548],{"type":23,"value":1549},".u2_min)",{"type":17,"tag":632,"props":1551,"children":1552},{"class":639},[1553],{"type":23,"value":1432},{"type":17,"tag":632,"props":1555,"children":1556},{"class":689},[1557],{"type":23,"value":1371},{"type":17,"tag":632,"props":1559,"children":1560},{"class":645},[1561],{"type":23,"value":1441},{"type":17,"tag":632,"props":1563,"children":1565},{"class":634,"line":1564},30,[1566],{"type":17,"tag":632,"props":1567,"children":1568},{},[1569],{"type":23,"value":668},{"type":17,"tag":632,"props":1571,"children":1573},{"class":634,"line":1572},31,[1574,1578,1582],{"type":17,"tag":632,"props":1575,"children":1576},{"class":645},[1577],{"type":23,"value":714},{"type":17,"tag":632,"props":1579,"children":1580},{"class":639},[1581],{"type":23,"value":1238},{"type":17,"tag":632,"props":1583,"children":1584},{"class":645},[1585],{"type":23,"value":1586}," dhdu1, dhdu2\n",{"type":17,"tag":632,"props":1588,"children":1590},{"class":634,"line":1589},32,[1591],{"type":17,"tag":632,"props":1592,"children":1593},{},[1594],{"type":23,"value":668},{"type":17,"tag":632,"props":1596,"children":1598},{"class":634,"line":1597},33,[1599,1603,1607,1611,1616],{"type":17,"tag":632,"props":1600,"children":1601},{"class":645},[1602],{"type":23,"value":677},{"type":17,"tag":632,"props":1604,"children":1605},{"class":639},[1606],{"type":23,"value":682},{"type":17,"tag":632,"props":1608,"children":1609},{"class":645},[1610],{"type":23,"value":648},{"type":17,"tag":632,"props":1612,"children":1613},{"class":651},[1614],{"type":23,"value":1615},"dphidx",{"type":17,"tag":632,"props":1617,"children":1618},{"class":645},[1619],{"type":23,"value":1620},"(self, x, y, yaw, x_r, y_r, yaw_r):\n",{"type":17,"tag":632,"props":1622,"children":1624},{"class":634,"line":1623},34,[1625,1630,1634,1638,1642,1647,1651,1656,1660],{"type":17,"tag":632,"props":1626,"children":1627},{"class":645},[1628],{"type":23,"value":1629},"        dphidx1 ",{"type":17,"tag":632,"props":1631,"children":1632},{"class":639},[1633],{"type":23,"value":729},{"type":17,"tag":632,"props":1635,"children":1636},{"class":645},[1637],{"type":23,"value":648},{"type":17,"tag":632,"props":1639,"children":1640},{"class":689},[1641],{"type":23,"value":719},{"type":17,"tag":632,"props":1643,"children":1644},{"class":645},[1645],{"type":23,"value":1646},".q1",{"type":17,"tag":632,"props":1648,"children":1649},{"class":639},[1650],{"type":23,"value":1074},{"type":17,"tag":632,"props":1652,"children":1653},{"class":645},[1654],{"type":23,"value":1655},"(x",{"type":17,"tag":632,"props":1657,"children":1658},{"class":639},[1659],{"type":23,"value":1064},{"type":17,"tag":632,"props":1661,"children":1662},{"class":645},[1663],{"type":23,"value":1664},"x_r)\n",{"type":17,"tag":632,"props":1666,"children":1668},{"class":634,"line":1667},35,[1669,1674,1678,1682,1686,1691,1695,1700,1704],{"type":17,"tag":632,"props":1670,"children":1671},{"class":645},[1672],{"type":23,"value":1673},"        dphidx2 ",{"type":17,"tag":632,"props":1675,"children":1676},{"class":639},[1677],{"type":23,"value":729},{"type":17,"tag":632,"props":1679,"children":1680},{"class":645},[1681],{"type":23,"value":648},{"type":17,"tag":632,"props":1683,"children":1684},{"class":689},[1685],{"type":23,"value":719},{"type":17,"tag":632,"props":1687,"children":1688},{"class":645},[1689],{"type":23,"value":1690},".q2",{"type":17,"tag":632,"props":1692,"children":1693},{"class":639},[1694],{"type":23,"value":1074},{"type":17,"tag":632,"props":1696,"children":1697},{"class":645},[1698],{"type":23,"value":1699},"(y",{"type":17,"tag":632,"props":1701,"children":1702},{"class":639},[1703],{"type":23,"value":1064},{"type":17,"tag":632,"props":1705,"children":1706},{"class":645},[1707],{"type":23,"value":1708},"y_r)\n",{"type":17,"tag":632,"props":1710,"children":1712},{"class":634,"line":1711},36,[1713,1718,1722,1726,1730,1734,1738,1743,1747],{"type":17,"tag":632,"props":1714,"children":1715},{"class":645},[1716],{"type":23,"value":1717},"        dphidx3 ",{"type":17,"tag":632,"props":1719,"children":1720},{"class":639},[1721],{"type":23,"value":729},{"type":17,"tag":632,"props":1723,"children":1724},{"class":645},[1725],{"type":23,"value":648},{"type":17,"tag":632,"props":1727,"children":1728},{"class":689},[1729],{"type":23,"value":719},{"type":17,"tag":632,"props":1731,"children":1732},{"class":645},[1733],{"type":23,"value":1163},{"type":17,"tag":632,"props":1735,"children":1736},{"class":639},[1737],{"type":23,"value":1074},{"type":17,"tag":632,"props":1739,"children":1740},{"class":645},[1741],{"type":23,"value":1742},"(yaw",{"type":17,"tag":632,"props":1744,"children":1745},{"class":639},[1746],{"type":23,"value":1064},{"type":17,"tag":632,"props":1748,"children":1749},{"class":645},[1750],{"type":23,"value":1751},"yaw_r)\n",{"type":17,"tag":632,"props":1753,"children":1755},{"class":634,"line":1754},37,[1756],{"type":17,"tag":632,"props":1757,"children":1758},{},[1759],{"type":23,"value":668},{"type":17,"tag":632,"props":1761,"children":1763},{"class":634,"line":1762},38,[1764,1768,1772],{"type":17,"tag":632,"props":1765,"children":1766},{"class":645},[1767],{"type":23,"value":714},{"type":17,"tag":632,"props":1769,"children":1770},{"class":639},[1771],{"type":23,"value":1238},{"type":17,"tag":632,"props":1773,"children":1774},{"class":645},[1775],{"type":23,"value":1776}," dphidx1, dphidx2, dphidx3",{"type":17,"tag":26,"props":1778,"children":1779},{},[1780,1782,1787,1788],{"type":23,"value":1781},"Here, I suggest that you should understand the mathematics equations above that I try to explain. It is easy to do it in Python programming language if you already understand its expression. Now I created another class for ",{"type":17,"tag":169,"props":1783,"children":1784},{},[1785],{"type":23,"value":1786}," NMPC with CGMRES ",{"type":23,"value":175},{"type":17,"tag":55,"props":1789,"children":1790},{},[],{"type":17,"tag":617,"props":1792,"children":1795},{"className":1793,"code":1794,"language":622,"meta":7},[620],"class NMPCCGMRES:\n\n    def __init__(self):\n\n        ## NMPC params\n        self.x_dim = 3\n        self.u_dim = 2\n        self.c_dim = 2\n        self.pred_horizons = 10\n\n        ### Continuations Params\n        self.ht = 1e-5\n        self.zeta = 1/self.ht\n        self.alpha = 0.5\n        self.tf = 1.0\n\n        ### Matrix\n\n        self.q1 = 1\n        self.q2 = 6\n        self.q3 = 1\n        self.r1 = 1\n        self.r2 = 0.1\n\n        ### Constraint\n        self.u_min = [ 0,  0]\n        self.u_max = [ 2,  1.57]\n        self.u_dummy = [0.01, 0.01]\n\n        ### Initialize matrix solution\n        self.dU = np.zeros((self.u_dim, self.pred_horizons))\n\n        ### Reference point\n        self.X_r = [3, 2, 0.0]\n        self.U_r = [0, 0]\n",[1796],{"type":17,"tag":625,"props":1797,"children":1798},{},[1799],{"type":17,"tag":617,"props":1800,"children":1801},{"__ignoreMap":7},[1802,1822,1829,1853,1860,1873,1902,1931,1959,1988,1995,2007,2036,2077,2106,2135,2142,2154,2161,2189,2217,2244,2271,2299,2306,2318,2360,2401,2444,2451,2463,2506,2513,2525,2575],{"type":17,"tag":632,"props":1803,"children":1804},{"class":634,"line":635},[1805,1809,1813,1818],{"type":17,"tag":632,"props":1806,"children":1807},{"class":639},[1808],{"type":23,"value":642},{"type":17,"tag":632,"props":1810,"children":1811},{"class":645},[1812],{"type":23,"value":648},{"type":17,"tag":632,"props":1814,"children":1815},{"class":651},[1816],{"type":23,"value":1817},"NMPCCGMRES",{"type":17,"tag":632,"props":1819,"children":1820},{"class":645},[1821],{"type":23,"value":659},{"type":17,"tag":632,"props":1823,"children":1824},{"class":634,"line":662},[1825],{"type":17,"tag":632,"props":1826,"children":1827},{},[1828],{"type":23,"value":668},{"type":17,"tag":632,"props":1830,"children":1831},{"class":634,"line":671},[1832,1836,1840,1844,1848],{"type":17,"tag":632,"props":1833,"children":1834},{"class":645},[1835],{"type":23,"value":677},{"type":17,"tag":632,"props":1837,"children":1838},{"class":639},[1839],{"type":23,"value":682},{"type":17,"tag":632,"props":1841,"children":1842},{"class":645},[1843],{"type":23,"value":648},{"type":17,"tag":632,"props":1845,"children":1846},{"class":689},[1847],{"type":23,"value":692},{"type":17,"tag":632,"props":1849,"children":1850},{"class":645},[1851],{"type":23,"value":1852},"(self):\n",{"type":17,"tag":632,"props":1854,"children":1855},{"class":634,"line":700},[1856],{"type":17,"tag":632,"props":1857,"children":1858},{},[1859],{"type":23,"value":668},{"type":17,"tag":632,"props":1861,"children":1862},{"class":634,"line":708},[1863,1867],{"type":17,"tag":632,"props":1864,"children":1865},{"class":645},[1866],{"type":23,"value":714},{"type":17,"tag":632,"props":1868,"children":1870},{"class":1869},"ct-326375",[1871],{"type":23,"value":1872},"## NMPC params\n",{"type":17,"tag":632,"props":1874,"children":1875},{"class":634,"line":737},[1876,1880,1884,1889,1893,1897],{"type":17,"tag":632,"props":1877,"children":1878},{"class":645},[1879],{"type":23,"value":714},{"type":17,"tag":632,"props":1881,"children":1882},{"class":689},[1883],{"type":23,"value":719},{"type":17,"tag":632,"props":1885,"children":1886},{"class":645},[1887],{"type":23,"value":1888},".x_dim ",{"type":17,"tag":632,"props":1890,"children":1891},{"class":639},[1892],{"type":23,"value":729},{"type":17,"tag":632,"props":1894,"children":1895},{"class":645},[1896],{"type":23,"value":648},{"type":17,"tag":632,"props":1898,"children":1899},{"class":689},[1900],{"type":23,"value":1901},"3\n",{"type":17,"tag":632,"props":1903,"children":1904},{"class":634,"line":763},[1905,1909,1913,1918,1922,1926],{"type":17,"tag":632,"props":1906,"children":1907},{"class":645},[1908],{"type":23,"value":714},{"type":17,"tag":632,"props":1910,"children":1911},{"class":689},[1912],{"type":23,"value":719},{"type":17,"tag":632,"props":1914,"children":1915},{"class":645},[1916],{"type":23,"value":1917},".u_dim ",{"type":17,"tag":632,"props":1919,"children":1920},{"class":639},[1921],{"type":23,"value":729},{"type":17,"tag":632,"props":1923,"children":1924},{"class":645},[1925],{"type":23,"value":648},{"type":17,"tag":632,"props":1927,"children":1928},{"class":689},[1929],{"type":23,"value":1930},"2\n",{"type":17,"tag":632,"props":1932,"children":1933},{"class":634,"line":789},[1934,1938,1942,1947,1951,1955],{"type":17,"tag":632,"props":1935,"children":1936},{"class":645},[1937],{"type":23,"value":714},{"type":17,"tag":632,"props":1939,"children":1940},{"class":689},[1941],{"type":23,"value":719},{"type":17,"tag":632,"props":1943,"children":1944},{"class":645},[1945],{"type":23,"value":1946},".c_dim ",{"type":17,"tag":632,"props":1948,"children":1949},{"class":639},[1950],{"type":23,"value":729},{"type":17,"tag":632,"props":1952,"children":1953},{"class":645},[1954],{"type":23,"value":648},{"type":17,"tag":632,"props":1956,"children":1957},{"class":689},[1958],{"type":23,"value":1930},{"type":17,"tag":632,"props":1960,"children":1961},{"class":634,"line":797},[1962,1966,1970,1975,1979,1983],{"type":17,"tag":632,"props":1963,"children":1964},{"class":645},[1965],{"type":23,"value":714},{"type":17,"tag":632,"props":1967,"children":1968},{"class":689},[1969],{"type":23,"value":719},{"type":17,"tag":632,"props":1971,"children":1972},{"class":645},[1973],{"type":23,"value":1974},".pred_horizons ",{"type":17,"tag":632,"props":1976,"children":1977},{"class":639},[1978],{"type":23,"value":729},{"type":17,"tag":632,"props":1980,"children":1981},{"class":645},[1982],{"type":23,"value":648},{"type":17,"tag":632,"props":1984,"children":1985},{"class":689},[1986],{"type":23,"value":1987},"10\n",{"type":17,"tag":632,"props":1989,"children":1990},{"class":634,"line":823},[1991],{"type":17,"tag":632,"props":1992,"children":1993},{},[1994],{"type":23,"value":668},{"type":17,"tag":632,"props":1996,"children":1997},{"class":634,"line":849},[1998,2002],{"type":17,"tag":632,"props":1999,"children":2000},{"class":645},[2001],{"type":23,"value":714},{"type":17,"tag":632,"props":2003,"children":2004},{"class":1869},[2005],{"type":23,"value":2006},"### Continuations Params\n",{"type":17,"tag":632,"props":2008,"children":2009},{"class":634,"line":857},[2010,2014,2018,2023,2027,2031],{"type":17,"tag":632,"props":2011,"children":2012},{"class":645},[2013],{"type":23,"value":714},{"type":17,"tag":632,"props":2015,"children":2016},{"class":689},[2017],{"type":23,"value":719},{"type":17,"tag":632,"props":2019,"children":2020},{"class":645},[2021],{"type":23,"value":2022},".ht ",{"type":17,"tag":632,"props":2024,"children":2025},{"class":639},[2026],{"type":23,"value":729},{"type":17,"tag":632,"props":2028,"children":2029},{"class":645},[2030],{"type":23,"value":648},{"type":17,"tag":632,"props":2032,"children":2033},{"class":689},[2034],{"type":23,"value":2035},"1e-5\n",{"type":17,"tag":632,"props":2037,"children":2038},{"class":634,"line":893},[2039,2043,2047,2052,2056,2060,2064,2068,2072],{"type":17,"tag":632,"props":2040,"children":2041},{"class":645},[2042],{"type":23,"value":714},{"type":17,"tag":632,"props":2044,"children":2045},{"class":689},[2046],{"type":23,"value":719},{"type":17,"tag":632,"props":2048,"children":2049},{"class":645},[2050],{"type":23,"value":2051},".zeta ",{"type":17,"tag":632,"props":2053,"children":2054},{"class":639},[2055],{"type":23,"value":729},{"type":17,"tag":632,"props":2057,"children":2058},{"class":645},[2059],{"type":23,"value":648},{"type":17,"tag":632,"props":2061,"children":2062},{"class":689},[2063],{"type":23,"value":995},{"type":17,"tag":632,"props":2065,"children":2066},{"class":639},[2067],{"type":23,"value":1432},{"type":17,"tag":632,"props":2069,"children":2070},{"class":689},[2071],{"type":23,"value":719},{"type":17,"tag":632,"props":2073,"children":2074},{"class":645},[2075],{"type":23,"value":2076},".ht\n",{"type":17,"tag":632,"props":2078,"children":2079},{"class":634,"line":926},[2080,2084,2088,2093,2097,2101],{"type":17,"tag":632,"props":2081,"children":2082},{"class":645},[2083],{"type":23,"value":714},{"type":17,"tag":632,"props":2085,"children":2086},{"class":689},[2087],{"type":23,"value":719},{"type":17,"tag":632,"props":2089,"children":2090},{"class":645},[2091],{"type":23,"value":2092},".alpha ",{"type":17,"tag":632,"props":2094,"children":2095},{"class":639},[2096],{"type":23,"value":729},{"type":17,"tag":632,"props":2098,"children":2099},{"class":645},[2100],{"type":23,"value":648},{"type":17,"tag":632,"props":2102,"children":2103},{"class":689},[2104],{"type":23,"value":2105},"0.5\n",{"type":17,"tag":632,"props":2107,"children":2108},{"class":634,"line":934},[2109,2113,2117,2122,2126,2130],{"type":17,"tag":632,"props":2110,"children":2111},{"class":645},[2112],{"type":23,"value":714},{"type":17,"tag":632,"props":2114,"children":2115},{"class":689},[2116],{"type":23,"value":719},{"type":17,"tag":632,"props":2118,"children":2119},{"class":645},[2120],{"type":23,"value":2121},".tf ",{"type":17,"tag":632,"props":2123,"children":2124},{"class":639},[2125],{"type":23,"value":729},{"type":17,"tag":632,"props":2127,"children":2128},{"class":645},[2129],{"type":23,"value":648},{"type":17,"tag":632,"props":2131,"children":2132},{"class":689},[2133],{"type":23,"value":2134},"1.0\n",{"type":17,"tag":632,"props":2136,"children":2137},{"class":634,"line":968},[2138],{"type":17,"tag":632,"props":2139,"children":2140},{},[2141],{"type":23,"value":668},{"type":17,"tag":632,"props":2143,"children":2144},{"class":634,"line":1002},[2145,2149],{"type":17,"tag":632,"props":2146,"children":2147},{"class":645},[2148],{"type":23,"value":714},{"type":17,"tag":632,"props":2150,"children":2151},{"class":1869},[2152],{"type":23,"value":2153},"### Matrix\n",{"type":17,"tag":632,"props":2155,"children":2156},{"class":634,"line":1010},[2157],{"type":17,"tag":632,"props":2158,"children":2159},{},[2160],{"type":23,"value":668},{"type":17,"tag":632,"props":2162,"children":2163},{"class":634,"line":1036},[2164,2168,2172,2176,2180,2184],{"type":17,"tag":632,"props":2165,"children":2166},{"class":645},[2167],{"type":23,"value":714},{"type":17,"tag":632,"props":2169,"children":2170},{"class":689},[2171],{"type":23,"value":719},{"type":17,"tag":632,"props":2173,"children":2174},{"class":645},[2175],{"type":23,"value":724},{"type":17,"tag":632,"props":2177,"children":2178},{"class":639},[2179],{"type":23,"value":729},{"type":17,"tag":632,"props":2181,"children":2182},{"class":645},[2183],{"type":23,"value":648},{"type":17,"tag":632,"props":2185,"children":2186},{"class":689},[2187],{"type":23,"value":2188},"1\n",{"type":17,"tag":632,"props":2190,"children":2191},{"class":634,"line":1044},[2192,2196,2200,2204,2208,2212],{"type":17,"tag":632,"props":2193,"children":2194},{"class":645},[2195],{"type":23,"value":714},{"type":17,"tag":632,"props":2197,"children":2198},{"class":689},[2199],{"type":23,"value":719},{"type":17,"tag":632,"props":2201,"children":2202},{"class":645},[2203],{"type":23,"value":751},{"type":17,"tag":632,"props":2205,"children":2206},{"class":639},[2207],{"type":23,"value":729},{"type":17,"tag":632,"props":2209,"children":2210},{"class":645},[2211],{"type":23,"value":648},{"type":17,"tag":632,"props":2213,"children":2214},{"class":689},[2215],{"type":23,"value":2216},"6\n",{"type":17,"tag":632,"props":2218,"children":2219},{"class":634,"line":1086},[2220,2224,2228,2232,2236,2240],{"type":17,"tag":632,"props":2221,"children":2222},{"class":645},[2223],{"type":23,"value":714},{"type":17,"tag":632,"props":2225,"children":2226},{"class":689},[2227],{"type":23,"value":719},{"type":17,"tag":632,"props":2229,"children":2230},{"class":645},[2231],{"type":23,"value":777},{"type":17,"tag":632,"props":2233,"children":2234},{"class":639},[2235],{"type":23,"value":729},{"type":17,"tag":632,"props":2237,"children":2238},{"class":645},[2239],{"type":23,"value":648},{"type":17,"tag":632,"props":2241,"children":2242},{"class":689},[2243],{"type":23,"value":2188},{"type":17,"tag":632,"props":2245,"children":2246},{"class":634,"line":1126},[2247,2251,2255,2259,2263,2267],{"type":17,"tag":632,"props":2248,"children":2249},{"class":645},[2250],{"type":23,"value":714},{"type":17,"tag":632,"props":2252,"children":2253},{"class":689},[2254],{"type":23,"value":719},{"type":17,"tag":632,"props":2256,"children":2257},{"class":645},[2258],{"type":23,"value":811},{"type":17,"tag":632,"props":2260,"children":2261},{"class":639},[2262],{"type":23,"value":729},{"type":17,"tag":632,"props":2264,"children":2265},{"class":645},[2266],{"type":23,"value":648},{"type":17,"tag":632,"props":2268,"children":2269},{"class":689},[2270],{"type":23,"value":2188},{"type":17,"tag":632,"props":2272,"children":2273},{"class":634,"line":1220},[2274,2278,2282,2286,2290,2294],{"type":17,"tag":632,"props":2275,"children":2276},{"class":645},[2277],{"type":23,"value":714},{"type":17,"tag":632,"props":2279,"children":2280},{"class":689},[2281],{"type":23,"value":719},{"type":17,"tag":632,"props":2283,"children":2284},{"class":645},[2285],{"type":23,"value":837},{"type":17,"tag":632,"props":2287,"children":2288},{"class":639},[2289],{"type":23,"value":729},{"type":17,"tag":632,"props":2291,"children":2292},{"class":645},[2293],{"type":23,"value":648},{"type":17,"tag":632,"props":2295,"children":2296},{"class":689},[2297],{"type":23,"value":2298},"0.1\n",{"type":17,"tag":632,"props":2300,"children":2301},{"class":634,"line":1228},[2302],{"type":17,"tag":632,"props":2303,"children":2304},{},[2305],{"type":23,"value":668},{"type":17,"tag":632,"props":2307,"children":2308},{"class":634,"line":1246},[2309,2313],{"type":17,"tag":632,"props":2310,"children":2311},{"class":645},[2312],{"type":23,"value":714},{"type":17,"tag":632,"props":2314,"children":2315},{"class":1869},[2316],{"type":23,"value":2317},"### Constraint\n",{"type":17,"tag":632,"props":2319,"children":2320},{"class":634,"line":1254},[2321,2325,2329,2334,2338,2343,2347,2352,2356],{"type":17,"tag":632,"props":2322,"children":2323},{"class":645},[2324],{"type":23,"value":714},{"type":17,"tag":632,"props":2326,"children":2327},{"class":689},[2328],{"type":23,"value":719},{"type":17,"tag":632,"props":2330,"children":2331},{"class":645},[2332],{"type":23,"value":2333},".u_min ",{"type":17,"tag":632,"props":2335,"children":2336},{"class":639},[2337],{"type":23,"value":729},{"type":17,"tag":632,"props":2339,"children":2340},{"class":645},[2341],{"type":23,"value":2342}," [ ",{"type":17,"tag":632,"props":2344,"children":2345},{"class":689},[2346],{"type":23,"value":885},{"type":17,"tag":632,"props":2348,"children":2349},{"class":645},[2350],{"type":23,"value":2351},",  ",{"type":17,"tag":632,"props":2353,"children":2354},{"class":689},[2355],{"type":23,"value":885},{"type":17,"tag":632,"props":2357,"children":2358},{"class":645},[2359],{"type":23,"value":890},{"type":17,"tag":632,"props":2361,"children":2362},{"class":634,"line":1280},[2363,2367,2371,2376,2380,2384,2388,2392,2397],{"type":17,"tag":632,"props":2364,"children":2365},{"class":645},[2366],{"type":23,"value":714},{"type":17,"tag":632,"props":2368,"children":2369},{"class":689},[2370],{"type":23,"value":719},{"type":17,"tag":632,"props":2372,"children":2373},{"class":645},[2374],{"type":23,"value":2375},".u_max ",{"type":17,"tag":632,"props":2377,"children":2378},{"class":639},[2379],{"type":23,"value":729},{"type":17,"tag":632,"props":2381,"children":2382},{"class":645},[2383],{"type":23,"value":2342},{"type":17,"tag":632,"props":2385,"children":2386},{"class":689},[2387],{"type":23,"value":1371},{"type":17,"tag":632,"props":2389,"children":2390},{"class":645},[2391],{"type":23,"value":2351},{"type":17,"tag":632,"props":2393,"children":2394},{"class":689},[2395],{"type":23,"value":2396},"1.57",{"type":17,"tag":632,"props":2398,"children":2399},{"class":645},[2400],{"type":23,"value":890},{"type":17,"tag":632,"props":2402,"children":2403},{"class":634,"line":1288},[2404,2408,2412,2417,2421,2426,2431,2436,2440],{"type":17,"tag":632,"props":2405,"children":2406},{"class":645},[2407],{"type":23,"value":714},{"type":17,"tag":632,"props":2409,"children":2410},{"class":689},[2411],{"type":23,"value":719},{"type":17,"tag":632,"props":2413,"children":2414},{"class":645},[2415],{"type":23,"value":2416},".u_dummy ",{"type":17,"tag":632,"props":2418,"children":2419},{"class":639},[2420],{"type":23,"value":729},{"type":17,"tag":632,"props":2422,"children":2423},{"class":645},[2424],{"type":23,"value":2425}," [",{"type":17,"tag":632,"props":2427,"children":2428},{"class":689},[2429],{"type":23,"value":2430},"0.01",{"type":17,"tag":632,"props":2432,"children":2433},{"class":645},[2434],{"type":23,"value":2435},", ",{"type":17,"tag":632,"props":2437,"children":2438},{"class":689},[2439],{"type":23,"value":2430},{"type":17,"tag":632,"props":2441,"children":2442},{"class":645},[2443],{"type":23,"value":890},{"type":17,"tag":632,"props":2445,"children":2446},{"class":634,"line":1444},[2447],{"type":17,"tag":632,"props":2448,"children":2449},{},[2450],{"type":23,"value":668},{"type":17,"tag":632,"props":2452,"children":2453},{"class":634,"line":1564},[2454,2458],{"type":17,"tag":632,"props":2455,"children":2456},{"class":645},[2457],{"type":23,"value":714},{"type":17,"tag":632,"props":2459,"children":2460},{"class":1869},[2461],{"type":23,"value":2462},"### Initialize matrix solution\n",{"type":17,"tag":632,"props":2464,"children":2465},{"class":634,"line":1572},[2466,2470,2474,2479,2483,2488,2492,2497,2501],{"type":17,"tag":632,"props":2467,"children":2468},{"class":645},[2469],{"type":23,"value":714},{"type":17,"tag":632,"props":2471,"children":2472},{"class":689},[2473],{"type":23,"value":719},{"type":17,"tag":632,"props":2475,"children":2476},{"class":645},[2477],{"type":23,"value":2478},".dU ",{"type":17,"tag":632,"props":2480,"children":2481},{"class":639},[2482],{"type":23,"value":729},{"type":17,"tag":632,"props":2484,"children":2485},{"class":645},[2486],{"type":23,"value":2487}," np.zeros((",{"type":17,"tag":632,"props":2489,"children":2490},{"class":689},[2491],{"type":23,"value":719},{"type":17,"tag":632,"props":2493,"children":2494},{"class":645},[2495],{"type":23,"value":2496},".u_dim, ",{"type":17,"tag":632,"props":2498,"children":2499},{"class":689},[2500],{"type":23,"value":719},{"type":17,"tag":632,"props":2502,"children":2503},{"class":645},[2504],{"type":23,"value":2505},".pred_horizons))\n",{"type":17,"tag":632,"props":2507,"children":2508},{"class":634,"line":1589},[2509],{"type":17,"tag":632,"props":2510,"children":2511},{},[2512],{"type":23,"value":668},{"type":17,"tag":632,"props":2514,"children":2515},{"class":634,"line":1597},[2516,2520],{"type":17,"tag":632,"props":2517,"children":2518},{"class":645},[2519],{"type":23,"value":714},{"type":17,"tag":632,"props":2521,"children":2522},{"class":1869},[2523],{"type":23,"value":2524},"### Reference point\n",{"type":17,"tag":632,"props":2526,"children":2527},{"class":634,"line":1623},[2528,2532,2536,2541,2545,2549,2554,2558,2562,2566,2571],{"type":17,"tag":632,"props":2529,"children":2530},{"class":645},[2531],{"type":23,"value":714},{"type":17,"tag":632,"props":2533,"children":2534},{"class":689},[2535],{"type":23,"value":719},{"type":17,"tag":632,"props":2537,"children":2538},{"class":645},[2539],{"type":23,"value":2540},".X_r ",{"type":17,"tag":632,"props":2542,"children":2543},{"class":639},[2544],{"type":23,"value":729},{"type":17,"tag":632,"props":2546,"children":2547},{"class":645},[2548],{"type":23,"value":2425},{"type":17,"tag":632,"props":2550,"children":2551},{"class":689},[2552],{"type":23,"value":2553},"3",{"type":17,"tag":632,"props":2555,"children":2556},{"class":645},[2557],{"type":23,"value":2435},{"type":17,"tag":632,"props":2559,"children":2560},{"class":689},[2561],{"type":23,"value":1371},{"type":17,"tag":632,"props":2563,"children":2564},{"class":645},[2565],{"type":23,"value":2435},{"type":17,"tag":632,"props":2567,"children":2568},{"class":689},[2569],{"type":23,"value":2570},"0.0",{"type":17,"tag":632,"props":2572,"children":2573},{"class":645},[2574],{"type":23,"value":890},{"type":17,"tag":632,"props":2576,"children":2577},{"class":634,"line":1667},[2578,2582,2586,2591,2595,2599,2603,2607,2611],{"type":17,"tag":632,"props":2579,"children":2580},{"class":645},[2581],{"type":23,"value":714},{"type":17,"tag":632,"props":2583,"children":2584},{"class":689},[2585],{"type":23,"value":719},{"type":17,"tag":632,"props":2587,"children":2588},{"class":645},[2589],{"type":23,"value":2590},".U_r ",{"type":17,"tag":632,"props":2592,"children":2593},{"class":639},[2594],{"type":23,"value":729},{"type":17,"tag":632,"props":2596,"children":2597},{"class":645},[2598],{"type":23,"value":2425},{"type":17,"tag":632,"props":2600,"children":2601},{"class":689},[2602],{"type":23,"value":885},{"type":17,"tag":632,"props":2604,"children":2605},{"class":645},[2606],{"type":23,"value":2435},{"type":17,"tag":632,"props":2608,"children":2609},{"class":689},[2610],{"type":23,"value":885},{"type":17,"tag":632,"props":2612,"children":2613},{"class":645},[2614],{"type":23,"value":2615},"]",{"type":17,"tag":26,"props":2617,"children":2618},{},[2619],{"type":23,"value":2620},"These are just for tuning parameters and initialize parameters, let's focus on CGMRES method. As the expression above at equation (1).\nLet's denote that",{"type":17,"tag":617,"props":2622,"children":2625},{"className":2623,"code":2624,"language":622,"meta":7},[620],"X = np.zeros((x_dim, pred_horizons+1))      ## State for N-prediction+1\nU = np.zeros((u_dim, pred_horizons))        ## Input Control for N-prediction\nLambda = np.zeros((x_dim, pred_horizons+1)) ## Costate vector for N-prediction+1\ndt = 0.01                                   ## Sampling Time\n",[2626],{"type":17,"tag":625,"props":2627,"children":2628},{},[2629],{"type":17,"tag":617,"props":2630,"children":2631},{"__ignoreMap":7},[2632,2667,2689,2723],{"type":17,"tag":632,"props":2633,"children":2634},{"class":634,"line":635},[2635,2640,2644,2649,2653,2657,2662],{"type":17,"tag":632,"props":2636,"children":2637},{"class":645},[2638],{"type":23,"value":2639},"X ",{"type":17,"tag":632,"props":2641,"children":2642},{"class":639},[2643],{"type":23,"value":729},{"type":17,"tag":632,"props":2645,"children":2646},{"class":645},[2647],{"type":23,"value":2648}," np.zeros((x_dim, pred_horizons",{"type":17,"tag":632,"props":2650,"children":2651},{"class":639},[2652],{"type":23,"value":1195},{"type":17,"tag":632,"props":2654,"children":2655},{"class":689},[2656],{"type":23,"value":995},{"type":17,"tag":632,"props":2658,"children":2659},{"class":645},[2660],{"type":23,"value":2661},"))      ",{"type":17,"tag":632,"props":2663,"children":2664},{"class":1869},[2665],{"type":23,"value":2666},"## State for N-prediction+1\n",{"type":17,"tag":632,"props":2668,"children":2669},{"class":634,"line":662},[2670,2675,2679,2684],{"type":17,"tag":632,"props":2671,"children":2672},{"class":645},[2673],{"type":23,"value":2674},"U ",{"type":17,"tag":632,"props":2676,"children":2677},{"class":639},[2678],{"type":23,"value":729},{"type":17,"tag":632,"props":2680,"children":2681},{"class":645},[2682],{"type":23,"value":2683}," np.zeros((u_dim, pred_horizons))        ",{"type":17,"tag":632,"props":2685,"children":2686},{"class":1869},[2687],{"type":23,"value":2688},"## Input Control for N-prediction\n",{"type":17,"tag":632,"props":2690,"children":2691},{"class":634,"line":671},[2692,2697,2701,2705,2709,2713,2718],{"type":17,"tag":632,"props":2693,"children":2694},{"class":645},[2695],{"type":23,"value":2696},"Lambda ",{"type":17,"tag":632,"props":2698,"children":2699},{"class":639},[2700],{"type":23,"value":729},{"type":17,"tag":632,"props":2702,"children":2703},{"class":645},[2704],{"type":23,"value":2648},{"type":17,"tag":632,"props":2706,"children":2707},{"class":639},[2708],{"type":23,"value":1195},{"type":17,"tag":632,"props":2710,"children":2711},{"class":689},[2712],{"type":23,"value":995},{"type":17,"tag":632,"props":2714,"children":2715},{"class":645},[2716],{"type":23,"value":2717},")) ",{"type":17,"tag":632,"props":2719,"children":2720},{"class":1869},[2721],{"type":23,"value":2722},"## Costate vector for N-prediction+1\n",{"type":17,"tag":632,"props":2724,"children":2725},{"class":634,"line":700},[2726,2731,2735,2739,2743,2748],{"type":17,"tag":632,"props":2727,"children":2728},{"class":645},[2729],{"type":23,"value":2730},"dt ",{"type":17,"tag":632,"props":2732,"children":2733},{"class":639},[2734],{"type":23,"value":729},{"type":17,"tag":632,"props":2736,"children":2737},{"class":645},[2738],{"type":23,"value":648},{"type":17,"tag":632,"props":2740,"children":2741},{"class":689},[2742],{"type":23,"value":2430},{"type":17,"tag":632,"props":2744,"children":2745},{"class":645},[2746],{"type":23,"value":2747},"                                   ",{"type":17,"tag":632,"props":2749,"children":2750},{"class":1869},[2751],{"type":23,"value":2752},"## Sampling Time",{"type":17,"tag":26,"props":2754,"children":2755},{},[2756],{"type":23,"value":2757},"Then, we can perform equation (1) as",{"type":17,"tag":617,"props":2759,"children":2762},{"className":2760,"code":2761,"language":622,"meta":7},[620],"def calc_state(self, X, U, dt):\n\n        for i in range(self.pred_horizons):\n            x_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, i], U[0, i], U[1, i])\n            \n            X[0, i+1] = X[0, i] + x_dot * dt\n            X[1, i+1] = X[1, i] + y_dot * dt\n            X[2, i+1] = X[2, i] + yaw_dot * dt\n\n        return X\n",[2763],{"type":17,"tag":625,"props":2764,"children":2765},{},[2766],{"type":17,"tag":617,"props":2767,"children":2768},{"__ignoreMap":7},[2769,2790,2797,2841,2892,2900,2966,3026,3086,3093],{"type":17,"tag":632,"props":2770,"children":2771},{"class":634,"line":635},[2772,2776,2780,2785],{"type":17,"tag":632,"props":2773,"children":2774},{"class":639},[2775],{"type":23,"value":682},{"type":17,"tag":632,"props":2777,"children":2778},{"class":645},[2779],{"type":23,"value":648},{"type":17,"tag":632,"props":2781,"children":2782},{"class":651},[2783],{"type":23,"value":2784},"calc_state",{"type":17,"tag":632,"props":2786,"children":2787},{"class":645},[2788],{"type":23,"value":2789},"(self, X, U, dt):\n",{"type":17,"tag":632,"props":2791,"children":2792},{"class":634,"line":662},[2793],{"type":17,"tag":632,"props":2794,"children":2795},{},[2796],{"type":23,"value":668},{"type":17,"tag":632,"props":2798,"children":2799},{"class":634,"line":671},[2800,2804,2809,2814,2819,2823,2828,2832,2836],{"type":17,"tag":632,"props":2801,"children":2802},{"class":645},[2803],{"type":23,"value":714},{"type":17,"tag":632,"props":2805,"children":2806},{"class":639},[2807],{"type":23,"value":2808},"for",{"type":17,"tag":632,"props":2810,"children":2811},{"class":645},[2812],{"type":23,"value":2813}," i ",{"type":17,"tag":632,"props":2815,"children":2816},{"class":639},[2817],{"type":23,"value":2818},"in",{"type":17,"tag":632,"props":2820,"children":2821},{"class":645},[2822],{"type":23,"value":648},{"type":17,"tag":632,"props":2824,"children":2825},{"class":689},[2826],{"type":23,"value":2827},"range",{"type":17,"tag":632,"props":2829,"children":2830},{"class":645},[2831],{"type":23,"value":1405},{"type":17,"tag":632,"props":2833,"children":2834},{"class":689},[2835],{"type":23,"value":719},{"type":17,"tag":632,"props":2837,"children":2838},{"class":645},[2839],{"type":23,"value":2840},".pred_horizons):\n",{"type":17,"tag":632,"props":2842,"children":2843},{"class":634,"line":700},[2844,2849,2853,2857,2861,2866,2870,2875,2879,2883,2887],{"type":17,"tag":632,"props":2845,"children":2846},{"class":645},[2847],{"type":23,"value":2848},"            x_dot, y_dot, yaw_dot ",{"type":17,"tag":632,"props":2850,"children":2851},{"class":639},[2852],{"type":23,"value":729},{"type":17,"tag":632,"props":2854,"children":2855},{"class":645},[2856],{"type":23,"value":648},{"type":17,"tag":632,"props":2858,"children":2859},{"class":689},[2860],{"type":23,"value":719},{"type":17,"tag":632,"props":2862,"children":2863},{"class":645},[2864],{"type":23,"value":2865},".robot_model.forward_kinematic(X[",{"type":17,"tag":632,"props":2867,"children":2868},{"class":689},[2869],{"type":23,"value":1371},{"type":17,"tag":632,"props":2871,"children":2872},{"class":645},[2873],{"type":23,"value":2874},", i], U[",{"type":17,"tag":632,"props":2876,"children":2877},{"class":689},[2878],{"type":23,"value":885},{"type":17,"tag":632,"props":2880,"children":2881},{"class":645},[2882],{"type":23,"value":2874},{"type":17,"tag":632,"props":2884,"children":2885},{"class":689},[2886],{"type":23,"value":995},{"type":17,"tag":632,"props":2888,"children":2889},{"class":645},[2890],{"type":23,"value":2891},", i])\n",{"type":17,"tag":632,"props":2893,"children":2894},{"class":634,"line":708},[2895],{"type":17,"tag":632,"props":2896,"children":2897},{"class":645},[2898],{"type":23,"value":2899},"            \n",{"type":17,"tag":632,"props":2901,"children":2902},{"class":634,"line":737},[2903,2908,2912,2917,2921,2925,2930,2934,2939,2943,2948,2952,2957,2961],{"type":17,"tag":632,"props":2904,"children":2905},{"class":645},[2906],{"type":23,"value":2907},"            X[",{"type":17,"tag":632,"props":2909,"children":2910},{"class":689},[2911],{"type":23,"value":885},{"type":17,"tag":632,"props":2913,"children":2914},{"class":645},[2915],{"type":23,"value":2916},", i",{"type":17,"tag":632,"props":2918,"children":2919},{"class":639},[2920],{"type":23,"value":1195},{"type":17,"tag":632,"props":2922,"children":2923},{"class":689},[2924],{"type":23,"value":995},{"type":17,"tag":632,"props":2926,"children":2927},{"class":645},[2928],{"type":23,"value":2929},"] ",{"type":17,"tag":632,"props":2931,"children":2932},{"class":639},[2933],{"type":23,"value":729},{"type":17,"tag":632,"props":2935,"children":2936},{"class":645},[2937],{"type":23,"value":2938}," X[",{"type":17,"tag":632,"props":2940,"children":2941},{"class":689},[2942],{"type":23,"value":885},{"type":17,"tag":632,"props":2944,"children":2945},{"class":645},[2946],{"type":23,"value":2947},", i] ",{"type":17,"tag":632,"props":2949,"children":2950},{"class":639},[2951],{"type":23,"value":1195},{"type":17,"tag":632,"props":2953,"children":2954},{"class":645},[2955],{"type":23,"value":2956}," x_dot ",{"type":17,"tag":632,"props":2958,"children":2959},{"class":639},[2960],{"type":23,"value":1074},{"type":17,"tag":632,"props":2962,"children":2963},{"class":645},[2964],{"type":23,"value":2965}," dt\n",{"type":17,"tag":632,"props":2967,"children":2968},{"class":634,"line":763},[2969,2973,2977,2981,2985,2989,2993,2997,3001,3005,3009,3013,3018,3022],{"type":17,"tag":632,"props":2970,"children":2971},{"class":645},[2972],{"type":23,"value":2907},{"type":17,"tag":632,"props":2974,"children":2975},{"class":689},[2976],{"type":23,"value":995},{"type":17,"tag":632,"props":2978,"children":2979},{"class":645},[2980],{"type":23,"value":2916},{"type":17,"tag":632,"props":2982,"children":2983},{"class":639},[2984],{"type":23,"value":1195},{"type":17,"tag":632,"props":2986,"children":2987},{"class":689},[2988],{"type":23,"value":995},{"type":17,"tag":632,"props":2990,"children":2991},{"class":645},[2992],{"type":23,"value":2929},{"type":17,"tag":632,"props":2994,"children":2995},{"class":639},[2996],{"type":23,"value":729},{"type":17,"tag":632,"props":2998,"children":2999},{"class":645},[3000],{"type":23,"value":2938},{"type":17,"tag":632,"props":3002,"children":3003},{"class":689},[3004],{"type":23,"value":995},{"type":17,"tag":632,"props":3006,"children":3007},{"class":645},[3008],{"type":23,"value":2947},{"type":17,"tag":632,"props":3010,"children":3011},{"class":639},[3012],{"type":23,"value":1195},{"type":17,"tag":632,"props":3014,"children":3015},{"class":645},[3016],{"type":23,"value":3017}," y_dot ",{"type":17,"tag":632,"props":3019,"children":3020},{"class":639},[3021],{"type":23,"value":1074},{"type":17,"tag":632,"props":3023,"children":3024},{"class":645},[3025],{"type":23,"value":2965},{"type":17,"tag":632,"props":3027,"children":3028},{"class":634,"line":789},[3029,3033,3037,3041,3045,3049,3053,3057,3061,3065,3069,3073,3078,3082],{"type":17,"tag":632,"props":3030,"children":3031},{"class":645},[3032],{"type":23,"value":2907},{"type":17,"tag":632,"props":3034,"children":3035},{"class":689},[3036],{"type":23,"value":1371},{"type":17,"tag":632,"props":3038,"children":3039},{"class":645},[3040],{"type":23,"value":2916},{"type":17,"tag":632,"props":3042,"children":3043},{"class":639},[3044],{"type":23,"value":1195},{"type":17,"tag":632,"props":3046,"children":3047},{"class":689},[3048],{"type":23,"value":995},{"type":17,"tag":632,"props":3050,"children":3051},{"class":645},[3052],{"type":23,"value":2929},{"type":17,"tag":632,"props":3054,"children":3055},{"class":639},[3056],{"type":23,"value":729},{"type":17,"tag":632,"props":3058,"children":3059},{"class":645},[3060],{"type":23,"value":2938},{"type":17,"tag":632,"props":3062,"children":3063},{"class":689},[3064],{"type":23,"value":1371},{"type":17,"tag":632,"props":3066,"children":3067},{"class":645},[3068],{"type":23,"value":2947},{"type":17,"tag":632,"props":3070,"children":3071},{"class":639},[3072],{"type":23,"value":1195},{"type":17,"tag":632,"props":3074,"children":3075},{"class":645},[3076],{"type":23,"value":3077}," yaw_dot ",{"type":17,"tag":632,"props":3079,"children":3080},{"class":639},[3081],{"type":23,"value":1074},{"type":17,"tag":632,"props":3083,"children":3084},{"class":645},[3085],{"type":23,"value":2965},{"type":17,"tag":632,"props":3087,"children":3088},{"class":634,"line":797},[3089],{"type":17,"tag":632,"props":3090,"children":3091},{},[3092],{"type":23,"value":668},{"type":17,"tag":632,"props":3094,"children":3095},{"class":634,"line":823},[3096,3100,3104],{"type":17,"tag":632,"props":3097,"children":3098},{"class":645},[3099],{"type":23,"value":714},{"type":17,"tag":632,"props":3101,"children":3102},{"class":639},[3103],{"type":23,"value":1238},{"type":17,"tag":632,"props":3105,"children":3106},{"class":645},[3107],{"type":23,"value":3108}," X",{"type":17,"tag":26,"props":3110,"children":3111},{},[3112],{"type":23,"value":3113},"Next we calculating costate, we are going in backward direction",{"type":17,"tag":617,"props":3115,"children":3118},{"className":3116,"code":3117,"language":622,"meta":7},[620],"def calc_costate(self, X, U, Lambda, dt):\n\n        x_N, y_N, yaw_N = self.hjb_equation.dphidx(X[0, -1], X[1, -1], X[2, -1],\n                                                   self.X_r[0], self.X_r[1], self.X_r[2])\n        Lambda[0, -1] = x_N\n        Lambda[1, -1] = y_N\n        Lambda[2, -1] = yaw_N\n\n\n        for i in reversed(range(1, self.pred_horizons)):\n\n            dhdx1, dhdx2, dhdx3 = self.hjb_equation.dhdx(\n                X[0, i], X[1, i], X[2, i],\n                self.X_r[0], self.X_r[1], self.X_r[2],\n                U[0, i], Lambda[0, i+1], Lambda[1, i+1]\n            )\n\n            Lambda[0, i] = Lambda[0, i+1] + dhdx1 * dt\n            Lambda[1, i] = Lambda[1, i+1] + dhdx2 * dt\n            Lambda[2, i] = Lambda[2, i+1] + dhdx3 * dt\n    \n\n        return Lambda\n",[3119],{"type":17,"tag":625,"props":3120,"children":3121},{},[3122],{"type":17,"tag":617,"props":3123,"children":3124},{"__ignoreMap":7},[3125,3146,3153,3240,3299,3336,3372,3408,3415,3422,3479,3486,3511,3545,3601,3659,3667,3674,3736,3796,3856,3864,3871],{"type":17,"tag":632,"props":3126,"children":3127},{"class":634,"line":635},[3128,3132,3136,3141],{"type":17,"tag":632,"props":3129,"children":3130},{"class":639},[3131],{"type":23,"value":682},{"type":17,"tag":632,"props":3133,"children":3134},{"class":645},[3135],{"type":23,"value":648},{"type":17,"tag":632,"props":3137,"children":3138},{"class":651},[3139],{"type":23,"value":3140},"calc_costate",{"type":17,"tag":632,"props":3142,"children":3143},{"class":645},[3144],{"type":23,"value":3145},"(self, X, U, Lambda, dt):\n",{"type":17,"tag":632,"props":3147,"children":3148},{"class":634,"line":662},[3149],{"type":17,"tag":632,"props":3150,"children":3151},{},[3152],{"type":23,"value":668},{"type":17,"tag":632,"props":3154,"children":3155},{"class":634,"line":671},[3156,3161,3165,3169,3173,3178,3182,3186,3190,3194,3199,3203,3207,3211,3215,3219,3223,3227,3231,3235],{"type":17,"tag":632,"props":3157,"children":3158},{"class":645},[3159],{"type":23,"value":3160},"        x_N, y_N, yaw_N ",{"type":17,"tag":632,"props":3162,"children":3163},{"class":639},[3164],{"type":23,"value":729},{"type":17,"tag":632,"props":3166,"children":3167},{"class":645},[3168],{"type":23,"value":648},{"type":17,"tag":632,"props":3170,"children":3171},{"class":689},[3172],{"type":23,"value":719},{"type":17,"tag":632,"props":3174,"children":3175},{"class":645},[3176],{"type":23,"value":3177},".hjb_equation.dphidx(X[",{"type":17,"tag":632,"props":3179,"children":3180},{"class":689},[3181],{"type":23,"value":885},{"type":17,"tag":632,"props":3183,"children":3184},{"class":645},[3185],{"type":23,"value":2435},{"type":17,"tag":632,"props":3187,"children":3188},{"class":639},[3189],{"type":23,"value":1064},{"type":17,"tag":632,"props":3191,"children":3192},{"class":689},[3193],{"type":23,"value":995},{"type":17,"tag":632,"props":3195,"children":3196},{"class":645},[3197],{"type":23,"value":3198},"], X[",{"type":17,"tag":632,"props":3200,"children":3201},{"class":689},[3202],{"type":23,"value":995},{"type":17,"tag":632,"props":3204,"children":3205},{"class":645},[3206],{"type":23,"value":2435},{"type":17,"tag":632,"props":3208,"children":3209},{"class":639},[3210],{"type":23,"value":1064},{"type":17,"tag":632,"props":3212,"children":3213},{"class":689},[3214],{"type":23,"value":995},{"type":17,"tag":632,"props":3216,"children":3217},{"class":645},[3218],{"type":23,"value":3198},{"type":17,"tag":632,"props":3220,"children":3221},{"class":689},[3222],{"type":23,"value":1371},{"type":17,"tag":632,"props":3224,"children":3225},{"class":645},[3226],{"type":23,"value":2435},{"type":17,"tag":632,"props":3228,"children":3229},{"class":639},[3230],{"type":23,"value":1064},{"type":17,"tag":632,"props":3232,"children":3233},{"class":689},[3234],{"type":23,"value":995},{"type":17,"tag":632,"props":3236,"children":3237},{"class":645},[3238],{"type":23,"value":3239},"],\n",{"type":17,"tag":632,"props":3241,"children":3242},{"class":634,"line":700},[3243,3248,3252,3257,3261,3266,3270,3274,3278,3282,3286,3290,3294],{"type":17,"tag":632,"props":3244,"children":3245},{"class":645},[3246],{"type":23,"value":3247},"                                                   ",{"type":17,"tag":632,"props":3249,"children":3250},{"class":689},[3251],{"type":23,"value":719},{"type":17,"tag":632,"props":3253,"children":3254},{"class":645},[3255],{"type":23,"value":3256},".X_r[",{"type":17,"tag":632,"props":3258,"children":3259},{"class":689},[3260],{"type":23,"value":885},{"type":17,"tag":632,"props":3262,"children":3263},{"class":645},[3264],{"type":23,"value":3265},"], ",{"type":17,"tag":632,"props":3267,"children":3268},{"class":689},[3269],{"type":23,"value":719},{"type":17,"tag":632,"props":3271,"children":3272},{"class":645},[3273],{"type":23,"value":3256},{"type":17,"tag":632,"props":3275,"children":3276},{"class":689},[3277],{"type":23,"value":995},{"type":17,"tag":632,"props":3279,"children":3280},{"class":645},[3281],{"type":23,"value":3265},{"type":17,"tag":632,"props":3283,"children":3284},{"class":689},[3285],{"type":23,"value":719},{"type":17,"tag":632,"props":3287,"children":3288},{"class":645},[3289],{"type":23,"value":3256},{"type":17,"tag":632,"props":3291,"children":3292},{"class":689},[3293],{"type":23,"value":1371},{"type":17,"tag":632,"props":3295,"children":3296},{"class":645},[3297],{"type":23,"value":3298},"])\n",{"type":17,"tag":632,"props":3300,"children":3301},{"class":634,"line":708},[3302,3307,3311,3315,3319,3323,3327,3331],{"type":17,"tag":632,"props":3303,"children":3304},{"class":645},[3305],{"type":23,"value":3306},"        Lambda[",{"type":17,"tag":632,"props":3308,"children":3309},{"class":689},[3310],{"type":23,"value":885},{"type":17,"tag":632,"props":3312,"children":3313},{"class":645},[3314],{"type":23,"value":2435},{"type":17,"tag":632,"props":3316,"children":3317},{"class":639},[3318],{"type":23,"value":1064},{"type":17,"tag":632,"props":3320,"children":3321},{"class":689},[3322],{"type":23,"value":995},{"type":17,"tag":632,"props":3324,"children":3325},{"class":645},[3326],{"type":23,"value":2929},{"type":17,"tag":632,"props":3328,"children":3329},{"class":639},[3330],{"type":23,"value":729},{"type":17,"tag":632,"props":3332,"children":3333},{"class":645},[3334],{"type":23,"value":3335}," x_N\n",{"type":17,"tag":632,"props":3337,"children":3338},{"class":634,"line":737},[3339,3343,3347,3351,3355,3359,3363,3367],{"type":17,"tag":632,"props":3340,"children":3341},{"class":645},[3342],{"type":23,"value":3306},{"type":17,"tag":632,"props":3344,"children":3345},{"class":689},[3346],{"type":23,"value":995},{"type":17,"tag":632,"props":3348,"children":3349},{"class":645},[3350],{"type":23,"value":2435},{"type":17,"tag":632,"props":3352,"children":3353},{"class":639},[3354],{"type":23,"value":1064},{"type":17,"tag":632,"props":3356,"children":3357},{"class":689},[3358],{"type":23,"value":995},{"type":17,"tag":632,"props":3360,"children":3361},{"class":645},[3362],{"type":23,"value":2929},{"type":17,"tag":632,"props":3364,"children":3365},{"class":639},[3366],{"type":23,"value":729},{"type":17,"tag":632,"props":3368,"children":3369},{"class":645},[3370],{"type":23,"value":3371}," y_N\n",{"type":17,"tag":632,"props":3373,"children":3374},{"class":634,"line":763},[3375,3379,3383,3387,3391,3395,3399,3403],{"type":17,"tag":632,"props":3376,"children":3377},{"class":645},[3378],{"type":23,"value":3306},{"type":17,"tag":632,"props":3380,"children":3381},{"class":689},[3382],{"type":23,"value":1371},{"type":17,"tag":632,"props":3384,"children":3385},{"class":645},[3386],{"type":23,"value":2435},{"type":17,"tag":632,"props":3388,"children":3389},{"class":639},[3390],{"type":23,"value":1064},{"type":17,"tag":632,"props":3392,"children":3393},{"class":689},[3394],{"type":23,"value":995},{"type":17,"tag":632,"props":3396,"children":3397},{"class":645},[3398],{"type":23,"value":2929},{"type":17,"tag":632,"props":3400,"children":3401},{"class":639},[3402],{"type":23,"value":729},{"type":17,"tag":632,"props":3404,"children":3405},{"class":645},[3406],{"type":23,"value":3407}," yaw_N\n",{"type":17,"tag":632,"props":3409,"children":3410},{"class":634,"line":789},[3411],{"type":17,"tag":632,"props":3412,"children":3413},{},[3414],{"type":23,"value":668},{"type":17,"tag":632,"props":3416,"children":3417},{"class":634,"line":797},[3418],{"type":17,"tag":632,"props":3419,"children":3420},{},[3421],{"type":23,"value":668},{"type":17,"tag":632,"props":3423,"children":3424},{"class":634,"line":823},[3425,3429,3433,3437,3441,3445,3450,3454,3458,3462,3466,3470,3474],{"type":17,"tag":632,"props":3426,"children":3427},{"class":645},[3428],{"type":23,"value":714},{"type":17,"tag":632,"props":3430,"children":3431},{"class":639},[3432],{"type":23,"value":2808},{"type":17,"tag":632,"props":3434,"children":3435},{"class":645},[3436],{"type":23,"value":2813},{"type":17,"tag":632,"props":3438,"children":3439},{"class":639},[3440],{"type":23,"value":2818},{"type":17,"tag":632,"props":3442,"children":3443},{"class":645},[3444],{"type":23,"value":648},{"type":17,"tag":632,"props":3446,"children":3447},{"class":689},[3448],{"type":23,"value":3449},"reversed",{"type":17,"tag":632,"props":3451,"children":3452},{"class":645},[3453],{"type":23,"value":1405},{"type":17,"tag":632,"props":3455,"children":3456},{"class":689},[3457],{"type":23,"value":2827},{"type":17,"tag":632,"props":3459,"children":3460},{"class":645},[3461],{"type":23,"value":1405},{"type":17,"tag":632,"props":3463,"children":3464},{"class":689},[3465],{"type":23,"value":995},{"type":17,"tag":632,"props":3467,"children":3468},{"class":645},[3469],{"type":23,"value":2435},{"type":17,"tag":632,"props":3471,"children":3472},{"class":689},[3473],{"type":23,"value":719},{"type":17,"tag":632,"props":3475,"children":3476},{"class":645},[3477],{"type":23,"value":3478},".pred_horizons)):\n",{"type":17,"tag":632,"props":3480,"children":3481},{"class":634,"line":849},[3482],{"type":17,"tag":632,"props":3483,"children":3484},{},[3485],{"type":23,"value":668},{"type":17,"tag":632,"props":3487,"children":3488},{"class":634,"line":857},[3489,3494,3498,3502,3506],{"type":17,"tag":632,"props":3490,"children":3491},{"class":645},[3492],{"type":23,"value":3493},"            dhdx1, dhdx2, dhdx3 ",{"type":17,"tag":632,"props":3495,"children":3496},{"class":639},[3497],{"type":23,"value":729},{"type":17,"tag":632,"props":3499,"children":3500},{"class":645},[3501],{"type":23,"value":648},{"type":17,"tag":632,"props":3503,"children":3504},{"class":689},[3505],{"type":23,"value":719},{"type":17,"tag":632,"props":3507,"children":3508},{"class":645},[3509],{"type":23,"value":3510},".hjb_equation.dhdx(\n",{"type":17,"tag":632,"props":3512,"children":3513},{"class":634,"line":893},[3514,3519,3523,3528,3532,3536,3540],{"type":17,"tag":632,"props":3515,"children":3516},{"class":645},[3517],{"type":23,"value":3518},"                X[",{"type":17,"tag":632,"props":3520,"children":3521},{"class":689},[3522],{"type":23,"value":885},{"type":17,"tag":632,"props":3524,"children":3525},{"class":645},[3526],{"type":23,"value":3527},", i], X[",{"type":17,"tag":632,"props":3529,"children":3530},{"class":689},[3531],{"type":23,"value":995},{"type":17,"tag":632,"props":3533,"children":3534},{"class":645},[3535],{"type":23,"value":3527},{"type":17,"tag":632,"props":3537,"children":3538},{"class":689},[3539],{"type":23,"value":1371},{"type":17,"tag":632,"props":3541,"children":3542},{"class":645},[3543],{"type":23,"value":3544},", i],\n",{"type":17,"tag":632,"props":3546,"children":3547},{"class":634,"line":926},[3548,3553,3557,3561,3565,3569,3573,3577,3581,3585,3589,3593,3597],{"type":17,"tag":632,"props":3549,"children":3550},{"class":645},[3551],{"type":23,"value":3552},"                ",{"type":17,"tag":632,"props":3554,"children":3555},{"class":689},[3556],{"type":23,"value":719},{"type":17,"tag":632,"props":3558,"children":3559},{"class":645},[3560],{"type":23,"value":3256},{"type":17,"tag":632,"props":3562,"children":3563},{"class":689},[3564],{"type":23,"value":885},{"type":17,"tag":632,"props":3566,"children":3567},{"class":645},[3568],{"type":23,"value":3265},{"type":17,"tag":632,"props":3570,"children":3571},{"class":689},[3572],{"type":23,"value":719},{"type":17,"tag":632,"props":3574,"children":3575},{"class":645},[3576],{"type":23,"value":3256},{"type":17,"tag":632,"props":3578,"children":3579},{"class":689},[3580],{"type":23,"value":995},{"type":17,"tag":632,"props":3582,"children":3583},{"class":645},[3584],{"type":23,"value":3265},{"type":17,"tag":632,"props":3586,"children":3587},{"class":689},[3588],{"type":23,"value":719},{"type":17,"tag":632,"props":3590,"children":3591},{"class":645},[3592],{"type":23,"value":3256},{"type":17,"tag":632,"props":3594,"children":3595},{"class":689},[3596],{"type":23,"value":1371},{"type":17,"tag":632,"props":3598,"children":3599},{"class":645},[3600],{"type":23,"value":3239},{"type":17,"tag":632,"props":3602,"children":3603},{"class":634,"line":934},[3604,3609,3613,3618,3622,3626,3630,3634,3639,3643,3647,3651,3655],{"type":17,"tag":632,"props":3605,"children":3606},{"class":645},[3607],{"type":23,"value":3608},"                U[",{"type":17,"tag":632,"props":3610,"children":3611},{"class":689},[3612],{"type":23,"value":885},{"type":17,"tag":632,"props":3614,"children":3615},{"class":645},[3616],{"type":23,"value":3617},", i], Lambda[",{"type":17,"tag":632,"props":3619,"children":3620},{"class":689},[3621],{"type":23,"value":885},{"type":17,"tag":632,"props":3623,"children":3624},{"class":645},[3625],{"type":23,"value":2916},{"type":17,"tag":632,"props":3627,"children":3628},{"class":639},[3629],{"type":23,"value":1195},{"type":17,"tag":632,"props":3631,"children":3632},{"class":689},[3633],{"type":23,"value":995},{"type":17,"tag":632,"props":3635,"children":3636},{"class":645},[3637],{"type":23,"value":3638},"], Lambda[",{"type":17,"tag":632,"props":3640,"children":3641},{"class":689},[3642],{"type":23,"value":995},{"type":17,"tag":632,"props":3644,"children":3645},{"class":645},[3646],{"type":23,"value":2916},{"type":17,"tag":632,"props":3648,"children":3649},{"class":639},[3650],{"type":23,"value":1195},{"type":17,"tag":632,"props":3652,"children":3653},{"class":689},[3654],{"type":23,"value":995},{"type":17,"tag":632,"props":3656,"children":3657},{"class":645},[3658],{"type":23,"value":890},{"type":17,"tag":632,"props":3660,"children":3661},{"class":634,"line":968},[3662],{"type":17,"tag":632,"props":3663,"children":3664},{"class":645},[3665],{"type":23,"value":3666},"            )\n",{"type":17,"tag":632,"props":3668,"children":3669},{"class":634,"line":1002},[3670],{"type":17,"tag":632,"props":3671,"children":3672},{},[3673],{"type":23,"value":668},{"type":17,"tag":632,"props":3675,"children":3676},{"class":634,"line":1010},[3677,3682,3686,3690,3694,3699,3703,3707,3711,3715,3719,3723,3728,3732],{"type":17,"tag":632,"props":3678,"children":3679},{"class":645},[3680],{"type":23,"value":3681},"            Lambda[",{"type":17,"tag":632,"props":3683,"children":3684},{"class":689},[3685],{"type":23,"value":885},{"type":17,"tag":632,"props":3687,"children":3688},{"class":645},[3689],{"type":23,"value":2947},{"type":17,"tag":632,"props":3691,"children":3692},{"class":639},[3693],{"type":23,"value":729},{"type":17,"tag":632,"props":3695,"children":3696},{"class":645},[3697],{"type":23,"value":3698}," Lambda[",{"type":17,"tag":632,"props":3700,"children":3701},{"class":689},[3702],{"type":23,"value":885},{"type":17,"tag":632,"props":3704,"children":3705},{"class":645},[3706],{"type":23,"value":2916},{"type":17,"tag":632,"props":3708,"children":3709},{"class":639},[3710],{"type":23,"value":1195},{"type":17,"tag":632,"props":3712,"children":3713},{"class":689},[3714],{"type":23,"value":995},{"type":17,"tag":632,"props":3716,"children":3717},{"class":645},[3718],{"type":23,"value":2929},{"type":17,"tag":632,"props":3720,"children":3721},{"class":639},[3722],{"type":23,"value":1195},{"type":17,"tag":632,"props":3724,"children":3725},{"class":645},[3726],{"type":23,"value":3727}," dhdx1 ",{"type":17,"tag":632,"props":3729,"children":3730},{"class":639},[3731],{"type":23,"value":1074},{"type":17,"tag":632,"props":3733,"children":3734},{"class":645},[3735],{"type":23,"value":2965},{"type":17,"tag":632,"props":3737,"children":3738},{"class":634,"line":1036},[3739,3743,3747,3751,3755,3759,3763,3767,3771,3775,3779,3783,3788,3792],{"type":17,"tag":632,"props":3740,"children":3741},{"class":645},[3742],{"type":23,"value":3681},{"type":17,"tag":632,"props":3744,"children":3745},{"class":689},[3746],{"type":23,"value":995},{"type":17,"tag":632,"props":3748,"children":3749},{"class":645},[3750],{"type":23,"value":2947},{"type":17,"tag":632,"props":3752,"children":3753},{"class":639},[3754],{"type":23,"value":729},{"type":17,"tag":632,"props":3756,"children":3757},{"class":645},[3758],{"type":23,"value":3698},{"type":17,"tag":632,"props":3760,"children":3761},{"class":689},[3762],{"type":23,"value":995},{"type":17,"tag":632,"props":3764,"children":3765},{"class":645},[3766],{"type":23,"value":2916},{"type":17,"tag":632,"props":3768,"children":3769},{"class":639},[3770],{"type":23,"value":1195},{"type":17,"tag":632,"props":3772,"children":3773},{"class":689},[3774],{"type":23,"value":995},{"type":17,"tag":632,"props":3776,"children":3777},{"class":645},[3778],{"type":23,"value":2929},{"type":17,"tag":632,"props":3780,"children":3781},{"class":639},[3782],{"type":23,"value":1195},{"type":17,"tag":632,"props":3784,"children":3785},{"class":645},[3786],{"type":23,"value":3787}," dhdx2 ",{"type":17,"tag":632,"props":3789,"children":3790},{"class":639},[3791],{"type":23,"value":1074},{"type":17,"tag":632,"props":3793,"children":3794},{"class":645},[3795],{"type":23,"value":2965},{"type":17,"tag":632,"props":3797,"children":3798},{"class":634,"line":1044},[3799,3803,3807,3811,3815,3819,3823,3827,3831,3835,3839,3843,3848,3852],{"type":17,"tag":632,"props":3800,"children":3801},{"class":645},[3802],{"type":23,"value":3681},{"type":17,"tag":632,"props":3804,"children":3805},{"class":689},[3806],{"type":23,"value":1371},{"type":17,"tag":632,"props":3808,"children":3809},{"class":645},[3810],{"type":23,"value":2947},{"type":17,"tag":632,"props":3812,"children":3813},{"class":639},[3814],{"type":23,"value":729},{"type":17,"tag":632,"props":3816,"children":3817},{"class":645},[3818],{"type":23,"value":3698},{"type":17,"tag":632,"props":3820,"children":3821},{"class":689},[3822],{"type":23,"value":1371},{"type":17,"tag":632,"props":3824,"children":3825},{"class":645},[3826],{"type":23,"value":2916},{"type":17,"tag":632,"props":3828,"children":3829},{"class":639},[3830],{"type":23,"value":1195},{"type":17,"tag":632,"props":3832,"children":3833},{"class":689},[3834],{"type":23,"value":995},{"type":17,"tag":632,"props":3836,"children":3837},{"class":645},[3838],{"type":23,"value":2929},{"type":17,"tag":632,"props":3840,"children":3841},{"class":639},[3842],{"type":23,"value":1195},{"type":17,"tag":632,"props":3844,"children":3845},{"class":645},[3846],{"type":23,"value":3847}," dhdx3 ",{"type":17,"tag":632,"props":3849,"children":3850},{"class":639},[3851],{"type":23,"value":1074},{"type":17,"tag":632,"props":3853,"children":3854},{"class":645},[3855],{"type":23,"value":2965},{"type":17,"tag":632,"props":3857,"children":3858},{"class":634,"line":1086},[3859],{"type":17,"tag":632,"props":3860,"children":3861},{"class":645},[3862],{"type":23,"value":3863},"    \n",{"type":17,"tag":632,"props":3865,"children":3866},{"class":634,"line":1126},[3867],{"type":17,"tag":632,"props":3868,"children":3869},{},[3870],{"type":23,"value":668},{"type":17,"tag":632,"props":3872,"children":3873},{"class":634,"line":1220},[3874,3878,3882],{"type":17,"tag":632,"props":3875,"children":3876},{"class":645},[3877],{"type":23,"value":714},{"type":17,"tag":632,"props":3879,"children":3880},{"class":639},[3881],{"type":23,"value":1238},{"type":17,"tag":632,"props":3883,"children":3884},{"class":645},[3885],{"type":23,"value":3886}," Lambda",{"type":17,"tag":26,"props":3888,"children":3889},{},[3890],{"type":23,"value":3891},"And finally, calculating Newton F Function",{"type":17,"tag":617,"props":3893,"children":3896},{"className":3894,"code":3895,"language":622,"meta":7},[620],"def calc_f(self, X, U, Lambda, Mu, dt):\n\n        X_new = self.calc_state(X, U, dt)\n\n        Lambda_new = self.calc_costate(X_new, U, Lambda, dt)\n\n        F = np.zeros((self.u_dim, self.pred_horizons))\n\n        for i in range(self.pred_horizons):\n            dhdu1, dhdu2 = self.hjb_equation.dhdu(X_new[2, i], U[0, i], U[1, i],\n                                                  self.U_r[0], self.U_r[1],\n                                                  Lambda_new[0, i+1], Lambda_new[1, i+1], Lambda_new[2, i+1],\n                                                  Mu[0, i], Mu[1, i])\n            F[0, i] = dhdu1\n            F[1, i] = dhdu2\n            \n        F = F.T.ravel().reshape(-1, 1)\n\n        return F\n",[3897],{"type":17,"tag":625,"props":3898,"children":3899},{},[3900],{"type":17,"tag":617,"props":3901,"children":3902},{"__ignoreMap":7},[3903,3924,3931,3956,3963,3988,3995,4027,4034,4073,4122,4163,4232,4257,4282,4306,4313,4349,4356],{"type":17,"tag":632,"props":3904,"children":3905},{"class":634,"line":635},[3906,3910,3914,3919],{"type":17,"tag":632,"props":3907,"children":3908},{"class":639},[3909],{"type":23,"value":682},{"type":17,"tag":632,"props":3911,"children":3912},{"class":645},[3913],{"type":23,"value":648},{"type":17,"tag":632,"props":3915,"children":3916},{"class":651},[3917],{"type":23,"value":3918},"calc_f",{"type":17,"tag":632,"props":3920,"children":3921},{"class":645},[3922],{"type":23,"value":3923},"(self, X, U, Lambda, Mu, dt):\n",{"type":17,"tag":632,"props":3925,"children":3926},{"class":634,"line":662},[3927],{"type":17,"tag":632,"props":3928,"children":3929},{},[3930],{"type":23,"value":668},{"type":17,"tag":632,"props":3932,"children":3933},{"class":634,"line":671},[3934,3939,3943,3947,3951],{"type":17,"tag":632,"props":3935,"children":3936},{"class":645},[3937],{"type":23,"value":3938},"        X_new ",{"type":17,"tag":632,"props":3940,"children":3941},{"class":639},[3942],{"type":23,"value":729},{"type":17,"tag":632,"props":3944,"children":3945},{"class":645},[3946],{"type":23,"value":648},{"type":17,"tag":632,"props":3948,"children":3949},{"class":689},[3950],{"type":23,"value":719},{"type":17,"tag":632,"props":3952,"children":3953},{"class":645},[3954],{"type":23,"value":3955},".calc_state(X, U, dt)\n",{"type":17,"tag":632,"props":3957,"children":3958},{"class":634,"line":700},[3959],{"type":17,"tag":632,"props":3960,"children":3961},{},[3962],{"type":23,"value":668},{"type":17,"tag":632,"props":3964,"children":3965},{"class":634,"line":708},[3966,3971,3975,3979,3983],{"type":17,"tag":632,"props":3967,"children":3968},{"class":645},[3969],{"type":23,"value":3970},"        Lambda_new ",{"type":17,"tag":632,"props":3972,"children":3973},{"class":639},[3974],{"type":23,"value":729},{"type":17,"tag":632,"props":3976,"children":3977},{"class":645},[3978],{"type":23,"value":648},{"type":17,"tag":632,"props":3980,"children":3981},{"class":689},[3982],{"type":23,"value":719},{"type":17,"tag":632,"props":3984,"children":3985},{"class":645},[3986],{"type":23,"value":3987},".calc_costate(X_new, U, Lambda, dt)\n",{"type":17,"tag":632,"props":3989,"children":3990},{"class":634,"line":737},[3991],{"type":17,"tag":632,"props":3992,"children":3993},{},[3994],{"type":23,"value":668},{"type":17,"tag":632,"props":3996,"children":3997},{"class":634,"line":763},[3998,4003,4007,4011,4015,4019,4023],{"type":17,"tag":632,"props":3999,"children":4000},{"class":645},[4001],{"type":23,"value":4002},"        F ",{"type":17,"tag":632,"props":4004,"children":4005},{"class":639},[4006],{"type":23,"value":729},{"type":17,"tag":632,"props":4008,"children":4009},{"class":645},[4010],{"type":23,"value":2487},{"type":17,"tag":632,"props":4012,"children":4013},{"class":689},[4014],{"type":23,"value":719},{"type":17,"tag":632,"props":4016,"children":4017},{"class":645},[4018],{"type":23,"value":2496},{"type":17,"tag":632,"props":4020,"children":4021},{"class":689},[4022],{"type":23,"value":719},{"type":17,"tag":632,"props":4024,"children":4025},{"class":645},[4026],{"type":23,"value":2505},{"type":17,"tag":632,"props":4028,"children":4029},{"class":634,"line":789},[4030],{"type":17,"tag":632,"props":4031,"children":4032},{},[4033],{"type":23,"value":668},{"type":17,"tag":632,"props":4035,"children":4036},{"class":634,"line":797},[4037,4041,4045,4049,4053,4057,4061,4065,4069],{"type":17,"tag":632,"props":4038,"children":4039},{"class":645},[4040],{"type":23,"value":714},{"type":17,"tag":632,"props":4042,"children":4043},{"class":639},[4044],{"type":23,"value":2808},{"type":17,"tag":632,"props":4046,"children":4047},{"class":645},[4048],{"type":23,"value":2813},{"type":17,"tag":632,"props":4050,"children":4051},{"class":639},[4052],{"type":23,"value":2818},{"type":17,"tag":632,"props":4054,"children":4055},{"class":645},[4056],{"type":23,"value":648},{"type":17,"tag":632,"props":4058,"children":4059},{"class":689},[4060],{"type":23,"value":2827},{"type":17,"tag":632,"props":4062,"children":4063},{"class":645},[4064],{"type":23,"value":1405},{"type":17,"tag":632,"props":4066,"children":4067},{"class":689},[4068],{"type":23,"value":719},{"type":17,"tag":632,"props":4070,"children":4071},{"class":645},[4072],{"type":23,"value":2840},{"type":17,"tag":632,"props":4074,"children":4075},{"class":634,"line":823},[4076,4081,4085,4089,4093,4098,4102,4106,4110,4114,4118],{"type":17,"tag":632,"props":4077,"children":4078},{"class":645},[4079],{"type":23,"value":4080},"            dhdu1, dhdu2 ",{"type":17,"tag":632,"props":4082,"children":4083},{"class":639},[4084],{"type":23,"value":729},{"type":17,"tag":632,"props":4086,"children":4087},{"class":645},[4088],{"type":23,"value":648},{"type":17,"tag":632,"props":4090,"children":4091},{"class":689},[4092],{"type":23,"value":719},{"type":17,"tag":632,"props":4094,"children":4095},{"class":645},[4096],{"type":23,"value":4097},".hjb_equation.dhdu(X_new[",{"type":17,"tag":632,"props":4099,"children":4100},{"class":689},[4101],{"type":23,"value":1371},{"type":17,"tag":632,"props":4103,"children":4104},{"class":645},[4105],{"type":23,"value":2874},{"type":17,"tag":632,"props":4107,"children":4108},{"class":689},[4109],{"type":23,"value":885},{"type":17,"tag":632,"props":4111,"children":4112},{"class":645},[4113],{"type":23,"value":2874},{"type":17,"tag":632,"props":4115,"children":4116},{"class":689},[4117],{"type":23,"value":995},{"type":17,"tag":632,"props":4119,"children":4120},{"class":645},[4121],{"type":23,"value":3544},{"type":17,"tag":632,"props":4123,"children":4124},{"class":634,"line":849},[4125,4130,4134,4139,4143,4147,4151,4155,4159],{"type":17,"tag":632,"props":4126,"children":4127},{"class":645},[4128],{"type":23,"value":4129},"                                                  ",{"type":17,"tag":632,"props":4131,"children":4132},{"class":689},[4133],{"type":23,"value":719},{"type":17,"tag":632,"props":4135,"children":4136},{"class":645},[4137],{"type":23,"value":4138},".U_r[",{"type":17,"tag":632,"props":4140,"children":4141},{"class":689},[4142],{"type":23,"value":885},{"type":17,"tag":632,"props":4144,"children":4145},{"class":645},[4146],{"type":23,"value":3265},{"type":17,"tag":632,"props":4148,"children":4149},{"class":689},[4150],{"type":23,"value":719},{"type":17,"tag":632,"props":4152,"children":4153},{"class":645},[4154],{"type":23,"value":4138},{"type":17,"tag":632,"props":4156,"children":4157},{"class":689},[4158],{"type":23,"value":995},{"type":17,"tag":632,"props":4160,"children":4161},{"class":645},[4162],{"type":23,"value":3239},{"type":17,"tag":632,"props":4164,"children":4165},{"class":634,"line":857},[4166,4171,4175,4179,4183,4187,4192,4196,4200,4204,4208,4212,4216,4220,4224,4228],{"type":17,"tag":632,"props":4167,"children":4168},{"class":645},[4169],{"type":23,"value":4170},"                                                  Lambda_new[",{"type":17,"tag":632,"props":4172,"children":4173},{"class":689},[4174],{"type":23,"value":885},{"type":17,"tag":632,"props":4176,"children":4177},{"class":645},[4178],{"type":23,"value":2916},{"type":17,"tag":632,"props":4180,"children":4181},{"class":639},[4182],{"type":23,"value":1195},{"type":17,"tag":632,"props":4184,"children":4185},{"class":689},[4186],{"type":23,"value":995},{"type":17,"tag":632,"props":4188,"children":4189},{"class":645},[4190],{"type":23,"value":4191},"], Lambda_new[",{"type":17,"tag":632,"props":4193,"children":4194},{"class":689},[4195],{"type":23,"value":995},{"type":17,"tag":632,"props":4197,"children":4198},{"class":645},[4199],{"type":23,"value":2916},{"type":17,"tag":632,"props":4201,"children":4202},{"class":639},[4203],{"type":23,"value":1195},{"type":17,"tag":632,"props":4205,"children":4206},{"class":689},[4207],{"type":23,"value":995},{"type":17,"tag":632,"props":4209,"children":4210},{"class":645},[4211],{"type":23,"value":4191},{"type":17,"tag":632,"props":4213,"children":4214},{"class":689},[4215],{"type":23,"value":1371},{"type":17,"tag":632,"props":4217,"children":4218},{"class":645},[4219],{"type":23,"value":2916},{"type":17,"tag":632,"props":4221,"children":4222},{"class":639},[4223],{"type":23,"value":1195},{"type":17,"tag":632,"props":4225,"children":4226},{"class":689},[4227],{"type":23,"value":995},{"type":17,"tag":632,"props":4229,"children":4230},{"class":645},[4231],{"type":23,"value":3239},{"type":17,"tag":632,"props":4233,"children":4234},{"class":634,"line":893},[4235,4240,4244,4249,4253],{"type":17,"tag":632,"props":4236,"children":4237},{"class":645},[4238],{"type":23,"value":4239},"                                                  Mu[",{"type":17,"tag":632,"props":4241,"children":4242},{"class":689},[4243],{"type":23,"value":885},{"type":17,"tag":632,"props":4245,"children":4246},{"class":645},[4247],{"type":23,"value":4248},", i], Mu[",{"type":17,"tag":632,"props":4250,"children":4251},{"class":689},[4252],{"type":23,"value":995},{"type":17,"tag":632,"props":4254,"children":4255},{"class":645},[4256],{"type":23,"value":2891},{"type":17,"tag":632,"props":4258,"children":4259},{"class":634,"line":926},[4260,4265,4269,4273,4277],{"type":17,"tag":632,"props":4261,"children":4262},{"class":645},[4263],{"type":23,"value":4264},"            F[",{"type":17,"tag":632,"props":4266,"children":4267},{"class":689},[4268],{"type":23,"value":885},{"type":17,"tag":632,"props":4270,"children":4271},{"class":645},[4272],{"type":23,"value":2947},{"type":17,"tag":632,"props":4274,"children":4275},{"class":639},[4276],{"type":23,"value":729},{"type":17,"tag":632,"props":4278,"children":4279},{"class":645},[4280],{"type":23,"value":4281}," dhdu1\n",{"type":17,"tag":632,"props":4283,"children":4284},{"class":634,"line":934},[4285,4289,4293,4297,4301],{"type":17,"tag":632,"props":4286,"children":4287},{"class":645},[4288],{"type":23,"value":4264},{"type":17,"tag":632,"props":4290,"children":4291},{"class":689},[4292],{"type":23,"value":995},{"type":17,"tag":632,"props":4294,"children":4295},{"class":645},[4296],{"type":23,"value":2947},{"type":17,"tag":632,"props":4298,"children":4299},{"class":639},[4300],{"type":23,"value":729},{"type":17,"tag":632,"props":4302,"children":4303},{"class":645},[4304],{"type":23,"value":4305}," dhdu2\n",{"type":17,"tag":632,"props":4307,"children":4308},{"class":634,"line":968},[4309],{"type":17,"tag":632,"props":4310,"children":4311},{"class":645},[4312],{"type":23,"value":2899},{"type":17,"tag":632,"props":4314,"children":4315},{"class":634,"line":1002},[4316,4320,4324,4329,4333,4337,4341,4345],{"type":17,"tag":632,"props":4317,"children":4318},{"class":645},[4319],{"type":23,"value":4002},{"type":17,"tag":632,"props":4321,"children":4322},{"class":639},[4323],{"type":23,"value":729},{"type":17,"tag":632,"props":4325,"children":4326},{"class":645},[4327],{"type":23,"value":4328}," F.T.ravel().reshape(",{"type":17,"tag":632,"props":4330,"children":4331},{"class":639},[4332],{"type":23,"value":1064},{"type":17,"tag":632,"props":4334,"children":4335},{"class":689},[4336],{"type":23,"value":995},{"type":17,"tag":632,"props":4338,"children":4339},{"class":645},[4340],{"type":23,"value":2435},{"type":17,"tag":632,"props":4342,"children":4343},{"class":689},[4344],{"type":23,"value":995},{"type":17,"tag":632,"props":4346,"children":4347},{"class":645},[4348],{"type":23,"value":1441},{"type":17,"tag":632,"props":4350,"children":4351},{"class":634,"line":1010},[4352],{"type":17,"tag":632,"props":4353,"children":4354},{},[4355],{"type":23,"value":668},{"type":17,"tag":632,"props":4357,"children":4358},{"class":634,"line":1036},[4359,4363,4367],{"type":17,"tag":632,"props":4360,"children":4361},{"class":645},[4362],{"type":23,"value":714},{"type":17,"tag":632,"props":4364,"children":4365},{"class":639},[4366],{"type":23,"value":1238},{"type":17,"tag":632,"props":4368,"children":4369},{"class":645},[4370],{"type":23,"value":4371}," F",{"type":17,"tag":26,"props":4373,"children":4374},{},[4375,4377,4383,4385,4390],{"type":23,"value":4376},"Now let's introduce Continuation method for Function ",{"type":17,"tag":4378,"props":4379,"children":4380},"code-inline",{},[4381],{"type":23,"value":4382},"F",{"type":23,"value":4384},", you can look at the ",{"type":17,"tag":169,"props":4386,"children":4387},{},[4388],{"type":23,"value":4389}," Continuation ",{"type":23,"value":4391}," part.",{"type":17,"tag":617,"props":4393,"children":4396},{"className":4394,"code":4395,"language":622,"meta":7},[620],"# Time step horizons\ndt = self.tf * (1-np.exp(-self.alpha*time)) / self.pred_horizons\n# F(x,u,t+h)\nF = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u,t+h)\nx_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, 0], U[0, 0], U[1, 0])\nX[:, 0] = X[:, 0] + np.array([x_dot, y_dot, yaw_dot]) * self.ht\nFxt = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u+hdx,t+h)\nFuxt = self.calc_f(X, U + self.dU*self.ht, Lambda, Mu , dt)\n\n# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n",[4397],{"type":17,"tag":625,"props":4398,"children":4399},{},[4400],{"type":17,"tag":617,"props":4401,"children":4402},{"__ignoreMap":7},[4403,4411,4495,4503,4528,4536,4609,4667,4691,4699,4754,4761,4769,4811],{"type":17,"tag":632,"props":4404,"children":4405},{"class":634,"line":635},[4406],{"type":17,"tag":632,"props":4407,"children":4408},{"class":1869},[4409],{"type":23,"value":4410},"# Time step horizons\n",{"type":17,"tag":632,"props":4412,"children":4413},{"class":634,"line":662},[4414,4418,4422,4426,4430,4434,4438,4443,4447,4451,4456,4460,4464,4469,4473,4478,4482,4486,4490],{"type":17,"tag":632,"props":4415,"children":4416},{"class":645},[4417],{"type":23,"value":2730},{"type":17,"tag":632,"props":4419,"children":4420},{"class":639},[4421],{"type":23,"value":729},{"type":17,"tag":632,"props":4423,"children":4424},{"class":645},[4425],{"type":23,"value":648},{"type":17,"tag":632,"props":4427,"children":4428},{"class":689},[4429],{"type":23,"value":719},{"type":17,"tag":632,"props":4431,"children":4432},{"class":645},[4433],{"type":23,"value":2121},{"type":17,"tag":632,"props":4435,"children":4436},{"class":639},[4437],{"type":23,"value":1074},{"type":17,"tag":632,"props":4439,"children":4440},{"class":645},[4441],{"type":23,"value":4442}," (",{"type":17,"tag":632,"props":4444,"children":4445},{"class":689},[4446],{"type":23,"value":995},{"type":17,"tag":632,"props":4448,"children":4449},{"class":639},[4450],{"type":23,"value":1064},{"type":17,"tag":632,"props":4452,"children":4453},{"class":645},[4454],{"type":23,"value":4455},"np.exp(",{"type":17,"tag":632,"props":4457,"children":4458},{"class":639},[4459],{"type":23,"value":1064},{"type":17,"tag":632,"props":4461,"children":4462},{"class":689},[4463],{"type":23,"value":719},{"type":17,"tag":632,"props":4465,"children":4466},{"class":645},[4467],{"type":23,"value":4468},".alpha",{"type":17,"tag":632,"props":4470,"children":4471},{"class":639},[4472],{"type":23,"value":1074},{"type":17,"tag":632,"props":4474,"children":4475},{"class":645},[4476],{"type":23,"value":4477},"time)) ",{"type":17,"tag":632,"props":4479,"children":4480},{"class":639},[4481],{"type":23,"value":1432},{"type":17,"tag":632,"props":4483,"children":4484},{"class":645},[4485],{"type":23,"value":648},{"type":17,"tag":632,"props":4487,"children":4488},{"class":689},[4489],{"type":23,"value":719},{"type":17,"tag":632,"props":4491,"children":4492},{"class":645},[4493],{"type":23,"value":4494},".pred_horizons\n",{"type":17,"tag":632,"props":4496,"children":4497},{"class":634,"line":671},[4498],{"type":17,"tag":632,"props":4499,"children":4500},{"class":1869},[4501],{"type":23,"value":4502},"# F(x,u,t+h)\n",{"type":17,"tag":632,"props":4504,"children":4505},{"class":634,"line":700},[4506,4511,4515,4519,4523],{"type":17,"tag":632,"props":4507,"children":4508},{"class":645},[4509],{"type":23,"value":4510},"F ",{"type":17,"tag":632,"props":4512,"children":4513},{"class":639},[4514],{"type":23,"value":729},{"type":17,"tag":632,"props":4516,"children":4517},{"class":645},[4518],{"type":23,"value":648},{"type":17,"tag":632,"props":4520,"children":4521},{"class":689},[4522],{"type":23,"value":719},{"type":17,"tag":632,"props":4524,"children":4525},{"class":645},[4526],{"type":23,"value":4527},".calc_f(X, U, Lambda, Mu, dt)\n",{"type":17,"tag":632,"props":4529,"children":4530},{"class":634,"line":708},[4531],{"type":17,"tag":632,"props":4532,"children":4533},{"class":1869},[4534],{"type":23,"value":4535},"# F(x+hdx,u,t+h)\n",{"type":17,"tag":632,"props":4537,"children":4538},{"class":634,"line":737},[4539,4544,4548,4552,4556,4560,4564,4568,4572,4577,4581,4585,4589,4593,4597,4601,4605],{"type":17,"tag":632,"props":4540,"children":4541},{"class":645},[4542],{"type":23,"value":4543},"x_dot, y_dot, yaw_dot ",{"type":17,"tag":632,"props":4545,"children":4546},{"class":639},[4547],{"type":23,"value":729},{"type":17,"tag":632,"props":4549,"children":4550},{"class":645},[4551],{"type":23,"value":648},{"type":17,"tag":632,"props":4553,"children":4554},{"class":689},[4555],{"type":23,"value":719},{"type":17,"tag":632,"props":4557,"children":4558},{"class":645},[4559],{"type":23,"value":2865},{"type":17,"tag":632,"props":4561,"children":4562},{"class":689},[4563],{"type":23,"value":1371},{"type":17,"tag":632,"props":4565,"children":4566},{"class":645},[4567],{"type":23,"value":2435},{"type":17,"tag":632,"props":4569,"children":4570},{"class":689},[4571],{"type":23,"value":885},{"type":17,"tag":632,"props":4573,"children":4574},{"class":645},[4575],{"type":23,"value":4576},"], U[",{"type":17,"tag":632,"props":4578,"children":4579},{"class":689},[4580],{"type":23,"value":885},{"type":17,"tag":632,"props":4582,"children":4583},{"class":645},[4584],{"type":23,"value":2435},{"type":17,"tag":632,"props":4586,"children":4587},{"class":689},[4588],{"type":23,"value":885},{"type":17,"tag":632,"props":4590,"children":4591},{"class":645},[4592],{"type":23,"value":4576},{"type":17,"tag":632,"props":4594,"children":4595},{"class":689},[4596],{"type":23,"value":995},{"type":17,"tag":632,"props":4598,"children":4599},{"class":645},[4600],{"type":23,"value":2435},{"type":17,"tag":632,"props":4602,"children":4603},{"class":689},[4604],{"type":23,"value":885},{"type":17,"tag":632,"props":4606,"children":4607},{"class":645},[4608],{"type":23,"value":3298},{"type":17,"tag":632,"props":4610,"children":4611},{"class":634,"line":763},[4612,4617,4621,4625,4629,4634,4638,4642,4646,4651,4655,4659,4663],{"type":17,"tag":632,"props":4613,"children":4614},{"class":645},[4615],{"type":23,"value":4616},"X[:, ",{"type":17,"tag":632,"props":4618,"children":4619},{"class":689},[4620],{"type":23,"value":885},{"type":17,"tag":632,"props":4622,"children":4623},{"class":645},[4624],{"type":23,"value":2929},{"type":17,"tag":632,"props":4626,"children":4627},{"class":639},[4628],{"type":23,"value":729},{"type":17,"tag":632,"props":4630,"children":4631},{"class":645},[4632],{"type":23,"value":4633}," X[:, ",{"type":17,"tag":632,"props":4635,"children":4636},{"class":689},[4637],{"type":23,"value":885},{"type":17,"tag":632,"props":4639,"children":4640},{"class":645},[4641],{"type":23,"value":2929},{"type":17,"tag":632,"props":4643,"children":4644},{"class":639},[4645],{"type":23,"value":1195},{"type":17,"tag":632,"props":4647,"children":4648},{"class":645},[4649],{"type":23,"value":4650}," np.array([x_dot, y_dot, yaw_dot]) ",{"type":17,"tag":632,"props":4652,"children":4653},{"class":639},[4654],{"type":23,"value":1074},{"type":17,"tag":632,"props":4656,"children":4657},{"class":645},[4658],{"type":23,"value":648},{"type":17,"tag":632,"props":4660,"children":4661},{"class":689},[4662],{"type":23,"value":719},{"type":17,"tag":632,"props":4664,"children":4665},{"class":645},[4666],{"type":23,"value":2076},{"type":17,"tag":632,"props":4668,"children":4669},{"class":634,"line":789},[4670,4675,4679,4683,4687],{"type":17,"tag":632,"props":4671,"children":4672},{"class":645},[4673],{"type":23,"value":4674},"Fxt ",{"type":17,"tag":632,"props":4676,"children":4677},{"class":639},[4678],{"type":23,"value":729},{"type":17,"tag":632,"props":4680,"children":4681},{"class":645},[4682],{"type":23,"value":648},{"type":17,"tag":632,"props":4684,"children":4685},{"class":689},[4686],{"type":23,"value":719},{"type":17,"tag":632,"props":4688,"children":4689},{"class":645},[4690],{"type":23,"value":4527},{"type":17,"tag":632,"props":4692,"children":4693},{"class":634,"line":797},[4694],{"type":17,"tag":632,"props":4695,"children":4696},{"class":1869},[4697],{"type":23,"value":4698},"# F(x+hdx,u+hdx,t+h)\n",{"type":17,"tag":632,"props":4700,"children":4701},{"class":634,"line":823},[4702,4707,4711,4715,4719,4724,4728,4732,4736,4741,4745,4749],{"type":17,"tag":632,"props":4703,"children":4704},{"class":645},[4705],{"type":23,"value":4706},"Fuxt ",{"type":17,"tag":632,"props":4708,"children":4709},{"class":639},[4710],{"type":23,"value":729},{"type":17,"tag":632,"props":4712,"children":4713},{"class":645},[4714],{"type":23,"value":648},{"type":17,"tag":632,"props":4716,"children":4717},{"class":689},[4718],{"type":23,"value":719},{"type":17,"tag":632,"props":4720,"children":4721},{"class":645},[4722],{"type":23,"value":4723},".calc_f(X, U ",{"type":17,"tag":632,"props":4725,"children":4726},{"class":639},[4727],{"type":23,"value":1195},{"type":17,"tag":632,"props":4729,"children":4730},{"class":645},[4731],{"type":23,"value":648},{"type":17,"tag":632,"props":4733,"children":4734},{"class":689},[4735],{"type":23,"value":719},{"type":17,"tag":632,"props":4737,"children":4738},{"class":645},[4739],{"type":23,"value":4740},".dU",{"type":17,"tag":632,"props":4742,"children":4743},{"class":639},[4744],{"type":23,"value":1074},{"type":17,"tag":632,"props":4746,"children":4747},{"class":689},[4748],{"type":23,"value":719},{"type":17,"tag":632,"props":4750,"children":4751},{"class":645},[4752],{"type":23,"value":4753},".ht, Lambda, Mu , dt)\n",{"type":17,"tag":632,"props":4755,"children":4756},{"class":634,"line":849},[4757],{"type":17,"tag":632,"props":4758,"children":4759},{},[4760],{"type":23,"value":668},{"type":17,"tag":632,"props":4762,"children":4763},{"class":634,"line":857},[4764],{"type":17,"tag":632,"props":4765,"children":4766},{"class":1869},[4767],{"type":23,"value":4768},"# Define right-left handside equation\n",{"type":17,"tag":632,"props":4770,"children":4771},{"class":634,"line":893},[4772,4777,4781,4786,4790,4795,4799,4803,4807],{"type":17,"tag":632,"props":4773,"children":4774},{"class":645},[4775],{"type":23,"value":4776},"left ",{"type":17,"tag":632,"props":4778,"children":4779},{"class":639},[4780],{"type":23,"value":729},{"type":17,"tag":632,"props":4782,"children":4783},{"class":645},[4784],{"type":23,"value":4785}," (Fuxt ",{"type":17,"tag":632,"props":4787,"children":4788},{"class":639},[4789],{"type":23,"value":1064},{"type":17,"tag":632,"props":4791,"children":4792},{"class":645},[4793],{"type":23,"value":4794}," Fxt) ",{"type":17,"tag":632,"props":4796,"children":4797},{"class":639},[4798],{"type":23,"value":1432},{"type":17,"tag":632,"props":4800,"children":4801},{"class":645},[4802],{"type":23,"value":648},{"type":17,"tag":632,"props":4804,"children":4805},{"class":689},[4806],{"type":23,"value":719},{"type":17,"tag":632,"props":4808,"children":4809},{"class":645},[4810],{"type":23,"value":2076},{"type":17,"tag":632,"props":4812,"children":4813},{"class":634,"line":926},[4814,4819,4823,4827,4831,4835,4839,4843,4848,4852,4857,4861,4866,4870,4874],{"type":17,"tag":632,"props":4815,"children":4816},{"class":645},[4817],{"type":23,"value":4818},"right ",{"type":17,"tag":632,"props":4820,"children":4821},{"class":639},[4822],{"type":23,"value":729},{"type":17,"tag":632,"props":4824,"children":4825},{"class":645},[4826],{"type":23,"value":648},{"type":17,"tag":632,"props":4828,"children":4829},{"class":639},[4830],{"type":23,"value":1064},{"type":17,"tag":632,"props":4832,"children":4833},{"class":689},[4834],{"type":23,"value":719},{"type":17,"tag":632,"props":4836,"children":4837},{"class":645},[4838],{"type":23,"value":2051},{"type":17,"tag":632,"props":4840,"children":4841},{"class":639},[4842],{"type":23,"value":1074},{"type":17,"tag":632,"props":4844,"children":4845},{"class":645},[4846],{"type":23,"value":4847}," F ",{"type":17,"tag":632,"props":4849,"children":4850},{"class":639},[4851],{"type":23,"value":1064},{"type":17,"tag":632,"props":4853,"children":4854},{"class":645},[4855],{"type":23,"value":4856}," (Fxt ",{"type":17,"tag":632,"props":4858,"children":4859},{"class":639},[4860],{"type":23,"value":1064},{"type":17,"tag":632,"props":4862,"children":4863},{"class":645},[4864],{"type":23,"value":4865}," F)",{"type":17,"tag":632,"props":4867,"children":4868},{"class":639},[4869],{"type":23,"value":1432},{"type":17,"tag":632,"props":4871,"children":4872},{"class":689},[4873],{"type":23,"value":719},{"type":17,"tag":632,"props":4875,"children":4876},{"class":645},[4877],{"type":23,"value":4878},".ht",{"type":17,"tag":26,"props":4880,"children":4881},{},[4882,4884,4888],{"type":23,"value":4883},"Here is the crucial part, we need to implement GMRES solver for our ",{"type":17,"tag":4378,"props":4885,"children":4886},{},[4887],{"type":23,"value":4382},{"type":23,"value":4889}," function to obtain solution vector.",{"type":17,"tag":617,"props":4891,"children":4894},{"className":4892,"code":4893,"language":622,"meta":7},[620],"# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n\n# Define iterations\nm = (self.u_dim ) * self.pred_horizons\n# Define r0\nr0 = right - left\n# print(r0)\n\n# GMRES\nVm = np.zeros((m, m+1))\nVm[:, 0:1] = r0 / np.linalg.norm(r0)\n# print(\"Vm\", Vm[:, 0])\nHm = np.zeros((m+1, m))\n# print(Vm[:, 0])\n\n\nfor i in range(m):\n    Fuxt = self.calc_f(\n        X, U + Vm[:, i:i+1].reshape(self.u_dim, self.pred_horizons, order='F') * self.ht,\n        Lambda, Mu,\n        dt\n    )\n\n    Av = (Fuxt - Fxt) / self.ht\n\n    for k in range(i+1):\n        Hm[k, i] = np.dot(Av.T, Vm[:, k:k+1])\n\n    temp_vec = np.zeros((m, 1))\n\n    for k in range(i+1):\n        temp_vec = temp_vec + np.dot(Hm[k, i], Vm[:, k:k+1])\n\n    v_hat = Av - temp_vec\n\n    Hm[i+1, i] = np.linalg.norm(v_hat)\n\n    Vm[:,i+1:i+2] = v_hat/Hm[i+1, i]\n\ne = np.zeros((m+1, 1))\ne[0, 0] = 1.0\ngm = np.linalg.norm(r0) * e\n# print(gm)\n\nUTMat, gm = self.ToUTMat(Hm, gm, m)\n\nmin_y = np.zeros((m, 1))\n\nfor i in range(m):\n    min_y[i][0] = (gm[i, 0] - np.dot(UTMat[i:i+1 ,:] ,min_y))/UTMat[i, i]\n\ndU_new = self.dU + np.dot(Vm[:, 0:m], min_y).reshape(self.u_dim, self.pred_horizons, order='F')\n\nself.dU = dU_new\n\nU = U + self.dU * self.ht\n",[4895],{"type":17,"tag":625,"props":4896,"children":4897},{},[4898],{"type":17,"tag":617,"props":4899,"children":4900},{"__ignoreMap":7},[4901,4908,4947,5010,5017,5025,5066,5074,5100,5108,5115,5123,5153,5195,5203,5233,5241,5248,5255,5283,5308,5393,5401,5409,5417,5424,5464,5471,5517,5546,5553,5578,5585,5628,5666,5673,5699,5706,5735,5743,5808,5816,5853,5890,5917,5926,5934,5960,5968,5993,6001,6029,6094,6102,6177,6185,6206,6214],{"type":17,"tag":632,"props":4902,"children":4903},{"class":634,"line":635},[4904],{"type":17,"tag":632,"props":4905,"children":4906},{"class":1869},[4907],{"type":23,"value":4768},{"type":17,"tag":632,"props":4909,"children":4910},{"class":634,"line":662},[4911,4915,4919,4923,4927,4931,4935,4939,4943],{"type":17,"tag":632,"props":4912,"children":4913},{"class":645},[4914],{"type":23,"value":4776},{"type":17,"tag":632,"props":4916,"children":4917},{"class":639},[4918],{"type":23,"value":729},{"type":17,"tag":632,"props":4920,"children":4921},{"class":645},[4922],{"type":23,"value":4785},{"type":17,"tag":632,"props":4924,"children":4925},{"class":639},[4926],{"type":23,"value":1064},{"type":17,"tag":632,"props":4928,"children":4929},{"class":645},[4930],{"type":23,"value":4794},{"type":17,"tag":632,"props":4932,"children":4933},{"class":639},[4934],{"type":23,"value":1432},{"type":17,"tag":632,"props":4936,"children":4937},{"class":645},[4938],{"type":23,"value":648},{"type":17,"tag":632,"props":4940,"children":4941},{"class":689},[4942],{"type":23,"value":719},{"type":17,"tag":632,"props":4944,"children":4945},{"class":645},[4946],{"type":23,"value":2076},{"type":17,"tag":632,"props":4948,"children":4949},{"class":634,"line":671},[4950,4954,4958,4962,4966,4970,4974,4978,4982,4986,4990,4994,4998,5002,5006],{"type":17,"tag":632,"props":4951,"children":4952},{"class":645},[4953],{"type":23,"value":4818},{"type":17,"tag":632,"props":4955,"children":4956},{"class":639},[4957],{"type":23,"value":729},{"type":17,"tag":632,"props":4959,"children":4960},{"class":645},[4961],{"type":23,"value":648},{"type":17,"tag":632,"props":4963,"children":4964},{"class":639},[4965],{"type":23,"value":1064},{"type":17,"tag":632,"props":4967,"children":4968},{"class":689},[4969],{"type":23,"value":719},{"type":17,"tag":632,"props":4971,"children":4972},{"class":645},[4973],{"type":23,"value":2051},{"type":17,"tag":632,"props":4975,"children":4976},{"class":639},[4977],{"type":23,"value":1074},{"type":17,"tag":632,"props":4979,"children":4980},{"class":645},[4981],{"type":23,"value":4847},{"type":17,"tag":632,"props":4983,"children":4984},{"class":639},[4985],{"type":23,"value":1064},{"type":17,"tag":632,"props":4987,"children":4988},{"class":645},[4989],{"type":23,"value":4856},{"type":17,"tag":632,"props":4991,"children":4992},{"class":639},[4993],{"type":23,"value":1064},{"type":17,"tag":632,"props":4995,"children":4996},{"class":645},[4997],{"type":23,"value":4865},{"type":17,"tag":632,"props":4999,"children":5000},{"class":639},[5001],{"type":23,"value":1432},{"type":17,"tag":632,"props":5003,"children":5004},{"class":689},[5005],{"type":23,"value":719},{"type":17,"tag":632,"props":5007,"children":5008},{"class":645},[5009],{"type":23,"value":2076},{"type":17,"tag":632,"props":5011,"children":5012},{"class":634,"line":700},[5013],{"type":17,"tag":632,"props":5014,"children":5015},{},[5016],{"type":23,"value":668},{"type":17,"tag":632,"props":5018,"children":5019},{"class":634,"line":708},[5020],{"type":17,"tag":632,"props":5021,"children":5022},{"class":1869},[5023],{"type":23,"value":5024},"# Define iterations\n",{"type":17,"tag":632,"props":5026,"children":5027},{"class":634,"line":737},[5028,5033,5037,5041,5045,5050,5054,5058,5062],{"type":17,"tag":632,"props":5029,"children":5030},{"class":645},[5031],{"type":23,"value":5032},"m ",{"type":17,"tag":632,"props":5034,"children":5035},{"class":639},[5036],{"type":23,"value":729},{"type":17,"tag":632,"props":5038,"children":5039},{"class":645},[5040],{"type":23,"value":4442},{"type":17,"tag":632,"props":5042,"children":5043},{"class":689},[5044],{"type":23,"value":719},{"type":17,"tag":632,"props":5046,"children":5047},{"class":645},[5048],{"type":23,"value":5049},".u_dim ) ",{"type":17,"tag":632,"props":5051,"children":5052},{"class":639},[5053],{"type":23,"value":1074},{"type":17,"tag":632,"props":5055,"children":5056},{"class":645},[5057],{"type":23,"value":648},{"type":17,"tag":632,"props":5059,"children":5060},{"class":689},[5061],{"type":23,"value":719},{"type":17,"tag":632,"props":5063,"children":5064},{"class":645},[5065],{"type":23,"value":4494},{"type":17,"tag":632,"props":5067,"children":5068},{"class":634,"line":763},[5069],{"type":17,"tag":632,"props":5070,"children":5071},{"class":1869},[5072],{"type":23,"value":5073},"# Define r0\n",{"type":17,"tag":632,"props":5075,"children":5076},{"class":634,"line":789},[5077,5082,5086,5091,5095],{"type":17,"tag":632,"props":5078,"children":5079},{"class":645},[5080],{"type":23,"value":5081},"r0 ",{"type":17,"tag":632,"props":5083,"children":5084},{"class":639},[5085],{"type":23,"value":729},{"type":17,"tag":632,"props":5087,"children":5088},{"class":645},[5089],{"type":23,"value":5090}," right ",{"type":17,"tag":632,"props":5092,"children":5093},{"class":639},[5094],{"type":23,"value":1064},{"type":17,"tag":632,"props":5096,"children":5097},{"class":645},[5098],{"type":23,"value":5099}," left\n",{"type":17,"tag":632,"props":5101,"children":5102},{"class":634,"line":797},[5103],{"type":17,"tag":632,"props":5104,"children":5105},{"class":1869},[5106],{"type":23,"value":5107},"# print(r0)\n",{"type":17,"tag":632,"props":5109,"children":5110},{"class":634,"line":823},[5111],{"type":17,"tag":632,"props":5112,"children":5113},{},[5114],{"type":23,"value":668},{"type":17,"tag":632,"props":5116,"children":5117},{"class":634,"line":849},[5118],{"type":17,"tag":632,"props":5119,"children":5120},{"class":1869},[5121],{"type":23,"value":5122},"# GMRES\n",{"type":17,"tag":632,"props":5124,"children":5125},{"class":634,"line":857},[5126,5131,5135,5140,5144,5148],{"type":17,"tag":632,"props":5127,"children":5128},{"class":645},[5129],{"type":23,"value":5130},"Vm ",{"type":17,"tag":632,"props":5132,"children":5133},{"class":639},[5134],{"type":23,"value":729},{"type":17,"tag":632,"props":5136,"children":5137},{"class":645},[5138],{"type":23,"value":5139}," np.zeros((m, m",{"type":17,"tag":632,"props":5141,"children":5142},{"class":639},[5143],{"type":23,"value":1195},{"type":17,"tag":632,"props":5145,"children":5146},{"class":689},[5147],{"type":23,"value":995},{"type":17,"tag":632,"props":5149,"children":5150},{"class":645},[5151],{"type":23,"value":5152},"))\n",{"type":17,"tag":632,"props":5154,"children":5155},{"class":634,"line":893},[5156,5161,5165,5169,5173,5177,5181,5186,5190],{"type":17,"tag":632,"props":5157,"children":5158},{"class":645},[5159],{"type":23,"value":5160},"Vm[:, ",{"type":17,"tag":632,"props":5162,"children":5163},{"class":689},[5164],{"type":23,"value":885},{"type":17,"tag":632,"props":5166,"children":5167},{"class":645},[5168],{"type":23,"value":295},{"type":17,"tag":632,"props":5170,"children":5171},{"class":689},[5172],{"type":23,"value":995},{"type":17,"tag":632,"props":5174,"children":5175},{"class":645},[5176],{"type":23,"value":2929},{"type":17,"tag":632,"props":5178,"children":5179},{"class":639},[5180],{"type":23,"value":729},{"type":17,"tag":632,"props":5182,"children":5183},{"class":645},[5184],{"type":23,"value":5185}," r0 ",{"type":17,"tag":632,"props":5187,"children":5188},{"class":639},[5189],{"type":23,"value":1432},{"type":17,"tag":632,"props":5191,"children":5192},{"class":645},[5193],{"type":23,"value":5194}," np.linalg.norm(r0)\n",{"type":17,"tag":632,"props":5196,"children":5197},{"class":634,"line":926},[5198],{"type":17,"tag":632,"props":5199,"children":5200},{"class":1869},[5201],{"type":23,"value":5202},"# print(\"Vm\", Vm[:, 0])\n",{"type":17,"tag":632,"props":5204,"children":5205},{"class":634,"line":934},[5206,5211,5215,5220,5224,5228],{"type":17,"tag":632,"props":5207,"children":5208},{"class":645},[5209],{"type":23,"value":5210},"Hm ",{"type":17,"tag":632,"props":5212,"children":5213},{"class":639},[5214],{"type":23,"value":729},{"type":17,"tag":632,"props":5216,"children":5217},{"class":645},[5218],{"type":23,"value":5219}," np.zeros((m",{"type":17,"tag":632,"props":5221,"children":5222},{"class":639},[5223],{"type":23,"value":1195},{"type":17,"tag":632,"props":5225,"children":5226},{"class":689},[5227],{"type":23,"value":995},{"type":17,"tag":632,"props":5229,"children":5230},{"class":645},[5231],{"type":23,"value":5232},", m))\n",{"type":17,"tag":632,"props":5234,"children":5235},{"class":634,"line":968},[5236],{"type":17,"tag":632,"props":5237,"children":5238},{"class":1869},[5239],{"type":23,"value":5240},"# print(Vm[:, 0])\n",{"type":17,"tag":632,"props":5242,"children":5243},{"class":634,"line":1002},[5244],{"type":17,"tag":632,"props":5245,"children":5246},{},[5247],{"type":23,"value":668},{"type":17,"tag":632,"props":5249,"children":5250},{"class":634,"line":1010},[5251],{"type":17,"tag":632,"props":5252,"children":5253},{},[5254],{"type":23,"value":668},{"type":17,"tag":632,"props":5256,"children":5257},{"class":634,"line":1036},[5258,5262,5266,5270,5274,5278],{"type":17,"tag":632,"props":5259,"children":5260},{"class":639},[5261],{"type":23,"value":2808},{"type":17,"tag":632,"props":5263,"children":5264},{"class":645},[5265],{"type":23,"value":2813},{"type":17,"tag":632,"props":5267,"children":5268},{"class":639},[5269],{"type":23,"value":2818},{"type":17,"tag":632,"props":5271,"children":5272},{"class":645},[5273],{"type":23,"value":648},{"type":17,"tag":632,"props":5275,"children":5276},{"class":689},[5277],{"type":23,"value":2827},{"type":17,"tag":632,"props":5279,"children":5280},{"class":645},[5281],{"type":23,"value":5282},"(m):\n",{"type":17,"tag":632,"props":5284,"children":5285},{"class":634,"line":1044},[5286,5291,5295,5299,5303],{"type":17,"tag":632,"props":5287,"children":5288},{"class":645},[5289],{"type":23,"value":5290},"    Fuxt ",{"type":17,"tag":632,"props":5292,"children":5293},{"class":639},[5294],{"type":23,"value":729},{"type":17,"tag":632,"props":5296,"children":5297},{"class":645},[5298],{"type":23,"value":648},{"type":17,"tag":632,"props":5300,"children":5301},{"class":689},[5302],{"type":23,"value":719},{"type":17,"tag":632,"props":5304,"children":5305},{"class":645},[5306],{"type":23,"value":5307},".calc_f(\n",{"type":17,"tag":632,"props":5309,"children":5310},{"class":634,"line":1086},[5311,5316,5320,5325,5329,5333,5338,5342,5346,5350,5355,5361,5365,5371,5376,5380,5384,5388],{"type":17,"tag":632,"props":5312,"children":5313},{"class":645},[5314],{"type":23,"value":5315},"        X, U ",{"type":17,"tag":632,"props":5317,"children":5318},{"class":639},[5319],{"type":23,"value":1195},{"type":17,"tag":632,"props":5321,"children":5322},{"class":645},[5323],{"type":23,"value":5324}," Vm[:, i:i",{"type":17,"tag":632,"props":5326,"children":5327},{"class":639},[5328],{"type":23,"value":1195},{"type":17,"tag":632,"props":5330,"children":5331},{"class":689},[5332],{"type":23,"value":995},{"type":17,"tag":632,"props":5334,"children":5335},{"class":645},[5336],{"type":23,"value":5337},"].reshape(",{"type":17,"tag":632,"props":5339,"children":5340},{"class":689},[5341],{"type":23,"value":719},{"type":17,"tag":632,"props":5343,"children":5344},{"class":645},[5345],{"type":23,"value":2496},{"type":17,"tag":632,"props":5347,"children":5348},{"class":689},[5349],{"type":23,"value":719},{"type":17,"tag":632,"props":5351,"children":5352},{"class":645},[5353],{"type":23,"value":5354},".pred_horizons, ",{"type":17,"tag":632,"props":5356,"children":5358},{"class":5357},"ct-657843",[5359],{"type":23,"value":5360},"order",{"type":17,"tag":632,"props":5362,"children":5363},{"class":639},[5364],{"type":23,"value":729},{"type":17,"tag":632,"props":5366,"children":5368},{"class":5367},"ct-244866",[5369],{"type":23,"value":5370},"'F'",{"type":17,"tag":632,"props":5372,"children":5373},{"class":645},[5374],{"type":23,"value":5375},") ",{"type":17,"tag":632,"props":5377,"children":5378},{"class":639},[5379],{"type":23,"value":1074},{"type":17,"tag":632,"props":5381,"children":5382},{"class":645},[5383],{"type":23,"value":648},{"type":17,"tag":632,"props":5385,"children":5386},{"class":689},[5387],{"type":23,"value":719},{"type":17,"tag":632,"props":5389,"children":5390},{"class":645},[5391],{"type":23,"value":5392},".ht,\n",{"type":17,"tag":632,"props":5394,"children":5395},{"class":634,"line":1126},[5396],{"type":17,"tag":632,"props":5397,"children":5398},{"class":645},[5399],{"type":23,"value":5400},"        Lambda, Mu,\n",{"type":17,"tag":632,"props":5402,"children":5403},{"class":634,"line":1220},[5404],{"type":17,"tag":632,"props":5405,"children":5406},{"class":645},[5407],{"type":23,"value":5408},"        dt\n",{"type":17,"tag":632,"props":5410,"children":5411},{"class":634,"line":1228},[5412],{"type":17,"tag":632,"props":5413,"children":5414},{"class":645},[5415],{"type":23,"value":5416},"    )\n",{"type":17,"tag":632,"props":5418,"children":5419},{"class":634,"line":1246},[5420],{"type":17,"tag":632,"props":5421,"children":5422},{},[5423],{"type":23,"value":668},{"type":17,"tag":632,"props":5425,"children":5426},{"class":634,"line":1254},[5427,5432,5436,5440,5444,5448,5452,5456,5460],{"type":17,"tag":632,"props":5428,"children":5429},{"class":645},[5430],{"type":23,"value":5431},"    Av ",{"type":17,"tag":632,"props":5433,"children":5434},{"class":639},[5435],{"type":23,"value":729},{"type":17,"tag":632,"props":5437,"children":5438},{"class":645},[5439],{"type":23,"value":4785},{"type":17,"tag":632,"props":5441,"children":5442},{"class":639},[5443],{"type":23,"value":1064},{"type":17,"tag":632,"props":5445,"children":5446},{"class":645},[5447],{"type":23,"value":4794},{"type":17,"tag":632,"props":5449,"children":5450},{"class":639},[5451],{"type":23,"value":1432},{"type":17,"tag":632,"props":5453,"children":5454},{"class":645},[5455],{"type":23,"value":648},{"type":17,"tag":632,"props":5457,"children":5458},{"class":689},[5459],{"type":23,"value":719},{"type":17,"tag":632,"props":5461,"children":5462},{"class":645},[5463],{"type":23,"value":2076},{"type":17,"tag":632,"props":5465,"children":5466},{"class":634,"line":1280},[5467],{"type":17,"tag":632,"props":5468,"children":5469},{},[5470],{"type":23,"value":668},{"type":17,"tag":632,"props":5472,"children":5473},{"class":634,"line":1288},[5474,5478,5482,5487,5491,5495,5499,5504,5508,5512],{"type":17,"tag":632,"props":5475,"children":5476},{"class":645},[5477],{"type":23,"value":677},{"type":17,"tag":632,"props":5479,"children":5480},{"class":639},[5481],{"type":23,"value":2808},{"type":17,"tag":632,"props":5483,"children":5484},{"class":645},[5485],{"type":23,"value":5486}," k ",{"type":17,"tag":632,"props":5488,"children":5489},{"class":639},[5490],{"type":23,"value":2818},{"type":17,"tag":632,"props":5492,"children":5493},{"class":645},[5494],{"type":23,"value":648},{"type":17,"tag":632,"props":5496,"children":5497},{"class":689},[5498],{"type":23,"value":2827},{"type":17,"tag":632,"props":5500,"children":5501},{"class":645},[5502],{"type":23,"value":5503},"(i",{"type":17,"tag":632,"props":5505,"children":5506},{"class":639},[5507],{"type":23,"value":1195},{"type":17,"tag":632,"props":5509,"children":5510},{"class":689},[5511],{"type":23,"value":995},{"type":17,"tag":632,"props":5513,"children":5514},{"class":645},[5515],{"type":23,"value":5516},"):\n",{"type":17,"tag":632,"props":5518,"children":5519},{"class":634,"line":1444},[5520,5525,5529,5534,5538,5542],{"type":17,"tag":632,"props":5521,"children":5522},{"class":645},[5523],{"type":23,"value":5524},"        Hm[k, i] ",{"type":17,"tag":632,"props":5526,"children":5527},{"class":639},[5528],{"type":23,"value":729},{"type":17,"tag":632,"props":5530,"children":5531},{"class":645},[5532],{"type":23,"value":5533}," np.dot(Av.T, Vm[:, k:k",{"type":17,"tag":632,"props":5535,"children":5536},{"class":639},[5537],{"type":23,"value":1195},{"type":17,"tag":632,"props":5539,"children":5540},{"class":689},[5541],{"type":23,"value":995},{"type":17,"tag":632,"props":5543,"children":5544},{"class":645},[5545],{"type":23,"value":3298},{"type":17,"tag":632,"props":5547,"children":5548},{"class":634,"line":1564},[5549],{"type":17,"tag":632,"props":5550,"children":5551},{},[5552],{"type":23,"value":668},{"type":17,"tag":632,"props":5554,"children":5555},{"class":634,"line":1572},[5556,5561,5565,5570,5574],{"type":17,"tag":632,"props":5557,"children":5558},{"class":645},[5559],{"type":23,"value":5560},"    temp_vec ",{"type":17,"tag":632,"props":5562,"children":5563},{"class":639},[5564],{"type":23,"value":729},{"type":17,"tag":632,"props":5566,"children":5567},{"class":645},[5568],{"type":23,"value":5569}," np.zeros((m, ",{"type":17,"tag":632,"props":5571,"children":5572},{"class":689},[5573],{"type":23,"value":995},{"type":17,"tag":632,"props":5575,"children":5576},{"class":645},[5577],{"type":23,"value":5152},{"type":17,"tag":632,"props":5579,"children":5580},{"class":634,"line":1589},[5581],{"type":17,"tag":632,"props":5582,"children":5583},{},[5584],{"type":23,"value":668},{"type":17,"tag":632,"props":5586,"children":5587},{"class":634,"line":1597},[5588,5592,5596,5600,5604,5608,5612,5616,5620,5624],{"type":17,"tag":632,"props":5589,"children":5590},{"class":645},[5591],{"type":23,"value":677},{"type":17,"tag":632,"props":5593,"children":5594},{"class":639},[5595],{"type":23,"value":2808},{"type":17,"tag":632,"props":5597,"children":5598},{"class":645},[5599],{"type":23,"value":5486},{"type":17,"tag":632,"props":5601,"children":5602},{"class":639},[5603],{"type":23,"value":2818},{"type":17,"tag":632,"props":5605,"children":5606},{"class":645},[5607],{"type":23,"value":648},{"type":17,"tag":632,"props":5609,"children":5610},{"class":689},[5611],{"type":23,"value":2827},{"type":17,"tag":632,"props":5613,"children":5614},{"class":645},[5615],{"type":23,"value":5503},{"type":17,"tag":632,"props":5617,"children":5618},{"class":639},[5619],{"type":23,"value":1195},{"type":17,"tag":632,"props":5621,"children":5622},{"class":689},[5623],{"type":23,"value":995},{"type":17,"tag":632,"props":5625,"children":5626},{"class":645},[5627],{"type":23,"value":5516},{"type":17,"tag":632,"props":5629,"children":5630},{"class":634,"line":1623},[5631,5636,5640,5645,5649,5654,5658,5662],{"type":17,"tag":632,"props":5632,"children":5633},{"class":645},[5634],{"type":23,"value":5635},"        temp_vec ",{"type":17,"tag":632,"props":5637,"children":5638},{"class":639},[5639],{"type":23,"value":729},{"type":17,"tag":632,"props":5641,"children":5642},{"class":645},[5643],{"type":23,"value":5644}," temp_vec ",{"type":17,"tag":632,"props":5646,"children":5647},{"class":639},[5648],{"type":23,"value":1195},{"type":17,"tag":632,"props":5650,"children":5651},{"class":645},[5652],{"type":23,"value":5653}," np.dot(Hm[k, i], Vm[:, k:k",{"type":17,"tag":632,"props":5655,"children":5656},{"class":639},[5657],{"type":23,"value":1195},{"type":17,"tag":632,"props":5659,"children":5660},{"class":689},[5661],{"type":23,"value":995},{"type":17,"tag":632,"props":5663,"children":5664},{"class":645},[5665],{"type":23,"value":3298},{"type":17,"tag":632,"props":5667,"children":5668},{"class":634,"line":1667},[5669],{"type":17,"tag":632,"props":5670,"children":5671},{},[5672],{"type":23,"value":668},{"type":17,"tag":632,"props":5674,"children":5675},{"class":634,"line":1711},[5676,5681,5685,5690,5694],{"type":17,"tag":632,"props":5677,"children":5678},{"class":645},[5679],{"type":23,"value":5680},"    v_hat ",{"type":17,"tag":632,"props":5682,"children":5683},{"class":639},[5684],{"type":23,"value":729},{"type":17,"tag":632,"props":5686,"children":5687},{"class":645},[5688],{"type":23,"value":5689}," Av ",{"type":17,"tag":632,"props":5691,"children":5692},{"class":639},[5693],{"type":23,"value":1064},{"type":17,"tag":632,"props":5695,"children":5696},{"class":645},[5697],{"type":23,"value":5698}," temp_vec\n",{"type":17,"tag":632,"props":5700,"children":5701},{"class":634,"line":1754},[5702],{"type":17,"tag":632,"props":5703,"children":5704},{},[5705],{"type":23,"value":668},{"type":17,"tag":632,"props":5707,"children":5708},{"class":634,"line":1762},[5709,5714,5718,5722,5726,5730],{"type":17,"tag":632,"props":5710,"children":5711},{"class":645},[5712],{"type":23,"value":5713},"    Hm[i",{"type":17,"tag":632,"props":5715,"children":5716},{"class":639},[5717],{"type":23,"value":1195},{"type":17,"tag":632,"props":5719,"children":5720},{"class":689},[5721],{"type":23,"value":995},{"type":17,"tag":632,"props":5723,"children":5724},{"class":645},[5725],{"type":23,"value":2947},{"type":17,"tag":632,"props":5727,"children":5728},{"class":639},[5729],{"type":23,"value":729},{"type":17,"tag":632,"props":5731,"children":5732},{"class":645},[5733],{"type":23,"value":5734}," np.linalg.norm(v_hat)\n",{"type":17,"tag":632,"props":5736,"children":5738},{"class":634,"line":5737},39,[5739],{"type":17,"tag":632,"props":5740,"children":5741},{},[5742],{"type":23,"value":668},{"type":17,"tag":632,"props":5744,"children":5746},{"class":634,"line":5745},40,[5747,5752,5756,5760,5765,5769,5773,5777,5781,5786,5790,5795,5799,5803],{"type":17,"tag":632,"props":5748,"children":5749},{"class":645},[5750],{"type":23,"value":5751},"    Vm[:,i",{"type":17,"tag":632,"props":5753,"children":5754},{"class":639},[5755],{"type":23,"value":1195},{"type":17,"tag":632,"props":5757,"children":5758},{"class":689},[5759],{"type":23,"value":995},{"type":17,"tag":632,"props":5761,"children":5762},{"class":645},[5763],{"type":23,"value":5764},":i",{"type":17,"tag":632,"props":5766,"children":5767},{"class":639},[5768],{"type":23,"value":1195},{"type":17,"tag":632,"props":5770,"children":5771},{"class":689},[5772],{"type":23,"value":1371},{"type":17,"tag":632,"props":5774,"children":5775},{"class":645},[5776],{"type":23,"value":2929},{"type":17,"tag":632,"props":5778,"children":5779},{"class":639},[5780],{"type":23,"value":729},{"type":17,"tag":632,"props":5782,"children":5783},{"class":645},[5784],{"type":23,"value":5785}," v_hat",{"type":17,"tag":632,"props":5787,"children":5788},{"class":639},[5789],{"type":23,"value":1432},{"type":17,"tag":632,"props":5791,"children":5792},{"class":645},[5793],{"type":23,"value":5794},"Hm[i",{"type":17,"tag":632,"props":5796,"children":5797},{"class":639},[5798],{"type":23,"value":1195},{"type":17,"tag":632,"props":5800,"children":5801},{"class":689},[5802],{"type":23,"value":995},{"type":17,"tag":632,"props":5804,"children":5805},{"class":645},[5806],{"type":23,"value":5807},", i]\n",{"type":17,"tag":632,"props":5809,"children":5811},{"class":634,"line":5810},41,[5812],{"type":17,"tag":632,"props":5813,"children":5814},{},[5815],{"type":23,"value":668},{"type":17,"tag":632,"props":5817,"children":5819},{"class":634,"line":5818},42,[5820,5825,5829,5833,5837,5841,5845,5849],{"type":17,"tag":632,"props":5821,"children":5822},{"class":645},[5823],{"type":23,"value":5824},"e ",{"type":17,"tag":632,"props":5826,"children":5827},{"class":639},[5828],{"type":23,"value":729},{"type":17,"tag":632,"props":5830,"children":5831},{"class":645},[5832],{"type":23,"value":5219},{"type":17,"tag":632,"props":5834,"children":5835},{"class":639},[5836],{"type":23,"value":1195},{"type":17,"tag":632,"props":5838,"children":5839},{"class":689},[5840],{"type":23,"value":995},{"type":17,"tag":632,"props":5842,"children":5843},{"class":645},[5844],{"type":23,"value":2435},{"type":17,"tag":632,"props":5846,"children":5847},{"class":689},[5848],{"type":23,"value":995},{"type":17,"tag":632,"props":5850,"children":5851},{"class":645},[5852],{"type":23,"value":5152},{"type":17,"tag":632,"props":5854,"children":5856},{"class":634,"line":5855},43,[5857,5862,5866,5870,5874,5878,5882,5886],{"type":17,"tag":632,"props":5858,"children":5859},{"class":645},[5860],{"type":23,"value":5861},"e[",{"type":17,"tag":632,"props":5863,"children":5864},{"class":689},[5865],{"type":23,"value":885},{"type":17,"tag":632,"props":5867,"children":5868},{"class":645},[5869],{"type":23,"value":2435},{"type":17,"tag":632,"props":5871,"children":5872},{"class":689},[5873],{"type":23,"value":885},{"type":17,"tag":632,"props":5875,"children":5876},{"class":645},[5877],{"type":23,"value":2929},{"type":17,"tag":632,"props":5879,"children":5880},{"class":639},[5881],{"type":23,"value":729},{"type":17,"tag":632,"props":5883,"children":5884},{"class":645},[5885],{"type":23,"value":648},{"type":17,"tag":632,"props":5887,"children":5888},{"class":689},[5889],{"type":23,"value":2134},{"type":17,"tag":632,"props":5891,"children":5893},{"class":634,"line":5892},44,[5894,5899,5903,5908,5912],{"type":17,"tag":632,"props":5895,"children":5896},{"class":645},[5897],{"type":23,"value":5898},"gm ",{"type":17,"tag":632,"props":5900,"children":5901},{"class":639},[5902],{"type":23,"value":729},{"type":17,"tag":632,"props":5904,"children":5905},{"class":645},[5906],{"type":23,"value":5907}," np.linalg.norm(r0) ",{"type":17,"tag":632,"props":5909,"children":5910},{"class":639},[5911],{"type":23,"value":1074},{"type":17,"tag":632,"props":5913,"children":5914},{"class":645},[5915],{"type":23,"value":5916}," e\n",{"type":17,"tag":632,"props":5918,"children":5920},{"class":634,"line":5919},45,[5921],{"type":17,"tag":632,"props":5922,"children":5923},{"class":1869},[5924],{"type":23,"value":5925},"# print(gm)\n",{"type":17,"tag":632,"props":5927,"children":5929},{"class":634,"line":5928},46,[5930],{"type":17,"tag":632,"props":5931,"children":5932},{},[5933],{"type":23,"value":668},{"type":17,"tag":632,"props":5935,"children":5937},{"class":634,"line":5936},47,[5938,5943,5947,5951,5955],{"type":17,"tag":632,"props":5939,"children":5940},{"class":645},[5941],{"type":23,"value":5942},"UTMat, gm ",{"type":17,"tag":632,"props":5944,"children":5945},{"class":639},[5946],{"type":23,"value":729},{"type":17,"tag":632,"props":5948,"children":5949},{"class":645},[5950],{"type":23,"value":648},{"type":17,"tag":632,"props":5952,"children":5953},{"class":689},[5954],{"type":23,"value":719},{"type":17,"tag":632,"props":5956,"children":5957},{"class":645},[5958],{"type":23,"value":5959},".ToUTMat(Hm, gm, m)\n",{"type":17,"tag":632,"props":5961,"children":5963},{"class":634,"line":5962},48,[5964],{"type":17,"tag":632,"props":5965,"children":5966},{},[5967],{"type":23,"value":668},{"type":17,"tag":632,"props":5969,"children":5971},{"class":634,"line":5970},49,[5972,5977,5981,5985,5989],{"type":17,"tag":632,"props":5973,"children":5974},{"class":645},[5975],{"type":23,"value":5976},"min_y ",{"type":17,"tag":632,"props":5978,"children":5979},{"class":639},[5980],{"type":23,"value":729},{"type":17,"tag":632,"props":5982,"children":5983},{"class":645},[5984],{"type":23,"value":5569},{"type":17,"tag":632,"props":5986,"children":5987},{"class":689},[5988],{"type":23,"value":995},{"type":17,"tag":632,"props":5990,"children":5991},{"class":645},[5992],{"type":23,"value":5152},{"type":17,"tag":632,"props":5994,"children":5996},{"class":634,"line":5995},50,[5997],{"type":17,"tag":632,"props":5998,"children":5999},{},[6000],{"type":23,"value":668},{"type":17,"tag":632,"props":6002,"children":6004},{"class":634,"line":6003},51,[6005,6009,6013,6017,6021,6025],{"type":17,"tag":632,"props":6006,"children":6007},{"class":639},[6008],{"type":23,"value":2808},{"type":17,"tag":632,"props":6010,"children":6011},{"class":645},[6012],{"type":23,"value":2813},{"type":17,"tag":632,"props":6014,"children":6015},{"class":639},[6016],{"type":23,"value":2818},{"type":17,"tag":632,"props":6018,"children":6019},{"class":645},[6020],{"type":23,"value":648},{"type":17,"tag":632,"props":6022,"children":6023},{"class":689},[6024],{"type":23,"value":2827},{"type":17,"tag":632,"props":6026,"children":6027},{"class":645},[6028],{"type":23,"value":5282},{"type":17,"tag":632,"props":6030,"children":6032},{"class":634,"line":6031},52,[6033,6038,6042,6046,6050,6055,6059,6063,6067,6072,6076,6080,6085,6089],{"type":17,"tag":632,"props":6034,"children":6035},{"class":645},[6036],{"type":23,"value":6037},"    min_y[i][",{"type":17,"tag":632,"props":6039,"children":6040},{"class":689},[6041],{"type":23,"value":885},{"type":17,"tag":632,"props":6043,"children":6044},{"class":645},[6045],{"type":23,"value":2929},{"type":17,"tag":632,"props":6047,"children":6048},{"class":639},[6049],{"type":23,"value":729},{"type":17,"tag":632,"props":6051,"children":6052},{"class":645},[6053],{"type":23,"value":6054}," (gm[i, ",{"type":17,"tag":632,"props":6056,"children":6057},{"class":689},[6058],{"type":23,"value":885},{"type":17,"tag":632,"props":6060,"children":6061},{"class":645},[6062],{"type":23,"value":2929},{"type":17,"tag":632,"props":6064,"children":6065},{"class":639},[6066],{"type":23,"value":1064},{"type":17,"tag":632,"props":6068,"children":6069},{"class":645},[6070],{"type":23,"value":6071}," np.dot(UTMat[i:i",{"type":17,"tag":632,"props":6073,"children":6074},{"class":639},[6075],{"type":23,"value":1195},{"type":17,"tag":632,"props":6077,"children":6078},{"class":689},[6079],{"type":23,"value":995},{"type":17,"tag":632,"props":6081,"children":6082},{"class":645},[6083],{"type":23,"value":6084}," ,:] ,min_y))",{"type":17,"tag":632,"props":6086,"children":6087},{"class":639},[6088],{"type":23,"value":1432},{"type":17,"tag":632,"props":6090,"children":6091},{"class":645},[6092],{"type":23,"value":6093},"UTMat[i, i]\n",{"type":17,"tag":632,"props":6095,"children":6097},{"class":634,"line":6096},53,[6098],{"type":17,"tag":632,"props":6099,"children":6100},{},[6101],{"type":23,"value":668},{"type":17,"tag":632,"props":6103,"children":6105},{"class":634,"line":6104},54,[6106,6111,6115,6119,6123,6127,6131,6136,6140,6145,6149,6153,6157,6161,6165,6169,6173],{"type":17,"tag":632,"props":6107,"children":6108},{"class":645},[6109],{"type":23,"value":6110},"dU_new ",{"type":17,"tag":632,"props":6112,"children":6113},{"class":639},[6114],{"type":23,"value":729},{"type":17,"tag":632,"props":6116,"children":6117},{"class":645},[6118],{"type":23,"value":648},{"type":17,"tag":632,"props":6120,"children":6121},{"class":689},[6122],{"type":23,"value":719},{"type":17,"tag":632,"props":6124,"children":6125},{"class":645},[6126],{"type":23,"value":2478},{"type":17,"tag":632,"props":6128,"children":6129},{"class":639},[6130],{"type":23,"value":1195},{"type":17,"tag":632,"props":6132,"children":6133},{"class":645},[6134],{"type":23,"value":6135}," np.dot(Vm[:, ",{"type":17,"tag":632,"props":6137,"children":6138},{"class":689},[6139],{"type":23,"value":885},{"type":17,"tag":632,"props":6141,"children":6142},{"class":645},[6143],{"type":23,"value":6144},":m], min_y).reshape(",{"type":17,"tag":632,"props":6146,"children":6147},{"class":689},[6148],{"type":23,"value":719},{"type":17,"tag":632,"props":6150,"children":6151},{"class":645},[6152],{"type":23,"value":2496},{"type":17,"tag":632,"props":6154,"children":6155},{"class":689},[6156],{"type":23,"value":719},{"type":17,"tag":632,"props":6158,"children":6159},{"class":645},[6160],{"type":23,"value":5354},{"type":17,"tag":632,"props":6162,"children":6163},{"class":5357},[6164],{"type":23,"value":5360},{"type":17,"tag":632,"props":6166,"children":6167},{"class":639},[6168],{"type":23,"value":729},{"type":17,"tag":632,"props":6170,"children":6171},{"class":5367},[6172],{"type":23,"value":5370},{"type":17,"tag":632,"props":6174,"children":6175},{"class":645},[6176],{"type":23,"value":1441},{"type":17,"tag":632,"props":6178,"children":6180},{"class":634,"line":6179},55,[6181],{"type":17,"tag":632,"props":6182,"children":6183},{},[6184],{"type":23,"value":668},{"type":17,"tag":632,"props":6186,"children":6188},{"class":634,"line":6187},56,[6189,6193,6197,6201],{"type":17,"tag":632,"props":6190,"children":6191},{"class":689},[6192],{"type":23,"value":719},{"type":17,"tag":632,"props":6194,"children":6195},{"class":645},[6196],{"type":23,"value":2478},{"type":17,"tag":632,"props":6198,"children":6199},{"class":639},[6200],{"type":23,"value":729},{"type":17,"tag":632,"props":6202,"children":6203},{"class":645},[6204],{"type":23,"value":6205}," dU_new\n",{"type":17,"tag":632,"props":6207,"children":6209},{"class":634,"line":6208},57,[6210],{"type":17,"tag":632,"props":6211,"children":6212},{},[6213],{"type":23,"value":668},{"type":17,"tag":632,"props":6215,"children":6217},{"class":634,"line":6216},58,[6218,6222,6226,6231,6235,6239,6243,6247,6251,6255,6259],{"type":17,"tag":632,"props":6219,"children":6220},{"class":645},[6221],{"type":23,"value":2674},{"type":17,"tag":632,"props":6223,"children":6224},{"class":639},[6225],{"type":23,"value":729},{"type":17,"tag":632,"props":6227,"children":6228},{"class":645},[6229],{"type":23,"value":6230}," U ",{"type":17,"tag":632,"props":6232,"children":6233},{"class":639},[6234],{"type":23,"value":1195},{"type":17,"tag":632,"props":6236,"children":6237},{"class":645},[6238],{"type":23,"value":648},{"type":17,"tag":632,"props":6240,"children":6241},{"class":689},[6242],{"type":23,"value":719},{"type":17,"tag":632,"props":6244,"children":6245},{"class":645},[6246],{"type":23,"value":2478},{"type":17,"tag":632,"props":6248,"children":6249},{"class":639},[6250],{"type":23,"value":1074},{"type":17,"tag":632,"props":6252,"children":6253},{"class":645},[6254],{"type":23,"value":648},{"type":17,"tag":632,"props":6256,"children":6257},{"class":689},[6258],{"type":23,"value":719},{"type":17,"tag":632,"props":6260,"children":6261},{"class":645},[6262],{"type":23,"value":4878},{"type":17,"tag":26,"props":6264,"children":6265},{},[6266,6268,6273],{"type":23,"value":6267},"You can look in my code inside function ",{"type":17,"tag":169,"props":6269,"children":6270},{},[6271],{"type":23,"value":6272}," solve_nmpc ",{"type":23,"value":196},{"type":17,"tag":18,"props":6275,"children":6277},{"id":6276},"experiment-in-python",[6278],{"type":23,"value":6279},"Experiment in Python",{"type":17,"tag":26,"props":6281,"children":6282},{},[6283,6285,6288,6290,6293,6295,6299,6301,6305,6307,6311],{"type":23,"value":6284},"GMRES was consider one of the fastest solver for sparse linear algebra problem, so I will include the link for the GMRES algorithms. ",{"type":17,"tag":55,"props":6286,"children":6287},{},[],{"type":23,"value":6289},"\nIn my experiment, I use differential drive robot. ",{"type":17,"tag":55,"props":6291,"children":6292},{},[],{"type":23,"value":6294},"\nConsider as our state representation ",{"type":17,"tag":83,"props":6296,"children":6298},{"latex-express":6297,"styles":86}," x = \\begin{bmatrix} x \\\\ y \\\\ \\phi \\end{bmatrix} ",[],{"type":23,"value":6300}," and of course setting initialization ",{"type":17,"tag":83,"props":6302,"children":6304},{"latex-express":6303,"styles":86}," x_{0} = [0.0, 0.0, 0.0] ",[],{"type":23,"value":6306},", also ",{"type":17,"tag":83,"props":6308,"children":6310},{"latex-express":6309,"styles":86}," u_{0} = [0.0, 0.0] ",[],{"type":23,"value":196},{"type":17,"tag":6313,"props":6314,"children":6319},"figure",{"className":6315},[6316,6317,6318],"mb-4","inline-block","max-w-sm",[6320,6322],{"type":23,"value":6321},"\n  ",{"type":17,"tag":6323,"props":6324,"children":6330},"img",{"className":6325,"src":6327,"width":6328,"height":6329},[6326],"mx-auto","/topics/robotics/nmpc/nmpc_cgmres.gif",700,350,[],{"type":17,"tag":6332,"props":6333,"children":6338},"figcaption",{"className":6334},[67,6335,6336,6337],"text-sm","text-neutral-600","dark:text-neutral-400",[6339],{"type":23,"value":6340},"\n    Animation of Differential Drive robot on optimal trajectory !!!\n",{"type":17,"tag":26,"props":6342,"children":6343},{},[6344],{"type":23,"value":6345},"And here are the optimal data for all state and input control.",{"type":17,"tag":6313,"props":6347,"children":6349},{"className":6348},[6316,6317,6318],[6350,6351],{"type":23,"value":6321},{"type":17,"tag":6323,"props":6352,"children":6357},{"className":6353,"src":6354,"width":6355,"height":6356},[6326],"/topics/robotics/nmpc/cgmreDat1.png",600,300,[],{"type":17,"tag":6332,"props":6359,"children":6361},{"className":6360},[67,6335,6336,6337],[6362],{"type":23,"value":6363},"\n    All data obtained after simulation.\n",{"type":17,"tag":26,"props":6365,"children":6366},{},[6367,6369],{"type":23,"value":6368},"You can find all the code of NMPC even with CasAdi and CGMRES here in my github: ",{"type":17,"tag":6370,"props":6371,"children":6375},"a",{"href":6372,"rel":6373},"https://github.com/SokhengDin/Path-Tracking/tree/main",[6374],"nofollow",[6376],{"type":23,"value":6377},"Path-Tracking",{"type":17,"tag":18,"props":6379,"children":6381},{"id":6380},"in-conclusion",[6382],{"type":23,"value":6383},"In Conclusion",{"type":17,"tag":26,"props":6385,"children":6386},{},[6387],{"type":23,"value":6388},"Nonlinear Model Predictive Control with CGMRES is one of the great NMPC method that you should try, since it provides a very fast numerical calculation thank to the GMRES algorithms with Given Rotation method. Even though compare to another NMPC solver, NMPC with CGMRES sometime is hard for finding the optimal parameters in order to not cause unstable numerical calculation. Next time, I will bring the multiple shooting method which is consider in the promise of more robust numerical stability tha single shooting method.",{"type":17,"tag":18,"props":6390,"children":6392},{"id":6391},"references",[6393],{"type":23,"value":6394},"References",{"type":17,"tag":283,"props":6396,"children":6397},{},[6398,6408,6418,6428,6438],{"type":17,"tag":79,"props":6399,"children":6400},{},[6401],{"type":17,"tag":6370,"props":6402,"children":6405},{"href":6403,"rel":6404},"https://www.researchgate.net/publication/228007717_A_real-time_algorithm_for_nonlinear_receding_horizon_control_using_multiple_shooting_and_continuationKrylov_method",[6374],[6406],{"type":23,"value":6407},"A real‐time algorithm for nonlinear receding horizon control using multiple shooting and continuation/Krylov method",{"type":17,"tag":79,"props":6409,"children":6410},{},[6411],{"type":17,"tag":6370,"props":6412,"children":6415},{"href":6413,"rel":6414},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathTracking/cgmres_nmpc",[6374],[6416],{"type":23,"value":6417},"Nonlinear Model Predictive Control with CGMRES of Steering Car ",{"type":17,"tag":79,"props":6419,"children":6420},{},[6421],{"type":17,"tag":6370,"props":6422,"children":6425},{"href":6423,"rel":6424},"https://qiita.com/PozihameBaystar/items/650cc839da5d9c974f5d",[6374],[6426],{"type":23,"value":6427},"C/GMRESシミュレーションを3つの言語で作ったので比較してみた",{"type":17,"tag":79,"props":6429,"children":6430},{},[6431],{"type":17,"tag":6370,"props":6432,"children":6435},{"href":6433,"rel":6434},"https://qiita.com/opticont/items/b3518b470d9e327144be",[6374],[6436],{"type":23,"value":6437},"Krylov部分空間とGMRES法について",{"type":17,"tag":79,"props":6439,"children":6440},{},[6441],{"type":17,"tag":6370,"props":6442,"children":6445},{"href":6443,"rel":6444},"https://www.sciencedirect.com/science/article/pii/S2405896318326727",[6374],[6446],{"type":23,"value":6447},"Nonlinear Model Predictive Control of Position and Attitude in a Hexacopter with Three Failed Rotors",{"type":17,"tag":6449,"children":6450},"style",[6451],{"type":23,"value":6452},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-657843{color:#FFAB70;}\n.ct-244866{color:#9ECBFF;}",{"title":7,"searchDepth":662,"depth":662,"links":6454},[6455,6461,6462,6463,6464],{"id":20,"depth":662,"text":24,"children":6456},[6457,6458,6459,6460],{"id":34,"depth":671,"text":37},{"id":45,"depth":671,"text":48},{"id":228,"depth":671,"text":231},{"id":266,"depth":671,"text":269},{"id":592,"depth":662,"text":595},{"id":6276,"depth":662,"text":6279},{"id":6380,"depth":662,"text":6383},{"id":6391,"depth":662,"text":6394},"markdown","content:topics:robotics:nmpc-cgmres.md","content","topics/robotics/nmpc-cgmres.md","md",1697293981990]