[{"data":1,"prerenderedAt":14391},["Reactive",2],{"topics/robotics":3,"topics/ai":12804},[4,6467,10455,12356,12596],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":9,"description":10,"author":11,"slug":12,"tag":12,"img":13,"body":14,"_type":6462,"_id":6463,"_source":6464,"_file":6465,"_extension":6466},"/topics/robotics/nmpc-cgmres","robotics",false,"","Nonlinear Model Predictive Control with C/GMRES","Optimal Control theory","Din Sokheng","nmpc-cgmres","/topics/robotics/nmpc/nmpc_cgmres.png",{"type":15,"children":16,"toc":6450},"root",[17,26,32,39,44,50,59,64,70,75,164,180,198,203,212,216,227,233,242,246,261,267,272,279,479,490,495,499,503,541,546,550,555,565,569,578,582,587,593,601,613,1774,1788,2613,2618,2750,2755,3106,3111,3884,3889,4369,4389,4876,4887,6260,6271,6277,6309,6328,6338,6343,6355,6361,6375,6381,6386,6392,6445],{"type":18,"tag":19,"props":20,"children":22},"element","h2",{"id":21},"the-optimal-control-theory-in-control-system",[23],{"type":24,"value":25},"text","The Optimal Control Theory in Control System",{"type":18,"tag":27,"props":28,"children":29},"p",{},[30],{"type":24,"value":31},"Optimal Control is a branch of control theory in control system, the theory works by solving the optimization problem of the dynamical system in order to find the optimal solution for the system",{"type":18,"tag":33,"props":34,"children":36},"h3",{"id":35},"what-is-model-predictive-control",[37],{"type":24,"value":38},"What is Model Predictive Control ?",{"type":18,"tag":27,"props":40,"children":41},{},[42],{"type":24,"value":43},"Model Predictive Control (MPC) is the optimal control method that use optimization algorithms to solve the cost function the occurs from the desired input and obtain back the optimal input control over the finite and infinite horizons. Recently, MPC is hyping up among the control system researcher, since it is fast, efficiency and robustness for any high complex system.",{"type":18,"tag":33,"props":45,"children":47},{"id":46},"hamilton-jacobian-bellman-equation-hjbe",[48],{"type":24,"value":49},"Hamilton Jacobian Bellman Equation (HJBE)",{"type":18,"tag":27,"props":51,"children":52},{},[53,55],{"type":24,"value":54},"Actually, the HJBE is a nonlinear partial differential equation that it consists necessary conditions for optimality of control by minimizing the loss function of the system. ",{"type":18,"tag":56,"props":57,"children":58},"br",{},[],{"type":18,"tag":27,"props":60,"children":61},{},[62],{"type":24,"value":63},"We have the Hamiltonian Jacobian Bellman Equation",{"type":18,"tag":65,"props":66,"children":69},"math-render-b",{"latex-express":67,"styles":68},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T} Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}","text-center",[],{"type":18,"tag":27,"props":71,"children":72},{},[73],{"type":24,"value":74},"Which",{"type":18,"tag":76,"props":77,"children":78},"ul",{},[79,91,106,119,128,137,146,155],{"type":18,"tag":80,"props":81,"children":82},"li",{},[83,89],{"type":18,"tag":84,"props":85,"children":88},"math-render",{"latex-express":86,"styles":87},"N","inline-flex",[],{"type":24,"value":90}," is the number of prediction future horizons or shooting node.",{"type":18,"tag":80,"props":92,"children":93},{},[94,98,100,104],{"type":18,"tag":84,"props":95,"children":97},{"latex-express":96,"styles":87},"x_{k}",[],{"type":24,"value":99}," is the state of the system at shooting node ",{"type":18,"tag":84,"props":101,"children":103},{"latex-express":102,"styles":87},"k",[],{"type":24,"value":105}," .",{"type":18,"tag":80,"props":107,"children":108},{},[109,113,115,118],{"type":18,"tag":84,"props":110,"children":112},{"latex-express":111,"styles":87},"u_{k}",[],{"type":24,"value":114}," is the input control of the system at shooting node ",{"type":18,"tag":84,"props":116,"children":117},{"latex-express":102,"styles":87},[],{"type":24,"value":105},{"type":18,"tag":80,"props":120,"children":121},{},[122,126],{"type":18,"tag":84,"props":123,"children":125},{"latex-express":124,"styles":87},"Q, R",[],{"type":24,"value":127}," are diagonal matrix which helps the optimization solving the nlp problem.",{"type":18,"tag":80,"props":129,"children":130},{},[131,135],{"type":18,"tag":84,"props":132,"children":134},{"latex-express":133,"styles":87},"f(x,u)",[],{"type":24,"value":136}," is the state representation of the system.",{"type":18,"tag":80,"props":138,"children":139},{},[140,144],{"type":18,"tag":84,"props":141,"children":143},{"latex-express":142,"styles":87},"C(x,u)",[],{"type":24,"value":145},"  is the constraint of the system.",{"type":18,"tag":80,"props":147,"children":148},{},[149,153],{"type":18,"tag":84,"props":150,"children":152},{"latex-express":151,"styles":87},"\\lambda",[],{"type":24,"value":154},"  is the costate vector for state representation.",{"type":18,"tag":80,"props":156,"children":157},{},[158,162],{"type":18,"tag":84,"props":159,"children":161},{"latex-express":160,"styles":87},"\\mu",[],{"type":24,"value":163},"  is the Lagrange multiplier vector for the equality constraint.",{"type":18,"tag":27,"props":165,"children":166},{},[167,169,175,177],{"type":24,"value":168},"Nonlinear Model Predictive Control has multiples solving method, but in this demonstration I will stick with the Continuation/GMRES method proposed by professor ",{"type":18,"tag":170,"props":171,"children":172},"strong",{},[173],{"type":24,"value":174}," Toshiyuki Ohtsuka ",{"type":24,"value":176},". ",{"type":18,"tag":56,"props":178,"children":179},{},[],{"type":18,"tag":27,"props":181,"children":182},{},[183,185,189,191,196],{"type":24,"value":184},"Supposed we want to obtain solution vector ",{"type":18,"tag":84,"props":186,"children":188},{"latex-express":187,"styles":87},"U(t) = [ u_{0}^{*}, \\mu_{0}^{*}, \\cdots, u_{N-1}^{*}, \\mu_{N-1}^{*} ]",[],{"type":24,"value":190},"   at sampling time $t$, we then define the discretization of ",{"type":18,"tag":170,"props":192,"children":193},{},[194],{"type":24,"value":195}," Euler Lagrangian Equation (ELE) ",{"type":24,"value":197},".",{"type":18,"tag":65,"props":199,"children":202},{"latex-express":200,"style":201},"\n\\begin{align}\n    x_{i+1}^{*}(t) &= x_{i}^{*}(t) + f(x_{i}^{*}(t), u_{i}^{*}(t))  \\\\\n    \\lambda_{i}^{*}(t) &= \\lambda_{i+1}^{*}(t) + \\frac{\\partial H}{\\partial x}\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) \\\\\n    \\lambda_{N}^{*}(t) &= \\frac{\\partial \\phi(x)}{\\partial x} \\\\\n    \\frac{\\partial H}{\\partial u} &\\left( x_{i}^{*}, u_{i}^{*}(t), \\lambda_{i+1}^{*}(t), \\mu_{i}^{*}(t) \\right) = 0 \\\\\n    C&(x_{i}^{*}(t),u_{i}^{*}(t)) = 0\n\\end{align}\n","text-ceneter",[],{"type":18,"tag":27,"props":204,"children":205},{},[206,208],{"type":24,"value":207},"To solve this nonlinear problem iteratively, we use Newton's method ",{"type":18,"tag":84,"props":209,"children":211},{"latex-express":210,"styles":87},"F(x,u)=0",[],{"type":18,"tag":65,"props":213,"children":215},{"latex-express":214,"styles":68},"\n\\begin{equation*}\n    F(x,u) = \\begin{bmatrix}\n        \\frac{\\partial H}{\\partial u} \\left( x_{0}^{*}, u_{0}^{*}(t), \\lambda_{1}^{*}(t), \\mu_{0}^{*}(t) \\right) \\\\\n        C(x_{0}^{*}(t),u_{0}^{*}(t))  \\\\\n        \\vdots \\\\\n        \\frac{\\partial H}{\\partial u} \\left( x_{N-1}^{*}, u_{N-1}^{*}(t), \\lambda_{N}^{*}(t), \\mu_{N-1}^{*}(t) \\right) \\\\\n        C(x_{N-1}^{*}(t),u_{N-1}^{*}(t)) \\\\\n    \\end{bmatrix} = 0\n\\end{equation*}",[],{"type":18,"tag":27,"props":217,"children":218},{},[219,221,225],{"type":24,"value":220},"Solving this problem directly will caused big computational complexity, hence we use Continuation to reduce the complexity of the ",{"type":18,"tag":84,"props":222,"children":224},{"latex-express":223,"styles":87},"F(x,u)",[],{"type":24,"value":226}," function and then solve it by using GMRES method.",{"type":18,"tag":33,"props":228,"children":230},{"id":229},"continuation",[231],{"type":24,"value":232},"Continuation",{"type":18,"tag":27,"props":234,"children":235},{},[236,238],{"type":24,"value":237},"Denote  ",{"type":18,"tag":84,"props":239,"children":241},{"latex-express":240,"styles":87},"\\zeta, \\alpha, h \\in{\\mathbb{R} }",[],{"type":18,"tag":65,"props":243,"children":245},{"latex-express":244,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial F}{\\partial u}(x,u) \\dot{u}(t) = -\\zeta F(x,u)(t)-\\frac{\\partial F}{\\partial x}(x,u)(t)\\dot{x}-\\frac{\\partial F}{\\partial t}(x,u)(t) \n\\end{equation*}",[],{"type":18,"tag":27,"props":247,"children":248},{},[249,251,255,257],{"type":24,"value":250},"Let ",{"type":18,"tag":65,"props":252,"children":254},{"latex-express":253,"styles":68},"right=\\frac{F(x(t)+h\\dot{x}(t),u(t)+h\\dot{u}(t),t+h)-F(x+h\\dot{x}(t),u(t),t+h)}{h}",[],{"type":24,"value":256}," and ",{"type":18,"tag":65,"props":258,"children":260},{"latex-express":259,"styles":68},"left =  -\\zeta F(x(t),u(t), t) - \\frac{F(x+h\\dot{x}(t), u(t),t+h)-F(x(t), u(t), t)}{h}",[],{"type":18,"tag":33,"props":262,"children":264},{"id":263},"generalized-minimal-residue-method-gmres",[265],{"type":24,"value":266},"Generalized Minimal Residue Method (GMRES)",{"type":18,"tag":27,"props":268,"children":269},{},[270],{"type":24,"value":271},"The Generalized Minimal Residual (GMRES) algorithm is an iterative method for solving linear systems of equations. It is often used for large sparse linear systems.",{"type":18,"tag":273,"props":274,"children":276},"h4",{"id":275},"algorithm-description",[277],{"type":24,"value":278},"Algorithm Description",{"type":18,"tag":280,"props":281,"children":282},"ol",{},[283,338,445,464],{"type":18,"tag":80,"props":284,"children":285},{},[286,291,293],{"type":18,"tag":170,"props":287,"children":288},{},[289],{"type":24,"value":290},"Initialize",{"type":24,"value":292},":",{"type":18,"tag":76,"props":294,"children":295},{},[296,306,316],{"type":18,"tag":80,"props":297,"children":298},{},[299,301,305],{"type":24,"value":300},"Choose an initial guess for the solution, denoted as ",{"type":18,"tag":84,"props":302,"children":304},{"latex-express":303,"styles":87},"x_{0}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":307,"children":308},{},[309,311,315],{"type":24,"value":310},"Set the residual vector ",{"type":18,"tag":84,"props":312,"children":314},{"latex-express":313,"styles":87},"r_{0}=\\left\\| Ax_{0}-b \\right\\|",[],{"type":24,"value":197},{"type":18,"tag":80,"props":317,"children":318},{},[319,321,325,327,331,333,337],{"type":24,"value":320},"Set ",{"type":18,"tag":84,"props":322,"children":324},{"latex-express":323,"styles":87},"v_{1}=\\frac{r_{0} }{\\left\\| r_{0} \\right\\|}",[],{"type":24,"value":326},", where ",{"type":18,"tag":84,"props":328,"children":330},{"latex-express":329,"styles":87},"\\left\\| r_{0} \\right\\|",[],{"type":24,"value":332},"  is the norm of ",{"type":18,"tag":84,"props":334,"children":336},{"latex-express":335,"styles":87},"r_{0}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":339,"children":340},{},[341,346,347],{"type":18,"tag":170,"props":342,"children":343},{},[344],{"type":24,"value":345},"Iterative Process",{"type":24,"value":292},{"type":18,"tag":76,"props":348,"children":349},{},[350,360,434],{"type":18,"tag":80,"props":351,"children":352},{},[353,355,359],{"type":24,"value":354},"Choose a vector ",{"type":18,"tag":84,"props":356,"children":358},{"latex-express":357,"styles":87},"v_{1}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":361,"children":362},{},[363,365,369,371,375,376],{"type":24,"value":364},"For ",{"type":18,"tag":84,"props":366,"children":368},{"latex-express":367,"styles":87},"k=0",[],{"type":24,"value":370}," to ",{"type":18,"tag":84,"props":372,"children":374},{"latex-express":373,"styles":87},"maxiteration",[],{"type":24,"value":292},{"type":18,"tag":76,"props":377,"children":378},{},[379,415],{"type":18,"tag":80,"props":380,"children":381},{},[382,384],{"type":24,"value":383},"Arnoldi process:",{"type":18,"tag":76,"props":385,"children":386},{},[387,394,401,408],{"type":18,"tag":80,"props":388,"children":389},{},[390],{"type":18,"tag":84,"props":391,"children":393},{"latex-express":392,"styles":87},"h_{i,j} = \\left(Av_{j}, v_{i} \\right)",[],{"type":18,"tag":80,"props":395,"children":396},{},[397],{"type":18,"tag":84,"props":398,"children":400},{"latex-express":399,"styles":87},"\\hat{v}_{j+1} = Av_{j} - \\sum_{i=1}^{j}h_{i,j}v_{i}",[],{"type":18,"tag":80,"props":402,"children":403},{},[404],{"type":18,"tag":84,"props":405,"children":407},{"latex-express":406,"styles":87},"h_{j+1,j} = \\left \\| \\hat{v}_{j+1}  \\right\\|_{2}",[],{"type":18,"tag":80,"props":409,"children":410},{},[411],{"type":18,"tag":84,"props":412,"children":414},{"latex-express":413,"styles":87},"v_{j+1} = \\frac{\\hat{v}_{j+1} }{h_{j+1,j} }",[],{"type":18,"tag":80,"props":416,"children":417},{},[418,420],{"type":24,"value":419},"Check for convergence:",{"type":18,"tag":76,"props":421,"children":422},{},[423],{"type":18,"tag":80,"props":424,"children":425},{},[426,428,432],{"type":24,"value":427},"If ",{"type":18,"tag":84,"props":429,"children":431},{"latex-express":430,"styles":87},"||r_k|| \u003C tolerance",[],{"type":24,"value":433},", exit the loop.",{"type":18,"tag":80,"props":435,"children":436},{},[437,439,443],{"type":24,"value":438},"If no convergence is achieved after ",{"type":18,"tag":84,"props":440,"children":442},{"latex-express":441,"styles":87},"maxiterations",[],{"type":24,"value":444},", exit with an error message.",{"type":18,"tag":80,"props":446,"children":447},{},[448,457,459,463],{"type":18,"tag":170,"props":449,"children":450},{},[451,453],{"type":24,"value":452},"Find ",{"type":18,"tag":84,"props":454,"children":456},{"latex-express":455,"styles":87},"y",[],{"type":24,"value":458},": which minimize ",{"type":18,"tag":84,"props":460,"children":462},{"latex-express":461,"styles":87},"\\left\\| r_{0}e_{1}-\\hat{H}_{m}y \\right \\|_{2}",[],{"type":24,"value":197},{"type":18,"tag":80,"props":465,"children":466},{},[467,472,474,478],{"type":18,"tag":170,"props":468,"children":469},{},[470],{"type":24,"value":471},"Compute",{"type":24,"value":473},": ",{"type":18,"tag":84,"props":475,"children":477},{"latex-express":476,"styles":87},"x_{m} = x_{0}+V_{m}y_{m}",[],{"type":24,"value":197},{"type":18,"tag":27,"props":480,"children":481},{},[482,484,488],{"type":24,"value":483},"For example differential model, let ",{"type":18,"tag":84,"props":485,"children":487},{"latex-express":486,"styles":87},"x, y, \\phi",[],{"type":24,"value":489}," is the state presentation of the model\n$$ \\dot{x} = f(x,u) $$",{"type":18,"tag":27,"props":491,"children":492},{},[493],{"type":24,"value":494},"Then the HJBE defined as",{"type":18,"tag":65,"props":496,"children":498},{"latex-express":497,"styles":68},"\n\\begin{equation*}\n    H(x,u,\\lambda,\\mu) = \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref}) + \n                         \\phi(x) + \\lambda^{T}f(x,u) + \\mu^{T}C(x,u)\n\\end{equation*}\n",[],{"type":18,"tag":27,"props":500,"children":501},{},[502],{"type":24,"value":74},{"type":18,"tag":76,"props":504,"children":505},{},[506,513,520,527,534],{"type":18,"tag":80,"props":507,"children":508},{},[509],{"type":18,"tag":84,"props":510,"children":512},{"latex-express":511,"styles":87},"f(x,u) = \\begin{bmatrix} u_{1}*\\cos{(\\phi)} \\\\ u_{1}*\\sin{(\\phi)} \\\\ u_{2} \\end{bmatrix}",[],{"type":18,"tag":80,"props":514,"children":515},{},[516],{"type":18,"tag":84,"props":517,"children":519},{"latex-express":518,"styles":87},"C(x,u) = \\begin{bmatrix} \\left(u_{1}-\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min} }{2})^{2} \\\\\n          \\left(u_{2}-\\frac{u_{2max}+u_{2min} }{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2}\n\\end{bmatrix}",[],{"type":18,"tag":80,"props":521,"children":522},{},[523],{"type":18,"tag":84,"props":524,"children":526},{"latex-express":525,"styles":87},"\\phi(x) = (x_{N}-x_{N,ref})^{T}Q(x_{N}-x_{N,ref})",[],{"type":18,"tag":80,"props":528,"children":529},{},[530],{"type":18,"tag":84,"props":531,"children":533},{"latex-express":532,"styles":87},"\\lambda = \\begin{bmatrix} \\lambda_{1} & \\lambda_{2} & \\lambda_{3} \\end{bmatrix}",[],{"type":18,"tag":80,"props":535,"children":536},{},[537],{"type":18,"tag":84,"props":538,"children":540},{"latex-express":539,"styles":87}," \\mu = \\begin{bmatrix} \\mu_{1} & \\mu_{2} \\end{bmatrix}",[],{"type":18,"tag":27,"props":542,"children":543},{},[544],{"type":24,"value":545},"Subtitute all of these term into HJBE",{"type":18,"tag":65,"props":547,"children":549},{"latex-express":548,"styles":68},"\n\\begin{align*}\nH(x,u,\\lambda,\\mu) &= \\sum_{k=0}^{N-1}(x_{k}-x_{k,ref})^{T}Q(x_{k}-x_{k,ref}) + (u_{k}-u_{k,ref})^{T}R(u_{k}-u_{k,ref})\n                     + (x_{N}-x_{N,ref})^{T}Q(x_{N}-x_{N,ref}) \\\\ & + \\begin{bmatrix} \\lambda_{1} \\\\ \\lambda_{2} \\\\ \\lambda_{3} \\end{bmatrix}^{T} \\begin{bmatrix} u_{1}*\\cos(\\phi) \\\\ u_{1}*\\sin(\\phi) \\\\ u_{2} \\end{bmatrix}\n                     + \\begin{bmatrix} \\mu_{1} \\\\ \\mu_{2} \\end{bmatrix}^{T} \\begin{bmatrix} \\left(u_{1}-\\frac{u_{1max}+u_{1min}}{2}\\right)^{2}+u_{1dummy}^{2}-(\\frac{u_{1max}-u_{1min}}{2})^{2} \\\\\n            \\left(u_{2}\\frac{u_{2max}+u_{2min}}{2}\\right)^{2}+u_{2dummy}^{2}-(\\frac{u_{2max}-u_{2min}}{2})^{2} \n\\end{bmatrix}\n\\end{align*}",[],{"type":18,"tag":27,"props":551,"children":552},{},[553],{"type":24,"value":554},"By doing partial derivative of HJBE, we get",{"type":18,"tag":273,"props":556,"children":558},{"id":557},"hamiltonian-respect-to-states",[559,561],{"type":24,"value":560},"Hamiltonian respect to states ",{"type":18,"tag":84,"props":562,"children":564},{"latex-express":563,"styles":87},"\\frac{\\partial H}{\\partial x}",[],{"type":18,"tag":65,"props":566,"children":568},{"latex-express":567,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial x} = \\begin{bmatrix}\n     (x-x_{ref})q_{1} \\\\\n     (y-y_{ref})q_{2} \\\\ \n     (\\phi-\\phi_{ref})q_{3} - \\lambda_{1}\\sin{(\\phi)}u_{1} + \\lambda_{2}\\cos{(\\phi)}u_{1}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":18,"tag":273,"props":570,"children":572},{"id":571},"hamiltonian-respect-to-input-control",[573,575],{"type":24,"value":574},"Hamiltonian respect to input control ",{"type":18,"tag":84,"props":576,"children":577},{"latex-express":563,"styles":87},[],{"type":18,"tag":65,"props":579,"children":581},{"latex-express":580,"styles":68},"\n\\begin{equation*}\n    \\frac{\\partial H}{\\partial u} = \\begin{bmatrix}\n      (u_{1}-u_{1,ref})r_{1}+\\lambda_{1}\\cos{(\\phi)}+\\lambda_{2}\\sin{(\\phi)} \\\\ \n      (u_{2}-u_{2,ref})r_{2}+\\lambda_{3}\n     \\end{bmatrix}\n\\end{equation*}\n",[],{"type":18,"tag":27,"props":583,"children":584},{},[585],{"type":24,"value":586},"I know this is quite complicated, this is just only input control without constraint and solver with single shooting method.",{"type":18,"tag":19,"props":588,"children":590},{"id":589},"implementing-in-python",[591],{"type":24,"value":592},"Implementing in Python",{"type":18,"tag":27,"props":594,"children":595},{},[596,598],{"type":24,"value":597},"It is safe to say that you will need to start from basic first. Like creating class for model representation, but for now I will just go with CGMRES implementing only, since I have done many demonstration of how to create class for model. ",{"type":18,"tag":56,"props":599,"children":600},{},[],{"type":18,"tag":27,"props":602,"children":603},{},[604,606,611],{"type":24,"value":605},"Let's create class for ",{"type":18,"tag":170,"props":607,"children":608},{},[609],{"type":24,"value":610}," Hamiltion Jacobian Bellman Equation ",{"type":24,"value":612}," which we already derived from above equation.",{"type":18,"tag":614,"props":615,"children":620},"code",{"className":616,"code":618,"language":619,"meta":8},[617],"language-python","class HJBEquation:\n\n    def __init__(self, q1, q2, q3, r1, r2, u_max, u_min):\n\n        self.q1 = q1\n        self.q2 = q2\n        self.q3 = q3\n\n        self.r1 = r1\n        self.r2 = r2\n\n        self.u1_min = u_min[0]\n        self.u2_min = u_min[0]\n\n        self.u1_max = u_max[0]\n        self.u2_max = u_max[1]\n\n    def dhdx(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n\n        dhdx1 = (x-x_r)*self.q1\n        dhdx2 = (y-y_r)*self.q2\n        dhdx3 = (yaw-yaw_r)*self.q3-u1*lam1*np.sin(yaw)+u1*lam2*np.cos(yaw)\n\n        return dhdx1, dhdx2, dhdx3\n\n    def dhdu(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n\n        dhdu1 = self.r1*(u1-u1_r)+lam1*np.cos(yaw)+lam2*np.sin(yaw)+2*mu1*u1*(u1+(self.u1_max+self.u1_min)/2)\n        dhdu2 = self.r2*(u2-u2_r)+lam3+2*mu2*(u2+(self.u2_max+self.u2_min)/2)\n\n        return dhdu1, dhdu2\n\n    def dphidx(self, x, y, yaw, x_r, y_r, yaw_r):\n        dphidx1 = self.q1*(x-x_r)\n        dphidx2 = self.q2*(y-y_r)\n        dphidx3 = self.q3*(yaw-yaw_r)\n\n        return dphidx1, dphidx2, dphidx3\n","python",[621],{"type":18,"tag":622,"props":623,"children":624},"pre",{},[625],{"type":18,"tag":614,"props":626,"children":627},{"__ignoreMap":8},[628,657,666,695,703,732,758,784,792,818,844,852,888,921,929,963,997,1005,1031,1039,1081,1121,1215,1223,1241,1249,1275,1283,1439,1559,1567,1584,1592,1618,1662,1706,1749,1757],{"type":18,"tag":629,"props":630,"children":633},"span",{"class":631,"line":632},"line",1,[634,640,646,652],{"type":18,"tag":629,"props":635,"children":637},{"class":636},"ct-857441",[638],{"type":24,"value":639},"class",{"type":18,"tag":629,"props":641,"children":643},{"class":642},"ct-767297",[644],{"type":24,"value":645}," ",{"type":18,"tag":629,"props":647,"children":649},{"class":648},"ct-806137",[650],{"type":24,"value":651},"HJBEquation",{"type":18,"tag":629,"props":653,"children":654},{"class":642},[655],{"type":24,"value":656},":\n",{"type":18,"tag":629,"props":658,"children":660},{"class":631,"line":659},2,[661],{"type":18,"tag":629,"props":662,"children":663},{},[664],{"type":24,"value":665},"\n",{"type":18,"tag":629,"props":667,"children":669},{"class":631,"line":668},3,[670,675,680,684,690],{"type":18,"tag":629,"props":671,"children":672},{"class":642},[673],{"type":24,"value":674},"    ",{"type":18,"tag":629,"props":676,"children":677},{"class":636},[678],{"type":24,"value":679},"def",{"type":18,"tag":629,"props":681,"children":682},{"class":642},[683],{"type":24,"value":645},{"type":18,"tag":629,"props":685,"children":687},{"class":686},"ct-533739",[688],{"type":24,"value":689},"__init__",{"type":18,"tag":629,"props":691,"children":692},{"class":642},[693],{"type":24,"value":694},"(self, q1, q2, q3, r1, r2, u_max, u_min):\n",{"type":18,"tag":629,"props":696,"children":698},{"class":631,"line":697},4,[699],{"type":18,"tag":629,"props":700,"children":701},{},[702],{"type":24,"value":665},{"type":18,"tag":629,"props":704,"children":706},{"class":631,"line":705},5,[707,712,717,722,727],{"type":18,"tag":629,"props":708,"children":709},{"class":642},[710],{"type":24,"value":711},"        ",{"type":18,"tag":629,"props":713,"children":714},{"class":686},[715],{"type":24,"value":716},"self",{"type":18,"tag":629,"props":718,"children":719},{"class":642},[720],{"type":24,"value":721},".q1 ",{"type":18,"tag":629,"props":723,"children":724},{"class":636},[725],{"type":24,"value":726},"=",{"type":18,"tag":629,"props":728,"children":729},{"class":642},[730],{"type":24,"value":731}," q1\n",{"type":18,"tag":629,"props":733,"children":735},{"class":631,"line":734},6,[736,740,744,749,753],{"type":18,"tag":629,"props":737,"children":738},{"class":642},[739],{"type":24,"value":711},{"type":18,"tag":629,"props":741,"children":742},{"class":686},[743],{"type":24,"value":716},{"type":18,"tag":629,"props":745,"children":746},{"class":642},[747],{"type":24,"value":748},".q2 ",{"type":18,"tag":629,"props":750,"children":751},{"class":636},[752],{"type":24,"value":726},{"type":18,"tag":629,"props":754,"children":755},{"class":642},[756],{"type":24,"value":757}," q2\n",{"type":18,"tag":629,"props":759,"children":761},{"class":631,"line":760},7,[762,766,770,775,779],{"type":18,"tag":629,"props":763,"children":764},{"class":642},[765],{"type":24,"value":711},{"type":18,"tag":629,"props":767,"children":768},{"class":686},[769],{"type":24,"value":716},{"type":18,"tag":629,"props":771,"children":772},{"class":642},[773],{"type":24,"value":774},".q3 ",{"type":18,"tag":629,"props":776,"children":777},{"class":636},[778],{"type":24,"value":726},{"type":18,"tag":629,"props":780,"children":781},{"class":642},[782],{"type":24,"value":783}," q3\n",{"type":18,"tag":629,"props":785,"children":787},{"class":631,"line":786},8,[788],{"type":18,"tag":629,"props":789,"children":790},{},[791],{"type":24,"value":665},{"type":18,"tag":629,"props":793,"children":795},{"class":631,"line":794},9,[796,800,804,809,813],{"type":18,"tag":629,"props":797,"children":798},{"class":642},[799],{"type":24,"value":711},{"type":18,"tag":629,"props":801,"children":802},{"class":686},[803],{"type":24,"value":716},{"type":18,"tag":629,"props":805,"children":806},{"class":642},[807],{"type":24,"value":808},".r1 ",{"type":18,"tag":629,"props":810,"children":811},{"class":636},[812],{"type":24,"value":726},{"type":18,"tag":629,"props":814,"children":815},{"class":642},[816],{"type":24,"value":817}," r1\n",{"type":18,"tag":629,"props":819,"children":821},{"class":631,"line":820},10,[822,826,830,835,839],{"type":18,"tag":629,"props":823,"children":824},{"class":642},[825],{"type":24,"value":711},{"type":18,"tag":629,"props":827,"children":828},{"class":686},[829],{"type":24,"value":716},{"type":18,"tag":629,"props":831,"children":832},{"class":642},[833],{"type":24,"value":834},".r2 ",{"type":18,"tag":629,"props":836,"children":837},{"class":636},[838],{"type":24,"value":726},{"type":18,"tag":629,"props":840,"children":841},{"class":642},[842],{"type":24,"value":843}," r2\n",{"type":18,"tag":629,"props":845,"children":847},{"class":631,"line":846},11,[848],{"type":18,"tag":629,"props":849,"children":850},{},[851],{"type":24,"value":665},{"type":18,"tag":629,"props":853,"children":855},{"class":631,"line":854},12,[856,860,864,869,873,878,883],{"type":18,"tag":629,"props":857,"children":858},{"class":642},[859],{"type":24,"value":711},{"type":18,"tag":629,"props":861,"children":862},{"class":686},[863],{"type":24,"value":716},{"type":18,"tag":629,"props":865,"children":866},{"class":642},[867],{"type":24,"value":868},".u1_min ",{"type":18,"tag":629,"props":870,"children":871},{"class":636},[872],{"type":24,"value":726},{"type":18,"tag":629,"props":874,"children":875},{"class":642},[876],{"type":24,"value":877}," u_min[",{"type":18,"tag":629,"props":879,"children":880},{"class":686},[881],{"type":24,"value":882},"0",{"type":18,"tag":629,"props":884,"children":885},{"class":642},[886],{"type":24,"value":887},"]\n",{"type":18,"tag":629,"props":889,"children":891},{"class":631,"line":890},13,[892,896,900,905,909,913,917],{"type":18,"tag":629,"props":893,"children":894},{"class":642},[895],{"type":24,"value":711},{"type":18,"tag":629,"props":897,"children":898},{"class":686},[899],{"type":24,"value":716},{"type":18,"tag":629,"props":901,"children":902},{"class":642},[903],{"type":24,"value":904},".u2_min ",{"type":18,"tag":629,"props":906,"children":907},{"class":636},[908],{"type":24,"value":726},{"type":18,"tag":629,"props":910,"children":911},{"class":642},[912],{"type":24,"value":877},{"type":18,"tag":629,"props":914,"children":915},{"class":686},[916],{"type":24,"value":882},{"type":18,"tag":629,"props":918,"children":919},{"class":642},[920],{"type":24,"value":887},{"type":18,"tag":629,"props":922,"children":924},{"class":631,"line":923},14,[925],{"type":18,"tag":629,"props":926,"children":927},{},[928],{"type":24,"value":665},{"type":18,"tag":629,"props":930,"children":932},{"class":631,"line":931},15,[933,937,941,946,950,955,959],{"type":18,"tag":629,"props":934,"children":935},{"class":642},[936],{"type":24,"value":711},{"type":18,"tag":629,"props":938,"children":939},{"class":686},[940],{"type":24,"value":716},{"type":18,"tag":629,"props":942,"children":943},{"class":642},[944],{"type":24,"value":945},".u1_max ",{"type":18,"tag":629,"props":947,"children":948},{"class":636},[949],{"type":24,"value":726},{"type":18,"tag":629,"props":951,"children":952},{"class":642},[953],{"type":24,"value":954}," u_max[",{"type":18,"tag":629,"props":956,"children":957},{"class":686},[958],{"type":24,"value":882},{"type":18,"tag":629,"props":960,"children":961},{"class":642},[962],{"type":24,"value":887},{"type":18,"tag":629,"props":964,"children":966},{"class":631,"line":965},16,[967,971,975,980,984,988,993],{"type":18,"tag":629,"props":968,"children":969},{"class":642},[970],{"type":24,"value":711},{"type":18,"tag":629,"props":972,"children":973},{"class":686},[974],{"type":24,"value":716},{"type":18,"tag":629,"props":976,"children":977},{"class":642},[978],{"type":24,"value":979},".u2_max ",{"type":18,"tag":629,"props":981,"children":982},{"class":636},[983],{"type":24,"value":726},{"type":18,"tag":629,"props":985,"children":986},{"class":642},[987],{"type":24,"value":954},{"type":18,"tag":629,"props":989,"children":990},{"class":686},[991],{"type":24,"value":992},"1",{"type":18,"tag":629,"props":994,"children":995},{"class":642},[996],{"type":24,"value":887},{"type":18,"tag":629,"props":998,"children":1000},{"class":631,"line":999},17,[1001],{"type":18,"tag":629,"props":1002,"children":1003},{},[1004],{"type":24,"value":665},{"type":18,"tag":629,"props":1006,"children":1008},{"class":631,"line":1007},18,[1009,1013,1017,1021,1026],{"type":18,"tag":629,"props":1010,"children":1011},{"class":642},[1012],{"type":24,"value":674},{"type":18,"tag":629,"props":1014,"children":1015},{"class":636},[1016],{"type":24,"value":679},{"type":18,"tag":629,"props":1018,"children":1019},{"class":642},[1020],{"type":24,"value":645},{"type":18,"tag":629,"props":1022,"children":1023},{"class":648},[1024],{"type":24,"value":1025},"dhdx",{"type":18,"tag":629,"props":1027,"children":1028},{"class":642},[1029],{"type":24,"value":1030},"(self, x, y, yaw, x_r, y_r, yaw_r, u1, lam1, lam2):\n",{"type":18,"tag":629,"props":1032,"children":1034},{"class":631,"line":1033},19,[1035],{"type":18,"tag":629,"props":1036,"children":1037},{},[1038],{"type":24,"value":665},{"type":18,"tag":629,"props":1040,"children":1042},{"class":631,"line":1041},20,[1043,1048,1052,1057,1062,1067,1072,1076],{"type":18,"tag":629,"props":1044,"children":1045},{"class":642},[1046],{"type":24,"value":1047},"        dhdx1 ",{"type":18,"tag":629,"props":1049,"children":1050},{"class":636},[1051],{"type":24,"value":726},{"type":18,"tag":629,"props":1053,"children":1054},{"class":642},[1055],{"type":24,"value":1056}," (x",{"type":18,"tag":629,"props":1058,"children":1059},{"class":636},[1060],{"type":24,"value":1061},"-",{"type":18,"tag":629,"props":1063,"children":1064},{"class":642},[1065],{"type":24,"value":1066},"x_r)",{"type":18,"tag":629,"props":1068,"children":1069},{"class":636},[1070],{"type":24,"value":1071},"*",{"type":18,"tag":629,"props":1073,"children":1074},{"class":686},[1075],{"type":24,"value":716},{"type":18,"tag":629,"props":1077,"children":1078},{"class":642},[1079],{"type":24,"value":1080},".q1\n",{"type":18,"tag":629,"props":1082,"children":1084},{"class":631,"line":1083},21,[1085,1090,1094,1099,1103,1108,1112,1116],{"type":18,"tag":629,"props":1086,"children":1087},{"class":642},[1088],{"type":24,"value":1089},"        dhdx2 ",{"type":18,"tag":629,"props":1091,"children":1092},{"class":636},[1093],{"type":24,"value":726},{"type":18,"tag":629,"props":1095,"children":1096},{"class":642},[1097],{"type":24,"value":1098}," (y",{"type":18,"tag":629,"props":1100,"children":1101},{"class":636},[1102],{"type":24,"value":1061},{"type":18,"tag":629,"props":1104,"children":1105},{"class":642},[1106],{"type":24,"value":1107},"y_r)",{"type":18,"tag":629,"props":1109,"children":1110},{"class":636},[1111],{"type":24,"value":1071},{"type":18,"tag":629,"props":1113,"children":1114},{"class":686},[1115],{"type":24,"value":716},{"type":18,"tag":629,"props":1117,"children":1118},{"class":642},[1119],{"type":24,"value":1120},".q2\n",{"type":18,"tag":629,"props":1122,"children":1124},{"class":631,"line":1123},22,[1125,1130,1134,1139,1143,1148,1152,1156,1161,1165,1170,1174,1179,1183,1188,1193,1197,1201,1206,1210],{"type":18,"tag":629,"props":1126,"children":1127},{"class":642},[1128],{"type":24,"value":1129},"        dhdx3 ",{"type":18,"tag":629,"props":1131,"children":1132},{"class":636},[1133],{"type":24,"value":726},{"type":18,"tag":629,"props":1135,"children":1136},{"class":642},[1137],{"type":24,"value":1138}," (yaw",{"type":18,"tag":629,"props":1140,"children":1141},{"class":636},[1142],{"type":24,"value":1061},{"type":18,"tag":629,"props":1144,"children":1145},{"class":642},[1146],{"type":24,"value":1147},"yaw_r)",{"type":18,"tag":629,"props":1149,"children":1150},{"class":636},[1151],{"type":24,"value":1071},{"type":18,"tag":629,"props":1153,"children":1154},{"class":686},[1155],{"type":24,"value":716},{"type":18,"tag":629,"props":1157,"children":1158},{"class":642},[1159],{"type":24,"value":1160},".q3",{"type":18,"tag":629,"props":1162,"children":1163},{"class":636},[1164],{"type":24,"value":1061},{"type":18,"tag":629,"props":1166,"children":1167},{"class":642},[1168],{"type":24,"value":1169},"u1",{"type":18,"tag":629,"props":1171,"children":1172},{"class":636},[1173],{"type":24,"value":1071},{"type":18,"tag":629,"props":1175,"children":1176},{"class":642},[1177],{"type":24,"value":1178},"lam1",{"type":18,"tag":629,"props":1180,"children":1181},{"class":636},[1182],{"type":24,"value":1071},{"type":18,"tag":629,"props":1184,"children":1185},{"class":642},[1186],{"type":24,"value":1187},"np.sin(yaw)",{"type":18,"tag":629,"props":1189,"children":1190},{"class":636},[1191],{"type":24,"value":1192},"+",{"type":18,"tag":629,"props":1194,"children":1195},{"class":642},[1196],{"type":24,"value":1169},{"type":18,"tag":629,"props":1198,"children":1199},{"class":636},[1200],{"type":24,"value":1071},{"type":18,"tag":629,"props":1202,"children":1203},{"class":642},[1204],{"type":24,"value":1205},"lam2",{"type":18,"tag":629,"props":1207,"children":1208},{"class":636},[1209],{"type":24,"value":1071},{"type":18,"tag":629,"props":1211,"children":1212},{"class":642},[1213],{"type":24,"value":1214},"np.cos(yaw)\n",{"type":18,"tag":629,"props":1216,"children":1218},{"class":631,"line":1217},23,[1219],{"type":18,"tag":629,"props":1220,"children":1221},{},[1222],{"type":24,"value":665},{"type":18,"tag":629,"props":1224,"children":1226},{"class":631,"line":1225},24,[1227,1231,1236],{"type":18,"tag":629,"props":1228,"children":1229},{"class":642},[1230],{"type":24,"value":711},{"type":18,"tag":629,"props":1232,"children":1233},{"class":636},[1234],{"type":24,"value":1235},"return",{"type":18,"tag":629,"props":1237,"children":1238},{"class":642},[1239],{"type":24,"value":1240}," dhdx1, dhdx2, dhdx3\n",{"type":18,"tag":629,"props":1242,"children":1244},{"class":631,"line":1243},25,[1245],{"type":18,"tag":629,"props":1246,"children":1247},{},[1248],{"type":24,"value":665},{"type":18,"tag":629,"props":1250,"children":1252},{"class":631,"line":1251},26,[1253,1257,1261,1265,1270],{"type":18,"tag":629,"props":1254,"children":1255},{"class":642},[1256],{"type":24,"value":674},{"type":18,"tag":629,"props":1258,"children":1259},{"class":636},[1260],{"type":24,"value":679},{"type":18,"tag":629,"props":1262,"children":1263},{"class":642},[1264],{"type":24,"value":645},{"type":18,"tag":629,"props":1266,"children":1267},{"class":648},[1268],{"type":24,"value":1269},"dhdu",{"type":18,"tag":629,"props":1271,"children":1272},{"class":642},[1273],{"type":24,"value":1274},"(self, yaw, u1, u2, u1_r, u2_r, lam1, lam2, lam3, mu1, mu2):\n",{"type":18,"tag":629,"props":1276,"children":1278},{"class":631,"line":1277},27,[1279],{"type":18,"tag":629,"props":1280,"children":1281},{},[1282],{"type":24,"value":665},{"type":18,"tag":629,"props":1284,"children":1286},{"class":631,"line":1285},28,[1287,1292,1296,1300,1304,1309,1313,1318,1322,1327,1331,1335,1339,1344,1348,1352,1356,1360,1364,1369,1373,1378,1382,1386,1390,1394,1398,1403,1407,1412,1416,1420,1425,1430,1434],{"type":18,"tag":629,"props":1288,"children":1289},{"class":642},[1290],{"type":24,"value":1291},"        dhdu1 ",{"type":18,"tag":629,"props":1293,"children":1294},{"class":636},[1295],{"type":24,"value":726},{"type":18,"tag":629,"props":1297,"children":1298},{"class":642},[1299],{"type":24,"value":645},{"type":18,"tag":629,"props":1301,"children":1302},{"class":686},[1303],{"type":24,"value":716},{"type":18,"tag":629,"props":1305,"children":1306},{"class":642},[1307],{"type":24,"value":1308},".r1",{"type":18,"tag":629,"props":1310,"children":1311},{"class":636},[1312],{"type":24,"value":1071},{"type":18,"tag":629,"props":1314,"children":1315},{"class":642},[1316],{"type":24,"value":1317},"(u1",{"type":18,"tag":629,"props":1319,"children":1320},{"class":636},[1321],{"type":24,"value":1061},{"type":18,"tag":629,"props":1323,"children":1324},{"class":642},[1325],{"type":24,"value":1326},"u1_r)",{"type":18,"tag":629,"props":1328,"children":1329},{"class":636},[1330],{"type":24,"value":1192},{"type":18,"tag":629,"props":1332,"children":1333},{"class":642},[1334],{"type":24,"value":1178},{"type":18,"tag":629,"props":1336,"children":1337},{"class":636},[1338],{"type":24,"value":1071},{"type":18,"tag":629,"props":1340,"children":1341},{"class":642},[1342],{"type":24,"value":1343},"np.cos(yaw)",{"type":18,"tag":629,"props":1345,"children":1346},{"class":636},[1347],{"type":24,"value":1192},{"type":18,"tag":629,"props":1349,"children":1350},{"class":642},[1351],{"type":24,"value":1205},{"type":18,"tag":629,"props":1353,"children":1354},{"class":636},[1355],{"type":24,"value":1071},{"type":18,"tag":629,"props":1357,"children":1358},{"class":642},[1359],{"type":24,"value":1187},{"type":18,"tag":629,"props":1361,"children":1362},{"class":636},[1363],{"type":24,"value":1192},{"type":18,"tag":629,"props":1365,"children":1366},{"class":686},[1367],{"type":24,"value":1368},"2",{"type":18,"tag":629,"props":1370,"children":1371},{"class":636},[1372],{"type":24,"value":1071},{"type":18,"tag":629,"props":1374,"children":1375},{"class":642},[1376],{"type":24,"value":1377},"mu1",{"type":18,"tag":629,"props":1379,"children":1380},{"class":636},[1381],{"type":24,"value":1071},{"type":18,"tag":629,"props":1383,"children":1384},{"class":642},[1385],{"type":24,"value":1169},{"type":18,"tag":629,"props":1387,"children":1388},{"class":636},[1389],{"type":24,"value":1071},{"type":18,"tag":629,"props":1391,"children":1392},{"class":642},[1393],{"type":24,"value":1317},{"type":18,"tag":629,"props":1395,"children":1396},{"class":636},[1397],{"type":24,"value":1192},{"type":18,"tag":629,"props":1399,"children":1400},{"class":642},[1401],{"type":24,"value":1402},"(",{"type":18,"tag":629,"props":1404,"children":1405},{"class":686},[1406],{"type":24,"value":716},{"type":18,"tag":629,"props":1408,"children":1409},{"class":642},[1410],{"type":24,"value":1411},".u1_max",{"type":18,"tag":629,"props":1413,"children":1414},{"class":636},[1415],{"type":24,"value":1192},{"type":18,"tag":629,"props":1417,"children":1418},{"class":686},[1419],{"type":24,"value":716},{"type":18,"tag":629,"props":1421,"children":1422},{"class":642},[1423],{"type":24,"value":1424},".u1_min)",{"type":18,"tag":629,"props":1426,"children":1427},{"class":636},[1428],{"type":24,"value":1429},"/",{"type":18,"tag":629,"props":1431,"children":1432},{"class":686},[1433],{"type":24,"value":1368},{"type":18,"tag":629,"props":1435,"children":1436},{"class":642},[1437],{"type":24,"value":1438},")\n",{"type":18,"tag":629,"props":1440,"children":1442},{"class":631,"line":1441},29,[1443,1448,1452,1456,1460,1465,1469,1474,1478,1483,1487,1492,1496,1500,1504,1509,1513,1517,1521,1525,1529,1534,1538,1542,1547,1551,1555],{"type":18,"tag":629,"props":1444,"children":1445},{"class":642},[1446],{"type":24,"value":1447},"        dhdu2 ",{"type":18,"tag":629,"props":1449,"children":1450},{"class":636},[1451],{"type":24,"value":726},{"type":18,"tag":629,"props":1453,"children":1454},{"class":642},[1455],{"type":24,"value":645},{"type":18,"tag":629,"props":1457,"children":1458},{"class":686},[1459],{"type":24,"value":716},{"type":18,"tag":629,"props":1461,"children":1462},{"class":642},[1463],{"type":24,"value":1464},".r2",{"type":18,"tag":629,"props":1466,"children":1467},{"class":636},[1468],{"type":24,"value":1071},{"type":18,"tag":629,"props":1470,"children":1471},{"class":642},[1472],{"type":24,"value":1473},"(u2",{"type":18,"tag":629,"props":1475,"children":1476},{"class":636},[1477],{"type":24,"value":1061},{"type":18,"tag":629,"props":1479,"children":1480},{"class":642},[1481],{"type":24,"value":1482},"u2_r)",{"type":18,"tag":629,"props":1484,"children":1485},{"class":636},[1486],{"type":24,"value":1192},{"type":18,"tag":629,"props":1488,"children":1489},{"class":642},[1490],{"type":24,"value":1491},"lam3",{"type":18,"tag":629,"props":1493,"children":1494},{"class":636},[1495],{"type":24,"value":1192},{"type":18,"tag":629,"props":1497,"children":1498},{"class":686},[1499],{"type":24,"value":1368},{"type":18,"tag":629,"props":1501,"children":1502},{"class":636},[1503],{"type":24,"value":1071},{"type":18,"tag":629,"props":1505,"children":1506},{"class":642},[1507],{"type":24,"value":1508},"mu2",{"type":18,"tag":629,"props":1510,"children":1511},{"class":636},[1512],{"type":24,"value":1071},{"type":18,"tag":629,"props":1514,"children":1515},{"class":642},[1516],{"type":24,"value":1473},{"type":18,"tag":629,"props":1518,"children":1519},{"class":636},[1520],{"type":24,"value":1192},{"type":18,"tag":629,"props":1522,"children":1523},{"class":642},[1524],{"type":24,"value":1402},{"type":18,"tag":629,"props":1526,"children":1527},{"class":686},[1528],{"type":24,"value":716},{"type":18,"tag":629,"props":1530,"children":1531},{"class":642},[1532],{"type":24,"value":1533},".u2_max",{"type":18,"tag":629,"props":1535,"children":1536},{"class":636},[1537],{"type":24,"value":1192},{"type":18,"tag":629,"props":1539,"children":1540},{"class":686},[1541],{"type":24,"value":716},{"type":18,"tag":629,"props":1543,"children":1544},{"class":642},[1545],{"type":24,"value":1546},".u2_min)",{"type":18,"tag":629,"props":1548,"children":1549},{"class":636},[1550],{"type":24,"value":1429},{"type":18,"tag":629,"props":1552,"children":1553},{"class":686},[1554],{"type":24,"value":1368},{"type":18,"tag":629,"props":1556,"children":1557},{"class":642},[1558],{"type":24,"value":1438},{"type":18,"tag":629,"props":1560,"children":1562},{"class":631,"line":1561},30,[1563],{"type":18,"tag":629,"props":1564,"children":1565},{},[1566],{"type":24,"value":665},{"type":18,"tag":629,"props":1568,"children":1570},{"class":631,"line":1569},31,[1571,1575,1579],{"type":18,"tag":629,"props":1572,"children":1573},{"class":642},[1574],{"type":24,"value":711},{"type":18,"tag":629,"props":1576,"children":1577},{"class":636},[1578],{"type":24,"value":1235},{"type":18,"tag":629,"props":1580,"children":1581},{"class":642},[1582],{"type":24,"value":1583}," dhdu1, dhdu2\n",{"type":18,"tag":629,"props":1585,"children":1587},{"class":631,"line":1586},32,[1588],{"type":18,"tag":629,"props":1589,"children":1590},{},[1591],{"type":24,"value":665},{"type":18,"tag":629,"props":1593,"children":1595},{"class":631,"line":1594},33,[1596,1600,1604,1608,1613],{"type":18,"tag":629,"props":1597,"children":1598},{"class":642},[1599],{"type":24,"value":674},{"type":18,"tag":629,"props":1601,"children":1602},{"class":636},[1603],{"type":24,"value":679},{"type":18,"tag":629,"props":1605,"children":1606},{"class":642},[1607],{"type":24,"value":645},{"type":18,"tag":629,"props":1609,"children":1610},{"class":648},[1611],{"type":24,"value":1612},"dphidx",{"type":18,"tag":629,"props":1614,"children":1615},{"class":642},[1616],{"type":24,"value":1617},"(self, x, y, yaw, x_r, y_r, yaw_r):\n",{"type":18,"tag":629,"props":1619,"children":1621},{"class":631,"line":1620},34,[1622,1627,1631,1635,1639,1644,1648,1653,1657],{"type":18,"tag":629,"props":1623,"children":1624},{"class":642},[1625],{"type":24,"value":1626},"        dphidx1 ",{"type":18,"tag":629,"props":1628,"children":1629},{"class":636},[1630],{"type":24,"value":726},{"type":18,"tag":629,"props":1632,"children":1633},{"class":642},[1634],{"type":24,"value":645},{"type":18,"tag":629,"props":1636,"children":1637},{"class":686},[1638],{"type":24,"value":716},{"type":18,"tag":629,"props":1640,"children":1641},{"class":642},[1642],{"type":24,"value":1643},".q1",{"type":18,"tag":629,"props":1645,"children":1646},{"class":636},[1647],{"type":24,"value":1071},{"type":18,"tag":629,"props":1649,"children":1650},{"class":642},[1651],{"type":24,"value":1652},"(x",{"type":18,"tag":629,"props":1654,"children":1655},{"class":636},[1656],{"type":24,"value":1061},{"type":18,"tag":629,"props":1658,"children":1659},{"class":642},[1660],{"type":24,"value":1661},"x_r)\n",{"type":18,"tag":629,"props":1663,"children":1665},{"class":631,"line":1664},35,[1666,1671,1675,1679,1683,1688,1692,1697,1701],{"type":18,"tag":629,"props":1667,"children":1668},{"class":642},[1669],{"type":24,"value":1670},"        dphidx2 ",{"type":18,"tag":629,"props":1672,"children":1673},{"class":636},[1674],{"type":24,"value":726},{"type":18,"tag":629,"props":1676,"children":1677},{"class":642},[1678],{"type":24,"value":645},{"type":18,"tag":629,"props":1680,"children":1681},{"class":686},[1682],{"type":24,"value":716},{"type":18,"tag":629,"props":1684,"children":1685},{"class":642},[1686],{"type":24,"value":1687},".q2",{"type":18,"tag":629,"props":1689,"children":1690},{"class":636},[1691],{"type":24,"value":1071},{"type":18,"tag":629,"props":1693,"children":1694},{"class":642},[1695],{"type":24,"value":1696},"(y",{"type":18,"tag":629,"props":1698,"children":1699},{"class":636},[1700],{"type":24,"value":1061},{"type":18,"tag":629,"props":1702,"children":1703},{"class":642},[1704],{"type":24,"value":1705},"y_r)\n",{"type":18,"tag":629,"props":1707,"children":1709},{"class":631,"line":1708},36,[1710,1715,1719,1723,1727,1731,1735,1740,1744],{"type":18,"tag":629,"props":1711,"children":1712},{"class":642},[1713],{"type":24,"value":1714},"        dphidx3 ",{"type":18,"tag":629,"props":1716,"children":1717},{"class":636},[1718],{"type":24,"value":726},{"type":18,"tag":629,"props":1720,"children":1721},{"class":642},[1722],{"type":24,"value":645},{"type":18,"tag":629,"props":1724,"children":1725},{"class":686},[1726],{"type":24,"value":716},{"type":18,"tag":629,"props":1728,"children":1729},{"class":642},[1730],{"type":24,"value":1160},{"type":18,"tag":629,"props":1732,"children":1733},{"class":636},[1734],{"type":24,"value":1071},{"type":18,"tag":629,"props":1736,"children":1737},{"class":642},[1738],{"type":24,"value":1739},"(yaw",{"type":18,"tag":629,"props":1741,"children":1742},{"class":636},[1743],{"type":24,"value":1061},{"type":18,"tag":629,"props":1745,"children":1746},{"class":642},[1747],{"type":24,"value":1748},"yaw_r)\n",{"type":18,"tag":629,"props":1750,"children":1752},{"class":631,"line":1751},37,[1753],{"type":18,"tag":629,"props":1754,"children":1755},{},[1756],{"type":24,"value":665},{"type":18,"tag":629,"props":1758,"children":1760},{"class":631,"line":1759},38,[1761,1765,1769],{"type":18,"tag":629,"props":1762,"children":1763},{"class":642},[1764],{"type":24,"value":711},{"type":18,"tag":629,"props":1766,"children":1767},{"class":636},[1768],{"type":24,"value":1235},{"type":18,"tag":629,"props":1770,"children":1771},{"class":642},[1772],{"type":24,"value":1773}," dphidx1, dphidx2, dphidx3",{"type":18,"tag":27,"props":1775,"children":1776},{},[1777,1779,1784,1785],{"type":24,"value":1778},"Here, I suggest that you should understand the mathematics equations above that I try to explain. It is easy to do it in Python programming language if you already understand its expression. Now I created another class for ",{"type":18,"tag":170,"props":1780,"children":1781},{},[1782],{"type":24,"value":1783}," NMPC with CGMRES ",{"type":24,"value":176},{"type":18,"tag":56,"props":1786,"children":1787},{},[],{"type":18,"tag":614,"props":1789,"children":1792},{"className":1790,"code":1791,"language":619,"meta":8},[617],"class NMPCCGMRES:\n\n    def __init__(self):\n\n        ## NMPC params\n        self.x_dim = 3\n        self.u_dim = 2\n        self.c_dim = 2\n        self.pred_horizons = 10\n\n        ### Continuations Params\n        self.ht = 1e-5\n        self.zeta = 1/self.ht\n        self.alpha = 0.5\n        self.tf = 1.0\n\n        ### Matrix\n\n        self.q1 = 1\n        self.q2 = 6\n        self.q3 = 1\n        self.r1 = 1\n        self.r2 = 0.1\n\n        ### Constraint\n        self.u_min = [ 0,  0]\n        self.u_max = [ 2,  1.57]\n        self.u_dummy = [0.01, 0.01]\n\n        ### Initialize matrix solution\n        self.dU = np.zeros((self.u_dim, self.pred_horizons))\n\n        ### Reference point\n        self.X_r = [3, 2, 0.0]\n        self.U_r = [0, 0]\n",[1793],{"type":18,"tag":622,"props":1794,"children":1795},{},[1796],{"type":18,"tag":614,"props":1797,"children":1798},{"__ignoreMap":8},[1799,1819,1826,1850,1857,1870,1899,1928,1956,1985,1992,2004,2033,2074,2103,2132,2139,2151,2158,2186,2214,2241,2268,2296,2303,2315,2357,2398,2441,2448,2460,2503,2510,2522,2572],{"type":18,"tag":629,"props":1800,"children":1801},{"class":631,"line":632},[1802,1806,1810,1815],{"type":18,"tag":629,"props":1803,"children":1804},{"class":636},[1805],{"type":24,"value":639},{"type":18,"tag":629,"props":1807,"children":1808},{"class":642},[1809],{"type":24,"value":645},{"type":18,"tag":629,"props":1811,"children":1812},{"class":648},[1813],{"type":24,"value":1814},"NMPCCGMRES",{"type":18,"tag":629,"props":1816,"children":1817},{"class":642},[1818],{"type":24,"value":656},{"type":18,"tag":629,"props":1820,"children":1821},{"class":631,"line":659},[1822],{"type":18,"tag":629,"props":1823,"children":1824},{},[1825],{"type":24,"value":665},{"type":18,"tag":629,"props":1827,"children":1828},{"class":631,"line":668},[1829,1833,1837,1841,1845],{"type":18,"tag":629,"props":1830,"children":1831},{"class":642},[1832],{"type":24,"value":674},{"type":18,"tag":629,"props":1834,"children":1835},{"class":636},[1836],{"type":24,"value":679},{"type":18,"tag":629,"props":1838,"children":1839},{"class":642},[1840],{"type":24,"value":645},{"type":18,"tag":629,"props":1842,"children":1843},{"class":686},[1844],{"type":24,"value":689},{"type":18,"tag":629,"props":1846,"children":1847},{"class":642},[1848],{"type":24,"value":1849},"(self):\n",{"type":18,"tag":629,"props":1851,"children":1852},{"class":631,"line":697},[1853],{"type":18,"tag":629,"props":1854,"children":1855},{},[1856],{"type":24,"value":665},{"type":18,"tag":629,"props":1858,"children":1859},{"class":631,"line":705},[1860,1864],{"type":18,"tag":629,"props":1861,"children":1862},{"class":642},[1863],{"type":24,"value":711},{"type":18,"tag":629,"props":1865,"children":1867},{"class":1866},"ct-326375",[1868],{"type":24,"value":1869},"## NMPC params\n",{"type":18,"tag":629,"props":1871,"children":1872},{"class":631,"line":734},[1873,1877,1881,1886,1890,1894],{"type":18,"tag":629,"props":1874,"children":1875},{"class":642},[1876],{"type":24,"value":711},{"type":18,"tag":629,"props":1878,"children":1879},{"class":686},[1880],{"type":24,"value":716},{"type":18,"tag":629,"props":1882,"children":1883},{"class":642},[1884],{"type":24,"value":1885},".x_dim ",{"type":18,"tag":629,"props":1887,"children":1888},{"class":636},[1889],{"type":24,"value":726},{"type":18,"tag":629,"props":1891,"children":1892},{"class":642},[1893],{"type":24,"value":645},{"type":18,"tag":629,"props":1895,"children":1896},{"class":686},[1897],{"type":24,"value":1898},"3\n",{"type":18,"tag":629,"props":1900,"children":1901},{"class":631,"line":760},[1902,1906,1910,1915,1919,1923],{"type":18,"tag":629,"props":1903,"children":1904},{"class":642},[1905],{"type":24,"value":711},{"type":18,"tag":629,"props":1907,"children":1908},{"class":686},[1909],{"type":24,"value":716},{"type":18,"tag":629,"props":1911,"children":1912},{"class":642},[1913],{"type":24,"value":1914},".u_dim ",{"type":18,"tag":629,"props":1916,"children":1917},{"class":636},[1918],{"type":24,"value":726},{"type":18,"tag":629,"props":1920,"children":1921},{"class":642},[1922],{"type":24,"value":645},{"type":18,"tag":629,"props":1924,"children":1925},{"class":686},[1926],{"type":24,"value":1927},"2\n",{"type":18,"tag":629,"props":1929,"children":1930},{"class":631,"line":786},[1931,1935,1939,1944,1948,1952],{"type":18,"tag":629,"props":1932,"children":1933},{"class":642},[1934],{"type":24,"value":711},{"type":18,"tag":629,"props":1936,"children":1937},{"class":686},[1938],{"type":24,"value":716},{"type":18,"tag":629,"props":1940,"children":1941},{"class":642},[1942],{"type":24,"value":1943},".c_dim ",{"type":18,"tag":629,"props":1945,"children":1946},{"class":636},[1947],{"type":24,"value":726},{"type":18,"tag":629,"props":1949,"children":1950},{"class":642},[1951],{"type":24,"value":645},{"type":18,"tag":629,"props":1953,"children":1954},{"class":686},[1955],{"type":24,"value":1927},{"type":18,"tag":629,"props":1957,"children":1958},{"class":631,"line":794},[1959,1963,1967,1972,1976,1980],{"type":18,"tag":629,"props":1960,"children":1961},{"class":642},[1962],{"type":24,"value":711},{"type":18,"tag":629,"props":1964,"children":1965},{"class":686},[1966],{"type":24,"value":716},{"type":18,"tag":629,"props":1968,"children":1969},{"class":642},[1970],{"type":24,"value":1971},".pred_horizons ",{"type":18,"tag":629,"props":1973,"children":1974},{"class":636},[1975],{"type":24,"value":726},{"type":18,"tag":629,"props":1977,"children":1978},{"class":642},[1979],{"type":24,"value":645},{"type":18,"tag":629,"props":1981,"children":1982},{"class":686},[1983],{"type":24,"value":1984},"10\n",{"type":18,"tag":629,"props":1986,"children":1987},{"class":631,"line":820},[1988],{"type":18,"tag":629,"props":1989,"children":1990},{},[1991],{"type":24,"value":665},{"type":18,"tag":629,"props":1993,"children":1994},{"class":631,"line":846},[1995,1999],{"type":18,"tag":629,"props":1996,"children":1997},{"class":642},[1998],{"type":24,"value":711},{"type":18,"tag":629,"props":2000,"children":2001},{"class":1866},[2002],{"type":24,"value":2003},"### Continuations Params\n",{"type":18,"tag":629,"props":2005,"children":2006},{"class":631,"line":854},[2007,2011,2015,2020,2024,2028],{"type":18,"tag":629,"props":2008,"children":2009},{"class":642},[2010],{"type":24,"value":711},{"type":18,"tag":629,"props":2012,"children":2013},{"class":686},[2014],{"type":24,"value":716},{"type":18,"tag":629,"props":2016,"children":2017},{"class":642},[2018],{"type":24,"value":2019},".ht ",{"type":18,"tag":629,"props":2021,"children":2022},{"class":636},[2023],{"type":24,"value":726},{"type":18,"tag":629,"props":2025,"children":2026},{"class":642},[2027],{"type":24,"value":645},{"type":18,"tag":629,"props":2029,"children":2030},{"class":686},[2031],{"type":24,"value":2032},"1e-5\n",{"type":18,"tag":629,"props":2034,"children":2035},{"class":631,"line":890},[2036,2040,2044,2049,2053,2057,2061,2065,2069],{"type":18,"tag":629,"props":2037,"children":2038},{"class":642},[2039],{"type":24,"value":711},{"type":18,"tag":629,"props":2041,"children":2042},{"class":686},[2043],{"type":24,"value":716},{"type":18,"tag":629,"props":2045,"children":2046},{"class":642},[2047],{"type":24,"value":2048},".zeta ",{"type":18,"tag":629,"props":2050,"children":2051},{"class":636},[2052],{"type":24,"value":726},{"type":18,"tag":629,"props":2054,"children":2055},{"class":642},[2056],{"type":24,"value":645},{"type":18,"tag":629,"props":2058,"children":2059},{"class":686},[2060],{"type":24,"value":992},{"type":18,"tag":629,"props":2062,"children":2063},{"class":636},[2064],{"type":24,"value":1429},{"type":18,"tag":629,"props":2066,"children":2067},{"class":686},[2068],{"type":24,"value":716},{"type":18,"tag":629,"props":2070,"children":2071},{"class":642},[2072],{"type":24,"value":2073},".ht\n",{"type":18,"tag":629,"props":2075,"children":2076},{"class":631,"line":923},[2077,2081,2085,2090,2094,2098],{"type":18,"tag":629,"props":2078,"children":2079},{"class":642},[2080],{"type":24,"value":711},{"type":18,"tag":629,"props":2082,"children":2083},{"class":686},[2084],{"type":24,"value":716},{"type":18,"tag":629,"props":2086,"children":2087},{"class":642},[2088],{"type":24,"value":2089},".alpha ",{"type":18,"tag":629,"props":2091,"children":2092},{"class":636},[2093],{"type":24,"value":726},{"type":18,"tag":629,"props":2095,"children":2096},{"class":642},[2097],{"type":24,"value":645},{"type":18,"tag":629,"props":2099,"children":2100},{"class":686},[2101],{"type":24,"value":2102},"0.5\n",{"type":18,"tag":629,"props":2104,"children":2105},{"class":631,"line":931},[2106,2110,2114,2119,2123,2127],{"type":18,"tag":629,"props":2107,"children":2108},{"class":642},[2109],{"type":24,"value":711},{"type":18,"tag":629,"props":2111,"children":2112},{"class":686},[2113],{"type":24,"value":716},{"type":18,"tag":629,"props":2115,"children":2116},{"class":642},[2117],{"type":24,"value":2118},".tf ",{"type":18,"tag":629,"props":2120,"children":2121},{"class":636},[2122],{"type":24,"value":726},{"type":18,"tag":629,"props":2124,"children":2125},{"class":642},[2126],{"type":24,"value":645},{"type":18,"tag":629,"props":2128,"children":2129},{"class":686},[2130],{"type":24,"value":2131},"1.0\n",{"type":18,"tag":629,"props":2133,"children":2134},{"class":631,"line":965},[2135],{"type":18,"tag":629,"props":2136,"children":2137},{},[2138],{"type":24,"value":665},{"type":18,"tag":629,"props":2140,"children":2141},{"class":631,"line":999},[2142,2146],{"type":18,"tag":629,"props":2143,"children":2144},{"class":642},[2145],{"type":24,"value":711},{"type":18,"tag":629,"props":2147,"children":2148},{"class":1866},[2149],{"type":24,"value":2150},"### Matrix\n",{"type":18,"tag":629,"props":2152,"children":2153},{"class":631,"line":1007},[2154],{"type":18,"tag":629,"props":2155,"children":2156},{},[2157],{"type":24,"value":665},{"type":18,"tag":629,"props":2159,"children":2160},{"class":631,"line":1033},[2161,2165,2169,2173,2177,2181],{"type":18,"tag":629,"props":2162,"children":2163},{"class":642},[2164],{"type":24,"value":711},{"type":18,"tag":629,"props":2166,"children":2167},{"class":686},[2168],{"type":24,"value":716},{"type":18,"tag":629,"props":2170,"children":2171},{"class":642},[2172],{"type":24,"value":721},{"type":18,"tag":629,"props":2174,"children":2175},{"class":636},[2176],{"type":24,"value":726},{"type":18,"tag":629,"props":2178,"children":2179},{"class":642},[2180],{"type":24,"value":645},{"type":18,"tag":629,"props":2182,"children":2183},{"class":686},[2184],{"type":24,"value":2185},"1\n",{"type":18,"tag":629,"props":2187,"children":2188},{"class":631,"line":1041},[2189,2193,2197,2201,2205,2209],{"type":18,"tag":629,"props":2190,"children":2191},{"class":642},[2192],{"type":24,"value":711},{"type":18,"tag":629,"props":2194,"children":2195},{"class":686},[2196],{"type":24,"value":716},{"type":18,"tag":629,"props":2198,"children":2199},{"class":642},[2200],{"type":24,"value":748},{"type":18,"tag":629,"props":2202,"children":2203},{"class":636},[2204],{"type":24,"value":726},{"type":18,"tag":629,"props":2206,"children":2207},{"class":642},[2208],{"type":24,"value":645},{"type":18,"tag":629,"props":2210,"children":2211},{"class":686},[2212],{"type":24,"value":2213},"6\n",{"type":18,"tag":629,"props":2215,"children":2216},{"class":631,"line":1083},[2217,2221,2225,2229,2233,2237],{"type":18,"tag":629,"props":2218,"children":2219},{"class":642},[2220],{"type":24,"value":711},{"type":18,"tag":629,"props":2222,"children":2223},{"class":686},[2224],{"type":24,"value":716},{"type":18,"tag":629,"props":2226,"children":2227},{"class":642},[2228],{"type":24,"value":774},{"type":18,"tag":629,"props":2230,"children":2231},{"class":636},[2232],{"type":24,"value":726},{"type":18,"tag":629,"props":2234,"children":2235},{"class":642},[2236],{"type":24,"value":645},{"type":18,"tag":629,"props":2238,"children":2239},{"class":686},[2240],{"type":24,"value":2185},{"type":18,"tag":629,"props":2242,"children":2243},{"class":631,"line":1123},[2244,2248,2252,2256,2260,2264],{"type":18,"tag":629,"props":2245,"children":2246},{"class":642},[2247],{"type":24,"value":711},{"type":18,"tag":629,"props":2249,"children":2250},{"class":686},[2251],{"type":24,"value":716},{"type":18,"tag":629,"props":2253,"children":2254},{"class":642},[2255],{"type":24,"value":808},{"type":18,"tag":629,"props":2257,"children":2258},{"class":636},[2259],{"type":24,"value":726},{"type":18,"tag":629,"props":2261,"children":2262},{"class":642},[2263],{"type":24,"value":645},{"type":18,"tag":629,"props":2265,"children":2266},{"class":686},[2267],{"type":24,"value":2185},{"type":18,"tag":629,"props":2269,"children":2270},{"class":631,"line":1217},[2271,2275,2279,2283,2287,2291],{"type":18,"tag":629,"props":2272,"children":2273},{"class":642},[2274],{"type":24,"value":711},{"type":18,"tag":629,"props":2276,"children":2277},{"class":686},[2278],{"type":24,"value":716},{"type":18,"tag":629,"props":2280,"children":2281},{"class":642},[2282],{"type":24,"value":834},{"type":18,"tag":629,"props":2284,"children":2285},{"class":636},[2286],{"type":24,"value":726},{"type":18,"tag":629,"props":2288,"children":2289},{"class":642},[2290],{"type":24,"value":645},{"type":18,"tag":629,"props":2292,"children":2293},{"class":686},[2294],{"type":24,"value":2295},"0.1\n",{"type":18,"tag":629,"props":2297,"children":2298},{"class":631,"line":1225},[2299],{"type":18,"tag":629,"props":2300,"children":2301},{},[2302],{"type":24,"value":665},{"type":18,"tag":629,"props":2304,"children":2305},{"class":631,"line":1243},[2306,2310],{"type":18,"tag":629,"props":2307,"children":2308},{"class":642},[2309],{"type":24,"value":711},{"type":18,"tag":629,"props":2311,"children":2312},{"class":1866},[2313],{"type":24,"value":2314},"### Constraint\n",{"type":18,"tag":629,"props":2316,"children":2317},{"class":631,"line":1251},[2318,2322,2326,2331,2335,2340,2344,2349,2353],{"type":18,"tag":629,"props":2319,"children":2320},{"class":642},[2321],{"type":24,"value":711},{"type":18,"tag":629,"props":2323,"children":2324},{"class":686},[2325],{"type":24,"value":716},{"type":18,"tag":629,"props":2327,"children":2328},{"class":642},[2329],{"type":24,"value":2330},".u_min ",{"type":18,"tag":629,"props":2332,"children":2333},{"class":636},[2334],{"type":24,"value":726},{"type":18,"tag":629,"props":2336,"children":2337},{"class":642},[2338],{"type":24,"value":2339}," [ ",{"type":18,"tag":629,"props":2341,"children":2342},{"class":686},[2343],{"type":24,"value":882},{"type":18,"tag":629,"props":2345,"children":2346},{"class":642},[2347],{"type":24,"value":2348},",  ",{"type":18,"tag":629,"props":2350,"children":2351},{"class":686},[2352],{"type":24,"value":882},{"type":18,"tag":629,"props":2354,"children":2355},{"class":642},[2356],{"type":24,"value":887},{"type":18,"tag":629,"props":2358,"children":2359},{"class":631,"line":1277},[2360,2364,2368,2373,2377,2381,2385,2389,2394],{"type":18,"tag":629,"props":2361,"children":2362},{"class":642},[2363],{"type":24,"value":711},{"type":18,"tag":629,"props":2365,"children":2366},{"class":686},[2367],{"type":24,"value":716},{"type":18,"tag":629,"props":2369,"children":2370},{"class":642},[2371],{"type":24,"value":2372},".u_max ",{"type":18,"tag":629,"props":2374,"children":2375},{"class":636},[2376],{"type":24,"value":726},{"type":18,"tag":629,"props":2378,"children":2379},{"class":642},[2380],{"type":24,"value":2339},{"type":18,"tag":629,"props":2382,"children":2383},{"class":686},[2384],{"type":24,"value":1368},{"type":18,"tag":629,"props":2386,"children":2387},{"class":642},[2388],{"type":24,"value":2348},{"type":18,"tag":629,"props":2390,"children":2391},{"class":686},[2392],{"type":24,"value":2393},"1.57",{"type":18,"tag":629,"props":2395,"children":2396},{"class":642},[2397],{"type":24,"value":887},{"type":18,"tag":629,"props":2399,"children":2400},{"class":631,"line":1285},[2401,2405,2409,2414,2418,2423,2428,2433,2437],{"type":18,"tag":629,"props":2402,"children":2403},{"class":642},[2404],{"type":24,"value":711},{"type":18,"tag":629,"props":2406,"children":2407},{"class":686},[2408],{"type":24,"value":716},{"type":18,"tag":629,"props":2410,"children":2411},{"class":642},[2412],{"type":24,"value":2413},".u_dummy ",{"type":18,"tag":629,"props":2415,"children":2416},{"class":636},[2417],{"type":24,"value":726},{"type":18,"tag":629,"props":2419,"children":2420},{"class":642},[2421],{"type":24,"value":2422}," [",{"type":18,"tag":629,"props":2424,"children":2425},{"class":686},[2426],{"type":24,"value":2427},"0.01",{"type":18,"tag":629,"props":2429,"children":2430},{"class":642},[2431],{"type":24,"value":2432},", ",{"type":18,"tag":629,"props":2434,"children":2435},{"class":686},[2436],{"type":24,"value":2427},{"type":18,"tag":629,"props":2438,"children":2439},{"class":642},[2440],{"type":24,"value":887},{"type":18,"tag":629,"props":2442,"children":2443},{"class":631,"line":1441},[2444],{"type":18,"tag":629,"props":2445,"children":2446},{},[2447],{"type":24,"value":665},{"type":18,"tag":629,"props":2449,"children":2450},{"class":631,"line":1561},[2451,2455],{"type":18,"tag":629,"props":2452,"children":2453},{"class":642},[2454],{"type":24,"value":711},{"type":18,"tag":629,"props":2456,"children":2457},{"class":1866},[2458],{"type":24,"value":2459},"### Initialize matrix solution\n",{"type":18,"tag":629,"props":2461,"children":2462},{"class":631,"line":1569},[2463,2467,2471,2476,2480,2485,2489,2494,2498],{"type":18,"tag":629,"props":2464,"children":2465},{"class":642},[2466],{"type":24,"value":711},{"type":18,"tag":629,"props":2468,"children":2469},{"class":686},[2470],{"type":24,"value":716},{"type":18,"tag":629,"props":2472,"children":2473},{"class":642},[2474],{"type":24,"value":2475},".dU ",{"type":18,"tag":629,"props":2477,"children":2478},{"class":636},[2479],{"type":24,"value":726},{"type":18,"tag":629,"props":2481,"children":2482},{"class":642},[2483],{"type":24,"value":2484}," np.zeros((",{"type":18,"tag":629,"props":2486,"children":2487},{"class":686},[2488],{"type":24,"value":716},{"type":18,"tag":629,"props":2490,"children":2491},{"class":642},[2492],{"type":24,"value":2493},".u_dim, ",{"type":18,"tag":629,"props":2495,"children":2496},{"class":686},[2497],{"type":24,"value":716},{"type":18,"tag":629,"props":2499,"children":2500},{"class":642},[2501],{"type":24,"value":2502},".pred_horizons))\n",{"type":18,"tag":629,"props":2504,"children":2505},{"class":631,"line":1586},[2506],{"type":18,"tag":629,"props":2507,"children":2508},{},[2509],{"type":24,"value":665},{"type":18,"tag":629,"props":2511,"children":2512},{"class":631,"line":1594},[2513,2517],{"type":18,"tag":629,"props":2514,"children":2515},{"class":642},[2516],{"type":24,"value":711},{"type":18,"tag":629,"props":2518,"children":2519},{"class":1866},[2520],{"type":24,"value":2521},"### Reference point\n",{"type":18,"tag":629,"props":2523,"children":2524},{"class":631,"line":1620},[2525,2529,2533,2538,2542,2546,2551,2555,2559,2563,2568],{"type":18,"tag":629,"props":2526,"children":2527},{"class":642},[2528],{"type":24,"value":711},{"type":18,"tag":629,"props":2530,"children":2531},{"class":686},[2532],{"type":24,"value":716},{"type":18,"tag":629,"props":2534,"children":2535},{"class":642},[2536],{"type":24,"value":2537},".X_r ",{"type":18,"tag":629,"props":2539,"children":2540},{"class":636},[2541],{"type":24,"value":726},{"type":18,"tag":629,"props":2543,"children":2544},{"class":642},[2545],{"type":24,"value":2422},{"type":18,"tag":629,"props":2547,"children":2548},{"class":686},[2549],{"type":24,"value":2550},"3",{"type":18,"tag":629,"props":2552,"children":2553},{"class":642},[2554],{"type":24,"value":2432},{"type":18,"tag":629,"props":2556,"children":2557},{"class":686},[2558],{"type":24,"value":1368},{"type":18,"tag":629,"props":2560,"children":2561},{"class":642},[2562],{"type":24,"value":2432},{"type":18,"tag":629,"props":2564,"children":2565},{"class":686},[2566],{"type":24,"value":2567},"0.0",{"type":18,"tag":629,"props":2569,"children":2570},{"class":642},[2571],{"type":24,"value":887},{"type":18,"tag":629,"props":2573,"children":2574},{"class":631,"line":1664},[2575,2579,2583,2588,2592,2596,2600,2604,2608],{"type":18,"tag":629,"props":2576,"children":2577},{"class":642},[2578],{"type":24,"value":711},{"type":18,"tag":629,"props":2580,"children":2581},{"class":686},[2582],{"type":24,"value":716},{"type":18,"tag":629,"props":2584,"children":2585},{"class":642},[2586],{"type":24,"value":2587},".U_r ",{"type":18,"tag":629,"props":2589,"children":2590},{"class":636},[2591],{"type":24,"value":726},{"type":18,"tag":629,"props":2593,"children":2594},{"class":642},[2595],{"type":24,"value":2422},{"type":18,"tag":629,"props":2597,"children":2598},{"class":686},[2599],{"type":24,"value":882},{"type":18,"tag":629,"props":2601,"children":2602},{"class":642},[2603],{"type":24,"value":2432},{"type":18,"tag":629,"props":2605,"children":2606},{"class":686},[2607],{"type":24,"value":882},{"type":18,"tag":629,"props":2609,"children":2610},{"class":642},[2611],{"type":24,"value":2612},"]",{"type":18,"tag":27,"props":2614,"children":2615},{},[2616],{"type":24,"value":2617},"These are just for tuning parameters and initialize parameters, let's focus on CGMRES method. As the expression above at equation (1).\nLet's denote that",{"type":18,"tag":614,"props":2619,"children":2622},{"className":2620,"code":2621,"language":619,"meta":8},[617],"X = np.zeros((x_dim, pred_horizons+1))      ## State for N-prediction+1\nU = np.zeros((u_dim, pred_horizons))        ## Input Control for N-prediction\nLambda = np.zeros((x_dim, pred_horizons+1)) ## Costate vector for N-prediction+1\ndt = 0.01                                   ## Sampling Time\n",[2623],{"type":18,"tag":622,"props":2624,"children":2625},{},[2626],{"type":18,"tag":614,"props":2627,"children":2628},{"__ignoreMap":8},[2629,2664,2686,2720],{"type":18,"tag":629,"props":2630,"children":2631},{"class":631,"line":632},[2632,2637,2641,2646,2650,2654,2659],{"type":18,"tag":629,"props":2633,"children":2634},{"class":642},[2635],{"type":24,"value":2636},"X ",{"type":18,"tag":629,"props":2638,"children":2639},{"class":636},[2640],{"type":24,"value":726},{"type":18,"tag":629,"props":2642,"children":2643},{"class":642},[2644],{"type":24,"value":2645}," np.zeros((x_dim, pred_horizons",{"type":18,"tag":629,"props":2647,"children":2648},{"class":636},[2649],{"type":24,"value":1192},{"type":18,"tag":629,"props":2651,"children":2652},{"class":686},[2653],{"type":24,"value":992},{"type":18,"tag":629,"props":2655,"children":2656},{"class":642},[2657],{"type":24,"value":2658},"))      ",{"type":18,"tag":629,"props":2660,"children":2661},{"class":1866},[2662],{"type":24,"value":2663},"## State for N-prediction+1\n",{"type":18,"tag":629,"props":2665,"children":2666},{"class":631,"line":659},[2667,2672,2676,2681],{"type":18,"tag":629,"props":2668,"children":2669},{"class":642},[2670],{"type":24,"value":2671},"U ",{"type":18,"tag":629,"props":2673,"children":2674},{"class":636},[2675],{"type":24,"value":726},{"type":18,"tag":629,"props":2677,"children":2678},{"class":642},[2679],{"type":24,"value":2680}," np.zeros((u_dim, pred_horizons))        ",{"type":18,"tag":629,"props":2682,"children":2683},{"class":1866},[2684],{"type":24,"value":2685},"## Input Control for N-prediction\n",{"type":18,"tag":629,"props":2687,"children":2688},{"class":631,"line":668},[2689,2694,2698,2702,2706,2710,2715],{"type":18,"tag":629,"props":2690,"children":2691},{"class":642},[2692],{"type":24,"value":2693},"Lambda ",{"type":18,"tag":629,"props":2695,"children":2696},{"class":636},[2697],{"type":24,"value":726},{"type":18,"tag":629,"props":2699,"children":2700},{"class":642},[2701],{"type":24,"value":2645},{"type":18,"tag":629,"props":2703,"children":2704},{"class":636},[2705],{"type":24,"value":1192},{"type":18,"tag":629,"props":2707,"children":2708},{"class":686},[2709],{"type":24,"value":992},{"type":18,"tag":629,"props":2711,"children":2712},{"class":642},[2713],{"type":24,"value":2714},")) ",{"type":18,"tag":629,"props":2716,"children":2717},{"class":1866},[2718],{"type":24,"value":2719},"## Costate vector for N-prediction+1\n",{"type":18,"tag":629,"props":2721,"children":2722},{"class":631,"line":697},[2723,2728,2732,2736,2740,2745],{"type":18,"tag":629,"props":2724,"children":2725},{"class":642},[2726],{"type":24,"value":2727},"dt ",{"type":18,"tag":629,"props":2729,"children":2730},{"class":636},[2731],{"type":24,"value":726},{"type":18,"tag":629,"props":2733,"children":2734},{"class":642},[2735],{"type":24,"value":645},{"type":18,"tag":629,"props":2737,"children":2738},{"class":686},[2739],{"type":24,"value":2427},{"type":18,"tag":629,"props":2741,"children":2742},{"class":642},[2743],{"type":24,"value":2744},"                                   ",{"type":18,"tag":629,"props":2746,"children":2747},{"class":1866},[2748],{"type":24,"value":2749},"## Sampling Time",{"type":18,"tag":27,"props":2751,"children":2752},{},[2753],{"type":24,"value":2754},"Then, we can perform equation (1) as",{"type":18,"tag":614,"props":2756,"children":2759},{"className":2757,"code":2758,"language":619,"meta":8},[617],"def calc_state(self, X, U, dt):\n\n        for i in range(self.pred_horizons):\n            x_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, i], U[0, i], U[1, i])\n            \n            X[0, i+1] = X[0, i] + x_dot * dt\n            X[1, i+1] = X[1, i] + y_dot * dt\n            X[2, i+1] = X[2, i] + yaw_dot * dt\n\n        return X\n",[2760],{"type":18,"tag":622,"props":2761,"children":2762},{},[2763],{"type":18,"tag":614,"props":2764,"children":2765},{"__ignoreMap":8},[2766,2787,2794,2838,2889,2897,2963,3023,3083,3090],{"type":18,"tag":629,"props":2767,"children":2768},{"class":631,"line":632},[2769,2773,2777,2782],{"type":18,"tag":629,"props":2770,"children":2771},{"class":636},[2772],{"type":24,"value":679},{"type":18,"tag":629,"props":2774,"children":2775},{"class":642},[2776],{"type":24,"value":645},{"type":18,"tag":629,"props":2778,"children":2779},{"class":648},[2780],{"type":24,"value":2781},"calc_state",{"type":18,"tag":629,"props":2783,"children":2784},{"class":642},[2785],{"type":24,"value":2786},"(self, X, U, dt):\n",{"type":18,"tag":629,"props":2788,"children":2789},{"class":631,"line":659},[2790],{"type":18,"tag":629,"props":2791,"children":2792},{},[2793],{"type":24,"value":665},{"type":18,"tag":629,"props":2795,"children":2796},{"class":631,"line":668},[2797,2801,2806,2811,2816,2820,2825,2829,2833],{"type":18,"tag":629,"props":2798,"children":2799},{"class":642},[2800],{"type":24,"value":711},{"type":18,"tag":629,"props":2802,"children":2803},{"class":636},[2804],{"type":24,"value":2805},"for",{"type":18,"tag":629,"props":2807,"children":2808},{"class":642},[2809],{"type":24,"value":2810}," i ",{"type":18,"tag":629,"props":2812,"children":2813},{"class":636},[2814],{"type":24,"value":2815},"in",{"type":18,"tag":629,"props":2817,"children":2818},{"class":642},[2819],{"type":24,"value":645},{"type":18,"tag":629,"props":2821,"children":2822},{"class":686},[2823],{"type":24,"value":2824},"range",{"type":18,"tag":629,"props":2826,"children":2827},{"class":642},[2828],{"type":24,"value":1402},{"type":18,"tag":629,"props":2830,"children":2831},{"class":686},[2832],{"type":24,"value":716},{"type":18,"tag":629,"props":2834,"children":2835},{"class":642},[2836],{"type":24,"value":2837},".pred_horizons):\n",{"type":18,"tag":629,"props":2839,"children":2840},{"class":631,"line":697},[2841,2846,2850,2854,2858,2863,2867,2872,2876,2880,2884],{"type":18,"tag":629,"props":2842,"children":2843},{"class":642},[2844],{"type":24,"value":2845},"            x_dot, y_dot, yaw_dot ",{"type":18,"tag":629,"props":2847,"children":2848},{"class":636},[2849],{"type":24,"value":726},{"type":18,"tag":629,"props":2851,"children":2852},{"class":642},[2853],{"type":24,"value":645},{"type":18,"tag":629,"props":2855,"children":2856},{"class":686},[2857],{"type":24,"value":716},{"type":18,"tag":629,"props":2859,"children":2860},{"class":642},[2861],{"type":24,"value":2862},".robot_model.forward_kinematic(X[",{"type":18,"tag":629,"props":2864,"children":2865},{"class":686},[2866],{"type":24,"value":1368},{"type":18,"tag":629,"props":2868,"children":2869},{"class":642},[2870],{"type":24,"value":2871},", i], U[",{"type":18,"tag":629,"props":2873,"children":2874},{"class":686},[2875],{"type":24,"value":882},{"type":18,"tag":629,"props":2877,"children":2878},{"class":642},[2879],{"type":24,"value":2871},{"type":18,"tag":629,"props":2881,"children":2882},{"class":686},[2883],{"type":24,"value":992},{"type":18,"tag":629,"props":2885,"children":2886},{"class":642},[2887],{"type":24,"value":2888},", i])\n",{"type":18,"tag":629,"props":2890,"children":2891},{"class":631,"line":705},[2892],{"type":18,"tag":629,"props":2893,"children":2894},{"class":642},[2895],{"type":24,"value":2896},"            \n",{"type":18,"tag":629,"props":2898,"children":2899},{"class":631,"line":734},[2900,2905,2909,2914,2918,2922,2927,2931,2936,2940,2945,2949,2954,2958],{"type":18,"tag":629,"props":2901,"children":2902},{"class":642},[2903],{"type":24,"value":2904},"            X[",{"type":18,"tag":629,"props":2906,"children":2907},{"class":686},[2908],{"type":24,"value":882},{"type":18,"tag":629,"props":2910,"children":2911},{"class":642},[2912],{"type":24,"value":2913},", i",{"type":18,"tag":629,"props":2915,"children":2916},{"class":636},[2917],{"type":24,"value":1192},{"type":18,"tag":629,"props":2919,"children":2920},{"class":686},[2921],{"type":24,"value":992},{"type":18,"tag":629,"props":2923,"children":2924},{"class":642},[2925],{"type":24,"value":2926},"] ",{"type":18,"tag":629,"props":2928,"children":2929},{"class":636},[2930],{"type":24,"value":726},{"type":18,"tag":629,"props":2932,"children":2933},{"class":642},[2934],{"type":24,"value":2935}," X[",{"type":18,"tag":629,"props":2937,"children":2938},{"class":686},[2939],{"type":24,"value":882},{"type":18,"tag":629,"props":2941,"children":2942},{"class":642},[2943],{"type":24,"value":2944},", i] ",{"type":18,"tag":629,"props":2946,"children":2947},{"class":636},[2948],{"type":24,"value":1192},{"type":18,"tag":629,"props":2950,"children":2951},{"class":642},[2952],{"type":24,"value":2953}," x_dot ",{"type":18,"tag":629,"props":2955,"children":2956},{"class":636},[2957],{"type":24,"value":1071},{"type":18,"tag":629,"props":2959,"children":2960},{"class":642},[2961],{"type":24,"value":2962}," dt\n",{"type":18,"tag":629,"props":2964,"children":2965},{"class":631,"line":760},[2966,2970,2974,2978,2982,2986,2990,2994,2998,3002,3006,3010,3015,3019],{"type":18,"tag":629,"props":2967,"children":2968},{"class":642},[2969],{"type":24,"value":2904},{"type":18,"tag":629,"props":2971,"children":2972},{"class":686},[2973],{"type":24,"value":992},{"type":18,"tag":629,"props":2975,"children":2976},{"class":642},[2977],{"type":24,"value":2913},{"type":18,"tag":629,"props":2979,"children":2980},{"class":636},[2981],{"type":24,"value":1192},{"type":18,"tag":629,"props":2983,"children":2984},{"class":686},[2985],{"type":24,"value":992},{"type":18,"tag":629,"props":2987,"children":2988},{"class":642},[2989],{"type":24,"value":2926},{"type":18,"tag":629,"props":2991,"children":2992},{"class":636},[2993],{"type":24,"value":726},{"type":18,"tag":629,"props":2995,"children":2996},{"class":642},[2997],{"type":24,"value":2935},{"type":18,"tag":629,"props":2999,"children":3000},{"class":686},[3001],{"type":24,"value":992},{"type":18,"tag":629,"props":3003,"children":3004},{"class":642},[3005],{"type":24,"value":2944},{"type":18,"tag":629,"props":3007,"children":3008},{"class":636},[3009],{"type":24,"value":1192},{"type":18,"tag":629,"props":3011,"children":3012},{"class":642},[3013],{"type":24,"value":3014}," y_dot ",{"type":18,"tag":629,"props":3016,"children":3017},{"class":636},[3018],{"type":24,"value":1071},{"type":18,"tag":629,"props":3020,"children":3021},{"class":642},[3022],{"type":24,"value":2962},{"type":18,"tag":629,"props":3024,"children":3025},{"class":631,"line":786},[3026,3030,3034,3038,3042,3046,3050,3054,3058,3062,3066,3070,3075,3079],{"type":18,"tag":629,"props":3027,"children":3028},{"class":642},[3029],{"type":24,"value":2904},{"type":18,"tag":629,"props":3031,"children":3032},{"class":686},[3033],{"type":24,"value":1368},{"type":18,"tag":629,"props":3035,"children":3036},{"class":642},[3037],{"type":24,"value":2913},{"type":18,"tag":629,"props":3039,"children":3040},{"class":636},[3041],{"type":24,"value":1192},{"type":18,"tag":629,"props":3043,"children":3044},{"class":686},[3045],{"type":24,"value":992},{"type":18,"tag":629,"props":3047,"children":3048},{"class":642},[3049],{"type":24,"value":2926},{"type":18,"tag":629,"props":3051,"children":3052},{"class":636},[3053],{"type":24,"value":726},{"type":18,"tag":629,"props":3055,"children":3056},{"class":642},[3057],{"type":24,"value":2935},{"type":18,"tag":629,"props":3059,"children":3060},{"class":686},[3061],{"type":24,"value":1368},{"type":18,"tag":629,"props":3063,"children":3064},{"class":642},[3065],{"type":24,"value":2944},{"type":18,"tag":629,"props":3067,"children":3068},{"class":636},[3069],{"type":24,"value":1192},{"type":18,"tag":629,"props":3071,"children":3072},{"class":642},[3073],{"type":24,"value":3074}," yaw_dot ",{"type":18,"tag":629,"props":3076,"children":3077},{"class":636},[3078],{"type":24,"value":1071},{"type":18,"tag":629,"props":3080,"children":3081},{"class":642},[3082],{"type":24,"value":2962},{"type":18,"tag":629,"props":3084,"children":3085},{"class":631,"line":794},[3086],{"type":18,"tag":629,"props":3087,"children":3088},{},[3089],{"type":24,"value":665},{"type":18,"tag":629,"props":3091,"children":3092},{"class":631,"line":820},[3093,3097,3101],{"type":18,"tag":629,"props":3094,"children":3095},{"class":642},[3096],{"type":24,"value":711},{"type":18,"tag":629,"props":3098,"children":3099},{"class":636},[3100],{"type":24,"value":1235},{"type":18,"tag":629,"props":3102,"children":3103},{"class":642},[3104],{"type":24,"value":3105}," X",{"type":18,"tag":27,"props":3107,"children":3108},{},[3109],{"type":24,"value":3110},"Next we calculating costate, we are going in backward direction",{"type":18,"tag":614,"props":3112,"children":3115},{"className":3113,"code":3114,"language":619,"meta":8},[617],"def calc_costate(self, X, U, Lambda, dt):\n\n        x_N, y_N, yaw_N = self.hjb_equation.dphidx(X[0, -1], X[1, -1], X[2, -1],\n                                                   self.X_r[0], self.X_r[1], self.X_r[2])\n        Lambda[0, -1] = x_N\n        Lambda[1, -1] = y_N\n        Lambda[2, -1] = yaw_N\n\n\n        for i in reversed(range(1, self.pred_horizons)):\n\n            dhdx1, dhdx2, dhdx3 = self.hjb_equation.dhdx(\n                X[0, i], X[1, i], X[2, i],\n                self.X_r[0], self.X_r[1], self.X_r[2],\n                U[0, i], Lambda[0, i+1], Lambda[1, i+1]\n            )\n\n            Lambda[0, i] = Lambda[0, i+1] + dhdx1 * dt\n            Lambda[1, i] = Lambda[1, i+1] + dhdx2 * dt\n            Lambda[2, i] = Lambda[2, i+1] + dhdx3 * dt\n    \n\n        return Lambda\n",[3116],{"type":18,"tag":622,"props":3117,"children":3118},{},[3119],{"type":18,"tag":614,"props":3120,"children":3121},{"__ignoreMap":8},[3122,3143,3150,3237,3296,3333,3369,3405,3412,3419,3476,3483,3508,3542,3598,3656,3664,3671,3733,3793,3853,3861,3868],{"type":18,"tag":629,"props":3123,"children":3124},{"class":631,"line":632},[3125,3129,3133,3138],{"type":18,"tag":629,"props":3126,"children":3127},{"class":636},[3128],{"type":24,"value":679},{"type":18,"tag":629,"props":3130,"children":3131},{"class":642},[3132],{"type":24,"value":645},{"type":18,"tag":629,"props":3134,"children":3135},{"class":648},[3136],{"type":24,"value":3137},"calc_costate",{"type":18,"tag":629,"props":3139,"children":3140},{"class":642},[3141],{"type":24,"value":3142},"(self, X, U, Lambda, dt):\n",{"type":18,"tag":629,"props":3144,"children":3145},{"class":631,"line":659},[3146],{"type":18,"tag":629,"props":3147,"children":3148},{},[3149],{"type":24,"value":665},{"type":18,"tag":629,"props":3151,"children":3152},{"class":631,"line":668},[3153,3158,3162,3166,3170,3175,3179,3183,3187,3191,3196,3200,3204,3208,3212,3216,3220,3224,3228,3232],{"type":18,"tag":629,"props":3154,"children":3155},{"class":642},[3156],{"type":24,"value":3157},"        x_N, y_N, yaw_N ",{"type":18,"tag":629,"props":3159,"children":3160},{"class":636},[3161],{"type":24,"value":726},{"type":18,"tag":629,"props":3163,"children":3164},{"class":642},[3165],{"type":24,"value":645},{"type":18,"tag":629,"props":3167,"children":3168},{"class":686},[3169],{"type":24,"value":716},{"type":18,"tag":629,"props":3171,"children":3172},{"class":642},[3173],{"type":24,"value":3174},".hjb_equation.dphidx(X[",{"type":18,"tag":629,"props":3176,"children":3177},{"class":686},[3178],{"type":24,"value":882},{"type":18,"tag":629,"props":3180,"children":3181},{"class":642},[3182],{"type":24,"value":2432},{"type":18,"tag":629,"props":3184,"children":3185},{"class":636},[3186],{"type":24,"value":1061},{"type":18,"tag":629,"props":3188,"children":3189},{"class":686},[3190],{"type":24,"value":992},{"type":18,"tag":629,"props":3192,"children":3193},{"class":642},[3194],{"type":24,"value":3195},"], X[",{"type":18,"tag":629,"props":3197,"children":3198},{"class":686},[3199],{"type":24,"value":992},{"type":18,"tag":629,"props":3201,"children":3202},{"class":642},[3203],{"type":24,"value":2432},{"type":18,"tag":629,"props":3205,"children":3206},{"class":636},[3207],{"type":24,"value":1061},{"type":18,"tag":629,"props":3209,"children":3210},{"class":686},[3211],{"type":24,"value":992},{"type":18,"tag":629,"props":3213,"children":3214},{"class":642},[3215],{"type":24,"value":3195},{"type":18,"tag":629,"props":3217,"children":3218},{"class":686},[3219],{"type":24,"value":1368},{"type":18,"tag":629,"props":3221,"children":3222},{"class":642},[3223],{"type":24,"value":2432},{"type":18,"tag":629,"props":3225,"children":3226},{"class":636},[3227],{"type":24,"value":1061},{"type":18,"tag":629,"props":3229,"children":3230},{"class":686},[3231],{"type":24,"value":992},{"type":18,"tag":629,"props":3233,"children":3234},{"class":642},[3235],{"type":24,"value":3236},"],\n",{"type":18,"tag":629,"props":3238,"children":3239},{"class":631,"line":697},[3240,3245,3249,3254,3258,3263,3267,3271,3275,3279,3283,3287,3291],{"type":18,"tag":629,"props":3241,"children":3242},{"class":642},[3243],{"type":24,"value":3244},"                                                   ",{"type":18,"tag":629,"props":3246,"children":3247},{"class":686},[3248],{"type":24,"value":716},{"type":18,"tag":629,"props":3250,"children":3251},{"class":642},[3252],{"type":24,"value":3253},".X_r[",{"type":18,"tag":629,"props":3255,"children":3256},{"class":686},[3257],{"type":24,"value":882},{"type":18,"tag":629,"props":3259,"children":3260},{"class":642},[3261],{"type":24,"value":3262},"], ",{"type":18,"tag":629,"props":3264,"children":3265},{"class":686},[3266],{"type":24,"value":716},{"type":18,"tag":629,"props":3268,"children":3269},{"class":642},[3270],{"type":24,"value":3253},{"type":18,"tag":629,"props":3272,"children":3273},{"class":686},[3274],{"type":24,"value":992},{"type":18,"tag":629,"props":3276,"children":3277},{"class":642},[3278],{"type":24,"value":3262},{"type":18,"tag":629,"props":3280,"children":3281},{"class":686},[3282],{"type":24,"value":716},{"type":18,"tag":629,"props":3284,"children":3285},{"class":642},[3286],{"type":24,"value":3253},{"type":18,"tag":629,"props":3288,"children":3289},{"class":686},[3290],{"type":24,"value":1368},{"type":18,"tag":629,"props":3292,"children":3293},{"class":642},[3294],{"type":24,"value":3295},"])\n",{"type":18,"tag":629,"props":3297,"children":3298},{"class":631,"line":705},[3299,3304,3308,3312,3316,3320,3324,3328],{"type":18,"tag":629,"props":3300,"children":3301},{"class":642},[3302],{"type":24,"value":3303},"        Lambda[",{"type":18,"tag":629,"props":3305,"children":3306},{"class":686},[3307],{"type":24,"value":882},{"type":18,"tag":629,"props":3309,"children":3310},{"class":642},[3311],{"type":24,"value":2432},{"type":18,"tag":629,"props":3313,"children":3314},{"class":636},[3315],{"type":24,"value":1061},{"type":18,"tag":629,"props":3317,"children":3318},{"class":686},[3319],{"type":24,"value":992},{"type":18,"tag":629,"props":3321,"children":3322},{"class":642},[3323],{"type":24,"value":2926},{"type":18,"tag":629,"props":3325,"children":3326},{"class":636},[3327],{"type":24,"value":726},{"type":18,"tag":629,"props":3329,"children":3330},{"class":642},[3331],{"type":24,"value":3332}," x_N\n",{"type":18,"tag":629,"props":3334,"children":3335},{"class":631,"line":734},[3336,3340,3344,3348,3352,3356,3360,3364],{"type":18,"tag":629,"props":3337,"children":3338},{"class":642},[3339],{"type":24,"value":3303},{"type":18,"tag":629,"props":3341,"children":3342},{"class":686},[3343],{"type":24,"value":992},{"type":18,"tag":629,"props":3345,"children":3346},{"class":642},[3347],{"type":24,"value":2432},{"type":18,"tag":629,"props":3349,"children":3350},{"class":636},[3351],{"type":24,"value":1061},{"type":18,"tag":629,"props":3353,"children":3354},{"class":686},[3355],{"type":24,"value":992},{"type":18,"tag":629,"props":3357,"children":3358},{"class":642},[3359],{"type":24,"value":2926},{"type":18,"tag":629,"props":3361,"children":3362},{"class":636},[3363],{"type":24,"value":726},{"type":18,"tag":629,"props":3365,"children":3366},{"class":642},[3367],{"type":24,"value":3368}," y_N\n",{"type":18,"tag":629,"props":3370,"children":3371},{"class":631,"line":760},[3372,3376,3380,3384,3388,3392,3396,3400],{"type":18,"tag":629,"props":3373,"children":3374},{"class":642},[3375],{"type":24,"value":3303},{"type":18,"tag":629,"props":3377,"children":3378},{"class":686},[3379],{"type":24,"value":1368},{"type":18,"tag":629,"props":3381,"children":3382},{"class":642},[3383],{"type":24,"value":2432},{"type":18,"tag":629,"props":3385,"children":3386},{"class":636},[3387],{"type":24,"value":1061},{"type":18,"tag":629,"props":3389,"children":3390},{"class":686},[3391],{"type":24,"value":992},{"type":18,"tag":629,"props":3393,"children":3394},{"class":642},[3395],{"type":24,"value":2926},{"type":18,"tag":629,"props":3397,"children":3398},{"class":636},[3399],{"type":24,"value":726},{"type":18,"tag":629,"props":3401,"children":3402},{"class":642},[3403],{"type":24,"value":3404}," yaw_N\n",{"type":18,"tag":629,"props":3406,"children":3407},{"class":631,"line":786},[3408],{"type":18,"tag":629,"props":3409,"children":3410},{},[3411],{"type":24,"value":665},{"type":18,"tag":629,"props":3413,"children":3414},{"class":631,"line":794},[3415],{"type":18,"tag":629,"props":3416,"children":3417},{},[3418],{"type":24,"value":665},{"type":18,"tag":629,"props":3420,"children":3421},{"class":631,"line":820},[3422,3426,3430,3434,3438,3442,3447,3451,3455,3459,3463,3467,3471],{"type":18,"tag":629,"props":3423,"children":3424},{"class":642},[3425],{"type":24,"value":711},{"type":18,"tag":629,"props":3427,"children":3428},{"class":636},[3429],{"type":24,"value":2805},{"type":18,"tag":629,"props":3431,"children":3432},{"class":642},[3433],{"type":24,"value":2810},{"type":18,"tag":629,"props":3435,"children":3436},{"class":636},[3437],{"type":24,"value":2815},{"type":18,"tag":629,"props":3439,"children":3440},{"class":642},[3441],{"type":24,"value":645},{"type":18,"tag":629,"props":3443,"children":3444},{"class":686},[3445],{"type":24,"value":3446},"reversed",{"type":18,"tag":629,"props":3448,"children":3449},{"class":642},[3450],{"type":24,"value":1402},{"type":18,"tag":629,"props":3452,"children":3453},{"class":686},[3454],{"type":24,"value":2824},{"type":18,"tag":629,"props":3456,"children":3457},{"class":642},[3458],{"type":24,"value":1402},{"type":18,"tag":629,"props":3460,"children":3461},{"class":686},[3462],{"type":24,"value":992},{"type":18,"tag":629,"props":3464,"children":3465},{"class":642},[3466],{"type":24,"value":2432},{"type":18,"tag":629,"props":3468,"children":3469},{"class":686},[3470],{"type":24,"value":716},{"type":18,"tag":629,"props":3472,"children":3473},{"class":642},[3474],{"type":24,"value":3475},".pred_horizons)):\n",{"type":18,"tag":629,"props":3477,"children":3478},{"class":631,"line":846},[3479],{"type":18,"tag":629,"props":3480,"children":3481},{},[3482],{"type":24,"value":665},{"type":18,"tag":629,"props":3484,"children":3485},{"class":631,"line":854},[3486,3491,3495,3499,3503],{"type":18,"tag":629,"props":3487,"children":3488},{"class":642},[3489],{"type":24,"value":3490},"            dhdx1, dhdx2, dhdx3 ",{"type":18,"tag":629,"props":3492,"children":3493},{"class":636},[3494],{"type":24,"value":726},{"type":18,"tag":629,"props":3496,"children":3497},{"class":642},[3498],{"type":24,"value":645},{"type":18,"tag":629,"props":3500,"children":3501},{"class":686},[3502],{"type":24,"value":716},{"type":18,"tag":629,"props":3504,"children":3505},{"class":642},[3506],{"type":24,"value":3507},".hjb_equation.dhdx(\n",{"type":18,"tag":629,"props":3509,"children":3510},{"class":631,"line":890},[3511,3516,3520,3525,3529,3533,3537],{"type":18,"tag":629,"props":3512,"children":3513},{"class":642},[3514],{"type":24,"value":3515},"                X[",{"type":18,"tag":629,"props":3517,"children":3518},{"class":686},[3519],{"type":24,"value":882},{"type":18,"tag":629,"props":3521,"children":3522},{"class":642},[3523],{"type":24,"value":3524},", i], X[",{"type":18,"tag":629,"props":3526,"children":3527},{"class":686},[3528],{"type":24,"value":992},{"type":18,"tag":629,"props":3530,"children":3531},{"class":642},[3532],{"type":24,"value":3524},{"type":18,"tag":629,"props":3534,"children":3535},{"class":686},[3536],{"type":24,"value":1368},{"type":18,"tag":629,"props":3538,"children":3539},{"class":642},[3540],{"type":24,"value":3541},", i],\n",{"type":18,"tag":629,"props":3543,"children":3544},{"class":631,"line":923},[3545,3550,3554,3558,3562,3566,3570,3574,3578,3582,3586,3590,3594],{"type":18,"tag":629,"props":3546,"children":3547},{"class":642},[3548],{"type":24,"value":3549},"                ",{"type":18,"tag":629,"props":3551,"children":3552},{"class":686},[3553],{"type":24,"value":716},{"type":18,"tag":629,"props":3555,"children":3556},{"class":642},[3557],{"type":24,"value":3253},{"type":18,"tag":629,"props":3559,"children":3560},{"class":686},[3561],{"type":24,"value":882},{"type":18,"tag":629,"props":3563,"children":3564},{"class":642},[3565],{"type":24,"value":3262},{"type":18,"tag":629,"props":3567,"children":3568},{"class":686},[3569],{"type":24,"value":716},{"type":18,"tag":629,"props":3571,"children":3572},{"class":642},[3573],{"type":24,"value":3253},{"type":18,"tag":629,"props":3575,"children":3576},{"class":686},[3577],{"type":24,"value":992},{"type":18,"tag":629,"props":3579,"children":3580},{"class":642},[3581],{"type":24,"value":3262},{"type":18,"tag":629,"props":3583,"children":3584},{"class":686},[3585],{"type":24,"value":716},{"type":18,"tag":629,"props":3587,"children":3588},{"class":642},[3589],{"type":24,"value":3253},{"type":18,"tag":629,"props":3591,"children":3592},{"class":686},[3593],{"type":24,"value":1368},{"type":18,"tag":629,"props":3595,"children":3596},{"class":642},[3597],{"type":24,"value":3236},{"type":18,"tag":629,"props":3599,"children":3600},{"class":631,"line":931},[3601,3606,3610,3615,3619,3623,3627,3631,3636,3640,3644,3648,3652],{"type":18,"tag":629,"props":3602,"children":3603},{"class":642},[3604],{"type":24,"value":3605},"                U[",{"type":18,"tag":629,"props":3607,"children":3608},{"class":686},[3609],{"type":24,"value":882},{"type":18,"tag":629,"props":3611,"children":3612},{"class":642},[3613],{"type":24,"value":3614},", i], Lambda[",{"type":18,"tag":629,"props":3616,"children":3617},{"class":686},[3618],{"type":24,"value":882},{"type":18,"tag":629,"props":3620,"children":3621},{"class":642},[3622],{"type":24,"value":2913},{"type":18,"tag":629,"props":3624,"children":3625},{"class":636},[3626],{"type":24,"value":1192},{"type":18,"tag":629,"props":3628,"children":3629},{"class":686},[3630],{"type":24,"value":992},{"type":18,"tag":629,"props":3632,"children":3633},{"class":642},[3634],{"type":24,"value":3635},"], Lambda[",{"type":18,"tag":629,"props":3637,"children":3638},{"class":686},[3639],{"type":24,"value":992},{"type":18,"tag":629,"props":3641,"children":3642},{"class":642},[3643],{"type":24,"value":2913},{"type":18,"tag":629,"props":3645,"children":3646},{"class":636},[3647],{"type":24,"value":1192},{"type":18,"tag":629,"props":3649,"children":3650},{"class":686},[3651],{"type":24,"value":992},{"type":18,"tag":629,"props":3653,"children":3654},{"class":642},[3655],{"type":24,"value":887},{"type":18,"tag":629,"props":3657,"children":3658},{"class":631,"line":965},[3659],{"type":18,"tag":629,"props":3660,"children":3661},{"class":642},[3662],{"type":24,"value":3663},"            )\n",{"type":18,"tag":629,"props":3665,"children":3666},{"class":631,"line":999},[3667],{"type":18,"tag":629,"props":3668,"children":3669},{},[3670],{"type":24,"value":665},{"type":18,"tag":629,"props":3672,"children":3673},{"class":631,"line":1007},[3674,3679,3683,3687,3691,3696,3700,3704,3708,3712,3716,3720,3725,3729],{"type":18,"tag":629,"props":3675,"children":3676},{"class":642},[3677],{"type":24,"value":3678},"            Lambda[",{"type":18,"tag":629,"props":3680,"children":3681},{"class":686},[3682],{"type":24,"value":882},{"type":18,"tag":629,"props":3684,"children":3685},{"class":642},[3686],{"type":24,"value":2944},{"type":18,"tag":629,"props":3688,"children":3689},{"class":636},[3690],{"type":24,"value":726},{"type":18,"tag":629,"props":3692,"children":3693},{"class":642},[3694],{"type":24,"value":3695}," Lambda[",{"type":18,"tag":629,"props":3697,"children":3698},{"class":686},[3699],{"type":24,"value":882},{"type":18,"tag":629,"props":3701,"children":3702},{"class":642},[3703],{"type":24,"value":2913},{"type":18,"tag":629,"props":3705,"children":3706},{"class":636},[3707],{"type":24,"value":1192},{"type":18,"tag":629,"props":3709,"children":3710},{"class":686},[3711],{"type":24,"value":992},{"type":18,"tag":629,"props":3713,"children":3714},{"class":642},[3715],{"type":24,"value":2926},{"type":18,"tag":629,"props":3717,"children":3718},{"class":636},[3719],{"type":24,"value":1192},{"type":18,"tag":629,"props":3721,"children":3722},{"class":642},[3723],{"type":24,"value":3724}," dhdx1 ",{"type":18,"tag":629,"props":3726,"children":3727},{"class":636},[3728],{"type":24,"value":1071},{"type":18,"tag":629,"props":3730,"children":3731},{"class":642},[3732],{"type":24,"value":2962},{"type":18,"tag":629,"props":3734,"children":3735},{"class":631,"line":1033},[3736,3740,3744,3748,3752,3756,3760,3764,3768,3772,3776,3780,3785,3789],{"type":18,"tag":629,"props":3737,"children":3738},{"class":642},[3739],{"type":24,"value":3678},{"type":18,"tag":629,"props":3741,"children":3742},{"class":686},[3743],{"type":24,"value":992},{"type":18,"tag":629,"props":3745,"children":3746},{"class":642},[3747],{"type":24,"value":2944},{"type":18,"tag":629,"props":3749,"children":3750},{"class":636},[3751],{"type":24,"value":726},{"type":18,"tag":629,"props":3753,"children":3754},{"class":642},[3755],{"type":24,"value":3695},{"type":18,"tag":629,"props":3757,"children":3758},{"class":686},[3759],{"type":24,"value":992},{"type":18,"tag":629,"props":3761,"children":3762},{"class":642},[3763],{"type":24,"value":2913},{"type":18,"tag":629,"props":3765,"children":3766},{"class":636},[3767],{"type":24,"value":1192},{"type":18,"tag":629,"props":3769,"children":3770},{"class":686},[3771],{"type":24,"value":992},{"type":18,"tag":629,"props":3773,"children":3774},{"class":642},[3775],{"type":24,"value":2926},{"type":18,"tag":629,"props":3777,"children":3778},{"class":636},[3779],{"type":24,"value":1192},{"type":18,"tag":629,"props":3781,"children":3782},{"class":642},[3783],{"type":24,"value":3784}," dhdx2 ",{"type":18,"tag":629,"props":3786,"children":3787},{"class":636},[3788],{"type":24,"value":1071},{"type":18,"tag":629,"props":3790,"children":3791},{"class":642},[3792],{"type":24,"value":2962},{"type":18,"tag":629,"props":3794,"children":3795},{"class":631,"line":1041},[3796,3800,3804,3808,3812,3816,3820,3824,3828,3832,3836,3840,3845,3849],{"type":18,"tag":629,"props":3797,"children":3798},{"class":642},[3799],{"type":24,"value":3678},{"type":18,"tag":629,"props":3801,"children":3802},{"class":686},[3803],{"type":24,"value":1368},{"type":18,"tag":629,"props":3805,"children":3806},{"class":642},[3807],{"type":24,"value":2944},{"type":18,"tag":629,"props":3809,"children":3810},{"class":636},[3811],{"type":24,"value":726},{"type":18,"tag":629,"props":3813,"children":3814},{"class":642},[3815],{"type":24,"value":3695},{"type":18,"tag":629,"props":3817,"children":3818},{"class":686},[3819],{"type":24,"value":1368},{"type":18,"tag":629,"props":3821,"children":3822},{"class":642},[3823],{"type":24,"value":2913},{"type":18,"tag":629,"props":3825,"children":3826},{"class":636},[3827],{"type":24,"value":1192},{"type":18,"tag":629,"props":3829,"children":3830},{"class":686},[3831],{"type":24,"value":992},{"type":18,"tag":629,"props":3833,"children":3834},{"class":642},[3835],{"type":24,"value":2926},{"type":18,"tag":629,"props":3837,"children":3838},{"class":636},[3839],{"type":24,"value":1192},{"type":18,"tag":629,"props":3841,"children":3842},{"class":642},[3843],{"type":24,"value":3844}," dhdx3 ",{"type":18,"tag":629,"props":3846,"children":3847},{"class":636},[3848],{"type":24,"value":1071},{"type":18,"tag":629,"props":3850,"children":3851},{"class":642},[3852],{"type":24,"value":2962},{"type":18,"tag":629,"props":3854,"children":3855},{"class":631,"line":1083},[3856],{"type":18,"tag":629,"props":3857,"children":3858},{"class":642},[3859],{"type":24,"value":3860},"    \n",{"type":18,"tag":629,"props":3862,"children":3863},{"class":631,"line":1123},[3864],{"type":18,"tag":629,"props":3865,"children":3866},{},[3867],{"type":24,"value":665},{"type":18,"tag":629,"props":3869,"children":3870},{"class":631,"line":1217},[3871,3875,3879],{"type":18,"tag":629,"props":3872,"children":3873},{"class":642},[3874],{"type":24,"value":711},{"type":18,"tag":629,"props":3876,"children":3877},{"class":636},[3878],{"type":24,"value":1235},{"type":18,"tag":629,"props":3880,"children":3881},{"class":642},[3882],{"type":24,"value":3883}," Lambda",{"type":18,"tag":27,"props":3885,"children":3886},{},[3887],{"type":24,"value":3888},"And finally, calculating Newton F Function",{"type":18,"tag":614,"props":3890,"children":3893},{"className":3891,"code":3892,"language":619,"meta":8},[617],"def calc_f(self, X, U, Lambda, Mu, dt):\n\n        X_new = self.calc_state(X, U, dt)\n\n        Lambda_new = self.calc_costate(X_new, U, Lambda, dt)\n\n        F = np.zeros((self.u_dim, self.pred_horizons))\n\n        for i in range(self.pred_horizons):\n            dhdu1, dhdu2 = self.hjb_equation.dhdu(X_new[2, i], U[0, i], U[1, i],\n                                                  self.U_r[0], self.U_r[1],\n                                                  Lambda_new[0, i+1], Lambda_new[1, i+1], Lambda_new[2, i+1],\n                                                  Mu[0, i], Mu[1, i])\n            F[0, i] = dhdu1\n            F[1, i] = dhdu2\n            \n        F = F.T.ravel().reshape(-1, 1)\n\n        return F\n",[3894],{"type":18,"tag":622,"props":3895,"children":3896},{},[3897],{"type":18,"tag":614,"props":3898,"children":3899},{"__ignoreMap":8},[3900,3921,3928,3953,3960,3985,3992,4024,4031,4070,4119,4160,4229,4254,4279,4303,4310,4346,4353],{"type":18,"tag":629,"props":3901,"children":3902},{"class":631,"line":632},[3903,3907,3911,3916],{"type":18,"tag":629,"props":3904,"children":3905},{"class":636},[3906],{"type":24,"value":679},{"type":18,"tag":629,"props":3908,"children":3909},{"class":642},[3910],{"type":24,"value":645},{"type":18,"tag":629,"props":3912,"children":3913},{"class":648},[3914],{"type":24,"value":3915},"calc_f",{"type":18,"tag":629,"props":3917,"children":3918},{"class":642},[3919],{"type":24,"value":3920},"(self, X, U, Lambda, Mu, dt):\n",{"type":18,"tag":629,"props":3922,"children":3923},{"class":631,"line":659},[3924],{"type":18,"tag":629,"props":3925,"children":3926},{},[3927],{"type":24,"value":665},{"type":18,"tag":629,"props":3929,"children":3930},{"class":631,"line":668},[3931,3936,3940,3944,3948],{"type":18,"tag":629,"props":3932,"children":3933},{"class":642},[3934],{"type":24,"value":3935},"        X_new ",{"type":18,"tag":629,"props":3937,"children":3938},{"class":636},[3939],{"type":24,"value":726},{"type":18,"tag":629,"props":3941,"children":3942},{"class":642},[3943],{"type":24,"value":645},{"type":18,"tag":629,"props":3945,"children":3946},{"class":686},[3947],{"type":24,"value":716},{"type":18,"tag":629,"props":3949,"children":3950},{"class":642},[3951],{"type":24,"value":3952},".calc_state(X, U, dt)\n",{"type":18,"tag":629,"props":3954,"children":3955},{"class":631,"line":697},[3956],{"type":18,"tag":629,"props":3957,"children":3958},{},[3959],{"type":24,"value":665},{"type":18,"tag":629,"props":3961,"children":3962},{"class":631,"line":705},[3963,3968,3972,3976,3980],{"type":18,"tag":629,"props":3964,"children":3965},{"class":642},[3966],{"type":24,"value":3967},"        Lambda_new ",{"type":18,"tag":629,"props":3969,"children":3970},{"class":636},[3971],{"type":24,"value":726},{"type":18,"tag":629,"props":3973,"children":3974},{"class":642},[3975],{"type":24,"value":645},{"type":18,"tag":629,"props":3977,"children":3978},{"class":686},[3979],{"type":24,"value":716},{"type":18,"tag":629,"props":3981,"children":3982},{"class":642},[3983],{"type":24,"value":3984},".calc_costate(X_new, U, Lambda, dt)\n",{"type":18,"tag":629,"props":3986,"children":3987},{"class":631,"line":734},[3988],{"type":18,"tag":629,"props":3989,"children":3990},{},[3991],{"type":24,"value":665},{"type":18,"tag":629,"props":3993,"children":3994},{"class":631,"line":760},[3995,4000,4004,4008,4012,4016,4020],{"type":18,"tag":629,"props":3996,"children":3997},{"class":642},[3998],{"type":24,"value":3999},"        F ",{"type":18,"tag":629,"props":4001,"children":4002},{"class":636},[4003],{"type":24,"value":726},{"type":18,"tag":629,"props":4005,"children":4006},{"class":642},[4007],{"type":24,"value":2484},{"type":18,"tag":629,"props":4009,"children":4010},{"class":686},[4011],{"type":24,"value":716},{"type":18,"tag":629,"props":4013,"children":4014},{"class":642},[4015],{"type":24,"value":2493},{"type":18,"tag":629,"props":4017,"children":4018},{"class":686},[4019],{"type":24,"value":716},{"type":18,"tag":629,"props":4021,"children":4022},{"class":642},[4023],{"type":24,"value":2502},{"type":18,"tag":629,"props":4025,"children":4026},{"class":631,"line":786},[4027],{"type":18,"tag":629,"props":4028,"children":4029},{},[4030],{"type":24,"value":665},{"type":18,"tag":629,"props":4032,"children":4033},{"class":631,"line":794},[4034,4038,4042,4046,4050,4054,4058,4062,4066],{"type":18,"tag":629,"props":4035,"children":4036},{"class":642},[4037],{"type":24,"value":711},{"type":18,"tag":629,"props":4039,"children":4040},{"class":636},[4041],{"type":24,"value":2805},{"type":18,"tag":629,"props":4043,"children":4044},{"class":642},[4045],{"type":24,"value":2810},{"type":18,"tag":629,"props":4047,"children":4048},{"class":636},[4049],{"type":24,"value":2815},{"type":18,"tag":629,"props":4051,"children":4052},{"class":642},[4053],{"type":24,"value":645},{"type":18,"tag":629,"props":4055,"children":4056},{"class":686},[4057],{"type":24,"value":2824},{"type":18,"tag":629,"props":4059,"children":4060},{"class":642},[4061],{"type":24,"value":1402},{"type":18,"tag":629,"props":4063,"children":4064},{"class":686},[4065],{"type":24,"value":716},{"type":18,"tag":629,"props":4067,"children":4068},{"class":642},[4069],{"type":24,"value":2837},{"type":18,"tag":629,"props":4071,"children":4072},{"class":631,"line":820},[4073,4078,4082,4086,4090,4095,4099,4103,4107,4111,4115],{"type":18,"tag":629,"props":4074,"children":4075},{"class":642},[4076],{"type":24,"value":4077},"            dhdu1, dhdu2 ",{"type":18,"tag":629,"props":4079,"children":4080},{"class":636},[4081],{"type":24,"value":726},{"type":18,"tag":629,"props":4083,"children":4084},{"class":642},[4085],{"type":24,"value":645},{"type":18,"tag":629,"props":4087,"children":4088},{"class":686},[4089],{"type":24,"value":716},{"type":18,"tag":629,"props":4091,"children":4092},{"class":642},[4093],{"type":24,"value":4094},".hjb_equation.dhdu(X_new[",{"type":18,"tag":629,"props":4096,"children":4097},{"class":686},[4098],{"type":24,"value":1368},{"type":18,"tag":629,"props":4100,"children":4101},{"class":642},[4102],{"type":24,"value":2871},{"type":18,"tag":629,"props":4104,"children":4105},{"class":686},[4106],{"type":24,"value":882},{"type":18,"tag":629,"props":4108,"children":4109},{"class":642},[4110],{"type":24,"value":2871},{"type":18,"tag":629,"props":4112,"children":4113},{"class":686},[4114],{"type":24,"value":992},{"type":18,"tag":629,"props":4116,"children":4117},{"class":642},[4118],{"type":24,"value":3541},{"type":18,"tag":629,"props":4120,"children":4121},{"class":631,"line":846},[4122,4127,4131,4136,4140,4144,4148,4152,4156],{"type":18,"tag":629,"props":4123,"children":4124},{"class":642},[4125],{"type":24,"value":4126},"                                                  ",{"type":18,"tag":629,"props":4128,"children":4129},{"class":686},[4130],{"type":24,"value":716},{"type":18,"tag":629,"props":4132,"children":4133},{"class":642},[4134],{"type":24,"value":4135},".U_r[",{"type":18,"tag":629,"props":4137,"children":4138},{"class":686},[4139],{"type":24,"value":882},{"type":18,"tag":629,"props":4141,"children":4142},{"class":642},[4143],{"type":24,"value":3262},{"type":18,"tag":629,"props":4145,"children":4146},{"class":686},[4147],{"type":24,"value":716},{"type":18,"tag":629,"props":4149,"children":4150},{"class":642},[4151],{"type":24,"value":4135},{"type":18,"tag":629,"props":4153,"children":4154},{"class":686},[4155],{"type":24,"value":992},{"type":18,"tag":629,"props":4157,"children":4158},{"class":642},[4159],{"type":24,"value":3236},{"type":18,"tag":629,"props":4161,"children":4162},{"class":631,"line":854},[4163,4168,4172,4176,4180,4184,4189,4193,4197,4201,4205,4209,4213,4217,4221,4225],{"type":18,"tag":629,"props":4164,"children":4165},{"class":642},[4166],{"type":24,"value":4167},"                                                  Lambda_new[",{"type":18,"tag":629,"props":4169,"children":4170},{"class":686},[4171],{"type":24,"value":882},{"type":18,"tag":629,"props":4173,"children":4174},{"class":642},[4175],{"type":24,"value":2913},{"type":18,"tag":629,"props":4177,"children":4178},{"class":636},[4179],{"type":24,"value":1192},{"type":18,"tag":629,"props":4181,"children":4182},{"class":686},[4183],{"type":24,"value":992},{"type":18,"tag":629,"props":4185,"children":4186},{"class":642},[4187],{"type":24,"value":4188},"], Lambda_new[",{"type":18,"tag":629,"props":4190,"children":4191},{"class":686},[4192],{"type":24,"value":992},{"type":18,"tag":629,"props":4194,"children":4195},{"class":642},[4196],{"type":24,"value":2913},{"type":18,"tag":629,"props":4198,"children":4199},{"class":636},[4200],{"type":24,"value":1192},{"type":18,"tag":629,"props":4202,"children":4203},{"class":686},[4204],{"type":24,"value":992},{"type":18,"tag":629,"props":4206,"children":4207},{"class":642},[4208],{"type":24,"value":4188},{"type":18,"tag":629,"props":4210,"children":4211},{"class":686},[4212],{"type":24,"value":1368},{"type":18,"tag":629,"props":4214,"children":4215},{"class":642},[4216],{"type":24,"value":2913},{"type":18,"tag":629,"props":4218,"children":4219},{"class":636},[4220],{"type":24,"value":1192},{"type":18,"tag":629,"props":4222,"children":4223},{"class":686},[4224],{"type":24,"value":992},{"type":18,"tag":629,"props":4226,"children":4227},{"class":642},[4228],{"type":24,"value":3236},{"type":18,"tag":629,"props":4230,"children":4231},{"class":631,"line":890},[4232,4237,4241,4246,4250],{"type":18,"tag":629,"props":4233,"children":4234},{"class":642},[4235],{"type":24,"value":4236},"                                                  Mu[",{"type":18,"tag":629,"props":4238,"children":4239},{"class":686},[4240],{"type":24,"value":882},{"type":18,"tag":629,"props":4242,"children":4243},{"class":642},[4244],{"type":24,"value":4245},", i], Mu[",{"type":18,"tag":629,"props":4247,"children":4248},{"class":686},[4249],{"type":24,"value":992},{"type":18,"tag":629,"props":4251,"children":4252},{"class":642},[4253],{"type":24,"value":2888},{"type":18,"tag":629,"props":4255,"children":4256},{"class":631,"line":923},[4257,4262,4266,4270,4274],{"type":18,"tag":629,"props":4258,"children":4259},{"class":642},[4260],{"type":24,"value":4261},"            F[",{"type":18,"tag":629,"props":4263,"children":4264},{"class":686},[4265],{"type":24,"value":882},{"type":18,"tag":629,"props":4267,"children":4268},{"class":642},[4269],{"type":24,"value":2944},{"type":18,"tag":629,"props":4271,"children":4272},{"class":636},[4273],{"type":24,"value":726},{"type":18,"tag":629,"props":4275,"children":4276},{"class":642},[4277],{"type":24,"value":4278}," dhdu1\n",{"type":18,"tag":629,"props":4280,"children":4281},{"class":631,"line":931},[4282,4286,4290,4294,4298],{"type":18,"tag":629,"props":4283,"children":4284},{"class":642},[4285],{"type":24,"value":4261},{"type":18,"tag":629,"props":4287,"children":4288},{"class":686},[4289],{"type":24,"value":992},{"type":18,"tag":629,"props":4291,"children":4292},{"class":642},[4293],{"type":24,"value":2944},{"type":18,"tag":629,"props":4295,"children":4296},{"class":636},[4297],{"type":24,"value":726},{"type":18,"tag":629,"props":4299,"children":4300},{"class":642},[4301],{"type":24,"value":4302}," dhdu2\n",{"type":18,"tag":629,"props":4304,"children":4305},{"class":631,"line":965},[4306],{"type":18,"tag":629,"props":4307,"children":4308},{"class":642},[4309],{"type":24,"value":2896},{"type":18,"tag":629,"props":4311,"children":4312},{"class":631,"line":999},[4313,4317,4321,4326,4330,4334,4338,4342],{"type":18,"tag":629,"props":4314,"children":4315},{"class":642},[4316],{"type":24,"value":3999},{"type":18,"tag":629,"props":4318,"children":4319},{"class":636},[4320],{"type":24,"value":726},{"type":18,"tag":629,"props":4322,"children":4323},{"class":642},[4324],{"type":24,"value":4325}," F.T.ravel().reshape(",{"type":18,"tag":629,"props":4327,"children":4328},{"class":636},[4329],{"type":24,"value":1061},{"type":18,"tag":629,"props":4331,"children":4332},{"class":686},[4333],{"type":24,"value":992},{"type":18,"tag":629,"props":4335,"children":4336},{"class":642},[4337],{"type":24,"value":2432},{"type":18,"tag":629,"props":4339,"children":4340},{"class":686},[4341],{"type":24,"value":992},{"type":18,"tag":629,"props":4343,"children":4344},{"class":642},[4345],{"type":24,"value":1438},{"type":18,"tag":629,"props":4347,"children":4348},{"class":631,"line":1007},[4349],{"type":18,"tag":629,"props":4350,"children":4351},{},[4352],{"type":24,"value":665},{"type":18,"tag":629,"props":4354,"children":4355},{"class":631,"line":1033},[4356,4360,4364],{"type":18,"tag":629,"props":4357,"children":4358},{"class":642},[4359],{"type":24,"value":711},{"type":18,"tag":629,"props":4361,"children":4362},{"class":636},[4363],{"type":24,"value":1235},{"type":18,"tag":629,"props":4365,"children":4366},{"class":642},[4367],{"type":24,"value":4368}," F",{"type":18,"tag":27,"props":4370,"children":4371},{},[4372,4374,4380,4382,4387],{"type":24,"value":4373},"Now let's introduce Continuation method for Function ",{"type":18,"tag":4375,"props":4376,"children":4377},"code-inline",{},[4378],{"type":24,"value":4379},"F",{"type":24,"value":4381},", you can look at the ",{"type":18,"tag":170,"props":4383,"children":4384},{},[4385],{"type":24,"value":4386}," Continuation ",{"type":24,"value":4388}," part.",{"type":18,"tag":614,"props":4390,"children":4393},{"className":4391,"code":4392,"language":619,"meta":8},[617],"# Time step horizons\ndt = self.tf * (1-np.exp(-self.alpha*time)) / self.pred_horizons\n# F(x,u,t+h)\nF = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u,t+h)\nx_dot, y_dot, yaw_dot = self.robot_model.forward_kinematic(X[2, 0], U[0, 0], U[1, 0])\nX[:, 0] = X[:, 0] + np.array([x_dot, y_dot, yaw_dot]) * self.ht\nFxt = self.calc_f(X, U, Lambda, Mu, dt)\n# F(x+hdx,u+hdx,t+h)\nFuxt = self.calc_f(X, U + self.dU*self.ht, Lambda, Mu , dt)\n\n# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n",[4394],{"type":18,"tag":622,"props":4395,"children":4396},{},[4397],{"type":18,"tag":614,"props":4398,"children":4399},{"__ignoreMap":8},[4400,4408,4492,4500,4525,4533,4606,4664,4688,4696,4751,4758,4766,4808],{"type":18,"tag":629,"props":4401,"children":4402},{"class":631,"line":632},[4403],{"type":18,"tag":629,"props":4404,"children":4405},{"class":1866},[4406],{"type":24,"value":4407},"# Time step horizons\n",{"type":18,"tag":629,"props":4409,"children":4410},{"class":631,"line":659},[4411,4415,4419,4423,4427,4431,4435,4440,4444,4448,4453,4457,4461,4466,4470,4475,4479,4483,4487],{"type":18,"tag":629,"props":4412,"children":4413},{"class":642},[4414],{"type":24,"value":2727},{"type":18,"tag":629,"props":4416,"children":4417},{"class":636},[4418],{"type":24,"value":726},{"type":18,"tag":629,"props":4420,"children":4421},{"class":642},[4422],{"type":24,"value":645},{"type":18,"tag":629,"props":4424,"children":4425},{"class":686},[4426],{"type":24,"value":716},{"type":18,"tag":629,"props":4428,"children":4429},{"class":642},[4430],{"type":24,"value":2118},{"type":18,"tag":629,"props":4432,"children":4433},{"class":636},[4434],{"type":24,"value":1071},{"type":18,"tag":629,"props":4436,"children":4437},{"class":642},[4438],{"type":24,"value":4439}," (",{"type":18,"tag":629,"props":4441,"children":4442},{"class":686},[4443],{"type":24,"value":992},{"type":18,"tag":629,"props":4445,"children":4446},{"class":636},[4447],{"type":24,"value":1061},{"type":18,"tag":629,"props":4449,"children":4450},{"class":642},[4451],{"type":24,"value":4452},"np.exp(",{"type":18,"tag":629,"props":4454,"children":4455},{"class":636},[4456],{"type":24,"value":1061},{"type":18,"tag":629,"props":4458,"children":4459},{"class":686},[4460],{"type":24,"value":716},{"type":18,"tag":629,"props":4462,"children":4463},{"class":642},[4464],{"type":24,"value":4465},".alpha",{"type":18,"tag":629,"props":4467,"children":4468},{"class":636},[4469],{"type":24,"value":1071},{"type":18,"tag":629,"props":4471,"children":4472},{"class":642},[4473],{"type":24,"value":4474},"time)) ",{"type":18,"tag":629,"props":4476,"children":4477},{"class":636},[4478],{"type":24,"value":1429},{"type":18,"tag":629,"props":4480,"children":4481},{"class":642},[4482],{"type":24,"value":645},{"type":18,"tag":629,"props":4484,"children":4485},{"class":686},[4486],{"type":24,"value":716},{"type":18,"tag":629,"props":4488,"children":4489},{"class":642},[4490],{"type":24,"value":4491},".pred_horizons\n",{"type":18,"tag":629,"props":4493,"children":4494},{"class":631,"line":668},[4495],{"type":18,"tag":629,"props":4496,"children":4497},{"class":1866},[4498],{"type":24,"value":4499},"# F(x,u,t+h)\n",{"type":18,"tag":629,"props":4501,"children":4502},{"class":631,"line":697},[4503,4508,4512,4516,4520],{"type":18,"tag":629,"props":4504,"children":4505},{"class":642},[4506],{"type":24,"value":4507},"F ",{"type":18,"tag":629,"props":4509,"children":4510},{"class":636},[4511],{"type":24,"value":726},{"type":18,"tag":629,"props":4513,"children":4514},{"class":642},[4515],{"type":24,"value":645},{"type":18,"tag":629,"props":4517,"children":4518},{"class":686},[4519],{"type":24,"value":716},{"type":18,"tag":629,"props":4521,"children":4522},{"class":642},[4523],{"type":24,"value":4524},".calc_f(X, U, Lambda, Mu, dt)\n",{"type":18,"tag":629,"props":4526,"children":4527},{"class":631,"line":705},[4528],{"type":18,"tag":629,"props":4529,"children":4530},{"class":1866},[4531],{"type":24,"value":4532},"# F(x+hdx,u,t+h)\n",{"type":18,"tag":629,"props":4534,"children":4535},{"class":631,"line":734},[4536,4541,4545,4549,4553,4557,4561,4565,4569,4574,4578,4582,4586,4590,4594,4598,4602],{"type":18,"tag":629,"props":4537,"children":4538},{"class":642},[4539],{"type":24,"value":4540},"x_dot, y_dot, yaw_dot ",{"type":18,"tag":629,"props":4542,"children":4543},{"class":636},[4544],{"type":24,"value":726},{"type":18,"tag":629,"props":4546,"children":4547},{"class":642},[4548],{"type":24,"value":645},{"type":18,"tag":629,"props":4550,"children":4551},{"class":686},[4552],{"type":24,"value":716},{"type":18,"tag":629,"props":4554,"children":4555},{"class":642},[4556],{"type":24,"value":2862},{"type":18,"tag":629,"props":4558,"children":4559},{"class":686},[4560],{"type":24,"value":1368},{"type":18,"tag":629,"props":4562,"children":4563},{"class":642},[4564],{"type":24,"value":2432},{"type":18,"tag":629,"props":4566,"children":4567},{"class":686},[4568],{"type":24,"value":882},{"type":18,"tag":629,"props":4570,"children":4571},{"class":642},[4572],{"type":24,"value":4573},"], U[",{"type":18,"tag":629,"props":4575,"children":4576},{"class":686},[4577],{"type":24,"value":882},{"type":18,"tag":629,"props":4579,"children":4580},{"class":642},[4581],{"type":24,"value":2432},{"type":18,"tag":629,"props":4583,"children":4584},{"class":686},[4585],{"type":24,"value":882},{"type":18,"tag":629,"props":4587,"children":4588},{"class":642},[4589],{"type":24,"value":4573},{"type":18,"tag":629,"props":4591,"children":4592},{"class":686},[4593],{"type":24,"value":992},{"type":18,"tag":629,"props":4595,"children":4596},{"class":642},[4597],{"type":24,"value":2432},{"type":18,"tag":629,"props":4599,"children":4600},{"class":686},[4601],{"type":24,"value":882},{"type":18,"tag":629,"props":4603,"children":4604},{"class":642},[4605],{"type":24,"value":3295},{"type":18,"tag":629,"props":4607,"children":4608},{"class":631,"line":760},[4609,4614,4618,4622,4626,4631,4635,4639,4643,4648,4652,4656,4660],{"type":18,"tag":629,"props":4610,"children":4611},{"class":642},[4612],{"type":24,"value":4613},"X[:, ",{"type":18,"tag":629,"props":4615,"children":4616},{"class":686},[4617],{"type":24,"value":882},{"type":18,"tag":629,"props":4619,"children":4620},{"class":642},[4621],{"type":24,"value":2926},{"type":18,"tag":629,"props":4623,"children":4624},{"class":636},[4625],{"type":24,"value":726},{"type":18,"tag":629,"props":4627,"children":4628},{"class":642},[4629],{"type":24,"value":4630}," X[:, ",{"type":18,"tag":629,"props":4632,"children":4633},{"class":686},[4634],{"type":24,"value":882},{"type":18,"tag":629,"props":4636,"children":4637},{"class":642},[4638],{"type":24,"value":2926},{"type":18,"tag":629,"props":4640,"children":4641},{"class":636},[4642],{"type":24,"value":1192},{"type":18,"tag":629,"props":4644,"children":4645},{"class":642},[4646],{"type":24,"value":4647}," np.array([x_dot, y_dot, yaw_dot]) ",{"type":18,"tag":629,"props":4649,"children":4650},{"class":636},[4651],{"type":24,"value":1071},{"type":18,"tag":629,"props":4653,"children":4654},{"class":642},[4655],{"type":24,"value":645},{"type":18,"tag":629,"props":4657,"children":4658},{"class":686},[4659],{"type":24,"value":716},{"type":18,"tag":629,"props":4661,"children":4662},{"class":642},[4663],{"type":24,"value":2073},{"type":18,"tag":629,"props":4665,"children":4666},{"class":631,"line":786},[4667,4672,4676,4680,4684],{"type":18,"tag":629,"props":4668,"children":4669},{"class":642},[4670],{"type":24,"value":4671},"Fxt ",{"type":18,"tag":629,"props":4673,"children":4674},{"class":636},[4675],{"type":24,"value":726},{"type":18,"tag":629,"props":4677,"children":4678},{"class":642},[4679],{"type":24,"value":645},{"type":18,"tag":629,"props":4681,"children":4682},{"class":686},[4683],{"type":24,"value":716},{"type":18,"tag":629,"props":4685,"children":4686},{"class":642},[4687],{"type":24,"value":4524},{"type":18,"tag":629,"props":4689,"children":4690},{"class":631,"line":794},[4691],{"type":18,"tag":629,"props":4692,"children":4693},{"class":1866},[4694],{"type":24,"value":4695},"# F(x+hdx,u+hdx,t+h)\n",{"type":18,"tag":629,"props":4697,"children":4698},{"class":631,"line":820},[4699,4704,4708,4712,4716,4721,4725,4729,4733,4738,4742,4746],{"type":18,"tag":629,"props":4700,"children":4701},{"class":642},[4702],{"type":24,"value":4703},"Fuxt ",{"type":18,"tag":629,"props":4705,"children":4706},{"class":636},[4707],{"type":24,"value":726},{"type":18,"tag":629,"props":4709,"children":4710},{"class":642},[4711],{"type":24,"value":645},{"type":18,"tag":629,"props":4713,"children":4714},{"class":686},[4715],{"type":24,"value":716},{"type":18,"tag":629,"props":4717,"children":4718},{"class":642},[4719],{"type":24,"value":4720},".calc_f(X, U ",{"type":18,"tag":629,"props":4722,"children":4723},{"class":636},[4724],{"type":24,"value":1192},{"type":18,"tag":629,"props":4726,"children":4727},{"class":642},[4728],{"type":24,"value":645},{"type":18,"tag":629,"props":4730,"children":4731},{"class":686},[4732],{"type":24,"value":716},{"type":18,"tag":629,"props":4734,"children":4735},{"class":642},[4736],{"type":24,"value":4737},".dU",{"type":18,"tag":629,"props":4739,"children":4740},{"class":636},[4741],{"type":24,"value":1071},{"type":18,"tag":629,"props":4743,"children":4744},{"class":686},[4745],{"type":24,"value":716},{"type":18,"tag":629,"props":4747,"children":4748},{"class":642},[4749],{"type":24,"value":4750},".ht, Lambda, Mu , dt)\n",{"type":18,"tag":629,"props":4752,"children":4753},{"class":631,"line":846},[4754],{"type":18,"tag":629,"props":4755,"children":4756},{},[4757],{"type":24,"value":665},{"type":18,"tag":629,"props":4759,"children":4760},{"class":631,"line":854},[4761],{"type":18,"tag":629,"props":4762,"children":4763},{"class":1866},[4764],{"type":24,"value":4765},"# Define right-left handside equation\n",{"type":18,"tag":629,"props":4767,"children":4768},{"class":631,"line":890},[4769,4774,4778,4783,4787,4792,4796,4800,4804],{"type":18,"tag":629,"props":4770,"children":4771},{"class":642},[4772],{"type":24,"value":4773},"left ",{"type":18,"tag":629,"props":4775,"children":4776},{"class":636},[4777],{"type":24,"value":726},{"type":18,"tag":629,"props":4779,"children":4780},{"class":642},[4781],{"type":24,"value":4782}," (Fuxt ",{"type":18,"tag":629,"props":4784,"children":4785},{"class":636},[4786],{"type":24,"value":1061},{"type":18,"tag":629,"props":4788,"children":4789},{"class":642},[4790],{"type":24,"value":4791}," Fxt) ",{"type":18,"tag":629,"props":4793,"children":4794},{"class":636},[4795],{"type":24,"value":1429},{"type":18,"tag":629,"props":4797,"children":4798},{"class":642},[4799],{"type":24,"value":645},{"type":18,"tag":629,"props":4801,"children":4802},{"class":686},[4803],{"type":24,"value":716},{"type":18,"tag":629,"props":4805,"children":4806},{"class":642},[4807],{"type":24,"value":2073},{"type":18,"tag":629,"props":4809,"children":4810},{"class":631,"line":923},[4811,4816,4820,4824,4828,4832,4836,4840,4845,4849,4854,4858,4863,4867,4871],{"type":18,"tag":629,"props":4812,"children":4813},{"class":642},[4814],{"type":24,"value":4815},"right ",{"type":18,"tag":629,"props":4817,"children":4818},{"class":636},[4819],{"type":24,"value":726},{"type":18,"tag":629,"props":4821,"children":4822},{"class":642},[4823],{"type":24,"value":645},{"type":18,"tag":629,"props":4825,"children":4826},{"class":636},[4827],{"type":24,"value":1061},{"type":18,"tag":629,"props":4829,"children":4830},{"class":686},[4831],{"type":24,"value":716},{"type":18,"tag":629,"props":4833,"children":4834},{"class":642},[4835],{"type":24,"value":2048},{"type":18,"tag":629,"props":4837,"children":4838},{"class":636},[4839],{"type":24,"value":1071},{"type":18,"tag":629,"props":4841,"children":4842},{"class":642},[4843],{"type":24,"value":4844}," F ",{"type":18,"tag":629,"props":4846,"children":4847},{"class":636},[4848],{"type":24,"value":1061},{"type":18,"tag":629,"props":4850,"children":4851},{"class":642},[4852],{"type":24,"value":4853}," (Fxt ",{"type":18,"tag":629,"props":4855,"children":4856},{"class":636},[4857],{"type":24,"value":1061},{"type":18,"tag":629,"props":4859,"children":4860},{"class":642},[4861],{"type":24,"value":4862}," F)",{"type":18,"tag":629,"props":4864,"children":4865},{"class":636},[4866],{"type":24,"value":1429},{"type":18,"tag":629,"props":4868,"children":4869},{"class":686},[4870],{"type":24,"value":716},{"type":18,"tag":629,"props":4872,"children":4873},{"class":642},[4874],{"type":24,"value":4875},".ht",{"type":18,"tag":27,"props":4877,"children":4878},{},[4879,4881,4885],{"type":24,"value":4880},"Here is the crucial part, we need to implement GMRES solver for our ",{"type":18,"tag":4375,"props":4882,"children":4883},{},[4884],{"type":24,"value":4379},{"type":24,"value":4886}," function to obtain solution vector.",{"type":18,"tag":614,"props":4888,"children":4891},{"className":4889,"code":4890,"language":619,"meta":8},[617],"# Define right-left handside equation\nleft = (Fuxt - Fxt) / self.ht\nright = -self.zeta * F - (Fxt - F)/self.ht\n\n# Define iterations\nm = (self.u_dim ) * self.pred_horizons\n# Define r0\nr0 = right - left\n# print(r0)\n\n# GMRES\nVm = np.zeros((m, m+1))\nVm[:, 0:1] = r0 / np.linalg.norm(r0)\n# print(\"Vm\", Vm[:, 0])\nHm = np.zeros((m+1, m))\n# print(Vm[:, 0])\n\n\nfor i in range(m):\n    Fuxt = self.calc_f(\n        X, U + Vm[:, i:i+1].reshape(self.u_dim, self.pred_horizons, order='F') * self.ht,\n        Lambda, Mu,\n        dt\n    )\n\n    Av = (Fuxt - Fxt) / self.ht\n\n    for k in range(i+1):\n        Hm[k, i] = np.dot(Av.T, Vm[:, k:k+1])\n\n    temp_vec = np.zeros((m, 1))\n\n    for k in range(i+1):\n        temp_vec = temp_vec + np.dot(Hm[k, i], Vm[:, k:k+1])\n\n    v_hat = Av - temp_vec\n\n    Hm[i+1, i] = np.linalg.norm(v_hat)\n\n    Vm[:,i+1:i+2] = v_hat/Hm[i+1, i]\n\ne = np.zeros((m+1, 1))\ne[0, 0] = 1.0\ngm = np.linalg.norm(r0) * e\n# print(gm)\n\nUTMat, gm = self.ToUTMat(Hm, gm, m)\n\nmin_y = np.zeros((m, 1))\n\nfor i in range(m):\n    min_y[i][0] = (gm[i, 0] - np.dot(UTMat[i:i+1 ,:] ,min_y))/UTMat[i, i]\n\ndU_new = self.dU + np.dot(Vm[:, 0:m], min_y).reshape(self.u_dim, self.pred_horizons, order='F')\n\nself.dU = dU_new\n\nU = U + self.dU * self.ht\n",[4892],{"type":18,"tag":622,"props":4893,"children":4894},{},[4895],{"type":18,"tag":614,"props":4896,"children":4897},{"__ignoreMap":8},[4898,4905,4944,5007,5014,5022,5063,5071,5097,5105,5112,5120,5150,5192,5200,5230,5238,5245,5252,5280,5305,5390,5398,5406,5414,5421,5461,5468,5514,5543,5550,5575,5582,5625,5663,5670,5696,5703,5732,5740,5805,5813,5850,5887,5914,5923,5931,5957,5965,5990,5998,6026,6091,6099,6174,6182,6203,6211],{"type":18,"tag":629,"props":4899,"children":4900},{"class":631,"line":632},[4901],{"type":18,"tag":629,"props":4902,"children":4903},{"class":1866},[4904],{"type":24,"value":4765},{"type":18,"tag":629,"props":4906,"children":4907},{"class":631,"line":659},[4908,4912,4916,4920,4924,4928,4932,4936,4940],{"type":18,"tag":629,"props":4909,"children":4910},{"class":642},[4911],{"type":24,"value":4773},{"type":18,"tag":629,"props":4913,"children":4914},{"class":636},[4915],{"type":24,"value":726},{"type":18,"tag":629,"props":4917,"children":4918},{"class":642},[4919],{"type":24,"value":4782},{"type":18,"tag":629,"props":4921,"children":4922},{"class":636},[4923],{"type":24,"value":1061},{"type":18,"tag":629,"props":4925,"children":4926},{"class":642},[4927],{"type":24,"value":4791},{"type":18,"tag":629,"props":4929,"children":4930},{"class":636},[4931],{"type":24,"value":1429},{"type":18,"tag":629,"props":4933,"children":4934},{"class":642},[4935],{"type":24,"value":645},{"type":18,"tag":629,"props":4937,"children":4938},{"class":686},[4939],{"type":24,"value":716},{"type":18,"tag":629,"props":4941,"children":4942},{"class":642},[4943],{"type":24,"value":2073},{"type":18,"tag":629,"props":4945,"children":4946},{"class":631,"line":668},[4947,4951,4955,4959,4963,4967,4971,4975,4979,4983,4987,4991,4995,4999,5003],{"type":18,"tag":629,"props":4948,"children":4949},{"class":642},[4950],{"type":24,"value":4815},{"type":18,"tag":629,"props":4952,"children":4953},{"class":636},[4954],{"type":24,"value":726},{"type":18,"tag":629,"props":4956,"children":4957},{"class":642},[4958],{"type":24,"value":645},{"type":18,"tag":629,"props":4960,"children":4961},{"class":636},[4962],{"type":24,"value":1061},{"type":18,"tag":629,"props":4964,"children":4965},{"class":686},[4966],{"type":24,"value":716},{"type":18,"tag":629,"props":4968,"children":4969},{"class":642},[4970],{"type":24,"value":2048},{"type":18,"tag":629,"props":4972,"children":4973},{"class":636},[4974],{"type":24,"value":1071},{"type":18,"tag":629,"props":4976,"children":4977},{"class":642},[4978],{"type":24,"value":4844},{"type":18,"tag":629,"props":4980,"children":4981},{"class":636},[4982],{"type":24,"value":1061},{"type":18,"tag":629,"props":4984,"children":4985},{"class":642},[4986],{"type":24,"value":4853},{"type":18,"tag":629,"props":4988,"children":4989},{"class":636},[4990],{"type":24,"value":1061},{"type":18,"tag":629,"props":4992,"children":4993},{"class":642},[4994],{"type":24,"value":4862},{"type":18,"tag":629,"props":4996,"children":4997},{"class":636},[4998],{"type":24,"value":1429},{"type":18,"tag":629,"props":5000,"children":5001},{"class":686},[5002],{"type":24,"value":716},{"type":18,"tag":629,"props":5004,"children":5005},{"class":642},[5006],{"type":24,"value":2073},{"type":18,"tag":629,"props":5008,"children":5009},{"class":631,"line":697},[5010],{"type":18,"tag":629,"props":5011,"children":5012},{},[5013],{"type":24,"value":665},{"type":18,"tag":629,"props":5015,"children":5016},{"class":631,"line":705},[5017],{"type":18,"tag":629,"props":5018,"children":5019},{"class":1866},[5020],{"type":24,"value":5021},"# Define iterations\n",{"type":18,"tag":629,"props":5023,"children":5024},{"class":631,"line":734},[5025,5030,5034,5038,5042,5047,5051,5055,5059],{"type":18,"tag":629,"props":5026,"children":5027},{"class":642},[5028],{"type":24,"value":5029},"m ",{"type":18,"tag":629,"props":5031,"children":5032},{"class":636},[5033],{"type":24,"value":726},{"type":18,"tag":629,"props":5035,"children":5036},{"class":642},[5037],{"type":24,"value":4439},{"type":18,"tag":629,"props":5039,"children":5040},{"class":686},[5041],{"type":24,"value":716},{"type":18,"tag":629,"props":5043,"children":5044},{"class":642},[5045],{"type":24,"value":5046},".u_dim ) ",{"type":18,"tag":629,"props":5048,"children":5049},{"class":636},[5050],{"type":24,"value":1071},{"type":18,"tag":629,"props":5052,"children":5053},{"class":642},[5054],{"type":24,"value":645},{"type":18,"tag":629,"props":5056,"children":5057},{"class":686},[5058],{"type":24,"value":716},{"type":18,"tag":629,"props":5060,"children":5061},{"class":642},[5062],{"type":24,"value":4491},{"type":18,"tag":629,"props":5064,"children":5065},{"class":631,"line":760},[5066],{"type":18,"tag":629,"props":5067,"children":5068},{"class":1866},[5069],{"type":24,"value":5070},"# Define r0\n",{"type":18,"tag":629,"props":5072,"children":5073},{"class":631,"line":786},[5074,5079,5083,5088,5092],{"type":18,"tag":629,"props":5075,"children":5076},{"class":642},[5077],{"type":24,"value":5078},"r0 ",{"type":18,"tag":629,"props":5080,"children":5081},{"class":636},[5082],{"type":24,"value":726},{"type":18,"tag":629,"props":5084,"children":5085},{"class":642},[5086],{"type":24,"value":5087}," right ",{"type":18,"tag":629,"props":5089,"children":5090},{"class":636},[5091],{"type":24,"value":1061},{"type":18,"tag":629,"props":5093,"children":5094},{"class":642},[5095],{"type":24,"value":5096}," left\n",{"type":18,"tag":629,"props":5098,"children":5099},{"class":631,"line":794},[5100],{"type":18,"tag":629,"props":5101,"children":5102},{"class":1866},[5103],{"type":24,"value":5104},"# print(r0)\n",{"type":18,"tag":629,"props":5106,"children":5107},{"class":631,"line":820},[5108],{"type":18,"tag":629,"props":5109,"children":5110},{},[5111],{"type":24,"value":665},{"type":18,"tag":629,"props":5113,"children":5114},{"class":631,"line":846},[5115],{"type":18,"tag":629,"props":5116,"children":5117},{"class":1866},[5118],{"type":24,"value":5119},"# GMRES\n",{"type":18,"tag":629,"props":5121,"children":5122},{"class":631,"line":854},[5123,5128,5132,5137,5141,5145],{"type":18,"tag":629,"props":5124,"children":5125},{"class":642},[5126],{"type":24,"value":5127},"Vm ",{"type":18,"tag":629,"props":5129,"children":5130},{"class":636},[5131],{"type":24,"value":726},{"type":18,"tag":629,"props":5133,"children":5134},{"class":642},[5135],{"type":24,"value":5136}," np.zeros((m, m",{"type":18,"tag":629,"props":5138,"children":5139},{"class":636},[5140],{"type":24,"value":1192},{"type":18,"tag":629,"props":5142,"children":5143},{"class":686},[5144],{"type":24,"value":992},{"type":18,"tag":629,"props":5146,"children":5147},{"class":642},[5148],{"type":24,"value":5149},"))\n",{"type":18,"tag":629,"props":5151,"children":5152},{"class":631,"line":890},[5153,5158,5162,5166,5170,5174,5178,5183,5187],{"type":18,"tag":629,"props":5154,"children":5155},{"class":642},[5156],{"type":24,"value":5157},"Vm[:, ",{"type":18,"tag":629,"props":5159,"children":5160},{"class":686},[5161],{"type":24,"value":882},{"type":18,"tag":629,"props":5163,"children":5164},{"class":642},[5165],{"type":24,"value":292},{"type":18,"tag":629,"props":5167,"children":5168},{"class":686},[5169],{"type":24,"value":992},{"type":18,"tag":629,"props":5171,"children":5172},{"class":642},[5173],{"type":24,"value":2926},{"type":18,"tag":629,"props":5175,"children":5176},{"class":636},[5177],{"type":24,"value":726},{"type":18,"tag":629,"props":5179,"children":5180},{"class":642},[5181],{"type":24,"value":5182}," r0 ",{"type":18,"tag":629,"props":5184,"children":5185},{"class":636},[5186],{"type":24,"value":1429},{"type":18,"tag":629,"props":5188,"children":5189},{"class":642},[5190],{"type":24,"value":5191}," np.linalg.norm(r0)\n",{"type":18,"tag":629,"props":5193,"children":5194},{"class":631,"line":923},[5195],{"type":18,"tag":629,"props":5196,"children":5197},{"class":1866},[5198],{"type":24,"value":5199},"# print(\"Vm\", Vm[:, 0])\n",{"type":18,"tag":629,"props":5201,"children":5202},{"class":631,"line":931},[5203,5208,5212,5217,5221,5225],{"type":18,"tag":629,"props":5204,"children":5205},{"class":642},[5206],{"type":24,"value":5207},"Hm ",{"type":18,"tag":629,"props":5209,"children":5210},{"class":636},[5211],{"type":24,"value":726},{"type":18,"tag":629,"props":5213,"children":5214},{"class":642},[5215],{"type":24,"value":5216}," np.zeros((m",{"type":18,"tag":629,"props":5218,"children":5219},{"class":636},[5220],{"type":24,"value":1192},{"type":18,"tag":629,"props":5222,"children":5223},{"class":686},[5224],{"type":24,"value":992},{"type":18,"tag":629,"props":5226,"children":5227},{"class":642},[5228],{"type":24,"value":5229},", m))\n",{"type":18,"tag":629,"props":5231,"children":5232},{"class":631,"line":965},[5233],{"type":18,"tag":629,"props":5234,"children":5235},{"class":1866},[5236],{"type":24,"value":5237},"# print(Vm[:, 0])\n",{"type":18,"tag":629,"props":5239,"children":5240},{"class":631,"line":999},[5241],{"type":18,"tag":629,"props":5242,"children":5243},{},[5244],{"type":24,"value":665},{"type":18,"tag":629,"props":5246,"children":5247},{"class":631,"line":1007},[5248],{"type":18,"tag":629,"props":5249,"children":5250},{},[5251],{"type":24,"value":665},{"type":18,"tag":629,"props":5253,"children":5254},{"class":631,"line":1033},[5255,5259,5263,5267,5271,5275],{"type":18,"tag":629,"props":5256,"children":5257},{"class":636},[5258],{"type":24,"value":2805},{"type":18,"tag":629,"props":5260,"children":5261},{"class":642},[5262],{"type":24,"value":2810},{"type":18,"tag":629,"props":5264,"children":5265},{"class":636},[5266],{"type":24,"value":2815},{"type":18,"tag":629,"props":5268,"children":5269},{"class":642},[5270],{"type":24,"value":645},{"type":18,"tag":629,"props":5272,"children":5273},{"class":686},[5274],{"type":24,"value":2824},{"type":18,"tag":629,"props":5276,"children":5277},{"class":642},[5278],{"type":24,"value":5279},"(m):\n",{"type":18,"tag":629,"props":5281,"children":5282},{"class":631,"line":1041},[5283,5288,5292,5296,5300],{"type":18,"tag":629,"props":5284,"children":5285},{"class":642},[5286],{"type":24,"value":5287},"    Fuxt ",{"type":18,"tag":629,"props":5289,"children":5290},{"class":636},[5291],{"type":24,"value":726},{"type":18,"tag":629,"props":5293,"children":5294},{"class":642},[5295],{"type":24,"value":645},{"type":18,"tag":629,"props":5297,"children":5298},{"class":686},[5299],{"type":24,"value":716},{"type":18,"tag":629,"props":5301,"children":5302},{"class":642},[5303],{"type":24,"value":5304},".calc_f(\n",{"type":18,"tag":629,"props":5306,"children":5307},{"class":631,"line":1083},[5308,5313,5317,5322,5326,5330,5335,5339,5343,5347,5352,5358,5362,5368,5373,5377,5381,5385],{"type":18,"tag":629,"props":5309,"children":5310},{"class":642},[5311],{"type":24,"value":5312},"        X, U ",{"type":18,"tag":629,"props":5314,"children":5315},{"class":636},[5316],{"type":24,"value":1192},{"type":18,"tag":629,"props":5318,"children":5319},{"class":642},[5320],{"type":24,"value":5321}," Vm[:, i:i",{"type":18,"tag":629,"props":5323,"children":5324},{"class":636},[5325],{"type":24,"value":1192},{"type":18,"tag":629,"props":5327,"children":5328},{"class":686},[5329],{"type":24,"value":992},{"type":18,"tag":629,"props":5331,"children":5332},{"class":642},[5333],{"type":24,"value":5334},"].reshape(",{"type":18,"tag":629,"props":5336,"children":5337},{"class":686},[5338],{"type":24,"value":716},{"type":18,"tag":629,"props":5340,"children":5341},{"class":642},[5342],{"type":24,"value":2493},{"type":18,"tag":629,"props":5344,"children":5345},{"class":686},[5346],{"type":24,"value":716},{"type":18,"tag":629,"props":5348,"children":5349},{"class":642},[5350],{"type":24,"value":5351},".pred_horizons, ",{"type":18,"tag":629,"props":5353,"children":5355},{"class":5354},"ct-657843",[5356],{"type":24,"value":5357},"order",{"type":18,"tag":629,"props":5359,"children":5360},{"class":636},[5361],{"type":24,"value":726},{"type":18,"tag":629,"props":5363,"children":5365},{"class":5364},"ct-244866",[5366],{"type":24,"value":5367},"'F'",{"type":18,"tag":629,"props":5369,"children":5370},{"class":642},[5371],{"type":24,"value":5372},") ",{"type":18,"tag":629,"props":5374,"children":5375},{"class":636},[5376],{"type":24,"value":1071},{"type":18,"tag":629,"props":5378,"children":5379},{"class":642},[5380],{"type":24,"value":645},{"type":18,"tag":629,"props":5382,"children":5383},{"class":686},[5384],{"type":24,"value":716},{"type":18,"tag":629,"props":5386,"children":5387},{"class":642},[5388],{"type":24,"value":5389},".ht,\n",{"type":18,"tag":629,"props":5391,"children":5392},{"class":631,"line":1123},[5393],{"type":18,"tag":629,"props":5394,"children":5395},{"class":642},[5396],{"type":24,"value":5397},"        Lambda, Mu,\n",{"type":18,"tag":629,"props":5399,"children":5400},{"class":631,"line":1217},[5401],{"type":18,"tag":629,"props":5402,"children":5403},{"class":642},[5404],{"type":24,"value":5405},"        dt\n",{"type":18,"tag":629,"props":5407,"children":5408},{"class":631,"line":1225},[5409],{"type":18,"tag":629,"props":5410,"children":5411},{"class":642},[5412],{"type":24,"value":5413},"    )\n",{"type":18,"tag":629,"props":5415,"children":5416},{"class":631,"line":1243},[5417],{"type":18,"tag":629,"props":5418,"children":5419},{},[5420],{"type":24,"value":665},{"type":18,"tag":629,"props":5422,"children":5423},{"class":631,"line":1251},[5424,5429,5433,5437,5441,5445,5449,5453,5457],{"type":18,"tag":629,"props":5425,"children":5426},{"class":642},[5427],{"type":24,"value":5428},"    Av ",{"type":18,"tag":629,"props":5430,"children":5431},{"class":636},[5432],{"type":24,"value":726},{"type":18,"tag":629,"props":5434,"children":5435},{"class":642},[5436],{"type":24,"value":4782},{"type":18,"tag":629,"props":5438,"children":5439},{"class":636},[5440],{"type":24,"value":1061},{"type":18,"tag":629,"props":5442,"children":5443},{"class":642},[5444],{"type":24,"value":4791},{"type":18,"tag":629,"props":5446,"children":5447},{"class":636},[5448],{"type":24,"value":1429},{"type":18,"tag":629,"props":5450,"children":5451},{"class":642},[5452],{"type":24,"value":645},{"type":18,"tag":629,"props":5454,"children":5455},{"class":686},[5456],{"type":24,"value":716},{"type":18,"tag":629,"props":5458,"children":5459},{"class":642},[5460],{"type":24,"value":2073},{"type":18,"tag":629,"props":5462,"children":5463},{"class":631,"line":1277},[5464],{"type":18,"tag":629,"props":5465,"children":5466},{},[5467],{"type":24,"value":665},{"type":18,"tag":629,"props":5469,"children":5470},{"class":631,"line":1285},[5471,5475,5479,5484,5488,5492,5496,5501,5505,5509],{"type":18,"tag":629,"props":5472,"children":5473},{"class":642},[5474],{"type":24,"value":674},{"type":18,"tag":629,"props":5476,"children":5477},{"class":636},[5478],{"type":24,"value":2805},{"type":18,"tag":629,"props":5480,"children":5481},{"class":642},[5482],{"type":24,"value":5483}," k ",{"type":18,"tag":629,"props":5485,"children":5486},{"class":636},[5487],{"type":24,"value":2815},{"type":18,"tag":629,"props":5489,"children":5490},{"class":642},[5491],{"type":24,"value":645},{"type":18,"tag":629,"props":5493,"children":5494},{"class":686},[5495],{"type":24,"value":2824},{"type":18,"tag":629,"props":5497,"children":5498},{"class":642},[5499],{"type":24,"value":5500},"(i",{"type":18,"tag":629,"props":5502,"children":5503},{"class":636},[5504],{"type":24,"value":1192},{"type":18,"tag":629,"props":5506,"children":5507},{"class":686},[5508],{"type":24,"value":992},{"type":18,"tag":629,"props":5510,"children":5511},{"class":642},[5512],{"type":24,"value":5513},"):\n",{"type":18,"tag":629,"props":5515,"children":5516},{"class":631,"line":1441},[5517,5522,5526,5531,5535,5539],{"type":18,"tag":629,"props":5518,"children":5519},{"class":642},[5520],{"type":24,"value":5521},"        Hm[k, i] ",{"type":18,"tag":629,"props":5523,"children":5524},{"class":636},[5525],{"type":24,"value":726},{"type":18,"tag":629,"props":5527,"children":5528},{"class":642},[5529],{"type":24,"value":5530}," np.dot(Av.T, Vm[:, k:k",{"type":18,"tag":629,"props":5532,"children":5533},{"class":636},[5534],{"type":24,"value":1192},{"type":18,"tag":629,"props":5536,"children":5537},{"class":686},[5538],{"type":24,"value":992},{"type":18,"tag":629,"props":5540,"children":5541},{"class":642},[5542],{"type":24,"value":3295},{"type":18,"tag":629,"props":5544,"children":5545},{"class":631,"line":1561},[5546],{"type":18,"tag":629,"props":5547,"children":5548},{},[5549],{"type":24,"value":665},{"type":18,"tag":629,"props":5551,"children":5552},{"class":631,"line":1569},[5553,5558,5562,5567,5571],{"type":18,"tag":629,"props":5554,"children":5555},{"class":642},[5556],{"type":24,"value":5557},"    temp_vec ",{"type":18,"tag":629,"props":5559,"children":5560},{"class":636},[5561],{"type":24,"value":726},{"type":18,"tag":629,"props":5563,"children":5564},{"class":642},[5565],{"type":24,"value":5566}," np.zeros((m, ",{"type":18,"tag":629,"props":5568,"children":5569},{"class":686},[5570],{"type":24,"value":992},{"type":18,"tag":629,"props":5572,"children":5573},{"class":642},[5574],{"type":24,"value":5149},{"type":18,"tag":629,"props":5576,"children":5577},{"class":631,"line":1586},[5578],{"type":18,"tag":629,"props":5579,"children":5580},{},[5581],{"type":24,"value":665},{"type":18,"tag":629,"props":5583,"children":5584},{"class":631,"line":1594},[5585,5589,5593,5597,5601,5605,5609,5613,5617,5621],{"type":18,"tag":629,"props":5586,"children":5587},{"class":642},[5588],{"type":24,"value":674},{"type":18,"tag":629,"props":5590,"children":5591},{"class":636},[5592],{"type":24,"value":2805},{"type":18,"tag":629,"props":5594,"children":5595},{"class":642},[5596],{"type":24,"value":5483},{"type":18,"tag":629,"props":5598,"children":5599},{"class":636},[5600],{"type":24,"value":2815},{"type":18,"tag":629,"props":5602,"children":5603},{"class":642},[5604],{"type":24,"value":645},{"type":18,"tag":629,"props":5606,"children":5607},{"class":686},[5608],{"type":24,"value":2824},{"type":18,"tag":629,"props":5610,"children":5611},{"class":642},[5612],{"type":24,"value":5500},{"type":18,"tag":629,"props":5614,"children":5615},{"class":636},[5616],{"type":24,"value":1192},{"type":18,"tag":629,"props":5618,"children":5619},{"class":686},[5620],{"type":24,"value":992},{"type":18,"tag":629,"props":5622,"children":5623},{"class":642},[5624],{"type":24,"value":5513},{"type":18,"tag":629,"props":5626,"children":5627},{"class":631,"line":1620},[5628,5633,5637,5642,5646,5651,5655,5659],{"type":18,"tag":629,"props":5629,"children":5630},{"class":642},[5631],{"type":24,"value":5632},"        temp_vec ",{"type":18,"tag":629,"props":5634,"children":5635},{"class":636},[5636],{"type":24,"value":726},{"type":18,"tag":629,"props":5638,"children":5639},{"class":642},[5640],{"type":24,"value":5641}," temp_vec ",{"type":18,"tag":629,"props":5643,"children":5644},{"class":636},[5645],{"type":24,"value":1192},{"type":18,"tag":629,"props":5647,"children":5648},{"class":642},[5649],{"type":24,"value":5650}," np.dot(Hm[k, i], Vm[:, k:k",{"type":18,"tag":629,"props":5652,"children":5653},{"class":636},[5654],{"type":24,"value":1192},{"type":18,"tag":629,"props":5656,"children":5657},{"class":686},[5658],{"type":24,"value":992},{"type":18,"tag":629,"props":5660,"children":5661},{"class":642},[5662],{"type":24,"value":3295},{"type":18,"tag":629,"props":5664,"children":5665},{"class":631,"line":1664},[5666],{"type":18,"tag":629,"props":5667,"children":5668},{},[5669],{"type":24,"value":665},{"type":18,"tag":629,"props":5671,"children":5672},{"class":631,"line":1708},[5673,5678,5682,5687,5691],{"type":18,"tag":629,"props":5674,"children":5675},{"class":642},[5676],{"type":24,"value":5677},"    v_hat ",{"type":18,"tag":629,"props":5679,"children":5680},{"class":636},[5681],{"type":24,"value":726},{"type":18,"tag":629,"props":5683,"children":5684},{"class":642},[5685],{"type":24,"value":5686}," Av ",{"type":18,"tag":629,"props":5688,"children":5689},{"class":636},[5690],{"type":24,"value":1061},{"type":18,"tag":629,"props":5692,"children":5693},{"class":642},[5694],{"type":24,"value":5695}," temp_vec\n",{"type":18,"tag":629,"props":5697,"children":5698},{"class":631,"line":1751},[5699],{"type":18,"tag":629,"props":5700,"children":5701},{},[5702],{"type":24,"value":665},{"type":18,"tag":629,"props":5704,"children":5705},{"class":631,"line":1759},[5706,5711,5715,5719,5723,5727],{"type":18,"tag":629,"props":5707,"children":5708},{"class":642},[5709],{"type":24,"value":5710},"    Hm[i",{"type":18,"tag":629,"props":5712,"children":5713},{"class":636},[5714],{"type":24,"value":1192},{"type":18,"tag":629,"props":5716,"children":5717},{"class":686},[5718],{"type":24,"value":992},{"type":18,"tag":629,"props":5720,"children":5721},{"class":642},[5722],{"type":24,"value":2944},{"type":18,"tag":629,"props":5724,"children":5725},{"class":636},[5726],{"type":24,"value":726},{"type":18,"tag":629,"props":5728,"children":5729},{"class":642},[5730],{"type":24,"value":5731}," np.linalg.norm(v_hat)\n",{"type":18,"tag":629,"props":5733,"children":5735},{"class":631,"line":5734},39,[5736],{"type":18,"tag":629,"props":5737,"children":5738},{},[5739],{"type":24,"value":665},{"type":18,"tag":629,"props":5741,"children":5743},{"class":631,"line":5742},40,[5744,5749,5753,5757,5762,5766,5770,5774,5778,5783,5787,5792,5796,5800],{"type":18,"tag":629,"props":5745,"children":5746},{"class":642},[5747],{"type":24,"value":5748},"    Vm[:,i",{"type":18,"tag":629,"props":5750,"children":5751},{"class":636},[5752],{"type":24,"value":1192},{"type":18,"tag":629,"props":5754,"children":5755},{"class":686},[5756],{"type":24,"value":992},{"type":18,"tag":629,"props":5758,"children":5759},{"class":642},[5760],{"type":24,"value":5761},":i",{"type":18,"tag":629,"props":5763,"children":5764},{"class":636},[5765],{"type":24,"value":1192},{"type":18,"tag":629,"props":5767,"children":5768},{"class":686},[5769],{"type":24,"value":1368},{"type":18,"tag":629,"props":5771,"children":5772},{"class":642},[5773],{"type":24,"value":2926},{"type":18,"tag":629,"props":5775,"children":5776},{"class":636},[5777],{"type":24,"value":726},{"type":18,"tag":629,"props":5779,"children":5780},{"class":642},[5781],{"type":24,"value":5782}," v_hat",{"type":18,"tag":629,"props":5784,"children":5785},{"class":636},[5786],{"type":24,"value":1429},{"type":18,"tag":629,"props":5788,"children":5789},{"class":642},[5790],{"type":24,"value":5791},"Hm[i",{"type":18,"tag":629,"props":5793,"children":5794},{"class":636},[5795],{"type":24,"value":1192},{"type":18,"tag":629,"props":5797,"children":5798},{"class":686},[5799],{"type":24,"value":992},{"type":18,"tag":629,"props":5801,"children":5802},{"class":642},[5803],{"type":24,"value":5804},", i]\n",{"type":18,"tag":629,"props":5806,"children":5808},{"class":631,"line":5807},41,[5809],{"type":18,"tag":629,"props":5810,"children":5811},{},[5812],{"type":24,"value":665},{"type":18,"tag":629,"props":5814,"children":5816},{"class":631,"line":5815},42,[5817,5822,5826,5830,5834,5838,5842,5846],{"type":18,"tag":629,"props":5818,"children":5819},{"class":642},[5820],{"type":24,"value":5821},"e ",{"type":18,"tag":629,"props":5823,"children":5824},{"class":636},[5825],{"type":24,"value":726},{"type":18,"tag":629,"props":5827,"children":5828},{"class":642},[5829],{"type":24,"value":5216},{"type":18,"tag":629,"props":5831,"children":5832},{"class":636},[5833],{"type":24,"value":1192},{"type":18,"tag":629,"props":5835,"children":5836},{"class":686},[5837],{"type":24,"value":992},{"type":18,"tag":629,"props":5839,"children":5840},{"class":642},[5841],{"type":24,"value":2432},{"type":18,"tag":629,"props":5843,"children":5844},{"class":686},[5845],{"type":24,"value":992},{"type":18,"tag":629,"props":5847,"children":5848},{"class":642},[5849],{"type":24,"value":5149},{"type":18,"tag":629,"props":5851,"children":5853},{"class":631,"line":5852},43,[5854,5859,5863,5867,5871,5875,5879,5883],{"type":18,"tag":629,"props":5855,"children":5856},{"class":642},[5857],{"type":24,"value":5858},"e[",{"type":18,"tag":629,"props":5860,"children":5861},{"class":686},[5862],{"type":24,"value":882},{"type":18,"tag":629,"props":5864,"children":5865},{"class":642},[5866],{"type":24,"value":2432},{"type":18,"tag":629,"props":5868,"children":5869},{"class":686},[5870],{"type":24,"value":882},{"type":18,"tag":629,"props":5872,"children":5873},{"class":642},[5874],{"type":24,"value":2926},{"type":18,"tag":629,"props":5876,"children":5877},{"class":636},[5878],{"type":24,"value":726},{"type":18,"tag":629,"props":5880,"children":5881},{"class":642},[5882],{"type":24,"value":645},{"type":18,"tag":629,"props":5884,"children":5885},{"class":686},[5886],{"type":24,"value":2131},{"type":18,"tag":629,"props":5888,"children":5890},{"class":631,"line":5889},44,[5891,5896,5900,5905,5909],{"type":18,"tag":629,"props":5892,"children":5893},{"class":642},[5894],{"type":24,"value":5895},"gm ",{"type":18,"tag":629,"props":5897,"children":5898},{"class":636},[5899],{"type":24,"value":726},{"type":18,"tag":629,"props":5901,"children":5902},{"class":642},[5903],{"type":24,"value":5904}," np.linalg.norm(r0) ",{"type":18,"tag":629,"props":5906,"children":5907},{"class":636},[5908],{"type":24,"value":1071},{"type":18,"tag":629,"props":5910,"children":5911},{"class":642},[5912],{"type":24,"value":5913}," e\n",{"type":18,"tag":629,"props":5915,"children":5917},{"class":631,"line":5916},45,[5918],{"type":18,"tag":629,"props":5919,"children":5920},{"class":1866},[5921],{"type":24,"value":5922},"# print(gm)\n",{"type":18,"tag":629,"props":5924,"children":5926},{"class":631,"line":5925},46,[5927],{"type":18,"tag":629,"props":5928,"children":5929},{},[5930],{"type":24,"value":665},{"type":18,"tag":629,"props":5932,"children":5934},{"class":631,"line":5933},47,[5935,5940,5944,5948,5952],{"type":18,"tag":629,"props":5936,"children":5937},{"class":642},[5938],{"type":24,"value":5939},"UTMat, gm ",{"type":18,"tag":629,"props":5941,"children":5942},{"class":636},[5943],{"type":24,"value":726},{"type":18,"tag":629,"props":5945,"children":5946},{"class":642},[5947],{"type":24,"value":645},{"type":18,"tag":629,"props":5949,"children":5950},{"class":686},[5951],{"type":24,"value":716},{"type":18,"tag":629,"props":5953,"children":5954},{"class":642},[5955],{"type":24,"value":5956},".ToUTMat(Hm, gm, m)\n",{"type":18,"tag":629,"props":5958,"children":5960},{"class":631,"line":5959},48,[5961],{"type":18,"tag":629,"props":5962,"children":5963},{},[5964],{"type":24,"value":665},{"type":18,"tag":629,"props":5966,"children":5968},{"class":631,"line":5967},49,[5969,5974,5978,5982,5986],{"type":18,"tag":629,"props":5970,"children":5971},{"class":642},[5972],{"type":24,"value":5973},"min_y ",{"type":18,"tag":629,"props":5975,"children":5976},{"class":636},[5977],{"type":24,"value":726},{"type":18,"tag":629,"props":5979,"children":5980},{"class":642},[5981],{"type":24,"value":5566},{"type":18,"tag":629,"props":5983,"children":5984},{"class":686},[5985],{"type":24,"value":992},{"type":18,"tag":629,"props":5987,"children":5988},{"class":642},[5989],{"type":24,"value":5149},{"type":18,"tag":629,"props":5991,"children":5993},{"class":631,"line":5992},50,[5994],{"type":18,"tag":629,"props":5995,"children":5996},{},[5997],{"type":24,"value":665},{"type":18,"tag":629,"props":5999,"children":6001},{"class":631,"line":6000},51,[6002,6006,6010,6014,6018,6022],{"type":18,"tag":629,"props":6003,"children":6004},{"class":636},[6005],{"type":24,"value":2805},{"type":18,"tag":629,"props":6007,"children":6008},{"class":642},[6009],{"type":24,"value":2810},{"type":18,"tag":629,"props":6011,"children":6012},{"class":636},[6013],{"type":24,"value":2815},{"type":18,"tag":629,"props":6015,"children":6016},{"class":642},[6017],{"type":24,"value":645},{"type":18,"tag":629,"props":6019,"children":6020},{"class":686},[6021],{"type":24,"value":2824},{"type":18,"tag":629,"props":6023,"children":6024},{"class":642},[6025],{"type":24,"value":5279},{"type":18,"tag":629,"props":6027,"children":6029},{"class":631,"line":6028},52,[6030,6035,6039,6043,6047,6052,6056,6060,6064,6069,6073,6077,6082,6086],{"type":18,"tag":629,"props":6031,"children":6032},{"class":642},[6033],{"type":24,"value":6034},"    min_y[i][",{"type":18,"tag":629,"props":6036,"children":6037},{"class":686},[6038],{"type":24,"value":882},{"type":18,"tag":629,"props":6040,"children":6041},{"class":642},[6042],{"type":24,"value":2926},{"type":18,"tag":629,"props":6044,"children":6045},{"class":636},[6046],{"type":24,"value":726},{"type":18,"tag":629,"props":6048,"children":6049},{"class":642},[6050],{"type":24,"value":6051}," (gm[i, ",{"type":18,"tag":629,"props":6053,"children":6054},{"class":686},[6055],{"type":24,"value":882},{"type":18,"tag":629,"props":6057,"children":6058},{"class":642},[6059],{"type":24,"value":2926},{"type":18,"tag":629,"props":6061,"children":6062},{"class":636},[6063],{"type":24,"value":1061},{"type":18,"tag":629,"props":6065,"children":6066},{"class":642},[6067],{"type":24,"value":6068}," np.dot(UTMat[i:i",{"type":18,"tag":629,"props":6070,"children":6071},{"class":636},[6072],{"type":24,"value":1192},{"type":18,"tag":629,"props":6074,"children":6075},{"class":686},[6076],{"type":24,"value":992},{"type":18,"tag":629,"props":6078,"children":6079},{"class":642},[6080],{"type":24,"value":6081}," ,:] ,min_y))",{"type":18,"tag":629,"props":6083,"children":6084},{"class":636},[6085],{"type":24,"value":1429},{"type":18,"tag":629,"props":6087,"children":6088},{"class":642},[6089],{"type":24,"value":6090},"UTMat[i, i]\n",{"type":18,"tag":629,"props":6092,"children":6094},{"class":631,"line":6093},53,[6095],{"type":18,"tag":629,"props":6096,"children":6097},{},[6098],{"type":24,"value":665},{"type":18,"tag":629,"props":6100,"children":6102},{"class":631,"line":6101},54,[6103,6108,6112,6116,6120,6124,6128,6133,6137,6142,6146,6150,6154,6158,6162,6166,6170],{"type":18,"tag":629,"props":6104,"children":6105},{"class":642},[6106],{"type":24,"value":6107},"dU_new ",{"type":18,"tag":629,"props":6109,"children":6110},{"class":636},[6111],{"type":24,"value":726},{"type":18,"tag":629,"props":6113,"children":6114},{"class":642},[6115],{"type":24,"value":645},{"type":18,"tag":629,"props":6117,"children":6118},{"class":686},[6119],{"type":24,"value":716},{"type":18,"tag":629,"props":6121,"children":6122},{"class":642},[6123],{"type":24,"value":2475},{"type":18,"tag":629,"props":6125,"children":6126},{"class":636},[6127],{"type":24,"value":1192},{"type":18,"tag":629,"props":6129,"children":6130},{"class":642},[6131],{"type":24,"value":6132}," np.dot(Vm[:, ",{"type":18,"tag":629,"props":6134,"children":6135},{"class":686},[6136],{"type":24,"value":882},{"type":18,"tag":629,"props":6138,"children":6139},{"class":642},[6140],{"type":24,"value":6141},":m], min_y).reshape(",{"type":18,"tag":629,"props":6143,"children":6144},{"class":686},[6145],{"type":24,"value":716},{"type":18,"tag":629,"props":6147,"children":6148},{"class":642},[6149],{"type":24,"value":2493},{"type":18,"tag":629,"props":6151,"children":6152},{"class":686},[6153],{"type":24,"value":716},{"type":18,"tag":629,"props":6155,"children":6156},{"class":642},[6157],{"type":24,"value":5351},{"type":18,"tag":629,"props":6159,"children":6160},{"class":5354},[6161],{"type":24,"value":5357},{"type":18,"tag":629,"props":6163,"children":6164},{"class":636},[6165],{"type":24,"value":726},{"type":18,"tag":629,"props":6167,"children":6168},{"class":5364},[6169],{"type":24,"value":5367},{"type":18,"tag":629,"props":6171,"children":6172},{"class":642},[6173],{"type":24,"value":1438},{"type":18,"tag":629,"props":6175,"children":6177},{"class":631,"line":6176},55,[6178],{"type":18,"tag":629,"props":6179,"children":6180},{},[6181],{"type":24,"value":665},{"type":18,"tag":629,"props":6183,"children":6185},{"class":631,"line":6184},56,[6186,6190,6194,6198],{"type":18,"tag":629,"props":6187,"children":6188},{"class":686},[6189],{"type":24,"value":716},{"type":18,"tag":629,"props":6191,"children":6192},{"class":642},[6193],{"type":24,"value":2475},{"type":18,"tag":629,"props":6195,"children":6196},{"class":636},[6197],{"type":24,"value":726},{"type":18,"tag":629,"props":6199,"children":6200},{"class":642},[6201],{"type":24,"value":6202}," dU_new\n",{"type":18,"tag":629,"props":6204,"children":6206},{"class":631,"line":6205},57,[6207],{"type":18,"tag":629,"props":6208,"children":6209},{},[6210],{"type":24,"value":665},{"type":18,"tag":629,"props":6212,"children":6214},{"class":631,"line":6213},58,[6215,6219,6223,6228,6232,6236,6240,6244,6248,6252,6256],{"type":18,"tag":629,"props":6216,"children":6217},{"class":642},[6218],{"type":24,"value":2671},{"type":18,"tag":629,"props":6220,"children":6221},{"class":636},[6222],{"type":24,"value":726},{"type":18,"tag":629,"props":6224,"children":6225},{"class":642},[6226],{"type":24,"value":6227}," U ",{"type":18,"tag":629,"props":6229,"children":6230},{"class":636},[6231],{"type":24,"value":1192},{"type":18,"tag":629,"props":6233,"children":6234},{"class":642},[6235],{"type":24,"value":645},{"type":18,"tag":629,"props":6237,"children":6238},{"class":686},[6239],{"type":24,"value":716},{"type":18,"tag":629,"props":6241,"children":6242},{"class":642},[6243],{"type":24,"value":2475},{"type":18,"tag":629,"props":6245,"children":6246},{"class":636},[6247],{"type":24,"value":1071},{"type":18,"tag":629,"props":6249,"children":6250},{"class":642},[6251],{"type":24,"value":645},{"type":18,"tag":629,"props":6253,"children":6254},{"class":686},[6255],{"type":24,"value":716},{"type":18,"tag":629,"props":6257,"children":6258},{"class":642},[6259],{"type":24,"value":4875},{"type":18,"tag":27,"props":6261,"children":6262},{},[6263,6265,6270],{"type":24,"value":6264},"You can look in my code inside function ",{"type":18,"tag":170,"props":6266,"children":6267},{},[6268],{"type":24,"value":6269}," solve_nmpc ",{"type":24,"value":197},{"type":18,"tag":19,"props":6272,"children":6274},{"id":6273},"experiment-in-python",[6275],{"type":24,"value":6276},"Experiment in Python",{"type":18,"tag":27,"props":6278,"children":6279},{},[6280,6282,6285,6287,6290,6292,6296,6298,6302,6304,6308],{"type":24,"value":6281},"GMRES was consider one of the fastest solver for sparse linear algebra problem, so I will include the link for the GMRES algorithms. ",{"type":18,"tag":56,"props":6283,"children":6284},{},[],{"type":24,"value":6286},"\nIn my experiment, I use differential drive robot. ",{"type":18,"tag":56,"props":6288,"children":6289},{},[],{"type":24,"value":6291},"\nConsider as our state representation ",{"type":18,"tag":84,"props":6293,"children":6295},{"latex-express":6294,"styles":87}," x = \\begin{bmatrix} x \\\\ y \\\\ \\phi \\end{bmatrix} ",[],{"type":24,"value":6297}," and of course setting initialization ",{"type":18,"tag":84,"props":6299,"children":6301},{"latex-express":6300,"styles":87}," x_{0} = [0.0, 0.0, 0.0] ",[],{"type":24,"value":6303},", also ",{"type":18,"tag":84,"props":6305,"children":6307},{"latex-express":6306,"styles":87}," u_{0} = [0.0, 0.0] ",[],{"type":24,"value":197},{"type":18,"tag":6310,"props":6311,"children":6316},"figure",{"className":6312},[6313,6314,6315],"mb-4","inline-block","max-w-sm",[6317,6319],{"type":24,"value":6318},"\n  ",{"type":18,"tag":6320,"props":6321,"children":6327},"img",{"className":6322,"src":6324,"width":6325,"height":6326},[6323],"mx-auto","/topics/robotics/nmpc/nmpc_cgmres.gif",700,350,[],{"type":18,"tag":6329,"props":6330,"children":6335},"figcaption",{"className":6331},[68,6332,6333,6334],"text-sm","text-neutral-600","dark:text-neutral-400",[6336],{"type":24,"value":6337},"\n    Animation of Differential Drive robot on optimal trajectory !!!\n",{"type":18,"tag":27,"props":6339,"children":6340},{},[6341],{"type":24,"value":6342},"And here are the optimal data for all state and input control.",{"type":18,"tag":6310,"props":6344,"children":6346},{"className":6345},[6313,6314,6315],[6347,6348],{"type":24,"value":6318},{"type":18,"tag":6320,"props":6349,"children":6354},{"className":6350,"src":6351,"width":6352,"height":6353},[6323],"/topics/robotics/nmpc/cgmreDat1.png",600,300,[],{"type":18,"tag":6329,"props":6356,"children":6358},{"className":6357},[68,6332,6333,6334],[6359],{"type":24,"value":6360},"\n    All data obtained after simulation.\n",{"type":18,"tag":27,"props":6362,"children":6363},{},[6364,6366],{"type":24,"value":6365},"You can find all the code of NMPC even with CasAdi and CGMRES here in my github: ",{"type":18,"tag":6367,"props":6368,"children":6372},"a",{"href":6369,"rel":6370},"https://github.com/SokhengDin/Path-Tracking/tree/main",[6371],"nofollow",[6373],{"type":24,"value":6374},"Path-Tracking",{"type":18,"tag":19,"props":6376,"children":6378},{"id":6377},"in-conclusion",[6379],{"type":24,"value":6380},"In Conclusion",{"type":18,"tag":27,"props":6382,"children":6383},{},[6384],{"type":24,"value":6385},"Nonlinear Model Predictive Control with CGMRES is one of the great NMPC method that you should try, since it provides a very fast numerical calculation thank to the GMRES algorithms with Given Rotation method. Even though compare to another NMPC solver, NMPC with CGMRES sometime is hard for finding the optimal parameters in order to not cause unstable numerical calculation. Next time, I will bring the multiple shooting method which is consider in the promise of more robust numerical stability tha single shooting method.",{"type":18,"tag":19,"props":6387,"children":6389},{"id":6388},"references",[6390],{"type":24,"value":6391},"References",{"type":18,"tag":280,"props":6393,"children":6394},{},[6395,6405,6415,6425,6435],{"type":18,"tag":80,"props":6396,"children":6397},{},[6398],{"type":18,"tag":6367,"props":6399,"children":6402},{"href":6400,"rel":6401},"https://www.researchgate.net/publication/228007717_A_real-time_algorithm_for_nonlinear_receding_horizon_control_using_multiple_shooting_and_continuationKrylov_method",[6371],[6403],{"type":24,"value":6404},"A real‐time algorithm for nonlinear receding horizon control using multiple shooting and continuation/Krylov method",{"type":18,"tag":80,"props":6406,"children":6407},{},[6408],{"type":18,"tag":6367,"props":6409,"children":6412},{"href":6410,"rel":6411},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathTracking/cgmres_nmpc",[6371],[6413],{"type":24,"value":6414},"Nonlinear Model Predictive Control with CGMRES of Steering Car ",{"type":18,"tag":80,"props":6416,"children":6417},{},[6418],{"type":18,"tag":6367,"props":6419,"children":6422},{"href":6420,"rel":6421},"https://qiita.com/PozihameBaystar/items/650cc839da5d9c974f5d",[6371],[6423],{"type":24,"value":6424},"C/GMRESシミュレーションを3つの言語で作ったので比較してみた",{"type":18,"tag":80,"props":6426,"children":6427},{},[6428],{"type":18,"tag":6367,"props":6429,"children":6432},{"href":6430,"rel":6431},"https://qiita.com/opticont/items/b3518b470d9e327144be",[6371],[6433],{"type":24,"value":6434},"Krylov部分空間とGMRES法について",{"type":18,"tag":80,"props":6436,"children":6437},{},[6438],{"type":18,"tag":6367,"props":6439,"children":6442},{"href":6440,"rel":6441},"https://www.sciencedirect.com/science/article/pii/S2405896318326727",[6371],[6443],{"type":24,"value":6444},"Nonlinear Model Predictive Control of Position and Attitude in a Hexacopter with Three Failed Rotors",{"type":18,"tag":6446,"children":6447},"style",[6448],{"type":24,"value":6449},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-657843{color:#FFAB70;}\n.ct-244866{color:#9ECBFF;}",{"title":8,"searchDepth":659,"depth":659,"links":6451},[6452,6458,6459,6460,6461],{"id":21,"depth":659,"text":25,"children":6453},[6454,6455,6456,6457],{"id":35,"depth":668,"text":38},{"id":46,"depth":668,"text":49},{"id":229,"depth":668,"text":232},{"id":263,"depth":668,"text":266},{"id":589,"depth":659,"text":592},{"id":6273,"depth":659,"text":6276},{"id":6377,"depth":659,"text":6380},{"id":6388,"depth":659,"text":6391},"markdown","content:topics:robotics:nmpc-cgmres.md","content","topics/robotics/nmpc-cgmres.md","md",{"_path":6468,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":6469,"description":6470,"author":11,"slug":6471,"tag":6471,"img":6472,"body":6473,"_type":6462,"_id":10453,"_source":6464,"_file":10454,"_extension":6466},"/topics/robotics/nonlinear-mpc","Nonlinear Model Predictive Control","Introduction to Nonlinear Model Predictive Control","nonlinear-mpc","/topics/robotics/nmpc/predict_horizon.png",{"type":15,"children":6474,"toc":10442},[6475,6479,6483,6504,6510,6516,6529,6534,6539,6544,6548,6553,6592,6597,6601,6606,6654,6660,6672,6676,6681,6686,6691,6696,6700,6704,6709,7892,7898,7903,7907,7911,7916,7920,7926,7931,7935,7951,7955,7959,7963,7969,7981,8013,8018,8547,8552,8728,8737,8992,8997,10010,10015,10363,10369,10374,10384,10390,10395,10400,10406,10438],{"type":18,"tag":19,"props":6476,"children":6477},{"id":35},[6478],{"type":24,"value":38},{"type":18,"tag":27,"props":6480,"children":6481},{},[6482],{"type":24,"value":43},{"type":18,"tag":6484,"props":6485,"children":6492},"div",{"className":6486},[6487,6488,6489,6490,6491],"grid","grid-cols-2","space-x-10","justify-center","items-center",[6493,6494,6498,6499],{"type":24,"value":6318},{"type":18,"tag":6320,"props":6495,"children":6497},{"className":6496,"src":6472,"width":6352,"height":6353},[6323],[],{"type":24,"value":6318},{"type":18,"tag":6320,"props":6500,"children":6503},{"className":6501,"src":6502,"width":6352,"height":6353},[6323],"/topics/robotics/nmpc/set_points.png",[],{"type":18,"tag":6329,"props":6505,"children":6507},{"className":6506},[68,6332,6333,6334],[6508],{"type":24,"value":6509},"\n  A car with finite horizons prediction and set point prediction over finite horizons.\n",{"type":18,"tag":19,"props":6511,"children":6513},{"id":6512},"nonlinear-model-predictive-control",[6514],{"type":24,"value":6515},"Nonlinear Model Predictive Control ?",{"type":18,"tag":27,"props":6517,"children":6518},{},[6519,6521,6524,6526],{"type":24,"value":6520},"Nonlinear Model Predictive Control has the same basic core of its control algorithms. The different is about the mathematical solving over the system. ",{"type":18,"tag":56,"props":6522,"children":6523},{},[],{"type":24,"value":6525},"\nIn the real-life application, most of the system certainly nonlinear and it's more complex than linear model. Linear systems are mostly time-invariant, meaning that the response of the system input is time-independent. Nonlinear systems are time-varying meaning that the response of the system to any input is time-dependent.",{"type":18,"tag":56,"props":6527,"children":6528},{},[],{"type":18,"tag":27,"props":6530,"children":6531},{},[6532],{"type":24,"value":6533},"The system model can be represent as state-space model",{"type":18,"tag":27,"props":6535,"children":6536},{},[6537],{"type":24,"value":6538},"$$ \\dot{X} = f(X,U) $$",{"type":18,"tag":27,"props":6540,"children":6541},{},[6542],{"type":24,"value":6543},"Nonlinear Model Predictive Control also works by solving the quardratic cost subject to the nonlinear function over a future finite horizons. The quadractic cost can be define as",{"type":18,"tag":65,"props":6545,"children":6547},{"latex-express":6546,"styles":68},"J(x,u) = \\displaystyle\\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})",[],{"type":18,"tag":27,"props":6549,"children":6550},{},[6551],{"type":24,"value":6552},"Notation",{"type":18,"tag":76,"props":6554,"children":6555},{},[6556,6565,6574,6583],{"type":18,"tag":80,"props":6557,"children":6558},{},[6559,6563],{"type":18,"tag":84,"props":6560,"children":6562},{"latex-express":6561,"styles":87},"X",[],{"type":24,"value":6564}," is the state of the system. This shall be obtained from the optimiztion problem.",{"type":18,"tag":80,"props":6566,"children":6567},{},[6568,6572],{"type":18,"tag":84,"props":6569,"children":6571},{"latex-express":6570,"styles":87},"X_{ref}",[],{"type":24,"value":6573}," is the reference state of the system or desired input state.",{"type":18,"tag":80,"props":6575,"children":6576},{},[6577,6581],{"type":18,"tag":84,"props":6578,"children":6580},{"latex-express":6579,"styles":87},"U",[],{"type":24,"value":6582}," is the input control of the system. This is a solution obtained from the optimization problem.",{"type":18,"tag":80,"props":6584,"children":6585},{},[6586,6590],{"type":18,"tag":84,"props":6587,"children":6589},{"latex-express":6588,"styles":87},"U_{ref}",[],{"type":24,"value":6591}," is the reference control of the system or desired input control.",{"type":18,"tag":27,"props":6593,"children":6594},{},[6595],{"type":24,"value":6596},"Rewrite the optimization of NMPC problem.",{"type":18,"tag":65,"props":6598,"children":6600},{"latex-express":6599,"styles":68},"\n      \\begin{align*}\n            \\min_{u_{0}, u_{1}, ..., u_{N-1} } \\quad \\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}&Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})\\\\\n            \\text{subject to} \\quad & x_{k+1} = f(x_k, u_k) \\quad \\text{(System dynamics)} \\\\\n            & g(x_k, x_k) \\leq 0 \\quad \\text{(State constraints)} \\\\\n            & h(x_k, x_k) \\leq 0 \\quad \\text{(Input constraints)} \\\\\n            & p(x_k) \\leq 0 \\quad \\text{(Path constraints)} \\\\\n            & x_0=x(0)  \\quad \\text{(Initial condition)}\n      \\end{align*}\n            ",[],{"type":18,"tag":27,"props":6602,"children":6603},{},[6604],{"type":24,"value":6605},"Which,",{"type":18,"tag":76,"props":6607,"children":6608},{},[6609,6618,6627,6636,6644],{"type":18,"tag":80,"props":6610,"children":6611},{},[6612,6616],{"type":18,"tag":84,"props":6613,"children":6615},{"latex-express":6614,"styles":87},"f",[],{"type":24,"value":6617}," is the system dynamics model.",{"type":18,"tag":80,"props":6619,"children":6620},{},[6621,6625],{"type":18,"tag":84,"props":6622,"children":6624},{"latex-express":6623,"styles":87},"g",[],{"type":24,"value":6626}," is the state constraints of the system.",{"type":18,"tag":80,"props":6628,"children":6629},{},[6630,6634],{"type":18,"tag":84,"props":6631,"children":6633},{"latex-express":6632,"styles":87},"h",[],{"type":24,"value":6635}," is the input constraints of the system.",{"type":18,"tag":80,"props":6637,"children":6638},{},[6639,6642],{"type":18,"tag":84,"props":6640,"children":6641},{"latex-express":27,"styles":87},[],{"type":24,"value":6643}," is the path constraint, it help to ensure the safety following path of our system.",{"type":18,"tag":80,"props":6645,"children":6646},{},[6647,6652],{"type":18,"tag":84,"props":6648,"children":6651},{"latex-express":6649,"styles":87,"dist-cond":6650},"\\phi(X_{N})","false",[],{"type":24,"value":6653}," is the terminal cost of the system.",{"type":18,"tag":19,"props":6655,"children":6657},{"id":6656},"discretize-the-system-model-with-runge-kutta-4th-order",[6658],{"type":24,"value":6659},"Discretize the system model with Runge-Kutta 4th order",{"type":18,"tag":27,"props":6661,"children":6662},{},[6663,6665,6670],{"type":24,"value":6664},"I will choose a simple system mode robot ",{"type":18,"tag":170,"props":6666,"children":6667},{},[6668],{"type":24,"value":6669}," DifferentialDrive ",{"type":24,"value":6671},".\nThe forward kinematic equation",{"type":18,"tag":65,"props":6673,"children":6675},{"latex-express":6674,"styles":68},"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix}\n ",[],{"type":18,"tag":27,"props":6677,"children":6678},{},[6679],{"type":24,"value":6680},"State constraints are the restriction imposed on the state variable of the system. It helps our optimizer not to obtain the solution that is outside the boundary region and also ensure the system to always perform the minimal action control in any critical condition.",{"type":18,"tag":27,"props":6682,"children":6683},{},[6684],{"type":24,"value":6685},"We, then can do the approximation",{"type":18,"tag":65,"props":6687,"children":6690},{"latex-express":6688,"styles":68,"dist-cond":6689},"\n    \\begin{align*}\n        k_{1} &= f(x^{*}, u^{*}) \\\\\n        k_{2} &= f(x^{*}+k_{1}\\frac{dt}{2}, u^{*}) \\\\ \n        k_{3} &= f(x^{*}+k_{2}\\frac{dt}{2}, u^{*}) \\\\\n        k_{4} &= f(x^{*}+k_{3}dt, u^{*}) \\\\ \n        \\Rightarrow{x_{k+1} } &= x_{k} + (k_{1}+2k_{2}+2k_{3}+k_{4})\\frac{dt}{6}\n    \\end{align*}\n","true",[],{"type":18,"tag":27,"props":6692,"children":6693},{},[6694],{"type":24,"value":6695},"Let's evaluate it with our model.",{"type":18,"tag":65,"props":6697,"children":6699},{"latex-express":6698,"styles":68},"\n      \\begin{align*}\n        k_{1} &= \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n        k_{2} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{3} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{4} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n    \\end{align*}\n      ",[],{"type":18,"tag":65,"props":6701,"children":6703},{"latex-express":6702,"styles":68},"\n      \\Rightarrow{x_{k+1} } = x_{k} + \\left( \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} + \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix}   \\right) \\frac{dt}{6}\n",[],{"type":18,"tag":27,"props":6705,"children":6706},{},[6707],{"type":24,"value":6708},"How to implement it in Python ???",{"type":18,"tag":614,"props":6710,"children":6713},{"className":6711,"code":6712,"language":619,"meta":8},[617],"import numpy as np\n\n## Define sampling time dt 100Hz\ndt = 0.01\n## Define the num steps for function approximation \nnum_steps = 100\n## Define initial states\nx = 0.0\ny = 0.0\nyaw = 0.0\n## Define input control\nv = 1.5 #m/s\nomega = 1.57 #rad/s\n## Define state represent model\n### define lambda function take variable x\nf = lambda x, u :  np.array([\n      [u[0]*np.cos(x[2])],\n      [u[0]*np.sin(x[2])],\n      [u[1]]\n])\n\nfor _ in range(num_steps):\n    k1 = f([x, y, yaw], [v, omega])\n    k2 = f([x + (dt / 2) * k1[0], y + (dt / 2) * k1[1], yaw + (dt / 2) * k1[2]], [v, omega])\n    k3 = f([x + (dt / 2) * k2[0], y + (dt / 2) * k2[1], yaw + (dt / 2) * k2[2]], [v, omega])\n    k4 = f([x + dt * k3[0], y + dt * k3[1], yaw + dt * k3[2]], [v, omega])\n\n    # Update state of the robot\n    x += (k1[0] + 2 * k2[0] + 2 * k3[0] + k4[0]) * dt / 6\n    y += (k1[1] + 2 * k2[1] + 2 * k3[1] + k4[1]) * dt / 6\n    yaw += (k1[2] + 2 * k2[2] + 2 * k3[2] + k4[2]) * dt / 6\n",[6714],{"type":18,"tag":622,"props":6715,"children":6716},{},[6717],{"type":18,"tag":614,"props":6718,"children":6719},{"__ignoreMap":8},[6720,6743,6750,6758,6778,6786,6807,6815,6836,6856,6876,6884,6914,6943,6951,6959,6985,7019,7051,7067,7074,7081,7110,7127,7269,7406,7496,7503,7515,7643,7767],{"type":18,"tag":629,"props":6721,"children":6722},{"class":631,"line":632},[6723,6728,6733,6738],{"type":18,"tag":629,"props":6724,"children":6725},{"class":636},[6726],{"type":24,"value":6727},"import",{"type":18,"tag":629,"props":6729,"children":6730},{"class":642},[6731],{"type":24,"value":6732}," numpy ",{"type":18,"tag":629,"props":6734,"children":6735},{"class":636},[6736],{"type":24,"value":6737},"as",{"type":18,"tag":629,"props":6739,"children":6740},{"class":642},[6741],{"type":24,"value":6742}," np\n",{"type":18,"tag":629,"props":6744,"children":6745},{"class":631,"line":659},[6746],{"type":18,"tag":629,"props":6747,"children":6748},{},[6749],{"type":24,"value":665},{"type":18,"tag":629,"props":6751,"children":6752},{"class":631,"line":668},[6753],{"type":18,"tag":629,"props":6754,"children":6755},{"class":1866},[6756],{"type":24,"value":6757},"## Define sampling time dt 100Hz\n",{"type":18,"tag":629,"props":6759,"children":6760},{"class":631,"line":697},[6761,6765,6769,6773],{"type":18,"tag":629,"props":6762,"children":6763},{"class":642},[6764],{"type":24,"value":2727},{"type":18,"tag":629,"props":6766,"children":6767},{"class":636},[6768],{"type":24,"value":726},{"type":18,"tag":629,"props":6770,"children":6771},{"class":642},[6772],{"type":24,"value":645},{"type":18,"tag":629,"props":6774,"children":6775},{"class":686},[6776],{"type":24,"value":6777},"0.01\n",{"type":18,"tag":629,"props":6779,"children":6780},{"class":631,"line":705},[6781],{"type":18,"tag":629,"props":6782,"children":6783},{"class":1866},[6784],{"type":24,"value":6785},"## Define the num steps for function approximation \n",{"type":18,"tag":629,"props":6787,"children":6788},{"class":631,"line":734},[6789,6794,6798,6802],{"type":18,"tag":629,"props":6790,"children":6791},{"class":642},[6792],{"type":24,"value":6793},"num_steps ",{"type":18,"tag":629,"props":6795,"children":6796},{"class":636},[6797],{"type":24,"value":726},{"type":18,"tag":629,"props":6799,"children":6800},{"class":642},[6801],{"type":24,"value":645},{"type":18,"tag":629,"props":6803,"children":6804},{"class":686},[6805],{"type":24,"value":6806},"100\n",{"type":18,"tag":629,"props":6808,"children":6809},{"class":631,"line":760},[6810],{"type":18,"tag":629,"props":6811,"children":6812},{"class":1866},[6813],{"type":24,"value":6814},"## Define initial states\n",{"type":18,"tag":629,"props":6816,"children":6817},{"class":631,"line":786},[6818,6823,6827,6831],{"type":18,"tag":629,"props":6819,"children":6820},{"class":642},[6821],{"type":24,"value":6822},"x ",{"type":18,"tag":629,"props":6824,"children":6825},{"class":636},[6826],{"type":24,"value":726},{"type":18,"tag":629,"props":6828,"children":6829},{"class":642},[6830],{"type":24,"value":645},{"type":18,"tag":629,"props":6832,"children":6833},{"class":686},[6834],{"type":24,"value":6835},"0.0\n",{"type":18,"tag":629,"props":6837,"children":6838},{"class":631,"line":794},[6839,6844,6848,6852],{"type":18,"tag":629,"props":6840,"children":6841},{"class":642},[6842],{"type":24,"value":6843},"y ",{"type":18,"tag":629,"props":6845,"children":6846},{"class":636},[6847],{"type":24,"value":726},{"type":18,"tag":629,"props":6849,"children":6850},{"class":642},[6851],{"type":24,"value":645},{"type":18,"tag":629,"props":6853,"children":6854},{"class":686},[6855],{"type":24,"value":6835},{"type":18,"tag":629,"props":6857,"children":6858},{"class":631,"line":820},[6859,6864,6868,6872],{"type":18,"tag":629,"props":6860,"children":6861},{"class":642},[6862],{"type":24,"value":6863},"yaw ",{"type":18,"tag":629,"props":6865,"children":6866},{"class":636},[6867],{"type":24,"value":726},{"type":18,"tag":629,"props":6869,"children":6870},{"class":642},[6871],{"type":24,"value":645},{"type":18,"tag":629,"props":6873,"children":6874},{"class":686},[6875],{"type":24,"value":6835},{"type":18,"tag":629,"props":6877,"children":6878},{"class":631,"line":846},[6879],{"type":18,"tag":629,"props":6880,"children":6881},{"class":1866},[6882],{"type":24,"value":6883},"## Define input control\n",{"type":18,"tag":629,"props":6885,"children":6886},{"class":631,"line":854},[6887,6892,6896,6900,6905,6909],{"type":18,"tag":629,"props":6888,"children":6889},{"class":642},[6890],{"type":24,"value":6891},"v ",{"type":18,"tag":629,"props":6893,"children":6894},{"class":636},[6895],{"type":24,"value":726},{"type":18,"tag":629,"props":6897,"children":6898},{"class":642},[6899],{"type":24,"value":645},{"type":18,"tag":629,"props":6901,"children":6902},{"class":686},[6903],{"type":24,"value":6904},"1.5",{"type":18,"tag":629,"props":6906,"children":6907},{"class":642},[6908],{"type":24,"value":645},{"type":18,"tag":629,"props":6910,"children":6911},{"class":1866},[6912],{"type":24,"value":6913},"#m/s\n",{"type":18,"tag":629,"props":6915,"children":6916},{"class":631,"line":890},[6917,6922,6926,6930,6934,6938],{"type":18,"tag":629,"props":6918,"children":6919},{"class":642},[6920],{"type":24,"value":6921},"omega ",{"type":18,"tag":629,"props":6923,"children":6924},{"class":636},[6925],{"type":24,"value":726},{"type":18,"tag":629,"props":6927,"children":6928},{"class":642},[6929],{"type":24,"value":645},{"type":18,"tag":629,"props":6931,"children":6932},{"class":686},[6933],{"type":24,"value":2393},{"type":18,"tag":629,"props":6935,"children":6936},{"class":642},[6937],{"type":24,"value":645},{"type":18,"tag":629,"props":6939,"children":6940},{"class":1866},[6941],{"type":24,"value":6942},"#rad/s\n",{"type":18,"tag":629,"props":6944,"children":6945},{"class":631,"line":923},[6946],{"type":18,"tag":629,"props":6947,"children":6948},{"class":1866},[6949],{"type":24,"value":6950},"## Define state represent model\n",{"type":18,"tag":629,"props":6952,"children":6953},{"class":631,"line":931},[6954],{"type":18,"tag":629,"props":6955,"children":6956},{"class":1866},[6957],{"type":24,"value":6958},"### define lambda function take variable x\n",{"type":18,"tag":629,"props":6960,"children":6961},{"class":631,"line":965},[6962,6967,6971,6975,6980],{"type":18,"tag":629,"props":6963,"children":6964},{"class":642},[6965],{"type":24,"value":6966},"f ",{"type":18,"tag":629,"props":6968,"children":6969},{"class":636},[6970],{"type":24,"value":726},{"type":18,"tag":629,"props":6972,"children":6973},{"class":642},[6974],{"type":24,"value":645},{"type":18,"tag":629,"props":6976,"children":6977},{"class":636},[6978],{"type":24,"value":6979},"lambda",{"type":18,"tag":629,"props":6981,"children":6982},{"class":642},[6983],{"type":24,"value":6984}," x, u :  np.array([\n",{"type":18,"tag":629,"props":6986,"children":6987},{"class":631,"line":999},[6988,6993,6997,7001,7005,7010,7014],{"type":18,"tag":629,"props":6989,"children":6990},{"class":642},[6991],{"type":24,"value":6992},"      [u[",{"type":18,"tag":629,"props":6994,"children":6995},{"class":686},[6996],{"type":24,"value":882},{"type":18,"tag":629,"props":6998,"children":6999},{"class":642},[7000],{"type":24,"value":2612},{"type":18,"tag":629,"props":7002,"children":7003},{"class":636},[7004],{"type":24,"value":1071},{"type":18,"tag":629,"props":7006,"children":7007},{"class":642},[7008],{"type":24,"value":7009},"np.cos(x[",{"type":18,"tag":629,"props":7011,"children":7012},{"class":686},[7013],{"type":24,"value":1368},{"type":18,"tag":629,"props":7015,"children":7016},{"class":642},[7017],{"type":24,"value":7018},"])],\n",{"type":18,"tag":629,"props":7020,"children":7021},{"class":631,"line":1007},[7022,7026,7030,7034,7038,7043,7047],{"type":18,"tag":629,"props":7023,"children":7024},{"class":642},[7025],{"type":24,"value":6992},{"type":18,"tag":629,"props":7027,"children":7028},{"class":686},[7029],{"type":24,"value":882},{"type":18,"tag":629,"props":7031,"children":7032},{"class":642},[7033],{"type":24,"value":2612},{"type":18,"tag":629,"props":7035,"children":7036},{"class":636},[7037],{"type":24,"value":1071},{"type":18,"tag":629,"props":7039,"children":7040},{"class":642},[7041],{"type":24,"value":7042},"np.sin(x[",{"type":18,"tag":629,"props":7044,"children":7045},{"class":686},[7046],{"type":24,"value":1368},{"type":18,"tag":629,"props":7048,"children":7049},{"class":642},[7050],{"type":24,"value":7018},{"type":18,"tag":629,"props":7052,"children":7053},{"class":631,"line":1033},[7054,7058,7062],{"type":18,"tag":629,"props":7055,"children":7056},{"class":642},[7057],{"type":24,"value":6992},{"type":18,"tag":629,"props":7059,"children":7060},{"class":686},[7061],{"type":24,"value":992},{"type":18,"tag":629,"props":7063,"children":7064},{"class":642},[7065],{"type":24,"value":7066},"]]\n",{"type":18,"tag":629,"props":7068,"children":7069},{"class":631,"line":1041},[7070],{"type":18,"tag":629,"props":7071,"children":7072},{"class":642},[7073],{"type":24,"value":3295},{"type":18,"tag":629,"props":7075,"children":7076},{"class":631,"line":1083},[7077],{"type":18,"tag":629,"props":7078,"children":7079},{},[7080],{"type":24,"value":665},{"type":18,"tag":629,"props":7082,"children":7083},{"class":631,"line":1123},[7084,7088,7093,7097,7101,7105],{"type":18,"tag":629,"props":7085,"children":7086},{"class":636},[7087],{"type":24,"value":2805},{"type":18,"tag":629,"props":7089,"children":7090},{"class":642},[7091],{"type":24,"value":7092}," _ ",{"type":18,"tag":629,"props":7094,"children":7095},{"class":636},[7096],{"type":24,"value":2815},{"type":18,"tag":629,"props":7098,"children":7099},{"class":642},[7100],{"type":24,"value":645},{"type":18,"tag":629,"props":7102,"children":7103},{"class":686},[7104],{"type":24,"value":2824},{"type":18,"tag":629,"props":7106,"children":7107},{"class":642},[7108],{"type":24,"value":7109},"(num_steps):\n",{"type":18,"tag":629,"props":7111,"children":7112},{"class":631,"line":1217},[7113,7118,7122],{"type":18,"tag":629,"props":7114,"children":7115},{"class":642},[7116],{"type":24,"value":7117},"    k1 ",{"type":18,"tag":629,"props":7119,"children":7120},{"class":636},[7121],{"type":24,"value":726},{"type":18,"tag":629,"props":7123,"children":7124},{"class":642},[7125],{"type":24,"value":7126}," f([x, y, yaw], [v, omega])\n",{"type":18,"tag":629,"props":7128,"children":7129},{"class":631,"line":1225},[7130,7135,7139,7144,7148,7153,7157,7161,7165,7169,7173,7178,7182,7187,7191,7195,7199,7203,7207,7211,7215,7219,7223,7228,7232,7236,7240,7244,7248,7252,7256,7260,7264],{"type":18,"tag":629,"props":7131,"children":7132},{"class":642},[7133],{"type":24,"value":7134},"    k2 ",{"type":18,"tag":629,"props":7136,"children":7137},{"class":636},[7138],{"type":24,"value":726},{"type":18,"tag":629,"props":7140,"children":7141},{"class":642},[7142],{"type":24,"value":7143}," f([x ",{"type":18,"tag":629,"props":7145,"children":7146},{"class":636},[7147],{"type":24,"value":1192},{"type":18,"tag":629,"props":7149,"children":7150},{"class":642},[7151],{"type":24,"value":7152}," (dt ",{"type":18,"tag":629,"props":7154,"children":7155},{"class":636},[7156],{"type":24,"value":1429},{"type":18,"tag":629,"props":7158,"children":7159},{"class":642},[7160],{"type":24,"value":645},{"type":18,"tag":629,"props":7162,"children":7163},{"class":686},[7164],{"type":24,"value":1368},{"type":18,"tag":629,"props":7166,"children":7167},{"class":642},[7168],{"type":24,"value":5372},{"type":18,"tag":629,"props":7170,"children":7171},{"class":636},[7172],{"type":24,"value":1071},{"type":18,"tag":629,"props":7174,"children":7175},{"class":642},[7176],{"type":24,"value":7177}," k1[",{"type":18,"tag":629,"props":7179,"children":7180},{"class":686},[7181],{"type":24,"value":882},{"type":18,"tag":629,"props":7183,"children":7184},{"class":642},[7185],{"type":24,"value":7186},"], y ",{"type":18,"tag":629,"props":7188,"children":7189},{"class":636},[7190],{"type":24,"value":1192},{"type":18,"tag":629,"props":7192,"children":7193},{"class":642},[7194],{"type":24,"value":7152},{"type":18,"tag":629,"props":7196,"children":7197},{"class":636},[7198],{"type":24,"value":1429},{"type":18,"tag":629,"props":7200,"children":7201},{"class":642},[7202],{"type":24,"value":645},{"type":18,"tag":629,"props":7204,"children":7205},{"class":686},[7206],{"type":24,"value":1368},{"type":18,"tag":629,"props":7208,"children":7209},{"class":642},[7210],{"type":24,"value":5372},{"type":18,"tag":629,"props":7212,"children":7213},{"class":636},[7214],{"type":24,"value":1071},{"type":18,"tag":629,"props":7216,"children":7217},{"class":642},[7218],{"type":24,"value":7177},{"type":18,"tag":629,"props":7220,"children":7221},{"class":686},[7222],{"type":24,"value":992},{"type":18,"tag":629,"props":7224,"children":7225},{"class":642},[7226],{"type":24,"value":7227},"], yaw ",{"type":18,"tag":629,"props":7229,"children":7230},{"class":636},[7231],{"type":24,"value":1192},{"type":18,"tag":629,"props":7233,"children":7234},{"class":642},[7235],{"type":24,"value":7152},{"type":18,"tag":629,"props":7237,"children":7238},{"class":636},[7239],{"type":24,"value":1429},{"type":18,"tag":629,"props":7241,"children":7242},{"class":642},[7243],{"type":24,"value":645},{"type":18,"tag":629,"props":7245,"children":7246},{"class":686},[7247],{"type":24,"value":1368},{"type":18,"tag":629,"props":7249,"children":7250},{"class":642},[7251],{"type":24,"value":5372},{"type":18,"tag":629,"props":7253,"children":7254},{"class":636},[7255],{"type":24,"value":1071},{"type":18,"tag":629,"props":7257,"children":7258},{"class":642},[7259],{"type":24,"value":7177},{"type":18,"tag":629,"props":7261,"children":7262},{"class":686},[7263],{"type":24,"value":1368},{"type":18,"tag":629,"props":7265,"children":7266},{"class":642},[7267],{"type":24,"value":7268},"]], [v, omega])\n",{"type":18,"tag":629,"props":7270,"children":7271},{"class":631,"line":1243},[7272,7277,7281,7285,7289,7293,7297,7301,7305,7309,7313,7318,7322,7326,7330,7334,7338,7342,7346,7350,7354,7358,7362,7366,7370,7374,7378,7382,7386,7390,7394,7398,7402],{"type":18,"tag":629,"props":7273,"children":7274},{"class":642},[7275],{"type":24,"value":7276},"    k3 ",{"type":18,"tag":629,"props":7278,"children":7279},{"class":636},[7280],{"type":24,"value":726},{"type":18,"tag":629,"props":7282,"children":7283},{"class":642},[7284],{"type":24,"value":7143},{"type":18,"tag":629,"props":7286,"children":7287},{"class":636},[7288],{"type":24,"value":1192},{"type":18,"tag":629,"props":7290,"children":7291},{"class":642},[7292],{"type":24,"value":7152},{"type":18,"tag":629,"props":7294,"children":7295},{"class":636},[7296],{"type":24,"value":1429},{"type":18,"tag":629,"props":7298,"children":7299},{"class":642},[7300],{"type":24,"value":645},{"type":18,"tag":629,"props":7302,"children":7303},{"class":686},[7304],{"type":24,"value":1368},{"type":18,"tag":629,"props":7306,"children":7307},{"class":642},[7308],{"type":24,"value":5372},{"type":18,"tag":629,"props":7310,"children":7311},{"class":636},[7312],{"type":24,"value":1071},{"type":18,"tag":629,"props":7314,"children":7315},{"class":642},[7316],{"type":24,"value":7317}," k2[",{"type":18,"tag":629,"props":7319,"children":7320},{"class":686},[7321],{"type":24,"value":882},{"type":18,"tag":629,"props":7323,"children":7324},{"class":642},[7325],{"type":24,"value":7186},{"type":18,"tag":629,"props":7327,"children":7328},{"class":636},[7329],{"type":24,"value":1192},{"type":18,"tag":629,"props":7331,"children":7332},{"class":642},[7333],{"type":24,"value":7152},{"type":18,"tag":629,"props":7335,"children":7336},{"class":636},[7337],{"type":24,"value":1429},{"type":18,"tag":629,"props":7339,"children":7340},{"class":642},[7341],{"type":24,"value":645},{"type":18,"tag":629,"props":7343,"children":7344},{"class":686},[7345],{"type":24,"value":1368},{"type":18,"tag":629,"props":7347,"children":7348},{"class":642},[7349],{"type":24,"value":5372},{"type":18,"tag":629,"props":7351,"children":7352},{"class":636},[7353],{"type":24,"value":1071},{"type":18,"tag":629,"props":7355,"children":7356},{"class":642},[7357],{"type":24,"value":7317},{"type":18,"tag":629,"props":7359,"children":7360},{"class":686},[7361],{"type":24,"value":992},{"type":18,"tag":629,"props":7363,"children":7364},{"class":642},[7365],{"type":24,"value":7227},{"type":18,"tag":629,"props":7367,"children":7368},{"class":636},[7369],{"type":24,"value":1192},{"type":18,"tag":629,"props":7371,"children":7372},{"class":642},[7373],{"type":24,"value":7152},{"type":18,"tag":629,"props":7375,"children":7376},{"class":636},[7377],{"type":24,"value":1429},{"type":18,"tag":629,"props":7379,"children":7380},{"class":642},[7381],{"type":24,"value":645},{"type":18,"tag":629,"props":7383,"children":7384},{"class":686},[7385],{"type":24,"value":1368},{"type":18,"tag":629,"props":7387,"children":7388},{"class":642},[7389],{"type":24,"value":5372},{"type":18,"tag":629,"props":7391,"children":7392},{"class":636},[7393],{"type":24,"value":1071},{"type":18,"tag":629,"props":7395,"children":7396},{"class":642},[7397],{"type":24,"value":7317},{"type":18,"tag":629,"props":7399,"children":7400},{"class":686},[7401],{"type":24,"value":1368},{"type":18,"tag":629,"props":7403,"children":7404},{"class":642},[7405],{"type":24,"value":7268},{"type":18,"tag":629,"props":7407,"children":7408},{"class":631,"line":1251},[7409,7414,7418,7422,7426,7431,7435,7440,7444,7448,7452,7456,7460,7464,7468,7472,7476,7480,7484,7488,7492],{"type":18,"tag":629,"props":7410,"children":7411},{"class":642},[7412],{"type":24,"value":7413},"    k4 ",{"type":18,"tag":629,"props":7415,"children":7416},{"class":636},[7417],{"type":24,"value":726},{"type":18,"tag":629,"props":7419,"children":7420},{"class":642},[7421],{"type":24,"value":7143},{"type":18,"tag":629,"props":7423,"children":7424},{"class":636},[7425],{"type":24,"value":1192},{"type":18,"tag":629,"props":7427,"children":7428},{"class":642},[7429],{"type":24,"value":7430}," dt ",{"type":18,"tag":629,"props":7432,"children":7433},{"class":636},[7434],{"type":24,"value":1071},{"type":18,"tag":629,"props":7436,"children":7437},{"class":642},[7438],{"type":24,"value":7439}," k3[",{"type":18,"tag":629,"props":7441,"children":7442},{"class":686},[7443],{"type":24,"value":882},{"type":18,"tag":629,"props":7445,"children":7446},{"class":642},[7447],{"type":24,"value":7186},{"type":18,"tag":629,"props":7449,"children":7450},{"class":636},[7451],{"type":24,"value":1192},{"type":18,"tag":629,"props":7453,"children":7454},{"class":642},[7455],{"type":24,"value":7430},{"type":18,"tag":629,"props":7457,"children":7458},{"class":636},[7459],{"type":24,"value":1071},{"type":18,"tag":629,"props":7461,"children":7462},{"class":642},[7463],{"type":24,"value":7439},{"type":18,"tag":629,"props":7465,"children":7466},{"class":686},[7467],{"type":24,"value":992},{"type":18,"tag":629,"props":7469,"children":7470},{"class":642},[7471],{"type":24,"value":7227},{"type":18,"tag":629,"props":7473,"children":7474},{"class":636},[7475],{"type":24,"value":1192},{"type":18,"tag":629,"props":7477,"children":7478},{"class":642},[7479],{"type":24,"value":7430},{"type":18,"tag":629,"props":7481,"children":7482},{"class":636},[7483],{"type":24,"value":1071},{"type":18,"tag":629,"props":7485,"children":7486},{"class":642},[7487],{"type":24,"value":7439},{"type":18,"tag":629,"props":7489,"children":7490},{"class":686},[7491],{"type":24,"value":1368},{"type":18,"tag":629,"props":7493,"children":7494},{"class":642},[7495],{"type":24,"value":7268},{"type":18,"tag":629,"props":7497,"children":7498},{"class":631,"line":1277},[7499],{"type":18,"tag":629,"props":7500,"children":7501},{},[7502],{"type":24,"value":665},{"type":18,"tag":629,"props":7504,"children":7505},{"class":631,"line":1285},[7506,7510],{"type":18,"tag":629,"props":7507,"children":7508},{"class":642},[7509],{"type":24,"value":674},{"type":18,"tag":629,"props":7511,"children":7512},{"class":1866},[7513],{"type":24,"value":7514},"# Update state of the robot\n",{"type":18,"tag":629,"props":7516,"children":7517},{"class":631,"line":1441},[7518,7523,7528,7533,7537,7541,7545,7549,7553,7557,7561,7565,7569,7573,7577,7581,7585,7589,7593,7597,7601,7605,7609,7614,7618,7623,7627,7631,7635,7639],{"type":18,"tag":629,"props":7519,"children":7520},{"class":642},[7521],{"type":24,"value":7522},"    x ",{"type":18,"tag":629,"props":7524,"children":7525},{"class":636},[7526],{"type":24,"value":7527},"+=",{"type":18,"tag":629,"props":7529,"children":7530},{"class":642},[7531],{"type":24,"value":7532}," (k1[",{"type":18,"tag":629,"props":7534,"children":7535},{"class":686},[7536],{"type":24,"value":882},{"type":18,"tag":629,"props":7538,"children":7539},{"class":642},[7540],{"type":24,"value":2926},{"type":18,"tag":629,"props":7542,"children":7543},{"class":636},[7544],{"type":24,"value":1192},{"type":18,"tag":629,"props":7546,"children":7547},{"class":642},[7548],{"type":24,"value":645},{"type":18,"tag":629,"props":7550,"children":7551},{"class":686},[7552],{"type":24,"value":1368},{"type":18,"tag":629,"props":7554,"children":7555},{"class":642},[7556],{"type":24,"value":645},{"type":18,"tag":629,"props":7558,"children":7559},{"class":636},[7560],{"type":24,"value":1071},{"type":18,"tag":629,"props":7562,"children":7563},{"class":642},[7564],{"type":24,"value":7317},{"type":18,"tag":629,"props":7566,"children":7567},{"class":686},[7568],{"type":24,"value":882},{"type":18,"tag":629,"props":7570,"children":7571},{"class":642},[7572],{"type":24,"value":2926},{"type":18,"tag":629,"props":7574,"children":7575},{"class":636},[7576],{"type":24,"value":1192},{"type":18,"tag":629,"props":7578,"children":7579},{"class":642},[7580],{"type":24,"value":645},{"type":18,"tag":629,"props":7582,"children":7583},{"class":686},[7584],{"type":24,"value":1368},{"type":18,"tag":629,"props":7586,"children":7587},{"class":642},[7588],{"type":24,"value":645},{"type":18,"tag":629,"props":7590,"children":7591},{"class":636},[7592],{"type":24,"value":1071},{"type":18,"tag":629,"props":7594,"children":7595},{"class":642},[7596],{"type":24,"value":7439},{"type":18,"tag":629,"props":7598,"children":7599},{"class":686},[7600],{"type":24,"value":882},{"type":18,"tag":629,"props":7602,"children":7603},{"class":642},[7604],{"type":24,"value":2926},{"type":18,"tag":629,"props":7606,"children":7607},{"class":636},[7608],{"type":24,"value":1192},{"type":18,"tag":629,"props":7610,"children":7611},{"class":642},[7612],{"type":24,"value":7613}," k4[",{"type":18,"tag":629,"props":7615,"children":7616},{"class":686},[7617],{"type":24,"value":882},{"type":18,"tag":629,"props":7619,"children":7620},{"class":642},[7621],{"type":24,"value":7622},"]) ",{"type":18,"tag":629,"props":7624,"children":7625},{"class":636},[7626],{"type":24,"value":1071},{"type":18,"tag":629,"props":7628,"children":7629},{"class":642},[7630],{"type":24,"value":7430},{"type":18,"tag":629,"props":7632,"children":7633},{"class":636},[7634],{"type":24,"value":1429},{"type":18,"tag":629,"props":7636,"children":7637},{"class":642},[7638],{"type":24,"value":645},{"type":18,"tag":629,"props":7640,"children":7641},{"class":686},[7642],{"type":24,"value":2213},{"type":18,"tag":629,"props":7644,"children":7645},{"class":631,"line":1561},[7646,7651,7655,7659,7663,7667,7671,7675,7679,7683,7687,7691,7695,7699,7703,7707,7711,7715,7719,7723,7727,7731,7735,7739,7743,7747,7751,7755,7759,7763],{"type":18,"tag":629,"props":7647,"children":7648},{"class":642},[7649],{"type":24,"value":7650},"    y ",{"type":18,"tag":629,"props":7652,"children":7653},{"class":636},[7654],{"type":24,"value":7527},{"type":18,"tag":629,"props":7656,"children":7657},{"class":642},[7658],{"type":24,"value":7532},{"type":18,"tag":629,"props":7660,"children":7661},{"class":686},[7662],{"type":24,"value":992},{"type":18,"tag":629,"props":7664,"children":7665},{"class":642},[7666],{"type":24,"value":2926},{"type":18,"tag":629,"props":7668,"children":7669},{"class":636},[7670],{"type":24,"value":1192},{"type":18,"tag":629,"props":7672,"children":7673},{"class":642},[7674],{"type":24,"value":645},{"type":18,"tag":629,"props":7676,"children":7677},{"class":686},[7678],{"type":24,"value":1368},{"type":18,"tag":629,"props":7680,"children":7681},{"class":642},[7682],{"type":24,"value":645},{"type":18,"tag":629,"props":7684,"children":7685},{"class":636},[7686],{"type":24,"value":1071},{"type":18,"tag":629,"props":7688,"children":7689},{"class":642},[7690],{"type":24,"value":7317},{"type":18,"tag":629,"props":7692,"children":7693},{"class":686},[7694],{"type":24,"value":992},{"type":18,"tag":629,"props":7696,"children":7697},{"class":642},[7698],{"type":24,"value":2926},{"type":18,"tag":629,"props":7700,"children":7701},{"class":636},[7702],{"type":24,"value":1192},{"type":18,"tag":629,"props":7704,"children":7705},{"class":642},[7706],{"type":24,"value":645},{"type":18,"tag":629,"props":7708,"children":7709},{"class":686},[7710],{"type":24,"value":1368},{"type":18,"tag":629,"props":7712,"children":7713},{"class":642},[7714],{"type":24,"value":645},{"type":18,"tag":629,"props":7716,"children":7717},{"class":636},[7718],{"type":24,"value":1071},{"type":18,"tag":629,"props":7720,"children":7721},{"class":642},[7722],{"type":24,"value":7439},{"type":18,"tag":629,"props":7724,"children":7725},{"class":686},[7726],{"type":24,"value":992},{"type":18,"tag":629,"props":7728,"children":7729},{"class":642},[7730],{"type":24,"value":2926},{"type":18,"tag":629,"props":7732,"children":7733},{"class":636},[7734],{"type":24,"value":1192},{"type":18,"tag":629,"props":7736,"children":7737},{"class":642},[7738],{"type":24,"value":7613},{"type":18,"tag":629,"props":7740,"children":7741},{"class":686},[7742],{"type":24,"value":992},{"type":18,"tag":629,"props":7744,"children":7745},{"class":642},[7746],{"type":24,"value":7622},{"type":18,"tag":629,"props":7748,"children":7749},{"class":636},[7750],{"type":24,"value":1071},{"type":18,"tag":629,"props":7752,"children":7753},{"class":642},[7754],{"type":24,"value":7430},{"type":18,"tag":629,"props":7756,"children":7757},{"class":636},[7758],{"type":24,"value":1429},{"type":18,"tag":629,"props":7760,"children":7761},{"class":642},[7762],{"type":24,"value":645},{"type":18,"tag":629,"props":7764,"children":7765},{"class":686},[7766],{"type":24,"value":2213},{"type":18,"tag":629,"props":7768,"children":7769},{"class":631,"line":1569},[7770,7775,7779,7783,7787,7791,7795,7799,7803,7807,7811,7815,7819,7823,7827,7831,7835,7839,7843,7847,7851,7855,7859,7863,7867,7871,7875,7879,7883,7887],{"type":18,"tag":629,"props":7771,"children":7772},{"class":642},[7773],{"type":24,"value":7774},"    yaw ",{"type":18,"tag":629,"props":7776,"children":7777},{"class":636},[7778],{"type":24,"value":7527},{"type":18,"tag":629,"props":7780,"children":7781},{"class":642},[7782],{"type":24,"value":7532},{"type":18,"tag":629,"props":7784,"children":7785},{"class":686},[7786],{"type":24,"value":1368},{"type":18,"tag":629,"props":7788,"children":7789},{"class":642},[7790],{"type":24,"value":2926},{"type":18,"tag":629,"props":7792,"children":7793},{"class":636},[7794],{"type":24,"value":1192},{"type":18,"tag":629,"props":7796,"children":7797},{"class":642},[7798],{"type":24,"value":645},{"type":18,"tag":629,"props":7800,"children":7801},{"class":686},[7802],{"type":24,"value":1368},{"type":18,"tag":629,"props":7804,"children":7805},{"class":642},[7806],{"type":24,"value":645},{"type":18,"tag":629,"props":7808,"children":7809},{"class":636},[7810],{"type":24,"value":1071},{"type":18,"tag":629,"props":7812,"children":7813},{"class":642},[7814],{"type":24,"value":7317},{"type":18,"tag":629,"props":7816,"children":7817},{"class":686},[7818],{"type":24,"value":1368},{"type":18,"tag":629,"props":7820,"children":7821},{"class":642},[7822],{"type":24,"value":2926},{"type":18,"tag":629,"props":7824,"children":7825},{"class":636},[7826],{"type":24,"value":1192},{"type":18,"tag":629,"props":7828,"children":7829},{"class":642},[7830],{"type":24,"value":645},{"type":18,"tag":629,"props":7832,"children":7833},{"class":686},[7834],{"type":24,"value":1368},{"type":18,"tag":629,"props":7836,"children":7837},{"class":642},[7838],{"type":24,"value":645},{"type":18,"tag":629,"props":7840,"children":7841},{"class":636},[7842],{"type":24,"value":1071},{"type":18,"tag":629,"props":7844,"children":7845},{"class":642},[7846],{"type":24,"value":7439},{"type":18,"tag":629,"props":7848,"children":7849},{"class":686},[7850],{"type":24,"value":1368},{"type":18,"tag":629,"props":7852,"children":7853},{"class":642},[7854],{"type":24,"value":2926},{"type":18,"tag":629,"props":7856,"children":7857},{"class":636},[7858],{"type":24,"value":1192},{"type":18,"tag":629,"props":7860,"children":7861},{"class":642},[7862],{"type":24,"value":7613},{"type":18,"tag":629,"props":7864,"children":7865},{"class":686},[7866],{"type":24,"value":1368},{"type":18,"tag":629,"props":7868,"children":7869},{"class":642},[7870],{"type":24,"value":7622},{"type":18,"tag":629,"props":7872,"children":7873},{"class":636},[7874],{"type":24,"value":1071},{"type":18,"tag":629,"props":7876,"children":7877},{"class":642},[7878],{"type":24,"value":7430},{"type":18,"tag":629,"props":7880,"children":7881},{"class":636},[7882],{"type":24,"value":1429},{"type":18,"tag":629,"props":7884,"children":7885},{"class":642},[7886],{"type":24,"value":645},{"type":18,"tag":629,"props":7888,"children":7889},{"class":686},[7890],{"type":24,"value":7891},"6",{"type":18,"tag":19,"props":7893,"children":7895},{"id":7894},"single-shooting-method",[7896],{"type":24,"value":7897},"Single Shooting Method",{"type":18,"tag":27,"props":7899,"children":7900},{},[7901],{"type":24,"value":7902},"Single Shooting Method is a method that we transform the optimal control problem to the nonlinear programming problem with just one decision variable.",{"type":18,"tag":65,"props":7904,"children":7906},{"latex-express":7905,"styles":68},"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}\\right]\n        \\end{align*}\n",[],{"type":18,"tag":65,"props":7908,"children":7910},{"latex-express":7909,"styles":68},"\n      \\begin{align*}\n            x_{u} &= F(w,x_{0},t_{k}) \\\\\n            F(w,x_{0},t_{0}) &= x_{0} \\\\\n        \\end{align*}\n",[],{"type":18,"tag":27,"props":7912,"children":7913},{},[7914],{"type":24,"value":7915},"Then solve the NLP",{"type":18,"tag":65,"props":7917,"children":7919},{"latex-express":7918,"styles":68},"\n      \\begin{align*}\n            \\min_{w}\\Phi(F(w,x_{0},t_{k}), w) \\\\ \n            \\text{Subject to} \\hspace{1cm}  g_{1}(F(w,x_{0},t_{k}),w) \\leq{0}\n        \\end{align*}\n",[],{"type":18,"tag":19,"props":7921,"children":7923},{"id":7922},"multiple-shooting-method",[7924],{"type":24,"value":7925},"Multiple Shooting Method",{"type":18,"tag":27,"props":7927,"children":7928},{},[7929],{"type":24,"value":7930},"Multiple Shooting Method is a method that consist of transforming of optimal control problem to the nonlinear programming problem with multiple decision variables.",{"type":18,"tag":65,"props":7932,"children":7934},{"latex-express":7933,"styles":68},"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}, x_{0}, ..., x_{N}\\right]\n        \\end{align*}\n",[],{"type":18,"tag":76,"props":7936,"children":7937},{},[7938,7946],{"type":18,"tag":80,"props":7939,"children":7940},{},[7941,7944],{"type":18,"tag":84,"props":7942,"children":7943},{"latex-express":6561,"styles":87},[],{"type":24,"value":7945}," becoming decision variable in the opimization problem as well as u",{"type":18,"tag":80,"props":7947,"children":7948},{},[7949],{"type":24,"value":7950},"We apply path constraint at each iteration step",{"type":18,"tag":65,"props":7952,"children":7954},{"latex-express":7953,"styles":68},"\n      \\begin{equation*}\n                x_{k+1}-f(x_{k},u_{k}) = 0\n            \\end{equation*}\n",[],{"type":18,"tag":27,"props":7956,"children":7957},{},[7958],{"type":24,"value":7915},{"type":18,"tag":65,"props":7960,"children":7962},{"latex-express":7961,"styles":68},"\n      \\begin{align*}\n            \\min_{w}  \\Phi(F(w,x_{0},t_{k}),& w) \\\\ \n            \\text{s.t}\\hspace{0.5cm}  g_{1}(F(w,x_{0},t_{k}),w) &\\leq{0} \\\\ \n                               g_{2}(w) = \\begin{bmatrix}\n                                  \\bar{x}_{0}-x_{0} \\\\\n                                  f(x_{0},u_{0})-x_{1} \\\\ \n                                  \\vdots \\\\\n                                  f(x_{N-1}, u_{N-1}-x_{N})\n                              \\end{bmatrix} &= 0\n        \\end{align*}\n",[],{"type":18,"tag":19,"props":7964,"children":7966},{"id":7965},"full-implement-in-python",[7967],{"type":24,"value":7968},"Full Implement in Python",{"type":18,"tag":27,"props":7970,"children":7971},{},[7972,7974,7979],{"type":24,"value":7973},"We will use ",{"type":18,"tag":4375,"props":7975,"children":7976},{},[7977],{"type":24,"value":7978},"Casadi",{"type":24,"value":7980}," as a numerical optimization framework.",{"type":18,"tag":614,"props":7982,"children":7985},{"className":7983,"code":7984,"language":619,"meta":8},[617],"import casadi as ca\n",[7986],{"type":18,"tag":622,"props":7987,"children":7988},{},[7989],{"type":18,"tag":614,"props":7990,"children":7991},{"__ignoreMap":8},[7992],{"type":18,"tag":629,"props":7993,"children":7994},{"class":631,"line":632},[7995,7999,8004,8008],{"type":18,"tag":629,"props":7996,"children":7997},{"class":636},[7998],{"type":24,"value":6727},{"type":18,"tag":629,"props":8000,"children":8001},{"class":642},[8002],{"type":24,"value":8003}," casadi ",{"type":18,"tag":629,"props":8005,"children":8006},{"class":636},[8007],{"type":24,"value":6737},{"type":18,"tag":629,"props":8009,"children":8010},{"class":642},[8011],{"type":24,"value":8012}," ca",{"type":18,"tag":27,"props":8014,"children":8015},{},[8016],{"type":24,"value":8017},"Define state representation and input control of our nonlinear model.",{"type":18,"tag":614,"props":8019,"children":8022},{"className":8020,"code":8021,"language":619,"meta":8},[617],"# Symbolic Variables\n## States\nx = ca.SX.sym(\"x\")\ny = ca.SX.sym(\"y\")\ntheta = ca.SX.sym(\"theta\")\nstates = ca.vertcat(x, y, theta)\nnum_states = states.numel()\n\n## Control\nu1 = ca.SX.sym(\"u1\")\nu2 = ca.SX.sym(\"u2\")\ncontrols = ca.vertcat(u1, u2)\nnum_controls = controls.numel()\n\n# Define Nonlinear model\n## Rotation Matrix\nrot_mat = ca.vertcat(\n    ca.horzcat(ca.cos(theta), ca.sin(theta), 0),\n    ca.horzcat(-ca.sin(theta), ca.cos(theta), 0),\n    ca.horzcat(0, 0, 1)\n)\n\nvx = u1 * ca.cos(theta)\nvy = u1 * ca.sin(theta)\nvyaw = u2\n\nrhs = ca.vertcat(vx, vy, vyaw)\n## Define mapped nonlinear function f(x,u) -> rhs\nf = ca.Function('f', [states, controls], [rhs])\n",[8023],{"type":18,"tag":622,"props":8024,"children":8025},{},[8026],{"type":18,"tag":614,"props":8027,"children":8028},{"__ignoreMap":8},[8029,8037,8045,8080,8112,8145,8162,8179,8186,8194,8227,8260,8277,8294,8301,8309,8317,8334,8351,8376,8407,8414,8421,8447,8472,8489,8496,8513,8521],{"type":18,"tag":629,"props":8030,"children":8031},{"class":631,"line":632},[8032],{"type":18,"tag":629,"props":8033,"children":8034},{"class":1866},[8035],{"type":24,"value":8036},"# Symbolic Variables\n",{"type":18,"tag":629,"props":8038,"children":8039},{"class":631,"line":659},[8040],{"type":18,"tag":629,"props":8041,"children":8042},{"class":1866},[8043],{"type":24,"value":8044},"## States\n",{"type":18,"tag":629,"props":8046,"children":8047},{"class":631,"line":668},[8048,8052,8056,8061,8066,8071,8076],{"type":18,"tag":629,"props":8049,"children":8050},{"class":642},[8051],{"type":24,"value":6822},{"type":18,"tag":629,"props":8053,"children":8054},{"class":636},[8055],{"type":24,"value":726},{"type":18,"tag":629,"props":8057,"children":8058},{"class":642},[8059],{"type":24,"value":8060}," ca.",{"type":18,"tag":629,"props":8062,"children":8063},{"class":686},[8064],{"type":24,"value":8065},"SX",{"type":18,"tag":629,"props":8067,"children":8068},{"class":642},[8069],{"type":24,"value":8070},".sym(",{"type":18,"tag":629,"props":8072,"children":8073},{"class":5364},[8074],{"type":24,"value":8075},"\"x\"",{"type":18,"tag":629,"props":8077,"children":8078},{"class":642},[8079],{"type":24,"value":1438},{"type":18,"tag":629,"props":8081,"children":8082},{"class":631,"line":697},[8083,8087,8091,8095,8099,8103,8108],{"type":18,"tag":629,"props":8084,"children":8085},{"class":642},[8086],{"type":24,"value":6843},{"type":18,"tag":629,"props":8088,"children":8089},{"class":636},[8090],{"type":24,"value":726},{"type":18,"tag":629,"props":8092,"children":8093},{"class":642},[8094],{"type":24,"value":8060},{"type":18,"tag":629,"props":8096,"children":8097},{"class":686},[8098],{"type":24,"value":8065},{"type":18,"tag":629,"props":8100,"children":8101},{"class":642},[8102],{"type":24,"value":8070},{"type":18,"tag":629,"props":8104,"children":8105},{"class":5364},[8106],{"type":24,"value":8107},"\"y\"",{"type":18,"tag":629,"props":8109,"children":8110},{"class":642},[8111],{"type":24,"value":1438},{"type":18,"tag":629,"props":8113,"children":8114},{"class":631,"line":705},[8115,8120,8124,8128,8132,8136,8141],{"type":18,"tag":629,"props":8116,"children":8117},{"class":642},[8118],{"type":24,"value":8119},"theta ",{"type":18,"tag":629,"props":8121,"children":8122},{"class":636},[8123],{"type":24,"value":726},{"type":18,"tag":629,"props":8125,"children":8126},{"class":642},[8127],{"type":24,"value":8060},{"type":18,"tag":629,"props":8129,"children":8130},{"class":686},[8131],{"type":24,"value":8065},{"type":18,"tag":629,"props":8133,"children":8134},{"class":642},[8135],{"type":24,"value":8070},{"type":18,"tag":629,"props":8137,"children":8138},{"class":5364},[8139],{"type":24,"value":8140},"\"theta\"",{"type":18,"tag":629,"props":8142,"children":8143},{"class":642},[8144],{"type":24,"value":1438},{"type":18,"tag":629,"props":8146,"children":8147},{"class":631,"line":734},[8148,8153,8157],{"type":18,"tag":629,"props":8149,"children":8150},{"class":642},[8151],{"type":24,"value":8152},"states ",{"type":18,"tag":629,"props":8154,"children":8155},{"class":636},[8156],{"type":24,"value":726},{"type":18,"tag":629,"props":8158,"children":8159},{"class":642},[8160],{"type":24,"value":8161}," ca.vertcat(x, y, theta)\n",{"type":18,"tag":629,"props":8163,"children":8164},{"class":631,"line":760},[8165,8170,8174],{"type":18,"tag":629,"props":8166,"children":8167},{"class":642},[8168],{"type":24,"value":8169},"num_states ",{"type":18,"tag":629,"props":8171,"children":8172},{"class":636},[8173],{"type":24,"value":726},{"type":18,"tag":629,"props":8175,"children":8176},{"class":642},[8177],{"type":24,"value":8178}," states.numel()\n",{"type":18,"tag":629,"props":8180,"children":8181},{"class":631,"line":786},[8182],{"type":18,"tag":629,"props":8183,"children":8184},{},[8185],{"type":24,"value":665},{"type":18,"tag":629,"props":8187,"children":8188},{"class":631,"line":794},[8189],{"type":18,"tag":629,"props":8190,"children":8191},{"class":1866},[8192],{"type":24,"value":8193},"## Control\n",{"type":18,"tag":629,"props":8195,"children":8196},{"class":631,"line":820},[8197,8202,8206,8210,8214,8218,8223],{"type":18,"tag":629,"props":8198,"children":8199},{"class":642},[8200],{"type":24,"value":8201},"u1 ",{"type":18,"tag":629,"props":8203,"children":8204},{"class":636},[8205],{"type":24,"value":726},{"type":18,"tag":629,"props":8207,"children":8208},{"class":642},[8209],{"type":24,"value":8060},{"type":18,"tag":629,"props":8211,"children":8212},{"class":686},[8213],{"type":24,"value":8065},{"type":18,"tag":629,"props":8215,"children":8216},{"class":642},[8217],{"type":24,"value":8070},{"type":18,"tag":629,"props":8219,"children":8220},{"class":5364},[8221],{"type":24,"value":8222},"\"u1\"",{"type":18,"tag":629,"props":8224,"children":8225},{"class":642},[8226],{"type":24,"value":1438},{"type":18,"tag":629,"props":8228,"children":8229},{"class":631,"line":846},[8230,8235,8239,8243,8247,8251,8256],{"type":18,"tag":629,"props":8231,"children":8232},{"class":642},[8233],{"type":24,"value":8234},"u2 ",{"type":18,"tag":629,"props":8236,"children":8237},{"class":636},[8238],{"type":24,"value":726},{"type":18,"tag":629,"props":8240,"children":8241},{"class":642},[8242],{"type":24,"value":8060},{"type":18,"tag":629,"props":8244,"children":8245},{"class":686},[8246],{"type":24,"value":8065},{"type":18,"tag":629,"props":8248,"children":8249},{"class":642},[8250],{"type":24,"value":8070},{"type":18,"tag":629,"props":8252,"children":8253},{"class":5364},[8254],{"type":24,"value":8255},"\"u2\"",{"type":18,"tag":629,"props":8257,"children":8258},{"class":642},[8259],{"type":24,"value":1438},{"type":18,"tag":629,"props":8261,"children":8262},{"class":631,"line":854},[8263,8268,8272],{"type":18,"tag":629,"props":8264,"children":8265},{"class":642},[8266],{"type":24,"value":8267},"controls ",{"type":18,"tag":629,"props":8269,"children":8270},{"class":636},[8271],{"type":24,"value":726},{"type":18,"tag":629,"props":8273,"children":8274},{"class":642},[8275],{"type":24,"value":8276}," ca.vertcat(u1, u2)\n",{"type":18,"tag":629,"props":8278,"children":8279},{"class":631,"line":890},[8280,8285,8289],{"type":18,"tag":629,"props":8281,"children":8282},{"class":642},[8283],{"type":24,"value":8284},"num_controls ",{"type":18,"tag":629,"props":8286,"children":8287},{"class":636},[8288],{"type":24,"value":726},{"type":18,"tag":629,"props":8290,"children":8291},{"class":642},[8292],{"type":24,"value":8293}," controls.numel()\n",{"type":18,"tag":629,"props":8295,"children":8296},{"class":631,"line":923},[8297],{"type":18,"tag":629,"props":8298,"children":8299},{},[8300],{"type":24,"value":665},{"type":18,"tag":629,"props":8302,"children":8303},{"class":631,"line":931},[8304],{"type":18,"tag":629,"props":8305,"children":8306},{"class":1866},[8307],{"type":24,"value":8308},"# Define Nonlinear model\n",{"type":18,"tag":629,"props":8310,"children":8311},{"class":631,"line":965},[8312],{"type":18,"tag":629,"props":8313,"children":8314},{"class":1866},[8315],{"type":24,"value":8316},"## Rotation Matrix\n",{"type":18,"tag":629,"props":8318,"children":8319},{"class":631,"line":999},[8320,8325,8329],{"type":18,"tag":629,"props":8321,"children":8322},{"class":642},[8323],{"type":24,"value":8324},"rot_mat ",{"type":18,"tag":629,"props":8326,"children":8327},{"class":636},[8328],{"type":24,"value":726},{"type":18,"tag":629,"props":8330,"children":8331},{"class":642},[8332],{"type":24,"value":8333}," ca.vertcat(\n",{"type":18,"tag":629,"props":8335,"children":8336},{"class":631,"line":1007},[8337,8342,8346],{"type":18,"tag":629,"props":8338,"children":8339},{"class":642},[8340],{"type":24,"value":8341},"    ca.horzcat(ca.cos(theta), ca.sin(theta), ",{"type":18,"tag":629,"props":8343,"children":8344},{"class":686},[8345],{"type":24,"value":882},{"type":18,"tag":629,"props":8347,"children":8348},{"class":642},[8349],{"type":24,"value":8350},"),\n",{"type":18,"tag":629,"props":8352,"children":8353},{"class":631,"line":1033},[8354,8359,8363,8368,8372],{"type":18,"tag":629,"props":8355,"children":8356},{"class":642},[8357],{"type":24,"value":8358},"    ca.horzcat(",{"type":18,"tag":629,"props":8360,"children":8361},{"class":636},[8362],{"type":24,"value":1061},{"type":18,"tag":629,"props":8364,"children":8365},{"class":642},[8366],{"type":24,"value":8367},"ca.sin(theta), ca.cos(theta), ",{"type":18,"tag":629,"props":8369,"children":8370},{"class":686},[8371],{"type":24,"value":882},{"type":18,"tag":629,"props":8373,"children":8374},{"class":642},[8375],{"type":24,"value":8350},{"type":18,"tag":629,"props":8377,"children":8378},{"class":631,"line":1041},[8379,8383,8387,8391,8395,8399,8403],{"type":18,"tag":629,"props":8380,"children":8381},{"class":642},[8382],{"type":24,"value":8358},{"type":18,"tag":629,"props":8384,"children":8385},{"class":686},[8386],{"type":24,"value":882},{"type":18,"tag":629,"props":8388,"children":8389},{"class":642},[8390],{"type":24,"value":2432},{"type":18,"tag":629,"props":8392,"children":8393},{"class":686},[8394],{"type":24,"value":882},{"type":18,"tag":629,"props":8396,"children":8397},{"class":642},[8398],{"type":24,"value":2432},{"type":18,"tag":629,"props":8400,"children":8401},{"class":686},[8402],{"type":24,"value":992},{"type":18,"tag":629,"props":8404,"children":8405},{"class":642},[8406],{"type":24,"value":1438},{"type":18,"tag":629,"props":8408,"children":8409},{"class":631,"line":1083},[8410],{"type":18,"tag":629,"props":8411,"children":8412},{"class":642},[8413],{"type":24,"value":1438},{"type":18,"tag":629,"props":8415,"children":8416},{"class":631,"line":1123},[8417],{"type":18,"tag":629,"props":8418,"children":8419},{},[8420],{"type":24,"value":665},{"type":18,"tag":629,"props":8422,"children":8423},{"class":631,"line":1217},[8424,8429,8433,8438,8442],{"type":18,"tag":629,"props":8425,"children":8426},{"class":642},[8427],{"type":24,"value":8428},"vx ",{"type":18,"tag":629,"props":8430,"children":8431},{"class":636},[8432],{"type":24,"value":726},{"type":18,"tag":629,"props":8434,"children":8435},{"class":642},[8436],{"type":24,"value":8437}," u1 ",{"type":18,"tag":629,"props":8439,"children":8440},{"class":636},[8441],{"type":24,"value":1071},{"type":18,"tag":629,"props":8443,"children":8444},{"class":642},[8445],{"type":24,"value":8446}," ca.cos(theta)\n",{"type":18,"tag":629,"props":8448,"children":8449},{"class":631,"line":1225},[8450,8455,8459,8463,8467],{"type":18,"tag":629,"props":8451,"children":8452},{"class":642},[8453],{"type":24,"value":8454},"vy ",{"type":18,"tag":629,"props":8456,"children":8457},{"class":636},[8458],{"type":24,"value":726},{"type":18,"tag":629,"props":8460,"children":8461},{"class":642},[8462],{"type":24,"value":8437},{"type":18,"tag":629,"props":8464,"children":8465},{"class":636},[8466],{"type":24,"value":1071},{"type":18,"tag":629,"props":8468,"children":8469},{"class":642},[8470],{"type":24,"value":8471}," ca.sin(theta)\n",{"type":18,"tag":629,"props":8473,"children":8474},{"class":631,"line":1243},[8475,8480,8484],{"type":18,"tag":629,"props":8476,"children":8477},{"class":642},[8478],{"type":24,"value":8479},"vyaw ",{"type":18,"tag":629,"props":8481,"children":8482},{"class":636},[8483],{"type":24,"value":726},{"type":18,"tag":629,"props":8485,"children":8486},{"class":642},[8487],{"type":24,"value":8488}," u2\n",{"type":18,"tag":629,"props":8490,"children":8491},{"class":631,"line":1251},[8492],{"type":18,"tag":629,"props":8493,"children":8494},{},[8495],{"type":24,"value":665},{"type":18,"tag":629,"props":8497,"children":8498},{"class":631,"line":1277},[8499,8504,8508],{"type":18,"tag":629,"props":8500,"children":8501},{"class":642},[8502],{"type":24,"value":8503},"rhs ",{"type":18,"tag":629,"props":8505,"children":8506},{"class":636},[8507],{"type":24,"value":726},{"type":18,"tag":629,"props":8509,"children":8510},{"class":642},[8511],{"type":24,"value":8512}," ca.vertcat(vx, vy, vyaw)\n",{"type":18,"tag":629,"props":8514,"children":8515},{"class":631,"line":1285},[8516],{"type":18,"tag":629,"props":8517,"children":8518},{"class":1866},[8519],{"type":24,"value":8520},"## Define mapped nonlinear function f(x,u) -> rhs\n",{"type":18,"tag":629,"props":8522,"children":8523},{"class":631,"line":1441},[8524,8528,8532,8537,8542],{"type":18,"tag":629,"props":8525,"children":8526},{"class":642},[8527],{"type":24,"value":6966},{"type":18,"tag":629,"props":8529,"children":8530},{"class":636},[8531],{"type":24,"value":726},{"type":18,"tag":629,"props":8533,"children":8534},{"class":642},[8535],{"type":24,"value":8536}," ca.Function(",{"type":18,"tag":629,"props":8538,"children":8539},{"class":5364},[8540],{"type":24,"value":8541},"'f'",{"type":18,"tag":629,"props":8543,"children":8544},{"class":642},[8545],{"type":24,"value":8546},", [states, controls], [rhs])",{"type":18,"tag":27,"props":8548,"children":8549},{},[8550],{"type":24,"value":8551},"Declare symbolic matrix",{"type":18,"tag":614,"props":8553,"children":8556},{"className":8554,"code":8555,"language":619,"meta":8},[617],"X = ca.SX.sym('X', num_states, prediction_horizons + 1)\nX_ref = ca.SX.sym('X_ref', num_states, prediction_horizons + 1)\nU = ca.SX.sym('U', num_controls, prediction_horizons)\nU_ref = ca.SX.sym('U_ref', num_controls, prediction_horizons)\n",[8557],{"type":18,"tag":622,"props":8558,"children":8559},{},[8560],{"type":18,"tag":614,"props":8561,"children":8562},{"__ignoreMap":8},[8563,8612,8661,8694],{"type":18,"tag":629,"props":8564,"children":8565},{"class":631,"line":632},[8566,8570,8574,8578,8582,8586,8591,8596,8600,8604,8608],{"type":18,"tag":629,"props":8567,"children":8568},{"class":642},[8569],{"type":24,"value":2636},{"type":18,"tag":629,"props":8571,"children":8572},{"class":636},[8573],{"type":24,"value":726},{"type":18,"tag":629,"props":8575,"children":8576},{"class":642},[8577],{"type":24,"value":8060},{"type":18,"tag":629,"props":8579,"children":8580},{"class":686},[8581],{"type":24,"value":8065},{"type":18,"tag":629,"props":8583,"children":8584},{"class":642},[8585],{"type":24,"value":8070},{"type":18,"tag":629,"props":8587,"children":8588},{"class":5364},[8589],{"type":24,"value":8590},"'X'",{"type":18,"tag":629,"props":8592,"children":8593},{"class":642},[8594],{"type":24,"value":8595},", num_states, prediction_horizons ",{"type":18,"tag":629,"props":8597,"children":8598},{"class":636},[8599],{"type":24,"value":1192},{"type":18,"tag":629,"props":8601,"children":8602},{"class":642},[8603],{"type":24,"value":645},{"type":18,"tag":629,"props":8605,"children":8606},{"class":686},[8607],{"type":24,"value":992},{"type":18,"tag":629,"props":8609,"children":8610},{"class":642},[8611],{"type":24,"value":1438},{"type":18,"tag":629,"props":8613,"children":8614},{"class":631,"line":659},[8615,8620,8624,8628,8632,8636,8641,8645,8649,8653,8657],{"type":18,"tag":629,"props":8616,"children":8617},{"class":642},[8618],{"type":24,"value":8619},"X_ref ",{"type":18,"tag":629,"props":8621,"children":8622},{"class":636},[8623],{"type":24,"value":726},{"type":18,"tag":629,"props":8625,"children":8626},{"class":642},[8627],{"type":24,"value":8060},{"type":18,"tag":629,"props":8629,"children":8630},{"class":686},[8631],{"type":24,"value":8065},{"type":18,"tag":629,"props":8633,"children":8634},{"class":642},[8635],{"type":24,"value":8070},{"type":18,"tag":629,"props":8637,"children":8638},{"class":5364},[8639],{"type":24,"value":8640},"'X_ref'",{"type":18,"tag":629,"props":8642,"children":8643},{"class":642},[8644],{"type":24,"value":8595},{"type":18,"tag":629,"props":8646,"children":8647},{"class":636},[8648],{"type":24,"value":1192},{"type":18,"tag":629,"props":8650,"children":8651},{"class":642},[8652],{"type":24,"value":645},{"type":18,"tag":629,"props":8654,"children":8655},{"class":686},[8656],{"type":24,"value":992},{"type":18,"tag":629,"props":8658,"children":8659},{"class":642},[8660],{"type":24,"value":1438},{"type":18,"tag":629,"props":8662,"children":8663},{"class":631,"line":668},[8664,8668,8672,8676,8680,8684,8689],{"type":18,"tag":629,"props":8665,"children":8666},{"class":642},[8667],{"type":24,"value":2671},{"type":18,"tag":629,"props":8669,"children":8670},{"class":636},[8671],{"type":24,"value":726},{"type":18,"tag":629,"props":8673,"children":8674},{"class":642},[8675],{"type":24,"value":8060},{"type":18,"tag":629,"props":8677,"children":8678},{"class":686},[8679],{"type":24,"value":8065},{"type":18,"tag":629,"props":8681,"children":8682},{"class":642},[8683],{"type":24,"value":8070},{"type":18,"tag":629,"props":8685,"children":8686},{"class":5364},[8687],{"type":24,"value":8688},"'U'",{"type":18,"tag":629,"props":8690,"children":8691},{"class":642},[8692],{"type":24,"value":8693},", num_controls, prediction_horizons)\n",{"type":18,"tag":629,"props":8695,"children":8696},{"class":631,"line":697},[8697,8702,8706,8710,8714,8718,8723],{"type":18,"tag":629,"props":8698,"children":8699},{"class":642},[8700],{"type":24,"value":8701},"U_ref ",{"type":18,"tag":629,"props":8703,"children":8704},{"class":636},[8705],{"type":24,"value":726},{"type":18,"tag":629,"props":8707,"children":8708},{"class":642},[8709],{"type":24,"value":8060},{"type":18,"tag":629,"props":8711,"children":8712},{"class":686},[8713],{"type":24,"value":8065},{"type":18,"tag":629,"props":8715,"children":8716},{"class":642},[8717],{"type":24,"value":8070},{"type":18,"tag":629,"props":8719,"children":8720},{"class":5364},[8721],{"type":24,"value":8722},"'U_ref'",{"type":18,"tag":629,"props":8724,"children":8725},{"class":642},[8726],{"type":24,"value":8727},", num_controls, prediction_horizons)",{"type":18,"tag":27,"props":8729,"children":8730},{},[8731,8733],{"type":24,"value":8732},"Define nonlinear programming and options for ",{"type":18,"tag":4375,"props":8734,"children":8735},{},[8736],{"type":24,"value":7978},{"type":18,"tag":614,"props":8738,"children":8741},{"className":8739,"code":8740,"language":619,"meta":8},[617],"nlp_prob = {\n    'f': cost_fn,\n    'x': opt_var,\n    'p': opt_dec,\n    'g': g\n}\n\nnlp_opts = {\n    'ipopt.max_iter': 5000,\n    'ipopt.print_level': 0,\n    'ipopt.acceptable_tol': 1e-6,\n    'ipopt.acceptable_obj_change_tol': 1e-4,\n    'print_time': 0\n}\n",[8742],{"type":18,"tag":622,"props":8743,"children":8744},{},[8745],{"type":18,"tag":614,"props":8746,"children":8747},{"__ignoreMap":8},[8748,8765,8781,8798,8815,8832,8840,8847,8863,8889,8913,8938,8963,8984],{"type":18,"tag":629,"props":8749,"children":8750},{"class":631,"line":632},[8751,8756,8760],{"type":18,"tag":629,"props":8752,"children":8753},{"class":642},[8754],{"type":24,"value":8755},"nlp_prob ",{"type":18,"tag":629,"props":8757,"children":8758},{"class":636},[8759],{"type":24,"value":726},{"type":18,"tag":629,"props":8761,"children":8762},{"class":642},[8763],{"type":24,"value":8764}," {\n",{"type":18,"tag":629,"props":8766,"children":8767},{"class":631,"line":659},[8768,8772,8776],{"type":18,"tag":629,"props":8769,"children":8770},{"class":642},[8771],{"type":24,"value":674},{"type":18,"tag":629,"props":8773,"children":8774},{"class":5364},[8775],{"type":24,"value":8541},{"type":18,"tag":629,"props":8777,"children":8778},{"class":642},[8779],{"type":24,"value":8780},": cost_fn,\n",{"type":18,"tag":629,"props":8782,"children":8783},{"class":631,"line":668},[8784,8788,8793],{"type":18,"tag":629,"props":8785,"children":8786},{"class":642},[8787],{"type":24,"value":674},{"type":18,"tag":629,"props":8789,"children":8790},{"class":5364},[8791],{"type":24,"value":8792},"'x'",{"type":18,"tag":629,"props":8794,"children":8795},{"class":642},[8796],{"type":24,"value":8797},": opt_var,\n",{"type":18,"tag":629,"props":8799,"children":8800},{"class":631,"line":697},[8801,8805,8810],{"type":18,"tag":629,"props":8802,"children":8803},{"class":642},[8804],{"type":24,"value":674},{"type":18,"tag":629,"props":8806,"children":8807},{"class":5364},[8808],{"type":24,"value":8809},"'p'",{"type":18,"tag":629,"props":8811,"children":8812},{"class":642},[8813],{"type":24,"value":8814},": opt_dec,\n",{"type":18,"tag":629,"props":8816,"children":8817},{"class":631,"line":705},[8818,8822,8827],{"type":18,"tag":629,"props":8819,"children":8820},{"class":642},[8821],{"type":24,"value":674},{"type":18,"tag":629,"props":8823,"children":8824},{"class":5364},[8825],{"type":24,"value":8826},"'g'",{"type":18,"tag":629,"props":8828,"children":8829},{"class":642},[8830],{"type":24,"value":8831},": g\n",{"type":18,"tag":629,"props":8833,"children":8834},{"class":631,"line":734},[8835],{"type":18,"tag":629,"props":8836,"children":8837},{"class":642},[8838],{"type":24,"value":8839},"}\n",{"type":18,"tag":629,"props":8841,"children":8842},{"class":631,"line":760},[8843],{"type":18,"tag":629,"props":8844,"children":8845},{},[8846],{"type":24,"value":665},{"type":18,"tag":629,"props":8848,"children":8849},{"class":631,"line":786},[8850,8855,8859],{"type":18,"tag":629,"props":8851,"children":8852},{"class":642},[8853],{"type":24,"value":8854},"nlp_opts ",{"type":18,"tag":629,"props":8856,"children":8857},{"class":636},[8858],{"type":24,"value":726},{"type":18,"tag":629,"props":8860,"children":8861},{"class":642},[8862],{"type":24,"value":8764},{"type":18,"tag":629,"props":8864,"children":8865},{"class":631,"line":794},[8866,8870,8875,8879,8884],{"type":18,"tag":629,"props":8867,"children":8868},{"class":642},[8869],{"type":24,"value":674},{"type":18,"tag":629,"props":8871,"children":8872},{"class":5364},[8873],{"type":24,"value":8874},"'ipopt.max_iter'",{"type":18,"tag":629,"props":8876,"children":8877},{"class":642},[8878],{"type":24,"value":473},{"type":18,"tag":629,"props":8880,"children":8881},{"class":686},[8882],{"type":24,"value":8883},"5000",{"type":18,"tag":629,"props":8885,"children":8886},{"class":642},[8887],{"type":24,"value":8888},",\n",{"type":18,"tag":629,"props":8890,"children":8891},{"class":631,"line":820},[8892,8896,8901,8905,8909],{"type":18,"tag":629,"props":8893,"children":8894},{"class":642},[8895],{"type":24,"value":674},{"type":18,"tag":629,"props":8897,"children":8898},{"class":5364},[8899],{"type":24,"value":8900},"'ipopt.print_level'",{"type":18,"tag":629,"props":8902,"children":8903},{"class":642},[8904],{"type":24,"value":473},{"type":18,"tag":629,"props":8906,"children":8907},{"class":686},[8908],{"type":24,"value":882},{"type":18,"tag":629,"props":8910,"children":8911},{"class":642},[8912],{"type":24,"value":8888},{"type":18,"tag":629,"props":8914,"children":8915},{"class":631,"line":846},[8916,8920,8925,8929,8934],{"type":18,"tag":629,"props":8917,"children":8918},{"class":642},[8919],{"type":24,"value":674},{"type":18,"tag":629,"props":8921,"children":8922},{"class":5364},[8923],{"type":24,"value":8924},"'ipopt.acceptable_tol'",{"type":18,"tag":629,"props":8926,"children":8927},{"class":642},[8928],{"type":24,"value":473},{"type":18,"tag":629,"props":8930,"children":8931},{"class":686},[8932],{"type":24,"value":8933},"1e-6",{"type":18,"tag":629,"props":8935,"children":8936},{"class":642},[8937],{"type":24,"value":8888},{"type":18,"tag":629,"props":8939,"children":8940},{"class":631,"line":854},[8941,8945,8950,8954,8959],{"type":18,"tag":629,"props":8942,"children":8943},{"class":642},[8944],{"type":24,"value":674},{"type":18,"tag":629,"props":8946,"children":8947},{"class":5364},[8948],{"type":24,"value":8949},"'ipopt.acceptable_obj_change_tol'",{"type":18,"tag":629,"props":8951,"children":8952},{"class":642},[8953],{"type":24,"value":473},{"type":18,"tag":629,"props":8955,"children":8956},{"class":686},[8957],{"type":24,"value":8958},"1e-4",{"type":18,"tag":629,"props":8960,"children":8961},{"class":642},[8962],{"type":24,"value":8888},{"type":18,"tag":629,"props":8964,"children":8965},{"class":631,"line":890},[8966,8970,8975,8979],{"type":18,"tag":629,"props":8967,"children":8968},{"class":642},[8969],{"type":24,"value":674},{"type":18,"tag":629,"props":8971,"children":8972},{"class":5364},[8973],{"type":24,"value":8974},"'print_time'",{"type":18,"tag":629,"props":8976,"children":8977},{"class":642},[8978],{"type":24,"value":473},{"type":18,"tag":629,"props":8980,"children":8981},{"class":686},[8982],{"type":24,"value":8983},"0\n",{"type":18,"tag":629,"props":8985,"children":8986},{"class":631,"line":923},[8987],{"type":18,"tag":629,"props":8988,"children":8989},{"class":642},[8990],{"type":24,"value":8991},"}",{"type":18,"tag":27,"props":8993,"children":8994},{},[8995],{"type":24,"value":8996},"Determine boundary and constraint for our optimizer",{"type":18,"tag":614,"props":8998,"children":9001},{"className":8999,"code":9000,"language":619,"meta":8},[617],"lbx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\nubx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\n\nlbx[0: num_states * (prediction_horizons + 1): num_states] = x_min\nlbx[1: num_states * (prediction_horizons + 1): num_states] = y_min\nlbx[2: num_states * (prediction_horizons + 1): num_states] = theta_min\n\nubx[0: num_states * (prediction_horizons + 1): num_states] = x_max\nubx[1: num_states * (prediction_horizons + 1): num_states] = y_max\nubx[2: num_states * (prediction_horizons + 1): num_states] = theta_max\n\nlbx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\nlbx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\n\nubx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\nubx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\n\nargs = {\n    'lbg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'ubg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'lbx': lbx,\n    'ubx': ubx\n}\n",[9002],{"type":18,"tag":622,"props":9003,"children":9004},{},[9005],{"type":18,"tag":614,"props":9006,"children":9007},{"__ignoreMap":8},[9008,9085,9157,9164,9215,9263,9311,9318,9367,9415,9463,9470,9553,9648,9655,9736,9831,9838,9854,9913,9969,9986,10003],{"type":18,"tag":629,"props":9009,"children":9010},{"class":631,"line":632},[9011,9016,9020,9024,9029,9034,9038,9043,9047,9051,9055,9059,9063,9068,9072,9077,9081],{"type":18,"tag":629,"props":9012,"children":9013},{"class":642},[9014],{"type":24,"value":9015},"lbx ",{"type":18,"tag":629,"props":9017,"children":9018},{"class":636},[9019],{"type":24,"value":726},{"type":18,"tag":629,"props":9021,"children":9022},{"class":642},[9023],{"type":24,"value":8060},{"type":18,"tag":629,"props":9025,"children":9026},{"class":686},[9027],{"type":24,"value":9028},"DM",{"type":18,"tag":629,"props":9030,"children":9031},{"class":642},[9032],{"type":24,"value":9033},".zeros((num_states ",{"type":18,"tag":629,"props":9035,"children":9036},{"class":636},[9037],{"type":24,"value":1071},{"type":18,"tag":629,"props":9039,"children":9040},{"class":642},[9041],{"type":24,"value":9042}," (prediction_horizons ",{"type":18,"tag":629,"props":9044,"children":9045},{"class":636},[9046],{"type":24,"value":1192},{"type":18,"tag":629,"props":9048,"children":9049},{"class":642},[9050],{"type":24,"value":645},{"type":18,"tag":629,"props":9052,"children":9053},{"class":686},[9054],{"type":24,"value":992},{"type":18,"tag":629,"props":9056,"children":9057},{"class":642},[9058],{"type":24,"value":5372},{"type":18,"tag":629,"props":9060,"children":9061},{"class":636},[9062],{"type":24,"value":1192},{"type":18,"tag":629,"props":9064,"children":9065},{"class":642},[9066],{"type":24,"value":9067}," num_controls ",{"type":18,"tag":629,"props":9069,"children":9070},{"class":636},[9071],{"type":24,"value":1071},{"type":18,"tag":629,"props":9073,"children":9074},{"class":642},[9075],{"type":24,"value":9076}," prediction_horizons, ",{"type":18,"tag":629,"props":9078,"children":9079},{"class":686},[9080],{"type":24,"value":992},{"type":18,"tag":629,"props":9082,"children":9083},{"class":642},[9084],{"type":24,"value":5149},{"type":18,"tag":629,"props":9086,"children":9087},{"class":631,"line":659},[9088,9093,9097,9101,9105,9109,9113,9117,9121,9125,9129,9133,9137,9141,9145,9149,9153],{"type":18,"tag":629,"props":9089,"children":9090},{"class":642},[9091],{"type":24,"value":9092},"ubx ",{"type":18,"tag":629,"props":9094,"children":9095},{"class":636},[9096],{"type":24,"value":726},{"type":18,"tag":629,"props":9098,"children":9099},{"class":642},[9100],{"type":24,"value":8060},{"type":18,"tag":629,"props":9102,"children":9103},{"class":686},[9104],{"type":24,"value":9028},{"type":18,"tag":629,"props":9106,"children":9107},{"class":642},[9108],{"type":24,"value":9033},{"type":18,"tag":629,"props":9110,"children":9111},{"class":636},[9112],{"type":24,"value":1071},{"type":18,"tag":629,"props":9114,"children":9115},{"class":642},[9116],{"type":24,"value":9042},{"type":18,"tag":629,"props":9118,"children":9119},{"class":636},[9120],{"type":24,"value":1192},{"type":18,"tag":629,"props":9122,"children":9123},{"class":642},[9124],{"type":24,"value":645},{"type":18,"tag":629,"props":9126,"children":9127},{"class":686},[9128],{"type":24,"value":992},{"type":18,"tag":629,"props":9130,"children":9131},{"class":642},[9132],{"type":24,"value":5372},{"type":18,"tag":629,"props":9134,"children":9135},{"class":636},[9136],{"type":24,"value":1192},{"type":18,"tag":629,"props":9138,"children":9139},{"class":642},[9140],{"type":24,"value":9067},{"type":18,"tag":629,"props":9142,"children":9143},{"class":636},[9144],{"type":24,"value":1071},{"type":18,"tag":629,"props":9146,"children":9147},{"class":642},[9148],{"type":24,"value":9076},{"type":18,"tag":629,"props":9150,"children":9151},{"class":686},[9152],{"type":24,"value":992},{"type":18,"tag":629,"props":9154,"children":9155},{"class":642},[9156],{"type":24,"value":5149},{"type":18,"tag":629,"props":9158,"children":9159},{"class":631,"line":668},[9160],{"type":18,"tag":629,"props":9161,"children":9162},{},[9163],{"type":24,"value":665},{"type":18,"tag":629,"props":9165,"children":9166},{"class":631,"line":697},[9167,9172,9176,9181,9185,9189,9193,9197,9201,9206,9210],{"type":18,"tag":629,"props":9168,"children":9169},{"class":642},[9170],{"type":24,"value":9171},"lbx[",{"type":18,"tag":629,"props":9173,"children":9174},{"class":686},[9175],{"type":24,"value":882},{"type":18,"tag":629,"props":9177,"children":9178},{"class":642},[9179],{"type":24,"value":9180},": num_states ",{"type":18,"tag":629,"props":9182,"children":9183},{"class":636},[9184],{"type":24,"value":1071},{"type":18,"tag":629,"props":9186,"children":9187},{"class":642},[9188],{"type":24,"value":9042},{"type":18,"tag":629,"props":9190,"children":9191},{"class":636},[9192],{"type":24,"value":1192},{"type":18,"tag":629,"props":9194,"children":9195},{"class":642},[9196],{"type":24,"value":645},{"type":18,"tag":629,"props":9198,"children":9199},{"class":686},[9200],{"type":24,"value":992},{"type":18,"tag":629,"props":9202,"children":9203},{"class":642},[9204],{"type":24,"value":9205},"): num_states] ",{"type":18,"tag":629,"props":9207,"children":9208},{"class":636},[9209],{"type":24,"value":726},{"type":18,"tag":629,"props":9211,"children":9212},{"class":642},[9213],{"type":24,"value":9214}," x_min\n",{"type":18,"tag":629,"props":9216,"children":9217},{"class":631,"line":705},[9218,9222,9226,9230,9234,9238,9242,9246,9250,9254,9258],{"type":18,"tag":629,"props":9219,"children":9220},{"class":642},[9221],{"type":24,"value":9171},{"type":18,"tag":629,"props":9223,"children":9224},{"class":686},[9225],{"type":24,"value":992},{"type":18,"tag":629,"props":9227,"children":9228},{"class":642},[9229],{"type":24,"value":9180},{"type":18,"tag":629,"props":9231,"children":9232},{"class":636},[9233],{"type":24,"value":1071},{"type":18,"tag":629,"props":9235,"children":9236},{"class":642},[9237],{"type":24,"value":9042},{"type":18,"tag":629,"props":9239,"children":9240},{"class":636},[9241],{"type":24,"value":1192},{"type":18,"tag":629,"props":9243,"children":9244},{"class":642},[9245],{"type":24,"value":645},{"type":18,"tag":629,"props":9247,"children":9248},{"class":686},[9249],{"type":24,"value":992},{"type":18,"tag":629,"props":9251,"children":9252},{"class":642},[9253],{"type":24,"value":9205},{"type":18,"tag":629,"props":9255,"children":9256},{"class":636},[9257],{"type":24,"value":726},{"type":18,"tag":629,"props":9259,"children":9260},{"class":642},[9261],{"type":24,"value":9262}," y_min\n",{"type":18,"tag":629,"props":9264,"children":9265},{"class":631,"line":734},[9266,9270,9274,9278,9282,9286,9290,9294,9298,9302,9306],{"type":18,"tag":629,"props":9267,"children":9268},{"class":642},[9269],{"type":24,"value":9171},{"type":18,"tag":629,"props":9271,"children":9272},{"class":686},[9273],{"type":24,"value":1368},{"type":18,"tag":629,"props":9275,"children":9276},{"class":642},[9277],{"type":24,"value":9180},{"type":18,"tag":629,"props":9279,"children":9280},{"class":636},[9281],{"type":24,"value":1071},{"type":18,"tag":629,"props":9283,"children":9284},{"class":642},[9285],{"type":24,"value":9042},{"type":18,"tag":629,"props":9287,"children":9288},{"class":636},[9289],{"type":24,"value":1192},{"type":18,"tag":629,"props":9291,"children":9292},{"class":642},[9293],{"type":24,"value":645},{"type":18,"tag":629,"props":9295,"children":9296},{"class":686},[9297],{"type":24,"value":992},{"type":18,"tag":629,"props":9299,"children":9300},{"class":642},[9301],{"type":24,"value":9205},{"type":18,"tag":629,"props":9303,"children":9304},{"class":636},[9305],{"type":24,"value":726},{"type":18,"tag":629,"props":9307,"children":9308},{"class":642},[9309],{"type":24,"value":9310}," theta_min\n",{"type":18,"tag":629,"props":9312,"children":9313},{"class":631,"line":760},[9314],{"type":18,"tag":629,"props":9315,"children":9316},{},[9317],{"type":24,"value":665},{"type":18,"tag":629,"props":9319,"children":9320},{"class":631,"line":786},[9321,9326,9330,9334,9338,9342,9346,9350,9354,9358,9362],{"type":18,"tag":629,"props":9322,"children":9323},{"class":642},[9324],{"type":24,"value":9325},"ubx[",{"type":18,"tag":629,"props":9327,"children":9328},{"class":686},[9329],{"type":24,"value":882},{"type":18,"tag":629,"props":9331,"children":9332},{"class":642},[9333],{"type":24,"value":9180},{"type":18,"tag":629,"props":9335,"children":9336},{"class":636},[9337],{"type":24,"value":1071},{"type":18,"tag":629,"props":9339,"children":9340},{"class":642},[9341],{"type":24,"value":9042},{"type":18,"tag":629,"props":9343,"children":9344},{"class":636},[9345],{"type":24,"value":1192},{"type":18,"tag":629,"props":9347,"children":9348},{"class":642},[9349],{"type":24,"value":645},{"type":18,"tag":629,"props":9351,"children":9352},{"class":686},[9353],{"type":24,"value":992},{"type":18,"tag":629,"props":9355,"children":9356},{"class":642},[9357],{"type":24,"value":9205},{"type":18,"tag":629,"props":9359,"children":9360},{"class":636},[9361],{"type":24,"value":726},{"type":18,"tag":629,"props":9363,"children":9364},{"class":642},[9365],{"type":24,"value":9366}," x_max\n",{"type":18,"tag":629,"props":9368,"children":9369},{"class":631,"line":794},[9370,9374,9378,9382,9386,9390,9394,9398,9402,9406,9410],{"type":18,"tag":629,"props":9371,"children":9372},{"class":642},[9373],{"type":24,"value":9325},{"type":18,"tag":629,"props":9375,"children":9376},{"class":686},[9377],{"type":24,"value":992},{"type":18,"tag":629,"props":9379,"children":9380},{"class":642},[9381],{"type":24,"value":9180},{"type":18,"tag":629,"props":9383,"children":9384},{"class":636},[9385],{"type":24,"value":1071},{"type":18,"tag":629,"props":9387,"children":9388},{"class":642},[9389],{"type":24,"value":9042},{"type":18,"tag":629,"props":9391,"children":9392},{"class":636},[9393],{"type":24,"value":1192},{"type":18,"tag":629,"props":9395,"children":9396},{"class":642},[9397],{"type":24,"value":645},{"type":18,"tag":629,"props":9399,"children":9400},{"class":686},[9401],{"type":24,"value":992},{"type":18,"tag":629,"props":9403,"children":9404},{"class":642},[9405],{"type":24,"value":9205},{"type":18,"tag":629,"props":9407,"children":9408},{"class":636},[9409],{"type":24,"value":726},{"type":18,"tag":629,"props":9411,"children":9412},{"class":642},[9413],{"type":24,"value":9414}," y_max\n",{"type":18,"tag":629,"props":9416,"children":9417},{"class":631,"line":820},[9418,9422,9426,9430,9434,9438,9442,9446,9450,9454,9458],{"type":18,"tag":629,"props":9419,"children":9420},{"class":642},[9421],{"type":24,"value":9325},{"type":18,"tag":629,"props":9423,"children":9424},{"class":686},[9425],{"type":24,"value":1368},{"type":18,"tag":629,"props":9427,"children":9428},{"class":642},[9429],{"type":24,"value":9180},{"type":18,"tag":629,"props":9431,"children":9432},{"class":636},[9433],{"type":24,"value":1071},{"type":18,"tag":629,"props":9435,"children":9436},{"class":642},[9437],{"type":24,"value":9042},{"type":18,"tag":629,"props":9439,"children":9440},{"class":636},[9441],{"type":24,"value":1192},{"type":18,"tag":629,"props":9443,"children":9444},{"class":642},[9445],{"type":24,"value":645},{"type":18,"tag":629,"props":9447,"children":9448},{"class":686},[9449],{"type":24,"value":992},{"type":18,"tag":629,"props":9451,"children":9452},{"class":642},[9453],{"type":24,"value":9205},{"type":18,"tag":629,"props":9455,"children":9456},{"class":636},[9457],{"type":24,"value":726},{"type":18,"tag":629,"props":9459,"children":9460},{"class":642},[9461],{"type":24,"value":9462}," theta_max\n",{"type":18,"tag":629,"props":9464,"children":9465},{"class":631,"line":846},[9466],{"type":18,"tag":629,"props":9467,"children":9468},{},[9469],{"type":24,"value":665},{"type":18,"tag":629,"props":9471,"children":9472},{"class":631,"line":854},[9473,9478,9482,9486,9490,9494,9498,9503,9507,9511,9515,9519,9523,9527,9531,9535,9539,9544,9548],{"type":18,"tag":629,"props":9474,"children":9475},{"class":642},[9476],{"type":24,"value":9477},"lbx[num_states ",{"type":18,"tag":629,"props":9479,"children":9480},{"class":636},[9481],{"type":24,"value":1071},{"type":18,"tag":629,"props":9483,"children":9484},{"class":642},[9485],{"type":24,"value":9042},{"type":18,"tag":629,"props":9487,"children":9488},{"class":636},[9489],{"type":24,"value":1192},{"type":18,"tag":629,"props":9491,"children":9492},{"class":642},[9493],{"type":24,"value":645},{"type":18,"tag":629,"props":9495,"children":9496},{"class":686},[9497],{"type":24,"value":992},{"type":18,"tag":629,"props":9499,"children":9500},{"class":642},[9501],{"type":24,"value":9502},"): num_states ",{"type":18,"tag":629,"props":9504,"children":9505},{"class":636},[9506],{"type":24,"value":1071},{"type":18,"tag":629,"props":9508,"children":9509},{"class":642},[9510],{"type":24,"value":9042},{"type":18,"tag":629,"props":9512,"children":9513},{"class":636},[9514],{"type":24,"value":1192},{"type":18,"tag":629,"props":9516,"children":9517},{"class":642},[9518],{"type":24,"value":645},{"type":18,"tag":629,"props":9520,"children":9521},{"class":686},[9522],{"type":24,"value":992},{"type":18,"tag":629,"props":9524,"children":9525},{"class":642},[9526],{"type":24,"value":5372},{"type":18,"tag":629,"props":9528,"children":9529},{"class":636},[9530],{"type":24,"value":1192},{"type":18,"tag":629,"props":9532,"children":9533},{"class":642},[9534],{"type":24,"value":9067},{"type":18,"tag":629,"props":9536,"children":9537},{"class":636},[9538],{"type":24,"value":1071},{"type":18,"tag":629,"props":9540,"children":9541},{"class":642},[9542],{"type":24,"value":9543}," prediction_horizons: num_controls] ",{"type":18,"tag":629,"props":9545,"children":9546},{"class":636},[9547],{"type":24,"value":726},{"type":18,"tag":629,"props":9549,"children":9550},{"class":642},[9551],{"type":24,"value":9552}," u_min\n",{"type":18,"tag":629,"props":9554,"children":9555},{"class":631,"line":890},[9556,9560,9564,9568,9572,9576,9580,9584,9588,9592,9596,9600,9604,9608,9612,9616,9620,9624,9628,9632,9636,9640,9644],{"type":18,"tag":629,"props":9557,"children":9558},{"class":642},[9559],{"type":24,"value":9477},{"type":18,"tag":629,"props":9561,"children":9562},{"class":636},[9563],{"type":24,"value":1071},{"type":18,"tag":629,"props":9565,"children":9566},{"class":642},[9567],{"type":24,"value":9042},{"type":18,"tag":629,"props":9569,"children":9570},{"class":636},[9571],{"type":24,"value":1192},{"type":18,"tag":629,"props":9573,"children":9574},{"class":642},[9575],{"type":24,"value":645},{"type":18,"tag":629,"props":9577,"children":9578},{"class":686},[9579],{"type":24,"value":992},{"type":18,"tag":629,"props":9581,"children":9582},{"class":642},[9583],{"type":24,"value":5372},{"type":18,"tag":629,"props":9585,"children":9586},{"class":636},[9587],{"type":24,"value":1192},{"type":18,"tag":629,"props":9589,"children":9590},{"class":642},[9591],{"type":24,"value":645},{"type":18,"tag":629,"props":9593,"children":9594},{"class":686},[9595],{"type":24,"value":992},{"type":18,"tag":629,"props":9597,"children":9598},{"class":642},[9599],{"type":24,"value":9180},{"type":18,"tag":629,"props":9601,"children":9602},{"class":636},[9603],{"type":24,"value":1071},{"type":18,"tag":629,"props":9605,"children":9606},{"class":642},[9607],{"type":24,"value":9042},{"type":18,"tag":629,"props":9609,"children":9610},{"class":636},[9611],{"type":24,"value":1192},{"type":18,"tag":629,"props":9613,"children":9614},{"class":642},[9615],{"type":24,"value":645},{"type":18,"tag":629,"props":9617,"children":9618},{"class":686},[9619],{"type":24,"value":992},{"type":18,"tag":629,"props":9621,"children":9622},{"class":642},[9623],{"type":24,"value":5372},{"type":18,"tag":629,"props":9625,"children":9626},{"class":636},[9627],{"type":24,"value":1192},{"type":18,"tag":629,"props":9629,"children":9630},{"class":642},[9631],{"type":24,"value":9067},{"type":18,"tag":629,"props":9633,"children":9634},{"class":636},[9635],{"type":24,"value":1071},{"type":18,"tag":629,"props":9637,"children":9638},{"class":642},[9639],{"type":24,"value":9543},{"type":18,"tag":629,"props":9641,"children":9642},{"class":636},[9643],{"type":24,"value":726},{"type":18,"tag":629,"props":9645,"children":9646},{"class":642},[9647],{"type":24,"value":9552},{"type":18,"tag":629,"props":9649,"children":9650},{"class":631,"line":923},[9651],{"type":18,"tag":629,"props":9652,"children":9653},{},[9654],{"type":24,"value":665},{"type":18,"tag":629,"props":9656,"children":9657},{"class":631,"line":931},[9658,9663,9667,9671,9675,9679,9683,9687,9691,9695,9699,9703,9707,9711,9715,9719,9723,9727,9731],{"type":18,"tag":629,"props":9659,"children":9660},{"class":642},[9661],{"type":24,"value":9662},"ubx[num_states ",{"type":18,"tag":629,"props":9664,"children":9665},{"class":636},[9666],{"type":24,"value":1071},{"type":18,"tag":629,"props":9668,"children":9669},{"class":642},[9670],{"type":24,"value":9042},{"type":18,"tag":629,"props":9672,"children":9673},{"class":636},[9674],{"type":24,"value":1192},{"type":18,"tag":629,"props":9676,"children":9677},{"class":642},[9678],{"type":24,"value":645},{"type":18,"tag":629,"props":9680,"children":9681},{"class":686},[9682],{"type":24,"value":992},{"type":18,"tag":629,"props":9684,"children":9685},{"class":642},[9686],{"type":24,"value":9502},{"type":18,"tag":629,"props":9688,"children":9689},{"class":636},[9690],{"type":24,"value":1071},{"type":18,"tag":629,"props":9692,"children":9693},{"class":642},[9694],{"type":24,"value":9042},{"type":18,"tag":629,"props":9696,"children":9697},{"class":636},[9698],{"type":24,"value":1192},{"type":18,"tag":629,"props":9700,"children":9701},{"class":642},[9702],{"type":24,"value":645},{"type":18,"tag":629,"props":9704,"children":9705},{"class":686},[9706],{"type":24,"value":992},{"type":18,"tag":629,"props":9708,"children":9709},{"class":642},[9710],{"type":24,"value":5372},{"type":18,"tag":629,"props":9712,"children":9713},{"class":636},[9714],{"type":24,"value":1192},{"type":18,"tag":629,"props":9716,"children":9717},{"class":642},[9718],{"type":24,"value":9067},{"type":18,"tag":629,"props":9720,"children":9721},{"class":636},[9722],{"type":24,"value":1071},{"type":18,"tag":629,"props":9724,"children":9725},{"class":642},[9726],{"type":24,"value":9543},{"type":18,"tag":629,"props":9728,"children":9729},{"class":636},[9730],{"type":24,"value":726},{"type":18,"tag":629,"props":9732,"children":9733},{"class":642},[9734],{"type":24,"value":9735}," u_max\n",{"type":18,"tag":629,"props":9737,"children":9738},{"class":631,"line":965},[9739,9743,9747,9751,9755,9759,9763,9767,9771,9775,9779,9783,9787,9791,9795,9799,9803,9807,9811,9815,9819,9823,9827],{"type":18,"tag":629,"props":9740,"children":9741},{"class":642},[9742],{"type":24,"value":9662},{"type":18,"tag":629,"props":9744,"children":9745},{"class":636},[9746],{"type":24,"value":1071},{"type":18,"tag":629,"props":9748,"children":9749},{"class":642},[9750],{"type":24,"value":9042},{"type":18,"tag":629,"props":9752,"children":9753},{"class":636},[9754],{"type":24,"value":1192},{"type":18,"tag":629,"props":9756,"children":9757},{"class":642},[9758],{"type":24,"value":645},{"type":18,"tag":629,"props":9760,"children":9761},{"class":686},[9762],{"type":24,"value":992},{"type":18,"tag":629,"props":9764,"children":9765},{"class":642},[9766],{"type":24,"value":5372},{"type":18,"tag":629,"props":9768,"children":9769},{"class":636},[9770],{"type":24,"value":1192},{"type":18,"tag":629,"props":9772,"children":9773},{"class":642},[9774],{"type":24,"value":645},{"type":18,"tag":629,"props":9776,"children":9777},{"class":686},[9778],{"type":24,"value":992},{"type":18,"tag":629,"props":9780,"children":9781},{"class":642},[9782],{"type":24,"value":9180},{"type":18,"tag":629,"props":9784,"children":9785},{"class":636},[9786],{"type":24,"value":1071},{"type":18,"tag":629,"props":9788,"children":9789},{"class":642},[9790],{"type":24,"value":9042},{"type":18,"tag":629,"props":9792,"children":9793},{"class":636},[9794],{"type":24,"value":1192},{"type":18,"tag":629,"props":9796,"children":9797},{"class":642},[9798],{"type":24,"value":645},{"type":18,"tag":629,"props":9800,"children":9801},{"class":686},[9802],{"type":24,"value":992},{"type":18,"tag":629,"props":9804,"children":9805},{"class":642},[9806],{"type":24,"value":5372},{"type":18,"tag":629,"props":9808,"children":9809},{"class":636},[9810],{"type":24,"value":1192},{"type":18,"tag":629,"props":9812,"children":9813},{"class":642},[9814],{"type":24,"value":9067},{"type":18,"tag":629,"props":9816,"children":9817},{"class":636},[9818],{"type":24,"value":1071},{"type":18,"tag":629,"props":9820,"children":9821},{"class":642},[9822],{"type":24,"value":9543},{"type":18,"tag":629,"props":9824,"children":9825},{"class":636},[9826],{"type":24,"value":726},{"type":18,"tag":629,"props":9828,"children":9829},{"class":642},[9830],{"type":24,"value":9735},{"type":18,"tag":629,"props":9832,"children":9833},{"class":631,"line":999},[9834],{"type":18,"tag":629,"props":9835,"children":9836},{},[9837],{"type":24,"value":665},{"type":18,"tag":629,"props":9839,"children":9840},{"class":631,"line":1007},[9841,9846,9850],{"type":18,"tag":629,"props":9842,"children":9843},{"class":642},[9844],{"type":24,"value":9845},"args ",{"type":18,"tag":629,"props":9847,"children":9848},{"class":636},[9849],{"type":24,"value":726},{"type":18,"tag":629,"props":9851,"children":9852},{"class":642},[9853],{"type":24,"value":8764},{"type":18,"tag":629,"props":9855,"children":9856},{"class":631,"line":1033},[9857,9861,9866,9871,9875,9879,9883,9887,9891,9895,9899,9904,9908],{"type":18,"tag":629,"props":9858,"children":9859},{"class":642},[9860],{"type":24,"value":674},{"type":18,"tag":629,"props":9862,"children":9863},{"class":5364},[9864],{"type":24,"value":9865},"'lbg'",{"type":18,"tag":629,"props":9867,"children":9868},{"class":642},[9869],{"type":24,"value":9870},": ca.",{"type":18,"tag":629,"props":9872,"children":9873},{"class":686},[9874],{"type":24,"value":9028},{"type":18,"tag":629,"props":9876,"children":9877},{"class":642},[9878],{"type":24,"value":9033},{"type":18,"tag":629,"props":9880,"children":9881},{"class":636},[9882],{"type":24,"value":1071},{"type":18,"tag":629,"props":9884,"children":9885},{"class":642},[9886],{"type":24,"value":9042},{"type":18,"tag":629,"props":9888,"children":9889},{"class":636},[9890],{"type":24,"value":1192},{"type":18,"tag":629,"props":9892,"children":9893},{"class":642},[9894],{"type":24,"value":645},{"type":18,"tag":629,"props":9896,"children":9897},{"class":686},[9898],{"type":24,"value":992},{"type":18,"tag":629,"props":9900,"children":9901},{"class":642},[9902],{"type":24,"value":9903},"), ",{"type":18,"tag":629,"props":9905,"children":9906},{"class":686},[9907],{"type":24,"value":992},{"type":18,"tag":629,"props":9909,"children":9910},{"class":642},[9911],{"type":24,"value":9912},")),\n",{"type":18,"tag":629,"props":9914,"children":9915},{"class":631,"line":1041},[9916,9920,9925,9929,9933,9937,9941,9945,9949,9953,9957,9961,9965],{"type":18,"tag":629,"props":9917,"children":9918},{"class":642},[9919],{"type":24,"value":674},{"type":18,"tag":629,"props":9921,"children":9922},{"class":5364},[9923],{"type":24,"value":9924},"'ubg'",{"type":18,"tag":629,"props":9926,"children":9927},{"class":642},[9928],{"type":24,"value":9870},{"type":18,"tag":629,"props":9930,"children":9931},{"class":686},[9932],{"type":24,"value":9028},{"type":18,"tag":629,"props":9934,"children":9935},{"class":642},[9936],{"type":24,"value":9033},{"type":18,"tag":629,"props":9938,"children":9939},{"class":636},[9940],{"type":24,"value":1071},{"type":18,"tag":629,"props":9942,"children":9943},{"class":642},[9944],{"type":24,"value":9042},{"type":18,"tag":629,"props":9946,"children":9947},{"class":636},[9948],{"type":24,"value":1192},{"type":18,"tag":629,"props":9950,"children":9951},{"class":642},[9952],{"type":24,"value":645},{"type":18,"tag":629,"props":9954,"children":9955},{"class":686},[9956],{"type":24,"value":992},{"type":18,"tag":629,"props":9958,"children":9959},{"class":642},[9960],{"type":24,"value":9903},{"type":18,"tag":629,"props":9962,"children":9963},{"class":686},[9964],{"type":24,"value":992},{"type":18,"tag":629,"props":9966,"children":9967},{"class":642},[9968],{"type":24,"value":9912},{"type":18,"tag":629,"props":9970,"children":9971},{"class":631,"line":1083},[9972,9976,9981],{"type":18,"tag":629,"props":9973,"children":9974},{"class":642},[9975],{"type":24,"value":674},{"type":18,"tag":629,"props":9977,"children":9978},{"class":5364},[9979],{"type":24,"value":9980},"'lbx'",{"type":18,"tag":629,"props":9982,"children":9983},{"class":642},[9984],{"type":24,"value":9985},": lbx,\n",{"type":18,"tag":629,"props":9987,"children":9988},{"class":631,"line":1123},[9989,9993,9998],{"type":18,"tag":629,"props":9990,"children":9991},{"class":642},[9992],{"type":24,"value":674},{"type":18,"tag":629,"props":9994,"children":9995},{"class":5364},[9996],{"type":24,"value":9997},"'ubx'",{"type":18,"tag":629,"props":9999,"children":10000},{"class":642},[10001],{"type":24,"value":10002},": ubx\n",{"type":18,"tag":629,"props":10004,"children":10005},{"class":631,"line":1217},[10006],{"type":18,"tag":629,"props":10007,"children":10008},{"class":642},[10009],{"type":24,"value":8991},{"type":18,"tag":27,"props":10011,"children":10012},{},[10013],{"type":24,"value":10014},"Obtain the solution from the solver at each iteration",{"type":18,"tag":614,"props":10016,"children":10019},{"className":10017,"code":10018,"language":619,"meta":8},[617],"sol = solver(\n            x0=args['x0'],\n            p=args['p'],\n            lbx=args['lbx'],\n            ubx=args['ubx'],\n            lbg=args['lbg'],\n            ubg=args['ubg'],\n        )\n\n        sol_x = ca.reshape(sol['x'][:num_states * (prediction_horizons + 1)], 3, prediction_horizons + 1)\n        sol_u = ca.reshape(sol['x'][num_states * (prediction_horizons + 1):], 2, prediction_horizons)\n",[10020],{"type":18,"tag":622,"props":10021,"children":10022},{},[10023],{"type":18,"tag":614,"props":10024,"children":10025},{"__ignoreMap":8},[10026,10043,10074,10101,10129,10157,10185,10213,10221,10228,10304],{"type":18,"tag":629,"props":10027,"children":10028},{"class":631,"line":632},[10029,10034,10038],{"type":18,"tag":629,"props":10030,"children":10031},{"class":642},[10032],{"type":24,"value":10033},"sol ",{"type":18,"tag":629,"props":10035,"children":10036},{"class":636},[10037],{"type":24,"value":726},{"type":18,"tag":629,"props":10039,"children":10040},{"class":642},[10041],{"type":24,"value":10042}," solver(\n",{"type":18,"tag":629,"props":10044,"children":10045},{"class":631,"line":659},[10046,10051,10056,10060,10065,10070],{"type":18,"tag":629,"props":10047,"children":10048},{"class":642},[10049],{"type":24,"value":10050},"            ",{"type":18,"tag":629,"props":10052,"children":10053},{"class":5354},[10054],{"type":24,"value":10055},"x0",{"type":18,"tag":629,"props":10057,"children":10058},{"class":636},[10059],{"type":24,"value":726},{"type":18,"tag":629,"props":10061,"children":10062},{"class":642},[10063],{"type":24,"value":10064},"args[",{"type":18,"tag":629,"props":10066,"children":10067},{"class":5364},[10068],{"type":24,"value":10069},"'x0'",{"type":18,"tag":629,"props":10071,"children":10072},{"class":642},[10073],{"type":24,"value":3236},{"type":18,"tag":629,"props":10075,"children":10076},{"class":631,"line":668},[10077,10081,10085,10089,10093,10097],{"type":18,"tag":629,"props":10078,"children":10079},{"class":642},[10080],{"type":24,"value":10050},{"type":18,"tag":629,"props":10082,"children":10083},{"class":5354},[10084],{"type":24,"value":27},{"type":18,"tag":629,"props":10086,"children":10087},{"class":636},[10088],{"type":24,"value":726},{"type":18,"tag":629,"props":10090,"children":10091},{"class":642},[10092],{"type":24,"value":10064},{"type":18,"tag":629,"props":10094,"children":10095},{"class":5364},[10096],{"type":24,"value":8809},{"type":18,"tag":629,"props":10098,"children":10099},{"class":642},[10100],{"type":24,"value":3236},{"type":18,"tag":629,"props":10102,"children":10103},{"class":631,"line":697},[10104,10108,10113,10117,10121,10125],{"type":18,"tag":629,"props":10105,"children":10106},{"class":642},[10107],{"type":24,"value":10050},{"type":18,"tag":629,"props":10109,"children":10110},{"class":5354},[10111],{"type":24,"value":10112},"lbx",{"type":18,"tag":629,"props":10114,"children":10115},{"class":636},[10116],{"type":24,"value":726},{"type":18,"tag":629,"props":10118,"children":10119},{"class":642},[10120],{"type":24,"value":10064},{"type":18,"tag":629,"props":10122,"children":10123},{"class":5364},[10124],{"type":24,"value":9980},{"type":18,"tag":629,"props":10126,"children":10127},{"class":642},[10128],{"type":24,"value":3236},{"type":18,"tag":629,"props":10130,"children":10131},{"class":631,"line":705},[10132,10136,10141,10145,10149,10153],{"type":18,"tag":629,"props":10133,"children":10134},{"class":642},[10135],{"type":24,"value":10050},{"type":18,"tag":629,"props":10137,"children":10138},{"class":5354},[10139],{"type":24,"value":10140},"ubx",{"type":18,"tag":629,"props":10142,"children":10143},{"class":636},[10144],{"type":24,"value":726},{"type":18,"tag":629,"props":10146,"children":10147},{"class":642},[10148],{"type":24,"value":10064},{"type":18,"tag":629,"props":10150,"children":10151},{"class":5364},[10152],{"type":24,"value":9997},{"type":18,"tag":629,"props":10154,"children":10155},{"class":642},[10156],{"type":24,"value":3236},{"type":18,"tag":629,"props":10158,"children":10159},{"class":631,"line":734},[10160,10164,10169,10173,10177,10181],{"type":18,"tag":629,"props":10161,"children":10162},{"class":642},[10163],{"type":24,"value":10050},{"type":18,"tag":629,"props":10165,"children":10166},{"class":5354},[10167],{"type":24,"value":10168},"lbg",{"type":18,"tag":629,"props":10170,"children":10171},{"class":636},[10172],{"type":24,"value":726},{"type":18,"tag":629,"props":10174,"children":10175},{"class":642},[10176],{"type":24,"value":10064},{"type":18,"tag":629,"props":10178,"children":10179},{"class":5364},[10180],{"type":24,"value":9865},{"type":18,"tag":629,"props":10182,"children":10183},{"class":642},[10184],{"type":24,"value":3236},{"type":18,"tag":629,"props":10186,"children":10187},{"class":631,"line":760},[10188,10192,10197,10201,10205,10209],{"type":18,"tag":629,"props":10189,"children":10190},{"class":642},[10191],{"type":24,"value":10050},{"type":18,"tag":629,"props":10193,"children":10194},{"class":5354},[10195],{"type":24,"value":10196},"ubg",{"type":18,"tag":629,"props":10198,"children":10199},{"class":636},[10200],{"type":24,"value":726},{"type":18,"tag":629,"props":10202,"children":10203},{"class":642},[10204],{"type":24,"value":10064},{"type":18,"tag":629,"props":10206,"children":10207},{"class":5364},[10208],{"type":24,"value":9924},{"type":18,"tag":629,"props":10210,"children":10211},{"class":642},[10212],{"type":24,"value":3236},{"type":18,"tag":629,"props":10214,"children":10215},{"class":631,"line":786},[10216],{"type":18,"tag":629,"props":10217,"children":10218},{"class":642},[10219],{"type":24,"value":10220},"        )\n",{"type":18,"tag":629,"props":10222,"children":10223},{"class":631,"line":794},[10224],{"type":18,"tag":629,"props":10225,"children":10226},{},[10227],{"type":24,"value":665},{"type":18,"tag":629,"props":10229,"children":10230},{"class":631,"line":820},[10231,10236,10240,10245,10249,10254,10258,10262,10266,10270,10274,10279,10283,10288,10292,10296,10300],{"type":18,"tag":629,"props":10232,"children":10233},{"class":642},[10234],{"type":24,"value":10235},"        sol_x ",{"type":18,"tag":629,"props":10237,"children":10238},{"class":636},[10239],{"type":24,"value":726},{"type":18,"tag":629,"props":10241,"children":10242},{"class":642},[10243],{"type":24,"value":10244}," ca.reshape(sol[",{"type":18,"tag":629,"props":10246,"children":10247},{"class":5364},[10248],{"type":24,"value":8792},{"type":18,"tag":629,"props":10250,"children":10251},{"class":642},[10252],{"type":24,"value":10253},"][:num_states ",{"type":18,"tag":629,"props":10255,"children":10256},{"class":636},[10257],{"type":24,"value":1071},{"type":18,"tag":629,"props":10259,"children":10260},{"class":642},[10261],{"type":24,"value":9042},{"type":18,"tag":629,"props":10263,"children":10264},{"class":636},[10265],{"type":24,"value":1192},{"type":18,"tag":629,"props":10267,"children":10268},{"class":642},[10269],{"type":24,"value":645},{"type":18,"tag":629,"props":10271,"children":10272},{"class":686},[10273],{"type":24,"value":992},{"type":18,"tag":629,"props":10275,"children":10276},{"class":642},[10277],{"type":24,"value":10278},")], ",{"type":18,"tag":629,"props":10280,"children":10281},{"class":686},[10282],{"type":24,"value":2550},{"type":18,"tag":629,"props":10284,"children":10285},{"class":642},[10286],{"type":24,"value":10287},", prediction_horizons ",{"type":18,"tag":629,"props":10289,"children":10290},{"class":636},[10291],{"type":24,"value":1192},{"type":18,"tag":629,"props":10293,"children":10294},{"class":642},[10295],{"type":24,"value":645},{"type":18,"tag":629,"props":10297,"children":10298},{"class":686},[10299],{"type":24,"value":992},{"type":18,"tag":629,"props":10301,"children":10302},{"class":642},[10303],{"type":24,"value":1438},{"type":18,"tag":629,"props":10305,"children":10306},{"class":631,"line":846},[10307,10312,10316,10320,10324,10329,10333,10337,10341,10345,10349,10354,10358],{"type":18,"tag":629,"props":10308,"children":10309},{"class":642},[10310],{"type":24,"value":10311},"        sol_u ",{"type":18,"tag":629,"props":10313,"children":10314},{"class":636},[10315],{"type":24,"value":726},{"type":18,"tag":629,"props":10317,"children":10318},{"class":642},[10319],{"type":24,"value":10244},{"type":18,"tag":629,"props":10321,"children":10322},{"class":5364},[10323],{"type":24,"value":8792},{"type":18,"tag":629,"props":10325,"children":10326},{"class":642},[10327],{"type":24,"value":10328},"][num_states ",{"type":18,"tag":629,"props":10330,"children":10331},{"class":636},[10332],{"type":24,"value":1071},{"type":18,"tag":629,"props":10334,"children":10335},{"class":642},[10336],{"type":24,"value":9042},{"type":18,"tag":629,"props":10338,"children":10339},{"class":636},[10340],{"type":24,"value":1192},{"type":18,"tag":629,"props":10342,"children":10343},{"class":642},[10344],{"type":24,"value":645},{"type":18,"tag":629,"props":10346,"children":10347},{"class":686},[10348],{"type":24,"value":992},{"type":18,"tag":629,"props":10350,"children":10351},{"class":642},[10352],{"type":24,"value":10353},"):], ",{"type":18,"tag":629,"props":10355,"children":10356},{"class":686},[10357],{"type":24,"value":1368},{"type":18,"tag":629,"props":10359,"children":10360},{"class":642},[10361],{"type":24,"value":10362},", prediction_horizons)",{"type":18,"tag":19,"props":10364,"children":10366},{"id":10365},"result",[10367],{"type":24,"value":10368},"Result",{"type":18,"tag":27,"props":10370,"children":10371},{},[10372],{"type":24,"value":10373},"I use MPC to control the differential drive robot to move from it zero position the the desired postion that I want to follow !.\nI generate a circle trajectory and I fit this curve into my beautiful and robustness cost and then volia !!!.",{"type":18,"tag":6310,"props":10375,"children":10377},{"className":10376},[6313,6314,6315],[10378,10379],{"type":24,"value":6318},{"type":18,"tag":6320,"props":10380,"children":10383},{"className":10381,"src":10382,"width":6352,"height":6353},[6323],"/topics/robotics/nmpc/diff_mpc.png",[],{"type":18,"tag":6329,"props":10385,"children":10387},{"className":10386},[68,6332,6333,6334],[10388],{"type":24,"value":10389},"\n    Plot of differential drive robot follow the circle trajectory !!!.\n",{"type":18,"tag":19,"props":10391,"children":10392},{"id":6377},[10393],{"type":24,"value":10394},"In conclusion",{"type":18,"tag":27,"props":10396,"children":10397},{},[10398],{"type":24,"value":10399},"In my opinion, I think MPC is suitable for the control system, since it can provide the significant control input that was predicted over the finite future of time. This can ensure the safety of the system and also can provide a quick look or reaction to the control action of the system too.",{"type":18,"tag":19,"props":10401,"children":10403},{"id":10402},"reference",[10404],{"type":24,"value":10405},"Reference",{"type":18,"tag":280,"props":10407,"children":10408},{},[10409,10419,10429],{"type":18,"tag":80,"props":10410,"children":10411},{},[10412],{"type":18,"tag":6367,"props":10413,"children":10416},{"href":10414,"rel":10415},"https://github.com/MMehrez/MPC-and-MHE-implementation-in-MATLAB-using-Casadi",[6371],[10417],{"type":24,"value":10418},"MPC-and-MHE-implementation-in-MATLAB-using-Casadi",{"type":18,"tag":80,"props":10420,"children":10421},{},[10422],{"type":18,"tag":6367,"props":10423,"children":10426},{"href":10424,"rel":10425},"https://web.casadi.org",[6371],[10427],{"type":24,"value":10428},"CasAdi",{"type":18,"tag":80,"props":10430,"children":10431},{},[10432],{"type":18,"tag":6367,"props":10433,"children":10436},{"href":10434,"rel":10435},"https://github.com/SokhengDin/PathTracking",[6371],[10437],{"type":24,"value":6374},{"type":18,"tag":6446,"children":10439},[10440],{"type":24,"value":10441},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-326375{color:#6A737D;}\n.ct-533739{color:#79B8FF;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":659,"depth":659,"links":10443},[10444,10445,10446,10447,10448,10449,10450,10451,10452],{"id":35,"depth":659,"text":38},{"id":6512,"depth":659,"text":6515},{"id":6656,"depth":659,"text":6659},{"id":7894,"depth":659,"text":7897},{"id":7922,"depth":659,"text":7925},{"id":7965,"depth":659,"text":7968},{"id":10365,"depth":659,"text":10368},{"id":6377,"depth":659,"text":10394},{"id":10402,"depth":659,"text":10405},"content:topics:robotics:nonlinear-mpc.md","topics/robotics/nonlinear-mpc.md",{"_path":10456,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":10457,"description":10458,"author":10459,"slug":10460,"tag":10460,"img":10461,"body":10462,"_type":6462,"_id":12354,"_source":6464,"_file":12355,"_extension":6466},"/topics/robotics/pid-controller","Introduction to PID Controller in Python","PID Control is a feedback control","DIN SOKHENG","pid","/topics/robotics/nmpc/PID.png",{"type":15,"children":10463,"toc":12340},[10464,10470,10480,10486,10491,10497,10501,10540,10549,10555,10561,10571,10577,10582,10616,10622,10627,10632,10642,10648,10653,10657,10662,10666,10671,11073,11090,11636,11641,11647,11653,11671,11757,11762,11824,11829,11913,11925,12211,12217,12236,12250,12254,12264,12270,12280,12286,12290,12295,12299,12336],{"type":18,"tag":19,"props":10465,"children":10467},{"id":10466},"what-is-pid-controller",[10468],{"type":24,"value":10469},"What is PID Controller ?",{"type":18,"tag":27,"props":10471,"children":10472},{},[10473,10475,10479],{"type":24,"value":10474},"The Proportional Integral Derivative (PID) controller is a traditional method in control systems that has found widespread use in control system engineering and industrial applications since its emergence in the 1940s. A PID controller is considered a feedback controller, aiming to minimize the error between the system's feedback and the desired setpoint by manually or automatically fine-tuning the coefficients ",{"type":18,"tag":84,"props":10476,"children":10478},{"latex-express":10477,"styles":87},"K_{P}, K_{I}, K_{D}",[],{"type":24,"value":197},{"type":18,"tag":19,"props":10481,"children":10483},{"id":10482},"how-it-works",[10484],{"type":24,"value":10485},"How it works ?",{"type":18,"tag":27,"props":10487,"children":10488},{},[10489],{"type":24,"value":10490},"Imagine you want to control the speed of a DC motor to reach 300 RPM, but due to the natural response of the DC motor, it cannot reach the desired angular speed. PID offers a solution to this natural response by adjusting the system's time response using its three components, as shown in the formula below.",{"type":18,"tag":19,"props":10492,"children":10494},{"id":10493},"formulation",[10495],{"type":24,"value":10496},"Formulation",{"type":18,"tag":65,"props":10498,"children":10500},{"latex-express":10499,"styles":68},"u(t) = K_{p}e(t) + K_{I} \\int_{0}^{t} e(t) dt + K_{D} \\frac{d e(t)}{dt} ",[],{"type":18,"tag":76,"props":10502,"children":10503},{},[10504,10513,10522,10531],{"type":18,"tag":80,"props":10505,"children":10506},{},[10507,10511],{"type":18,"tag":84,"props":10508,"children":10510},{"latex-express":10509,"styles":87},"K_{P}",[],{"type":24,"value":10512}," represents the proportional gain.",{"type":18,"tag":80,"props":10514,"children":10515},{},[10516,10520],{"type":18,"tag":84,"props":10517,"children":10519},{"latex-express":10518,"styles":87},"K_{I}",[],{"type":24,"value":10521}," represents the integral gain.",{"type":18,"tag":80,"props":10523,"children":10524},{},[10525,10529],{"type":18,"tag":84,"props":10526,"children":10528},{"latex-express":10527,"styles":87},"K_{D}",[],{"type":24,"value":10530}," represents the derivative gain.",{"type":18,"tag":80,"props":10532,"children":10533},{},[10534,10538],{"type":18,"tag":84,"props":10535,"children":10537},{"latex-express":10536,"styles":87},"e(t)=target-feedback",[],{"type":24,"value":10539}," is the error between target point and feedback of the system",{"type":18,"tag":6310,"props":10541,"children":10543},{"className":10542},[6313,6314,6315],[10544,10545],{"type":24,"value":6318},{"type":18,"tag":6320,"props":10546,"children":10548},{"className":10547,"src":10461},[6323],[],{"type":18,"tag":6329,"props":10550,"children":10552},{"className":10551},[68,6332,6333,6334],[10553],{"type":24,"value":10554},"\n    The Block diagram of PID Controller\n",{"type":18,"tag":19,"props":10556,"children":10558},{"id":10557},"response-time",[10559],{"type":24,"value":10560},"Response Time",{"type":18,"tag":6310,"props":10562,"children":10564},{"className":10563},[6313,6314,6315],[10565,10566],{"type":24,"value":6318},{"type":18,"tag":6320,"props":10567,"children":10570},{"className":10568,"src":10569},[6323],"/topics/robotics/nmpc/response_timepid.png",[],{"type":18,"tag":6329,"props":10572,"children":10574},{"className":10573},[68,6332,6333,6334],[10575],{"type":24,"value":10576},"\n    The response time of the system with each K_P, K_I, K_D\n",{"type":18,"tag":27,"props":10578,"children":10579},{},[10580],{"type":24,"value":10581},"As you can see in the figure above, the response time of the system is difference.",{"type":18,"tag":76,"props":10583,"children":10584},{},[10585,10596,10606],{"type":18,"tag":80,"props":10586,"children":10587},{},[10588,10590,10594],{"type":24,"value":10589},"The response time with ",{"type":18,"tag":84,"props":10591,"children":10593},{"latex-express":10592,"styles":87},"K_{I}=2",[],{"type":24,"value":10595}," the system is likely to overshoot before reaching the steady-state, which may not be suitable for applications like controlling a DC motor.",{"type":18,"tag":80,"props":10597,"children":10598},{},[10599,10600,10604],{"type":24,"value":10589},{"type":18,"tag":84,"props":10601,"children":10603},{"latex-express":10602,"styles":87},"K_{i}=0.5, ",[],{"type":24,"value":10605},"  the response does not overshoot but has a slower response to reach the steady-state.",{"type":18,"tag":80,"props":10607,"children":10608},{},[10609,10610,10614],{"type":24,"value":10589},{"type":18,"tag":84,"props":10611,"children":10613},{"latex-express":10612,"styles":87},"K_{p}=1, K_{i}=1, K_{d}=1",[],{"type":24,"value":10615},"  there is a slight overshoot, but the steady-state is reached faster.",{"type":18,"tag":19,"props":10617,"children":10619},{"id":10618},"how-can-we-write-pid-code-in-python",[10620],{"type":24,"value":10621},"How can we write PID code in Python ?",{"type":18,"tag":27,"props":10623,"children":10624},{},[10625],{"type":24,"value":10626},"Let's use a differential drive robot as a case study system. A differential drive robot is commonly used in robotics and automation, making it an ideal choice for a demonstration.",{"type":18,"tag":27,"props":10628,"children":10629},{},[10630],{"type":24,"value":10631},"The configuration of Differential Drive Robot in axes OXY.",{"type":18,"tag":6310,"props":10633,"children":10635},{"className":10634},[6313,6314,6315],[10636,10637],{"type":24,"value":6318},{"type":18,"tag":6320,"props":10638,"children":10641},{"className":10639,"src":10640},[6323],"/topics/robotics/nmpc/diff_drive.png",[],{"type":18,"tag":6329,"props":10643,"children":10645},{"className":10644},[68,6332,6333,6334],[10646],{"type":24,"value":10647},"\n    The configuration of Differential Drive Robot in axes OXY.\n",{"type":18,"tag":27,"props":10649,"children":10650},{},[10651],{"type":24,"value":10652},"The forward kinematic equation",{"type":18,"tag":65,"props":10654,"children":10656},{"latex-express":10655,"styles":68},"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{\\theta} \\\\ \\omega \\end{bmatrix}\n ",[],{"type":18,"tag":27,"props":10658,"children":10659},{},[10660],{"type":24,"value":10661},"So, if we discretize the forward kinematic with a certain sampling time, we will get",{"type":18,"tag":84,"props":10663,"children":10665},{"latex-express":10664,"styles":68},"\n\\begin{bmatrix} x_{t+1} \\\\ y_{t+1} \\\\ \\theta_{t+1} \\end{bmatrix} = \\begin{bmatrix} x_{t} \\\\ y_{t} \\\\ \\theta_{t} \\end{bmatrix} +\\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix} \\times \\Delta t\n ",[],{"type":18,"tag":27,"props":10667,"children":10668},{},[10669],{"type":24,"value":10670},"In Python,",{"type":18,"tag":614,"props":10672,"children":10675},{"className":10673,"code":10674,"language":619,"meta":8},[617],"class DifferentialDrive:\n    def __init__(self):\n        self.r = 0.05\n        self.L = 0.25\n    def forward_kinematic(self, v, omega, yaw):\n        vx = v*np.cos(yaw)\n        vy = v*np.sin(yaw)\n        vyaw = omega\n\n        return vx, vy, vyaw\n    def discrete_state(self, x, y, yaw, v, omega, dt):\n        dx, dy, dyaw = self.forward_kinematic(v, omega, yaw)\n        x_next = x + dx * dt\n        y_next = y + dy * dt\n        yaw_next = yaw + dyaw * dt\n\n        return x_next, y_next, yaw_next\n",[10676],{"type":18,"tag":622,"props":10677,"children":10678},{},[10679],{"type":18,"tag":614,"props":10680,"children":10681},{"__ignoreMap":8},[10682,10702,10725,10754,10783,10808,10833,10858,10875,10882,10898,10923,10948,10982,11016,11050,11057],{"type":18,"tag":629,"props":10683,"children":10684},{"class":631,"line":632},[10685,10689,10693,10698],{"type":18,"tag":629,"props":10686,"children":10687},{"class":636},[10688],{"type":24,"value":639},{"type":18,"tag":629,"props":10690,"children":10691},{"class":642},[10692],{"type":24,"value":645},{"type":18,"tag":629,"props":10694,"children":10695},{"class":648},[10696],{"type":24,"value":10697},"DifferentialDrive",{"type":18,"tag":629,"props":10699,"children":10700},{"class":642},[10701],{"type":24,"value":656},{"type":18,"tag":629,"props":10703,"children":10704},{"class":631,"line":659},[10705,10709,10713,10717,10721],{"type":18,"tag":629,"props":10706,"children":10707},{"class":642},[10708],{"type":24,"value":674},{"type":18,"tag":629,"props":10710,"children":10711},{"class":636},[10712],{"type":24,"value":679},{"type":18,"tag":629,"props":10714,"children":10715},{"class":642},[10716],{"type":24,"value":645},{"type":18,"tag":629,"props":10718,"children":10719},{"class":686},[10720],{"type":24,"value":689},{"type":18,"tag":629,"props":10722,"children":10723},{"class":642},[10724],{"type":24,"value":1849},{"type":18,"tag":629,"props":10726,"children":10727},{"class":631,"line":668},[10728,10732,10736,10741,10745,10749],{"type":18,"tag":629,"props":10729,"children":10730},{"class":642},[10731],{"type":24,"value":711},{"type":18,"tag":629,"props":10733,"children":10734},{"class":686},[10735],{"type":24,"value":716},{"type":18,"tag":629,"props":10737,"children":10738},{"class":642},[10739],{"type":24,"value":10740},".r ",{"type":18,"tag":629,"props":10742,"children":10743},{"class":636},[10744],{"type":24,"value":726},{"type":18,"tag":629,"props":10746,"children":10747},{"class":642},[10748],{"type":24,"value":645},{"type":18,"tag":629,"props":10750,"children":10751},{"class":686},[10752],{"type":24,"value":10753},"0.05\n",{"type":18,"tag":629,"props":10755,"children":10756},{"class":631,"line":697},[10757,10761,10765,10770,10774,10778],{"type":18,"tag":629,"props":10758,"children":10759},{"class":642},[10760],{"type":24,"value":711},{"type":18,"tag":629,"props":10762,"children":10763},{"class":686},[10764],{"type":24,"value":716},{"type":18,"tag":629,"props":10766,"children":10767},{"class":642},[10768],{"type":24,"value":10769},".L ",{"type":18,"tag":629,"props":10771,"children":10772},{"class":636},[10773],{"type":24,"value":726},{"type":18,"tag":629,"props":10775,"children":10776},{"class":642},[10777],{"type":24,"value":645},{"type":18,"tag":629,"props":10779,"children":10780},{"class":686},[10781],{"type":24,"value":10782},"0.25\n",{"type":18,"tag":629,"props":10784,"children":10785},{"class":631,"line":705},[10786,10790,10794,10798,10803],{"type":18,"tag":629,"props":10787,"children":10788},{"class":642},[10789],{"type":24,"value":674},{"type":18,"tag":629,"props":10791,"children":10792},{"class":636},[10793],{"type":24,"value":679},{"type":18,"tag":629,"props":10795,"children":10796},{"class":642},[10797],{"type":24,"value":645},{"type":18,"tag":629,"props":10799,"children":10800},{"class":648},[10801],{"type":24,"value":10802},"forward_kinematic",{"type":18,"tag":629,"props":10804,"children":10805},{"class":642},[10806],{"type":24,"value":10807},"(self, v, omega, yaw):\n",{"type":18,"tag":629,"props":10809,"children":10810},{"class":631,"line":734},[10811,10816,10820,10825,10829],{"type":18,"tag":629,"props":10812,"children":10813},{"class":642},[10814],{"type":24,"value":10815},"        vx ",{"type":18,"tag":629,"props":10817,"children":10818},{"class":636},[10819],{"type":24,"value":726},{"type":18,"tag":629,"props":10821,"children":10822},{"class":642},[10823],{"type":24,"value":10824}," v",{"type":18,"tag":629,"props":10826,"children":10827},{"class":636},[10828],{"type":24,"value":1071},{"type":18,"tag":629,"props":10830,"children":10831},{"class":642},[10832],{"type":24,"value":1214},{"type":18,"tag":629,"props":10834,"children":10835},{"class":631,"line":760},[10836,10841,10845,10849,10853],{"type":18,"tag":629,"props":10837,"children":10838},{"class":642},[10839],{"type":24,"value":10840},"        vy ",{"type":18,"tag":629,"props":10842,"children":10843},{"class":636},[10844],{"type":24,"value":726},{"type":18,"tag":629,"props":10846,"children":10847},{"class":642},[10848],{"type":24,"value":10824},{"type":18,"tag":629,"props":10850,"children":10851},{"class":636},[10852],{"type":24,"value":1071},{"type":18,"tag":629,"props":10854,"children":10855},{"class":642},[10856],{"type":24,"value":10857},"np.sin(yaw)\n",{"type":18,"tag":629,"props":10859,"children":10860},{"class":631,"line":786},[10861,10866,10870],{"type":18,"tag":629,"props":10862,"children":10863},{"class":642},[10864],{"type":24,"value":10865},"        vyaw ",{"type":18,"tag":629,"props":10867,"children":10868},{"class":636},[10869],{"type":24,"value":726},{"type":18,"tag":629,"props":10871,"children":10872},{"class":642},[10873],{"type":24,"value":10874}," omega\n",{"type":18,"tag":629,"props":10876,"children":10877},{"class":631,"line":794},[10878],{"type":18,"tag":629,"props":10879,"children":10880},{},[10881],{"type":24,"value":665},{"type":18,"tag":629,"props":10883,"children":10884},{"class":631,"line":820},[10885,10889,10893],{"type":18,"tag":629,"props":10886,"children":10887},{"class":642},[10888],{"type":24,"value":711},{"type":18,"tag":629,"props":10890,"children":10891},{"class":636},[10892],{"type":24,"value":1235},{"type":18,"tag":629,"props":10894,"children":10895},{"class":642},[10896],{"type":24,"value":10897}," vx, vy, vyaw\n",{"type":18,"tag":629,"props":10899,"children":10900},{"class":631,"line":846},[10901,10905,10909,10913,10918],{"type":18,"tag":629,"props":10902,"children":10903},{"class":642},[10904],{"type":24,"value":674},{"type":18,"tag":629,"props":10906,"children":10907},{"class":636},[10908],{"type":24,"value":679},{"type":18,"tag":629,"props":10910,"children":10911},{"class":642},[10912],{"type":24,"value":645},{"type":18,"tag":629,"props":10914,"children":10915},{"class":648},[10916],{"type":24,"value":10917},"discrete_state",{"type":18,"tag":629,"props":10919,"children":10920},{"class":642},[10921],{"type":24,"value":10922},"(self, x, y, yaw, v, omega, dt):\n",{"type":18,"tag":629,"props":10924,"children":10925},{"class":631,"line":854},[10926,10931,10935,10939,10943],{"type":18,"tag":629,"props":10927,"children":10928},{"class":642},[10929],{"type":24,"value":10930},"        dx, dy, dyaw ",{"type":18,"tag":629,"props":10932,"children":10933},{"class":636},[10934],{"type":24,"value":726},{"type":18,"tag":629,"props":10936,"children":10937},{"class":642},[10938],{"type":24,"value":645},{"type":18,"tag":629,"props":10940,"children":10941},{"class":686},[10942],{"type":24,"value":716},{"type":18,"tag":629,"props":10944,"children":10945},{"class":642},[10946],{"type":24,"value":10947},".forward_kinematic(v, omega, yaw)\n",{"type":18,"tag":629,"props":10949,"children":10950},{"class":631,"line":890},[10951,10956,10960,10965,10969,10974,10978],{"type":18,"tag":629,"props":10952,"children":10953},{"class":642},[10954],{"type":24,"value":10955},"        x_next ",{"type":18,"tag":629,"props":10957,"children":10958},{"class":636},[10959],{"type":24,"value":726},{"type":18,"tag":629,"props":10961,"children":10962},{"class":642},[10963],{"type":24,"value":10964}," x ",{"type":18,"tag":629,"props":10966,"children":10967},{"class":636},[10968],{"type":24,"value":1192},{"type":18,"tag":629,"props":10970,"children":10971},{"class":642},[10972],{"type":24,"value":10973}," dx ",{"type":18,"tag":629,"props":10975,"children":10976},{"class":636},[10977],{"type":24,"value":1071},{"type":18,"tag":629,"props":10979,"children":10980},{"class":642},[10981],{"type":24,"value":2962},{"type":18,"tag":629,"props":10983,"children":10984},{"class":631,"line":923},[10985,10990,10994,10999,11003,11008,11012],{"type":18,"tag":629,"props":10986,"children":10987},{"class":642},[10988],{"type":24,"value":10989},"        y_next ",{"type":18,"tag":629,"props":10991,"children":10992},{"class":636},[10993],{"type":24,"value":726},{"type":18,"tag":629,"props":10995,"children":10996},{"class":642},[10997],{"type":24,"value":10998}," y ",{"type":18,"tag":629,"props":11000,"children":11001},{"class":636},[11002],{"type":24,"value":1192},{"type":18,"tag":629,"props":11004,"children":11005},{"class":642},[11006],{"type":24,"value":11007}," dy ",{"type":18,"tag":629,"props":11009,"children":11010},{"class":636},[11011],{"type":24,"value":1071},{"type":18,"tag":629,"props":11013,"children":11014},{"class":642},[11015],{"type":24,"value":2962},{"type":18,"tag":629,"props":11017,"children":11018},{"class":631,"line":931},[11019,11024,11028,11033,11037,11042,11046],{"type":18,"tag":629,"props":11020,"children":11021},{"class":642},[11022],{"type":24,"value":11023},"        yaw_next ",{"type":18,"tag":629,"props":11025,"children":11026},{"class":636},[11027],{"type":24,"value":726},{"type":18,"tag":629,"props":11029,"children":11030},{"class":642},[11031],{"type":24,"value":11032}," yaw ",{"type":18,"tag":629,"props":11034,"children":11035},{"class":636},[11036],{"type":24,"value":1192},{"type":18,"tag":629,"props":11038,"children":11039},{"class":642},[11040],{"type":24,"value":11041}," dyaw ",{"type":18,"tag":629,"props":11043,"children":11044},{"class":636},[11045],{"type":24,"value":1071},{"type":18,"tag":629,"props":11047,"children":11048},{"class":642},[11049],{"type":24,"value":2962},{"type":18,"tag":629,"props":11051,"children":11052},{"class":631,"line":965},[11053],{"type":18,"tag":629,"props":11054,"children":11055},{},[11056],{"type":24,"value":665},{"type":18,"tag":629,"props":11058,"children":11059},{"class":631,"line":999},[11060,11064,11068],{"type":18,"tag":629,"props":11061,"children":11062},{"class":642},[11063],{"type":24,"value":711},{"type":18,"tag":629,"props":11065,"children":11066},{"class":636},[11067],{"type":24,"value":1235},{"type":18,"tag":629,"props":11069,"children":11070},{"class":642},[11071],{"type":24,"value":11072}," x_next, y_next, yaw_next",{"type":18,"tag":27,"props":11074,"children":11075},{},[11076,11078,11082,11084,11089],{"type":24,"value":11077},"The ",{"type":18,"tag":170,"props":11079,"children":11080},{},[11081],{"type":24,"value":6669},{"type":24,"value":11083}," class that we defined, has all the need attribute to use for PID control !!. We just need to write another class for our ",{"type":18,"tag":170,"props":11085,"children":11086},{},[11087],{"type":24,"value":11088}," PID Controller ",{"type":24,"value":197},{"type":18,"tag":614,"props":11091,"children":11094},{"className":11092,"code":11093,"language":619,"meta":8},[617],"class PIDController:\n    def __init__(self, kp, ki, kd, dt):\n\n        self.kp = kp\n        self.ki = ki\n        self.kd = kd\n        self.dt = dt\n        self.integral = 0\n\n    def calculate_pid(self, errors):\n        # Calculate proportional error\n        proportional = self.kp * errors[-1]\n        # Calculate integration error\n        integral = self.integral + self.ki * (errors[-1]) * self.dt\n        self.integral = integral\n        # Calculate derivative error\n        derivative = self.kd * (errors[-1] - errors[-2])/self.dt\n\n        output = proportional + integral + derivative\n\n        return output\n",[11095],{"type":18,"tag":622,"props":11096,"children":11097},{},[11098],{"type":18,"tag":614,"props":11099,"children":11100},{"__ignoreMap":8},[11101,11121,11145,11152,11177,11202,11227,11251,11279,11286,11311,11323,11368,11380,11458,11482,11494,11571,11578,11613,11620],{"type":18,"tag":629,"props":11102,"children":11103},{"class":631,"line":632},[11104,11108,11112,11117],{"type":18,"tag":629,"props":11105,"children":11106},{"class":636},[11107],{"type":24,"value":639},{"type":18,"tag":629,"props":11109,"children":11110},{"class":642},[11111],{"type":24,"value":645},{"type":18,"tag":629,"props":11113,"children":11114},{"class":648},[11115],{"type":24,"value":11116},"PIDController",{"type":18,"tag":629,"props":11118,"children":11119},{"class":642},[11120],{"type":24,"value":656},{"type":18,"tag":629,"props":11122,"children":11123},{"class":631,"line":659},[11124,11128,11132,11136,11140],{"type":18,"tag":629,"props":11125,"children":11126},{"class":642},[11127],{"type":24,"value":674},{"type":18,"tag":629,"props":11129,"children":11130},{"class":636},[11131],{"type":24,"value":679},{"type":18,"tag":629,"props":11133,"children":11134},{"class":642},[11135],{"type":24,"value":645},{"type":18,"tag":629,"props":11137,"children":11138},{"class":686},[11139],{"type":24,"value":689},{"type":18,"tag":629,"props":11141,"children":11142},{"class":642},[11143],{"type":24,"value":11144},"(self, kp, ki, kd, dt):\n",{"type":18,"tag":629,"props":11146,"children":11147},{"class":631,"line":668},[11148],{"type":18,"tag":629,"props":11149,"children":11150},{},[11151],{"type":24,"value":665},{"type":18,"tag":629,"props":11153,"children":11154},{"class":631,"line":697},[11155,11159,11163,11168,11172],{"type":18,"tag":629,"props":11156,"children":11157},{"class":642},[11158],{"type":24,"value":711},{"type":18,"tag":629,"props":11160,"children":11161},{"class":686},[11162],{"type":24,"value":716},{"type":18,"tag":629,"props":11164,"children":11165},{"class":642},[11166],{"type":24,"value":11167},".kp ",{"type":18,"tag":629,"props":11169,"children":11170},{"class":636},[11171],{"type":24,"value":726},{"type":18,"tag":629,"props":11173,"children":11174},{"class":642},[11175],{"type":24,"value":11176}," kp\n",{"type":18,"tag":629,"props":11178,"children":11179},{"class":631,"line":705},[11180,11184,11188,11193,11197],{"type":18,"tag":629,"props":11181,"children":11182},{"class":642},[11183],{"type":24,"value":711},{"type":18,"tag":629,"props":11185,"children":11186},{"class":686},[11187],{"type":24,"value":716},{"type":18,"tag":629,"props":11189,"children":11190},{"class":642},[11191],{"type":24,"value":11192},".ki ",{"type":18,"tag":629,"props":11194,"children":11195},{"class":636},[11196],{"type":24,"value":726},{"type":18,"tag":629,"props":11198,"children":11199},{"class":642},[11200],{"type":24,"value":11201}," ki\n",{"type":18,"tag":629,"props":11203,"children":11204},{"class":631,"line":734},[11205,11209,11213,11218,11222],{"type":18,"tag":629,"props":11206,"children":11207},{"class":642},[11208],{"type":24,"value":711},{"type":18,"tag":629,"props":11210,"children":11211},{"class":686},[11212],{"type":24,"value":716},{"type":18,"tag":629,"props":11214,"children":11215},{"class":642},[11216],{"type":24,"value":11217},".kd ",{"type":18,"tag":629,"props":11219,"children":11220},{"class":636},[11221],{"type":24,"value":726},{"type":18,"tag":629,"props":11223,"children":11224},{"class":642},[11225],{"type":24,"value":11226}," kd\n",{"type":18,"tag":629,"props":11228,"children":11229},{"class":631,"line":760},[11230,11234,11238,11243,11247],{"type":18,"tag":629,"props":11231,"children":11232},{"class":642},[11233],{"type":24,"value":711},{"type":18,"tag":629,"props":11235,"children":11236},{"class":686},[11237],{"type":24,"value":716},{"type":18,"tag":629,"props":11239,"children":11240},{"class":642},[11241],{"type":24,"value":11242},".dt ",{"type":18,"tag":629,"props":11244,"children":11245},{"class":636},[11246],{"type":24,"value":726},{"type":18,"tag":629,"props":11248,"children":11249},{"class":642},[11250],{"type":24,"value":2962},{"type":18,"tag":629,"props":11252,"children":11253},{"class":631,"line":786},[11254,11258,11262,11267,11271,11275],{"type":18,"tag":629,"props":11255,"children":11256},{"class":642},[11257],{"type":24,"value":711},{"type":18,"tag":629,"props":11259,"children":11260},{"class":686},[11261],{"type":24,"value":716},{"type":18,"tag":629,"props":11263,"children":11264},{"class":642},[11265],{"type":24,"value":11266},".integral ",{"type":18,"tag":629,"props":11268,"children":11269},{"class":636},[11270],{"type":24,"value":726},{"type":18,"tag":629,"props":11272,"children":11273},{"class":642},[11274],{"type":24,"value":645},{"type":18,"tag":629,"props":11276,"children":11277},{"class":686},[11278],{"type":24,"value":8983},{"type":18,"tag":629,"props":11280,"children":11281},{"class":631,"line":794},[11282],{"type":18,"tag":629,"props":11283,"children":11284},{},[11285],{"type":24,"value":665},{"type":18,"tag":629,"props":11287,"children":11288},{"class":631,"line":820},[11289,11293,11297,11301,11306],{"type":18,"tag":629,"props":11290,"children":11291},{"class":642},[11292],{"type":24,"value":674},{"type":18,"tag":629,"props":11294,"children":11295},{"class":636},[11296],{"type":24,"value":679},{"type":18,"tag":629,"props":11298,"children":11299},{"class":642},[11300],{"type":24,"value":645},{"type":18,"tag":629,"props":11302,"children":11303},{"class":648},[11304],{"type":24,"value":11305},"calculate_pid",{"type":18,"tag":629,"props":11307,"children":11308},{"class":642},[11309],{"type":24,"value":11310},"(self, errors):\n",{"type":18,"tag":629,"props":11312,"children":11313},{"class":631,"line":846},[11314,11318],{"type":18,"tag":629,"props":11315,"children":11316},{"class":642},[11317],{"type":24,"value":711},{"type":18,"tag":629,"props":11319,"children":11320},{"class":1866},[11321],{"type":24,"value":11322},"# Calculate proportional error\n",{"type":18,"tag":629,"props":11324,"children":11325},{"class":631,"line":854},[11326,11331,11335,11339,11343,11347,11351,11356,11360,11364],{"type":18,"tag":629,"props":11327,"children":11328},{"class":642},[11329],{"type":24,"value":11330},"        proportional ",{"type":18,"tag":629,"props":11332,"children":11333},{"class":636},[11334],{"type":24,"value":726},{"type":18,"tag":629,"props":11336,"children":11337},{"class":642},[11338],{"type":24,"value":645},{"type":18,"tag":629,"props":11340,"children":11341},{"class":686},[11342],{"type":24,"value":716},{"type":18,"tag":629,"props":11344,"children":11345},{"class":642},[11346],{"type":24,"value":11167},{"type":18,"tag":629,"props":11348,"children":11349},{"class":636},[11350],{"type":24,"value":1071},{"type":18,"tag":629,"props":11352,"children":11353},{"class":642},[11354],{"type":24,"value":11355}," errors[",{"type":18,"tag":629,"props":11357,"children":11358},{"class":636},[11359],{"type":24,"value":1061},{"type":18,"tag":629,"props":11361,"children":11362},{"class":686},[11363],{"type":24,"value":992},{"type":18,"tag":629,"props":11365,"children":11366},{"class":642},[11367],{"type":24,"value":887},{"type":18,"tag":629,"props":11369,"children":11370},{"class":631,"line":890},[11371,11375],{"type":18,"tag":629,"props":11372,"children":11373},{"class":642},[11374],{"type":24,"value":711},{"type":18,"tag":629,"props":11376,"children":11377},{"class":1866},[11378],{"type":24,"value":11379},"# Calculate integration error\n",{"type":18,"tag":629,"props":11381,"children":11382},{"class":631,"line":923},[11383,11388,11392,11396,11400,11404,11408,11412,11416,11420,11424,11429,11433,11437,11441,11445,11449,11453],{"type":18,"tag":629,"props":11384,"children":11385},{"class":642},[11386],{"type":24,"value":11387},"        integral ",{"type":18,"tag":629,"props":11389,"children":11390},{"class":636},[11391],{"type":24,"value":726},{"type":18,"tag":629,"props":11393,"children":11394},{"class":642},[11395],{"type":24,"value":645},{"type":18,"tag":629,"props":11397,"children":11398},{"class":686},[11399],{"type":24,"value":716},{"type":18,"tag":629,"props":11401,"children":11402},{"class":642},[11403],{"type":24,"value":11266},{"type":18,"tag":629,"props":11405,"children":11406},{"class":636},[11407],{"type":24,"value":1192},{"type":18,"tag":629,"props":11409,"children":11410},{"class":642},[11411],{"type":24,"value":645},{"type":18,"tag":629,"props":11413,"children":11414},{"class":686},[11415],{"type":24,"value":716},{"type":18,"tag":629,"props":11417,"children":11418},{"class":642},[11419],{"type":24,"value":11192},{"type":18,"tag":629,"props":11421,"children":11422},{"class":636},[11423],{"type":24,"value":1071},{"type":18,"tag":629,"props":11425,"children":11426},{"class":642},[11427],{"type":24,"value":11428}," (errors[",{"type":18,"tag":629,"props":11430,"children":11431},{"class":636},[11432],{"type":24,"value":1061},{"type":18,"tag":629,"props":11434,"children":11435},{"class":686},[11436],{"type":24,"value":992},{"type":18,"tag":629,"props":11438,"children":11439},{"class":642},[11440],{"type":24,"value":7622},{"type":18,"tag":629,"props":11442,"children":11443},{"class":636},[11444],{"type":24,"value":1071},{"type":18,"tag":629,"props":11446,"children":11447},{"class":642},[11448],{"type":24,"value":645},{"type":18,"tag":629,"props":11450,"children":11451},{"class":686},[11452],{"type":24,"value":716},{"type":18,"tag":629,"props":11454,"children":11455},{"class":642},[11456],{"type":24,"value":11457},".dt\n",{"type":18,"tag":629,"props":11459,"children":11460},{"class":631,"line":931},[11461,11465,11469,11473,11477],{"type":18,"tag":629,"props":11462,"children":11463},{"class":642},[11464],{"type":24,"value":711},{"type":18,"tag":629,"props":11466,"children":11467},{"class":686},[11468],{"type":24,"value":716},{"type":18,"tag":629,"props":11470,"children":11471},{"class":642},[11472],{"type":24,"value":11266},{"type":18,"tag":629,"props":11474,"children":11475},{"class":636},[11476],{"type":24,"value":726},{"type":18,"tag":629,"props":11478,"children":11479},{"class":642},[11480],{"type":24,"value":11481}," integral\n",{"type":18,"tag":629,"props":11483,"children":11484},{"class":631,"line":965},[11485,11489],{"type":18,"tag":629,"props":11486,"children":11487},{"class":642},[11488],{"type":24,"value":711},{"type":18,"tag":629,"props":11490,"children":11491},{"class":1866},[11492],{"type":24,"value":11493},"# Calculate derivative error\n",{"type":18,"tag":629,"props":11495,"children":11496},{"class":631,"line":999},[11497,11502,11506,11510,11514,11518,11522,11526,11530,11534,11538,11542,11546,11550,11554,11559,11563,11567],{"type":18,"tag":629,"props":11498,"children":11499},{"class":642},[11500],{"type":24,"value":11501},"        derivative ",{"type":18,"tag":629,"props":11503,"children":11504},{"class":636},[11505],{"type":24,"value":726},{"type":18,"tag":629,"props":11507,"children":11508},{"class":642},[11509],{"type":24,"value":645},{"type":18,"tag":629,"props":11511,"children":11512},{"class":686},[11513],{"type":24,"value":716},{"type":18,"tag":629,"props":11515,"children":11516},{"class":642},[11517],{"type":24,"value":11217},{"type":18,"tag":629,"props":11519,"children":11520},{"class":636},[11521],{"type":24,"value":1071},{"type":18,"tag":629,"props":11523,"children":11524},{"class":642},[11525],{"type":24,"value":11428},{"type":18,"tag":629,"props":11527,"children":11528},{"class":636},[11529],{"type":24,"value":1061},{"type":18,"tag":629,"props":11531,"children":11532},{"class":686},[11533],{"type":24,"value":992},{"type":18,"tag":629,"props":11535,"children":11536},{"class":642},[11537],{"type":24,"value":2926},{"type":18,"tag":629,"props":11539,"children":11540},{"class":636},[11541],{"type":24,"value":1061},{"type":18,"tag":629,"props":11543,"children":11544},{"class":642},[11545],{"type":24,"value":11355},{"type":18,"tag":629,"props":11547,"children":11548},{"class":636},[11549],{"type":24,"value":1061},{"type":18,"tag":629,"props":11551,"children":11552},{"class":686},[11553],{"type":24,"value":1368},{"type":18,"tag":629,"props":11555,"children":11556},{"class":642},[11557],{"type":24,"value":11558},"])",{"type":18,"tag":629,"props":11560,"children":11561},{"class":636},[11562],{"type":24,"value":1429},{"type":18,"tag":629,"props":11564,"children":11565},{"class":686},[11566],{"type":24,"value":716},{"type":18,"tag":629,"props":11568,"children":11569},{"class":642},[11570],{"type":24,"value":11457},{"type":18,"tag":629,"props":11572,"children":11573},{"class":631,"line":1007},[11574],{"type":18,"tag":629,"props":11575,"children":11576},{},[11577],{"type":24,"value":665},{"type":18,"tag":629,"props":11579,"children":11580},{"class":631,"line":1033},[11581,11586,11590,11595,11599,11604,11608],{"type":18,"tag":629,"props":11582,"children":11583},{"class":642},[11584],{"type":24,"value":11585},"        output ",{"type":18,"tag":629,"props":11587,"children":11588},{"class":636},[11589],{"type":24,"value":726},{"type":18,"tag":629,"props":11591,"children":11592},{"class":642},[11593],{"type":24,"value":11594}," proportional ",{"type":18,"tag":629,"props":11596,"children":11597},{"class":636},[11598],{"type":24,"value":1192},{"type":18,"tag":629,"props":11600,"children":11601},{"class":642},[11602],{"type":24,"value":11603}," integral ",{"type":18,"tag":629,"props":11605,"children":11606},{"class":636},[11607],{"type":24,"value":1192},{"type":18,"tag":629,"props":11609,"children":11610},{"class":642},[11611],{"type":24,"value":11612}," derivative\n",{"type":18,"tag":629,"props":11614,"children":11615},{"class":631,"line":1041},[11616],{"type":18,"tag":629,"props":11617,"children":11618},{},[11619],{"type":24,"value":665},{"type":18,"tag":629,"props":11621,"children":11622},{"class":631,"line":1083},[11623,11627,11631],{"type":18,"tag":629,"props":11624,"children":11625},{"class":642},[11626],{"type":24,"value":711},{"type":18,"tag":629,"props":11628,"children":11629},{"class":636},[11630],{"type":24,"value":1235},{"type":18,"tag":629,"props":11632,"children":11633},{"class":642},[11634],{"type":24,"value":11635}," output",{"type":18,"tag":27,"props":11637,"children":11638},{},[11639],{"type":24,"value":11640},"Don't worry, this class just defined as the PID formula. So, by doing this, we will be able to use all the characteristic of our PID controller.",{"type":18,"tag":19,"props":11642,"children":11644},{"id":11643},"experiment",[11645],{"type":24,"value":11646},"Experiment",{"type":18,"tag":33,"props":11648,"children":11650},{"id":11649},"pid-for-point-control",[11651],{"type":24,"value":11652},"PID for point control",{"type":18,"tag":27,"props":11654,"children":11655},{},[11656,11658,11662,11664,11669],{"type":24,"value":11657},"If I want my DifferentialDrive robot go to point ",{"type":18,"tag":84,"props":11659,"children":11661},{"latex-express":11660,"styles":87},"x_{ref}, y_{ref}, \\theta_{ref}",[],{"type":24,"value":11663},", Then I can calculate the error between the reference point and the feedback position of the robot. I simulated my robot in the  ",{"type":18,"tag":4375,"props":11665,"children":11666},{},[11667],{"type":24,"value":11668},"for loop",{"type":24,"value":11670}," and calculate this error recursively.",{"type":18,"tag":614,"props":11672,"children":11675},{"className":11673,"code":11674,"language":619,"meta":8},[617],"error_x.append(ref_path[0]-current_x)\nerror_y.append(ref_path[1]-current_y)\nerror_yaw.append(ref_path[2]-current_yaw)\n",[11676],{"type":18,"tag":622,"props":11677,"children":11678},{},[11679],{"type":18,"tag":614,"props":11680,"children":11681},{"__ignoreMap":8},[11682,11707,11732],{"type":18,"tag":629,"props":11683,"children":11684},{"class":631,"line":632},[11685,11690,11694,11698,11702],{"type":18,"tag":629,"props":11686,"children":11687},{"class":642},[11688],{"type":24,"value":11689},"error_x.append(ref_path[",{"type":18,"tag":629,"props":11691,"children":11692},{"class":686},[11693],{"type":24,"value":882},{"type":18,"tag":629,"props":11695,"children":11696},{"class":642},[11697],{"type":24,"value":2612},{"type":18,"tag":629,"props":11699,"children":11700},{"class":636},[11701],{"type":24,"value":1061},{"type":18,"tag":629,"props":11703,"children":11704},{"class":642},[11705],{"type":24,"value":11706},"current_x)\n",{"type":18,"tag":629,"props":11708,"children":11709},{"class":631,"line":659},[11710,11715,11719,11723,11727],{"type":18,"tag":629,"props":11711,"children":11712},{"class":642},[11713],{"type":24,"value":11714},"error_y.append(ref_path[",{"type":18,"tag":629,"props":11716,"children":11717},{"class":686},[11718],{"type":24,"value":992},{"type":18,"tag":629,"props":11720,"children":11721},{"class":642},[11722],{"type":24,"value":2612},{"type":18,"tag":629,"props":11724,"children":11725},{"class":636},[11726],{"type":24,"value":1061},{"type":18,"tag":629,"props":11728,"children":11729},{"class":642},[11730],{"type":24,"value":11731},"current_y)\n",{"type":18,"tag":629,"props":11733,"children":11734},{"class":631,"line":668},[11735,11740,11744,11748,11752],{"type":18,"tag":629,"props":11736,"children":11737},{"class":642},[11738],{"type":24,"value":11739},"error_yaw.append(ref_path[",{"type":18,"tag":629,"props":11741,"children":11742},{"class":686},[11743],{"type":24,"value":1368},{"type":18,"tag":629,"props":11745,"children":11746},{"class":642},[11747],{"type":24,"value":2612},{"type":18,"tag":629,"props":11749,"children":11750},{"class":636},[11751],{"type":24,"value":1061},{"type":18,"tag":629,"props":11753,"children":11754},{"class":642},[11755],{"type":24,"value":11756},"current_yaw)",{"type":18,"tag":27,"props":11758,"children":11759},{},[11760],{"type":24,"value":11761},"Then, let's apply PID",{"type":18,"tag":614,"props":11763,"children":11766},{"className":11764,"code":11765,"language":619,"meta":8},[617],"output_vx = pid_controller_x.calculate_pid(error_x)\noutput_vy = pid_controller_y.calculate_pid(error_y)\noutput_omega = pid_controller_yaw.calculate_pid(error_yaw)\n",[11767],{"type":18,"tag":622,"props":11768,"children":11769},{},[11770],{"type":18,"tag":614,"props":11771,"children":11772},{"__ignoreMap":8},[11773,11790,11807],{"type":18,"tag":629,"props":11774,"children":11775},{"class":631,"line":632},[11776,11781,11785],{"type":18,"tag":629,"props":11777,"children":11778},{"class":642},[11779],{"type":24,"value":11780},"output_vx ",{"type":18,"tag":629,"props":11782,"children":11783},{"class":636},[11784],{"type":24,"value":726},{"type":18,"tag":629,"props":11786,"children":11787},{"class":642},[11788],{"type":24,"value":11789}," pid_controller_x.calculate_pid(error_x)\n",{"type":18,"tag":629,"props":11791,"children":11792},{"class":631,"line":659},[11793,11798,11802],{"type":18,"tag":629,"props":11794,"children":11795},{"class":642},[11796],{"type":24,"value":11797},"output_vy ",{"type":18,"tag":629,"props":11799,"children":11800},{"class":636},[11801],{"type":24,"value":726},{"type":18,"tag":629,"props":11803,"children":11804},{"class":642},[11805],{"type":24,"value":11806}," pid_controller_y.calculate_pid(error_y)\n",{"type":18,"tag":629,"props":11808,"children":11809},{"class":631,"line":668},[11810,11815,11819],{"type":18,"tag":629,"props":11811,"children":11812},{"class":642},[11813],{"type":24,"value":11814},"output_omega ",{"type":18,"tag":629,"props":11816,"children":11817},{"class":636},[11818],{"type":24,"value":726},{"type":18,"tag":629,"props":11820,"children":11821},{"class":642},[11822],{"type":24,"value":11823}," pid_controller_yaw.calculate_pid(error_yaw)",{"type":18,"tag":27,"props":11825,"children":11826},{},[11827],{"type":24,"value":11828},"We will also need to update current position of the robot with the given optimal value from the PID controller.",{"type":18,"tag":614,"props":11830,"children":11833},{"className":11831,"code":11832,"language":619,"meta":8},[617],"x_next, y_next, yaw_next = diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) # Skip for omega we only look for x, y\ncurrent_x = x_next\ncurrent_y = y_next\ncurrent_yaw = yaw_next\n",[11834],{"type":18,"tag":622,"props":11835,"children":11836},{},[11837],{"type":18,"tag":614,"props":11838,"children":11839},{"__ignoreMap":8},[11840,11862,11879,11896],{"type":18,"tag":629,"props":11841,"children":11842},{"class":631,"line":632},[11843,11848,11852,11857],{"type":18,"tag":629,"props":11844,"children":11845},{"class":642},[11846],{"type":24,"value":11847},"x_next, y_next, yaw_next ",{"type":18,"tag":629,"props":11849,"children":11850},{"class":636},[11851],{"type":24,"value":726},{"type":18,"tag":629,"props":11853,"children":11854},{"class":642},[11855],{"type":24,"value":11856}," diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) ",{"type":18,"tag":629,"props":11858,"children":11859},{"class":1866},[11860],{"type":24,"value":11861},"# Skip for omega we only look for x, y\n",{"type":18,"tag":629,"props":11863,"children":11864},{"class":631,"line":659},[11865,11870,11874],{"type":18,"tag":629,"props":11866,"children":11867},{"class":642},[11868],{"type":24,"value":11869},"current_x ",{"type":18,"tag":629,"props":11871,"children":11872},{"class":636},[11873],{"type":24,"value":726},{"type":18,"tag":629,"props":11875,"children":11876},{"class":642},[11877],{"type":24,"value":11878}," x_next\n",{"type":18,"tag":629,"props":11880,"children":11881},{"class":631,"line":668},[11882,11887,11891],{"type":18,"tag":629,"props":11883,"children":11884},{"class":642},[11885],{"type":24,"value":11886},"current_y ",{"type":18,"tag":629,"props":11888,"children":11889},{"class":636},[11890],{"type":24,"value":726},{"type":18,"tag":629,"props":11892,"children":11893},{"class":642},[11894],{"type":24,"value":11895}," y_next\n",{"type":18,"tag":629,"props":11897,"children":11898},{"class":631,"line":697},[11899,11904,11908],{"type":18,"tag":629,"props":11900,"children":11901},{"class":642},[11902],{"type":24,"value":11903},"current_yaw ",{"type":18,"tag":629,"props":11905,"children":11906},{"class":636},[11907],{"type":24,"value":726},{"type":18,"tag":629,"props":11909,"children":11910},{"class":642},[11911],{"type":24,"value":11912}," yaw_next",{"type":18,"tag":27,"props":11914,"children":11915},{},[11916,11918,11923],{"type":24,"value":11917},"I use ",{"type":18,"tag":4375,"props":11919,"children":11920},{},[11921],{"type":24,"value":11922},"matplotlib",{"type":24,"value":11924}," library to simulate my robot.",{"type":18,"tag":614,"props":11926,"children":11929},{"className":11927,"code":11928,"language":619,"meta":8},[617],"plt.clf()\nplt.gcf().canvas.mpl_connect('key_release_event',\n            lambda event: [exit(0) if event.key == 'escape' else None])\nplot_arrow(current_x, current_y, current_yaw)\nplt.plot(5, 5)\nplt.plot(ref_path[0], ref_path[1], marker=\"x\", color=\"blue\", label=\"Input Trajectory\")\nplt.axis(\"equal\")\nplt.grid(True)\nplt.legend()\nplt.pause(0.0001)\n",[11930],{"type":18,"tag":622,"props":11931,"children":11932},{},[11933],{"type":18,"tag":614,"props":11934,"children":11935},{"__ignoreMap":8},[11936,11944,11961,12040,12048,12073,12151,12168,12185,12193],{"type":18,"tag":629,"props":11937,"children":11938},{"class":631,"line":632},[11939],{"type":18,"tag":629,"props":11940,"children":11941},{"class":642},[11942],{"type":24,"value":11943},"plt.clf()\n",{"type":18,"tag":629,"props":11945,"children":11946},{"class":631,"line":659},[11947,11952,11957],{"type":18,"tag":629,"props":11948,"children":11949},{"class":642},[11950],{"type":24,"value":11951},"plt.gcf().canvas.mpl_connect(",{"type":18,"tag":629,"props":11953,"children":11954},{"class":5364},[11955],{"type":24,"value":11956},"'key_release_event'",{"type":18,"tag":629,"props":11958,"children":11959},{"class":642},[11960],{"type":24,"value":8888},{"type":18,"tag":629,"props":11962,"children":11963},{"class":631,"line":668},[11964,11968,11972,11977,11982,11986,11990,11994,11999,12004,12009,12013,12018,12022,12027,12031,12036],{"type":18,"tag":629,"props":11965,"children":11966},{"class":642},[11967],{"type":24,"value":10050},{"type":18,"tag":629,"props":11969,"children":11970},{"class":636},[11971],{"type":24,"value":6979},{"type":18,"tag":629,"props":11973,"children":11974},{"class":642},[11975],{"type":24,"value":11976}," event: [",{"type":18,"tag":629,"props":11978,"children":11979},{"class":686},[11980],{"type":24,"value":11981},"exit",{"type":18,"tag":629,"props":11983,"children":11984},{"class":642},[11985],{"type":24,"value":1402},{"type":18,"tag":629,"props":11987,"children":11988},{"class":686},[11989],{"type":24,"value":882},{"type":18,"tag":629,"props":11991,"children":11992},{"class":642},[11993],{"type":24,"value":5372},{"type":18,"tag":629,"props":11995,"children":11996},{"class":636},[11997],{"type":24,"value":11998},"if",{"type":18,"tag":629,"props":12000,"children":12001},{"class":642},[12002],{"type":24,"value":12003}," event.key ",{"type":18,"tag":629,"props":12005,"children":12006},{"class":636},[12007],{"type":24,"value":12008},"==",{"type":18,"tag":629,"props":12010,"children":12011},{"class":642},[12012],{"type":24,"value":645},{"type":18,"tag":629,"props":12014,"children":12015},{"class":5364},[12016],{"type":24,"value":12017},"'escape'",{"type":18,"tag":629,"props":12019,"children":12020},{"class":642},[12021],{"type":24,"value":645},{"type":18,"tag":629,"props":12023,"children":12024},{"class":636},[12025],{"type":24,"value":12026},"else",{"type":18,"tag":629,"props":12028,"children":12029},{"class":642},[12030],{"type":24,"value":645},{"type":18,"tag":629,"props":12032,"children":12033},{"class":686},[12034],{"type":24,"value":12035},"None",{"type":18,"tag":629,"props":12037,"children":12038},{"class":642},[12039],{"type":24,"value":3295},{"type":18,"tag":629,"props":12041,"children":12042},{"class":631,"line":697},[12043],{"type":18,"tag":629,"props":12044,"children":12045},{"class":642},[12046],{"type":24,"value":12047},"plot_arrow(current_x, current_y, current_yaw)\n",{"type":18,"tag":629,"props":12049,"children":12050},{"class":631,"line":705},[12051,12056,12061,12065,12069],{"type":18,"tag":629,"props":12052,"children":12053},{"class":642},[12054],{"type":24,"value":12055},"plt.plot(",{"type":18,"tag":629,"props":12057,"children":12058},{"class":686},[12059],{"type":24,"value":12060},"5",{"type":18,"tag":629,"props":12062,"children":12063},{"class":642},[12064],{"type":24,"value":2432},{"type":18,"tag":629,"props":12066,"children":12067},{"class":686},[12068],{"type":24,"value":12060},{"type":18,"tag":629,"props":12070,"children":12071},{"class":642},[12072],{"type":24,"value":1438},{"type":18,"tag":629,"props":12074,"children":12075},{"class":631,"line":734},[12076,12081,12085,12090,12094,12098,12103,12107,12111,12115,12120,12124,12129,12133,12138,12142,12147],{"type":18,"tag":629,"props":12077,"children":12078},{"class":642},[12079],{"type":24,"value":12080},"plt.plot(ref_path[",{"type":18,"tag":629,"props":12082,"children":12083},{"class":686},[12084],{"type":24,"value":882},{"type":18,"tag":629,"props":12086,"children":12087},{"class":642},[12088],{"type":24,"value":12089},"], ref_path[",{"type":18,"tag":629,"props":12091,"children":12092},{"class":686},[12093],{"type":24,"value":992},{"type":18,"tag":629,"props":12095,"children":12096},{"class":642},[12097],{"type":24,"value":3262},{"type":18,"tag":629,"props":12099,"children":12100},{"class":5354},[12101],{"type":24,"value":12102},"marker",{"type":18,"tag":629,"props":12104,"children":12105},{"class":636},[12106],{"type":24,"value":726},{"type":18,"tag":629,"props":12108,"children":12109},{"class":5364},[12110],{"type":24,"value":8075},{"type":18,"tag":629,"props":12112,"children":12113},{"class":642},[12114],{"type":24,"value":2432},{"type":18,"tag":629,"props":12116,"children":12117},{"class":5354},[12118],{"type":24,"value":12119},"color",{"type":18,"tag":629,"props":12121,"children":12122},{"class":636},[12123],{"type":24,"value":726},{"type":18,"tag":629,"props":12125,"children":12126},{"class":5364},[12127],{"type":24,"value":12128},"\"blue\"",{"type":18,"tag":629,"props":12130,"children":12131},{"class":642},[12132],{"type":24,"value":2432},{"type":18,"tag":629,"props":12134,"children":12135},{"class":5354},[12136],{"type":24,"value":12137},"label",{"type":18,"tag":629,"props":12139,"children":12140},{"class":636},[12141],{"type":24,"value":726},{"type":18,"tag":629,"props":12143,"children":12144},{"class":5364},[12145],{"type":24,"value":12146},"\"Input Trajectory\"",{"type":18,"tag":629,"props":12148,"children":12149},{"class":642},[12150],{"type":24,"value":1438},{"type":18,"tag":629,"props":12152,"children":12153},{"class":631,"line":760},[12154,12159,12164],{"type":18,"tag":629,"props":12155,"children":12156},{"class":642},[12157],{"type":24,"value":12158},"plt.axis(",{"type":18,"tag":629,"props":12160,"children":12161},{"class":5364},[12162],{"type":24,"value":12163},"\"equal\"",{"type":18,"tag":629,"props":12165,"children":12166},{"class":642},[12167],{"type":24,"value":1438},{"type":18,"tag":629,"props":12169,"children":12170},{"class":631,"line":786},[12171,12176,12181],{"type":18,"tag":629,"props":12172,"children":12173},{"class":642},[12174],{"type":24,"value":12175},"plt.grid(",{"type":18,"tag":629,"props":12177,"children":12178},{"class":686},[12179],{"type":24,"value":12180},"True",{"type":18,"tag":629,"props":12182,"children":12183},{"class":642},[12184],{"type":24,"value":1438},{"type":18,"tag":629,"props":12186,"children":12187},{"class":631,"line":794},[12188],{"type":18,"tag":629,"props":12189,"children":12190},{"class":642},[12191],{"type":24,"value":12192},"plt.legend()\n",{"type":18,"tag":629,"props":12194,"children":12195},{"class":631,"line":820},[12196,12201,12206],{"type":18,"tag":629,"props":12197,"children":12198},{"class":642},[12199],{"type":24,"value":12200},"plt.pause(",{"type":18,"tag":629,"props":12202,"children":12203},{"class":686},[12204],{"type":24,"value":12205},"0.0001",{"type":18,"tag":629,"props":12207,"children":12208},{"class":642},[12209],{"type":24,"value":12210},")",{"type":18,"tag":33,"props":12212,"children":12214},{"id":12213},"path-tracking",[12215],{"type":24,"value":12216},"Path Tracking",{"type":18,"tag":27,"props":12218,"children":12219},{},[12220,12222,12227,12229,12234],{"type":24,"value":12221},"The code is all way the same. The different is that, I fit the continuous point into the robot instead of fixed goal point. I use ",{"type":18,"tag":4375,"props":12223,"children":12224},{},[12225],{"type":24,"value":12226},"BeizerCurve",{"type":24,"value":12228}," function to generate ",{"type":18,"tag":170,"props":12230,"children":12231},{},[12232],{"type":24,"value":12233}," Spline Trajectory ",{"type":24,"value":12235}," for the robot.",{"type":18,"tag":27,"props":12237,"children":12238},{},[12239,12241,12248],{"type":24,"value":12240},"The full code is published open-source on my Github. Link here ",{"type":18,"tag":6367,"props":12242,"children":12245},{"href":12243,"rel":12244},"https://github.com/SokhengDin/PathTracking/tree/main/PID",[6371],[12246],{"type":24,"value":12247},"Github",{"type":24,"value":12249},". Hit the star for me if you like my work 🙂.",{"type":18,"tag":33,"props":12251,"children":12252},{"id":10365},[12253],{"type":24,"value":10368},{"type":18,"tag":6310,"props":12255,"children":12257},{"className":12256},[6313,6314,6315],[12258,12259],{"type":24,"value":6318},{"type":18,"tag":6320,"props":12260,"children":12263},{"className":12261,"src":12262},[6323],"/topics/robotics/nmpc/Figure_pid_p.png",[],{"type":18,"tag":6329,"props":12265,"children":12267},{"className":12266},[68,6332,6333,6334],[12268],{"type":24,"value":12269},"\n    PID Controller with position control on Differential Drive Robot\n",{"type":18,"tag":6310,"props":12271,"children":12273},{"className":12272},[6313,6314,6315],[12274,12275],{"type":24,"value":6318},{"type":18,"tag":6320,"props":12276,"children":12279},{"className":12277,"src":12278},[6323],"/topics/robotics/nmpc/Figure_pid_t.png",[],{"type":18,"tag":6329,"props":12281,"children":12283},{"className":12282},[68,6332,6333,6334],[12284],{"type":24,"value":12285},"\n    PID Controller with path tracking control on Differential Drive Robot\n",{"type":18,"tag":19,"props":12287,"children":12288},{"id":6377},[12289],{"type":24,"value":6380},{"type":18,"tag":27,"props":12291,"children":12292},{},[12293],{"type":24,"value":12294},"In my opinion, the PID Controller is an excellent choice for most control system applications due to its simplicity and powerful capabilities in handling complex control challenges arising from various systems.",{"type":18,"tag":19,"props":12296,"children":12297},{"id":6388},[12298],{"type":24,"value":6391},{"type":18,"tag":280,"props":12300,"children":12301},{},[12302,12311,12316,12326],{"type":18,"tag":80,"props":12303,"children":12304},{},[12305],{"type":18,"tag":6367,"props":12306,"children":12309},{"href":12307,"rel":12308},"https://en.wikipedia.org/wiki/B%C3%A9zier_curve",[6371],[12310],{"type":24,"value":12226},{"type":18,"tag":80,"props":12312,"children":12313},{},[12314],{"type":24,"value":12315},"PID Controller: Control Systems Engineering by Normal S. Nise.",{"type":18,"tag":80,"props":12317,"children":12318},{},[12319],{"type":18,"tag":6367,"props":12320,"children":12323},{"href":12321,"rel":12322},"https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathPlanning/BezierPath",[6371],[12324],{"type":24,"value":12325},"Beizer Path",{"type":18,"tag":80,"props":12327,"children":12328},{},[12329],{"type":18,"tag":6367,"props":12330,"children":12333},{"href":12331,"rel":12332},"https://www.cds.caltech.edu/~murray/courses/cds101/fa02/caltech/astrom-ch6.pdf",[6371],[12334],{"type":24,"value":12335},"PID Lecture",{"type":18,"tag":6446,"children":12337},[12338],{"type":24,"value":12339},".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":659,"depth":659,"links":12341},[12342,12343,12344,12345,12346,12347,12352,12353],{"id":10466,"depth":659,"text":10469},{"id":10482,"depth":659,"text":10485},{"id":10493,"depth":659,"text":10496},{"id":10557,"depth":659,"text":10560},{"id":10618,"depth":659,"text":10621},{"id":11643,"depth":659,"text":11646,"children":12348},[12349,12350,12351],{"id":11649,"depth":668,"text":11652},{"id":12213,"depth":668,"text":12216},{"id":10365,"depth":668,"text":10368},{"id":6377,"depth":659,"text":6380},{"id":6388,"depth":659,"text":6391},"content:topics:robotics:pid-controller.md","topics/robotics/pid-controller.md",{"_path":12357,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12358,"description":12359,"slug":12360,"tag":12360,"img":12361,"body":12362,"_type":6462,"_id":12594,"_source":6464,"_file":12595,"_extension":6466},"/topics/robotics/pure-pursuit","Pure Pursuit Controller","Introduction to Pure Pursuit Controller","pure-pursuit","/topics/robotics/nmpc/pure_pursuit.png",{"type":15,"children":12363,"toc":12587},[12364,12369,12379,12385,12390,12442,12448,12453,12505,12511,12516,12539,12544,12583],{"type":18,"tag":19,"props":12365,"children":12367},{"id":12366},"pure-pursuit-controller",[12368],{"type":24,"value":12358},{"type":18,"tag":27,"props":12370,"children":12371},{},[12372,12373,12377],{"type":24,"value":11077},{"type":18,"tag":170,"props":12374,"children":12375},{},[12376],{"type":24,"value":12358},{"type":24,"value":12378}," is a widely-used path-tracking algorithm in robotics and autonomous vehicle navigation. Its primary objective is to guide a vehicle or robot along a predefined path while ensuring precise path-following.",{"type":18,"tag":33,"props":12380,"children":12382},{"id":12381},"principle-of-operation",[12383],{"type":24,"value":12384},"Principle of Operation",{"type":18,"tag":27,"props":12386,"children":12387},{},[12388],{"type":24,"value":12389},"The operation of the Pure Pursuit Controller is based on a straightforward concept:",{"type":18,"tag":280,"props":12391,"children":12392},{},[12393,12403,12413,12423,12433],{"type":18,"tag":80,"props":12394,"children":12395},{},[12396,12401],{"type":18,"tag":170,"props":12397,"children":12398},{},[12399],{"type":24,"value":12400},"Path Definition",{"type":24,"value":12402},": The controller works with a defined path, often represented as a series of waypoints or a continuous curve, each associated with specific coordinates (x, y) and curvature information.",{"type":18,"tag":80,"props":12404,"children":12405},{},[12406,12411],{"type":18,"tag":170,"props":12407,"children":12408},{},[12409],{"type":24,"value":12410},"Target Point Selection",{"type":24,"value":12412},": The controller continuously selects a target point ahead of the vehicle. This target point is typically chosen as the point on the path that is a certain fixed distance (known as the \"lookahead distance\") in front of the vehicle.",{"type":18,"tag":80,"props":12414,"children":12415},{},[12416,12421],{"type":18,"tag":170,"props":12417,"children":12418},{},[12419],{"type":24,"value":12420},"Steering Command Calculation",{"type":24,"value":12422},": To navigate toward the target point, the controller calculates the steering command, often represented as the desired steering angle or curvature, required to reach the target point. Commonly, this involves computing the angle between the vehicle's current heading and the vector pointing from the current position to the target point.",{"type":18,"tag":80,"props":12424,"children":12425},{},[12426,12431],{"type":18,"tag":170,"props":12427,"children":12428},{},[12429],{"type":24,"value":12430},"Vehicle Control",{"type":24,"value":12432},": The calculated steering command is used to control the vehicle's steering mechanism (e.g., steering wheel or wheel angles) to guide it toward the target point.",{"type":18,"tag":80,"props":12434,"children":12435},{},[12436,12440],{"type":18,"tag":170,"props":12437,"children":12438},{},[12439],{"type":24,"value":345},{"type":24,"value":12441},": The process is iterative, with the controller continuously selecting new target points ahead as the vehicle advances along the path and adjusting its steering to reach them.",{"type":18,"tag":33,"props":12443,"children":12445},{"id":12444},"advantages",[12446],{"type":24,"value":12447},"Advantages",{"type":18,"tag":27,"props":12449,"children":12450},{},[12451],{"type":24,"value":12452},"The Pure Pursuit Controller offers several advantages:",{"type":18,"tag":76,"props":12454,"children":12455},{},[12456,12466,12475,12485,12495],{"type":18,"tag":80,"props":12457,"children":12458},{},[12459,12464],{"type":18,"tag":170,"props":12460,"children":12461},{},[12462],{"type":24,"value":12463},"Simplicity",{"type":24,"value":12465},": It is conceptually simple and easy to implement, making it suitable for a wide range of robotic and vehicle navigation applications.",{"type":18,"tag":80,"props":12467,"children":12468},{},[12469,12473],{"type":18,"tag":170,"props":12470,"children":12471},{},[12472],{"type":24,"value":12216},{"type":24,"value":12474},": The controller excels at accurate path tracking, even in complex environments with curves and turns.",{"type":18,"tag":80,"props":12476,"children":12477},{},[12478,12483],{"type":18,"tag":170,"props":12479,"children":12480},{},[12481],{"type":24,"value":12482},"Real-Time Operation",{"type":24,"value":12484},": It can operate in real-time, making it well-suited for dynamic environments where quick decision-making is crucial.",{"type":18,"tag":80,"props":12486,"children":12487},{},[12488,12493],{"type":18,"tag":170,"props":12489,"children":12490},{},[12491],{"type":24,"value":12492},"Adaptability",{"type":24,"value":12494},": The controller can adapt to changes in the path, such as deviations caused by obstacles or unexpected conditions, by continuously updating the target point.",{"type":18,"tag":80,"props":12496,"children":12497},{},[12498,12503],{"type":18,"tag":170,"props":12499,"children":12500},{},[12501],{"type":24,"value":12502},"Low Computational Overhead",{"type":24,"value":12504},": Compared to some other control algorithms, the Pure Pursuit Controller often has low computational requirements, which is advantageous for resource-constrained systems.",{"type":18,"tag":33,"props":12506,"children":12508},{"id":12507},"limitations",[12509],{"type":24,"value":12510},"Limitations",{"type":18,"tag":27,"props":12512,"children":12513},{},[12514],{"type":24,"value":12515},"Despite its advantages, the Pure Pursuit Controller has some limitations:",{"type":18,"tag":76,"props":12517,"children":12518},{},[12519,12529],{"type":18,"tag":80,"props":12520,"children":12521},{},[12522,12527],{"type":18,"tag":170,"props":12523,"children":12524},{},[12525],{"type":24,"value":12526},"Lookahead Distance Sensitivity",{"type":24,"value":12528},": Its performance can be sensitive to the choice of the lookahead distance, which requires careful tuning for optimal path tracking.",{"type":18,"tag":80,"props":12530,"children":12531},{},[12532,12537],{"type":18,"tag":170,"props":12533,"children":12534},{},[12535],{"type":24,"value":12536},"Non-Holonomic Assumption",{"type":24,"value":12538},": The controller assumes that the vehicle is non-holonomic, meaning it cannot move sideways. This assumption may not hold for certain types of vehicles, such as omnidirectional robots.",{"type":18,"tag":27,"props":12540,"children":12541},{},[12542],{"type":24,"value":12543},"In summary, the Pure Pursuit Controller is a straightforward yet effective algorithm for path tracking and navigation. Its ability to calculate a steering command based on a selected target point ahead of the vehicle makes it a valuable tool for applications ranging from autonomous cars to mobile robots.",{"type":18,"tag":614,"props":12545,"children":12550},{"className":12546,"code":12548,"language":12549,"meta":8},[12547],"language-js","console.log(\"Hello world\")\n\n","js",[12551],{"type":18,"tag":622,"props":12552,"children":12553},{},[12554],{"type":18,"tag":614,"props":12555,"children":12556},{"__ignoreMap":8},[12557],{"type":18,"tag":629,"props":12558,"children":12559},{"class":631,"line":632},[12560,12565,12570,12574,12579],{"type":18,"tag":629,"props":12561,"children":12562},{"class":642},[12563],{"type":24,"value":12564},"console.",{"type":18,"tag":629,"props":12566,"children":12567},{"class":648},[12568],{"type":24,"value":12569},"log",{"type":18,"tag":629,"props":12571,"children":12572},{"class":642},[12573],{"type":24,"value":1402},{"type":18,"tag":629,"props":12575,"children":12576},{"class":5364},[12577],{"type":24,"value":12578},"\"Hello world\"",{"type":18,"tag":629,"props":12580,"children":12581},{"class":642},[12582],{"type":24,"value":12210},{"type":18,"tag":6446,"children":12584},[12585],{"type":24,"value":12586},".ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-244866{color:#9ECBFF;}",{"title":8,"searchDepth":659,"depth":659,"links":12588},[12589],{"id":12366,"depth":659,"text":12358,"children":12590},[12591,12592,12593],{"id":12381,"depth":668,"text":12384},{"id":12444,"depth":668,"text":12447},{"id":12507,"depth":668,"text":12510},"content:topics:robotics:pure-pursuit.md","topics/robotics/pure-pursuit.md",{"_path":12597,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12598,"description":12599,"slug":12600,"tag":12600,"body":12601,"_type":6462,"_id":12802,"_source":6464,"_file":12803,"_extension":6466},"/topics/robotics/stanley-controller","Stanley Controller","Introduction to Stanley Controller","stanley",{"type":15,"children":12602,"toc":12795},[12603,12608,12618,12622,12627,12688,12692,12697,12748,12752,12757,12790],{"type":18,"tag":19,"props":12604,"children":12606},{"id":12605},"stanley-controller",[12607],{"type":24,"value":12598},{"type":18,"tag":27,"props":12609,"children":12610},{},[12611,12612,12616],{"type":24,"value":11077},{"type":18,"tag":170,"props":12613,"children":12614},{},[12615],{"type":24,"value":12598},{"type":24,"value":12617}," is an advanced path-tracking algorithm primarily used in the field of autonomous vehicle navigation. It is named after its creator, Professor John K. Hedrick, who developed it at Stanford University. The Stanley Controller is designed to enable a vehicle to follow a predefined path with high accuracy and stability.",{"type":18,"tag":33,"props":12619,"children":12620},{"id":12381},[12621],{"type":24,"value":12384},{"type":18,"tag":27,"props":12623,"children":12624},{},[12625],{"type":24,"value":12626},"The Stanley Controller operates based on a combination of control and feedback mechanisms:",{"type":18,"tag":280,"props":12628,"children":12629},{},[12630,12639,12649,12659,12669,12678],{"type":18,"tag":80,"props":12631,"children":12632},{},[12633,12637],{"type":18,"tag":170,"props":12634,"children":12635},{},[12636],{"type":24,"value":12400},{"type":24,"value":12638},": A predefined path is represented as a series of waypoints or a continuous curve. Each waypoint is associated with specific coordinates (x, y) and often includes additional information like desired speed and curvature.",{"type":18,"tag":80,"props":12640,"children":12641},{},[12642,12647],{"type":18,"tag":170,"props":12643,"children":12644},{},[12645],{"type":24,"value":12646},"Cross-Track Error (CTE) Calculation",{"type":24,"value":12648},": The controller calculates the cross-track error, which is the perpendicular distance between the vehicle's current position and the desired path. This error represents how far the vehicle has deviated from the path.",{"type":18,"tag":80,"props":12650,"children":12651},{},[12652,12657],{"type":18,"tag":170,"props":12653,"children":12654},{},[12655],{"type":24,"value":12656},"Heading Error Calculation",{"type":24,"value":12658},": The heading error, which is the difference between the vehicle's current heading (yaw angle) and the desired path's tangent angle at the nearest waypoint, is also computed.",{"type":18,"tag":80,"props":12660,"children":12661},{},[12662,12667],{"type":18,"tag":170,"props":12663,"children":12664},{},[12665],{"type":24,"value":12666},"Control Command Generation",{"type":24,"value":12668},": Using the calculated cross-track error and heading error, the Stanley Controller generates control commands. These commands typically include steering angle adjustments and throttle/brake control to minimize both errors.",{"type":18,"tag":80,"props":12670,"children":12671},{},[12672,12676],{"type":18,"tag":170,"props":12673,"children":12674},{},[12675],{"type":24,"value":12430},{"type":24,"value":12677},": The generated control commands are applied to the vehicle's steering and throttle/brake systems to guide it back to the desired path.",{"type":18,"tag":80,"props":12679,"children":12680},{},[12681,12686],{"type":18,"tag":170,"props":12682,"children":12683},{},[12684],{"type":24,"value":12685},"Iterative Feedback",{"type":24,"value":12687},": The process is iterative, with the controller continuously recalculating the cross-track and heading errors and adjusting the control commands to keep the vehicle on track.",{"type":18,"tag":33,"props":12689,"children":12690},{"id":12444},[12691],{"type":24,"value":12447},{"type":18,"tag":27,"props":12693,"children":12694},{},[12695],{"type":24,"value":12696},"The Stanley Controller offers several advantages:",{"type":18,"tag":76,"props":12698,"children":12699},{},[12700,12710,12720,12729,12738],{"type":18,"tag":80,"props":12701,"children":12702},{},[12703,12708],{"type":18,"tag":170,"props":12704,"children":12705},{},[12706],{"type":24,"value":12707},"High Accuracy",{"type":24,"value":12709},": It is known for its ability to achieve precise path-following, even in challenging conditions and complex road geometries.",{"type":18,"tag":80,"props":12711,"children":12712},{},[12713,12718],{"type":18,"tag":170,"props":12714,"children":12715},{},[12716],{"type":24,"value":12717},"Stability",{"type":24,"value":12719},": The controller's feedback mechanisms contribute to stable and smooth vehicle motion, reducing the risk of overshooting or oscillations.",{"type":18,"tag":80,"props":12721,"children":12722},{},[12723,12727],{"type":18,"tag":170,"props":12724,"children":12725},{},[12726],{"type":24,"value":12492},{"type":24,"value":12728},": The Stanley Controller can adapt to changes in the path, such as deviations caused by obstacles or dynamic road conditions.",{"type":18,"tag":80,"props":12730,"children":12731},{},[12732,12736],{"type":18,"tag":170,"props":12733,"children":12734},{},[12735],{"type":24,"value":12482},{"type":24,"value":12737},": It can operate in real-time, making it suitable for autonomous vehicle navigation in dynamic environments.",{"type":18,"tag":80,"props":12739,"children":12740},{},[12741,12746],{"type":18,"tag":170,"props":12742,"children":12743},{},[12744],{"type":24,"value":12745},"Versatility",{"type":24,"value":12747},": While primarily used in autonomous vehicles, the Stanley Controller's principles can be applied to various path-tracking tasks.",{"type":18,"tag":33,"props":12749,"children":12750},{"id":12507},[12751],{"type":24,"value":12510},{"type":18,"tag":27,"props":12753,"children":12754},{},[12755],{"type":24,"value":12756},"Despite its advantages, the Stanley Controller has some limitations:",{"type":18,"tag":76,"props":12758,"children":12759},{},[12760,12770,12780],{"type":18,"tag":80,"props":12761,"children":12762},{},[12763,12768],{"type":18,"tag":170,"props":12764,"children":12765},{},[12766],{"type":24,"value":12767},"Complexity",{"type":24,"value":12769},": Implementing the Stanley Controller can be more complex than some other control algorithms due to its mathematical calculations and tuning requirements.",{"type":18,"tag":80,"props":12771,"children":12772},{},[12773,12778],{"type":18,"tag":170,"props":12774,"children":12775},{},[12776],{"type":24,"value":12777},"Initialization",{"type":24,"value":12779},": It relies on accurate initialization, including knowledge of the vehicle's initial position and heading relative to the path.",{"type":18,"tag":80,"props":12781,"children":12782},{},[12783,12788],{"type":18,"tag":170,"props":12784,"children":12785},{},[12786],{"type":24,"value":12787},"Sensitivity to Noise",{"type":24,"value":12789},": Like many feedback-based controllers, the Stanley Controller can be sensitive to noisy sensor data and require robust sensor fusion techniques.",{"type":18,"tag":27,"props":12791,"children":12792},{},[12793],{"type":24,"value":12794},"In summary, the Stanley Controller is an advanced path-tracking algorithm known for its accuracy and stability, making it a valuable tool in the field of autonomous vehicle navigation. Proper implementation and tuning are essential to harness its full potential.",{"title":8,"searchDepth":659,"depth":659,"links":12796},[12797],{"id":12605,"depth":659,"text":12598,"children":12798},[12799,12800,12801],{"id":12381,"depth":668,"text":12384},{"id":12444,"depth":668,"text":12447},{"id":12507,"depth":668,"text":12510},"content:topics:robotics:stanley-controller.md","topics/robotics/stanley-controller.md",[12805,12951],{"_path":12806,"_dir":12807,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12808,"description":12809,"author":11,"slug":12810,"tag":12810,"img":12811,"body":12812,"_type":6462,"_id":12949,"_source":6464,"_file":12950,"_extension":6466},"/topics/ai/cnn","ai","Convolutional Neural Network","How Convolution Neural Network works.","ai-cnn","/topics/ai/figure-dnn.png",{"type":15,"children":12813,"toc":12945},[12814,12821,12826,12832,12837,12867,12873,12878,12940],{"type":18,"tag":12815,"props":12816,"children":12818},"h1",{"id":12817},"convolutional-neural-network-cnn",[12819],{"type":24,"value":12820},"Convolutional Neural Network (CNN)",{"type":18,"tag":27,"props":12822,"children":12823},{},[12824],{"type":24,"value":12825},"Convolutional Neural Networks (CNNs) are a class of deep learning models primarily used for image and video analysis. They have revolutionized computer vision tasks such as image classification, object detection, and image segmentation. CNNs are designed to automatically learn hierarchical features from input data, which makes them particularly effective for tasks where the spatial relationships in data are essential, like recognizing patterns in images.",{"type":18,"tag":19,"props":12827,"children":12829},{"id":12828},"forward-propagation",[12830],{"type":24,"value":12831},"Forward Propagation",{"type":18,"tag":27,"props":12833,"children":12834},{},[12835],{"type":24,"value":12836},"In the forward propagation phase of a CNN, the input image is convolved with learnable filters, followed by non-linear activation functions like ReLU (Rectified Linear Unit). The output of this convolutional layer is then pooled to reduce dimensionality and make the network translation-invariant. These operations are typically represented mathematically as:",{"type":18,"tag":76,"props":12838,"children":12839},{},[12840,12849,12858],{"type":18,"tag":80,"props":12841,"children":12842},{},[12843,12845],{"type":24,"value":12844},"Convolution: ",{"type":18,"tag":84,"props":12846,"children":12848},{"latex-express":12847,"styles":87}," Z^{[l]} = (W^{[l]} * A^{[l-1]}) + b^{[l]}",[],{"type":18,"tag":80,"props":12850,"children":12851},{},[12852,12854],{"type":24,"value":12853},"Activation: ",{"type":18,"tag":84,"props":12855,"children":12857},{"latex-express":12856,"styles":87},"A^{[l]} = \\text{ReLU}(Z^{[l]})",[],{"type":18,"tag":80,"props":12859,"children":12860},{},[12861,12863],{"type":24,"value":12862},"Pooling: ",{"type":18,"tag":84,"props":12864,"children":12866},{"latex-express":12865,"styles":87},"A^{[l]} = \\text{MaxPooling}(A^{[l-1]})",[],{"type":18,"tag":19,"props":12868,"children":12870},{"id":12869},"backward-propagation",[12871],{"type":24,"value":12872},"Backward Propagation",{"type":18,"tag":27,"props":12874,"children":12875},{},[12876],{"type":24,"value":12877},"Backward propagation is the process of computing gradients with respect to the loss function, which allows the network to update its parameters during training. The gradients are computed using the chain rule of calculus and are used to adjust the convolutional filter weights and biases. The formulas for backward propagation are as follows:",{"type":18,"tag":76,"props":12879,"children":12880},{},[12881,12910,12925],{"type":18,"tag":80,"props":12882,"children":12883},{},[12884,12886],{"type":24,"value":12885},"Convolutional Layer Backpropagation:",{"type":18,"tag":76,"props":12887,"children":12888},{},[12889,12896,12903],{"type":18,"tag":80,"props":12890,"children":12891},{},[12892],{"type":18,"tag":84,"props":12893,"children":12895},{"latex-express":12894,"styles":87}," \\frac{\\partial \\mathcal{L}}{\\partial W^{[l]}} = dZ^{[l]} * A^{[l-1]T}  ",[],{"type":18,"tag":80,"props":12897,"children":12898},{},[12899],{"type":18,"tag":84,"props":12900,"children":12902},{"latex-express":12901,"styles":87}," \\frac{\\partial \\mathcal{L}}{\\partial b^{[l]}} = \\sum dZ^{[l]} ",[],{"type":18,"tag":80,"props":12904,"children":12905},{},[12906],{"type":18,"tag":84,"props":12907,"children":12909},{"latex-express":12908,"styles":87}," \\frac{\\partial \\mathcal{L}}{\\partial A^{[l-1]}} = W^{[l]T} * dZ^{[l]} ",[],{"type":18,"tag":80,"props":12911,"children":12912},{},[12913,12915],{"type":24,"value":12914},"Activation Layer Backpropagation (ReLU):",{"type":18,"tag":76,"props":12916,"children":12917},{},[12918],{"type":18,"tag":80,"props":12919,"children":12920},{},[12921],{"type":18,"tag":84,"props":12922,"children":12924},{"latex-express":12923,"styles":87}," \\frac{\\partial \\mathcal{L}}{\\partial Z^{[l]}} = dA^{[l]} \\odot \\text{ReLU}'(Z^{[l]})",[],{"type":18,"tag":80,"props":12926,"children":12927},{},[12928,12930],{"type":24,"value":12929},"Pooling Layer Backpropagation:",{"type":18,"tag":76,"props":12931,"children":12932},{},[12933],{"type":18,"tag":80,"props":12934,"children":12935},{},[12936],{"type":18,"tag":84,"props":12937,"children":12939},{"latex-express":12938,"styles":87}," \\frac{\\partial \\mathcal{L}}{\\partial A^{[l-1]}} = \\text{upsample}(dA^{[l]})",[],{"type":18,"tag":27,"props":12941,"children":12942},{},[12943],{"type":24,"value":12944},"These gradients are then used to update the network's parameters via optimization algorithms like gradient descent, enabling the CNN to learn and improve its performance over time through the training process.",{"title":8,"searchDepth":659,"depth":659,"links":12946},[12947,12948],{"id":12828,"depth":659,"text":12831},{"id":12869,"depth":659,"text":12872},"content:topics:ai:cnn.md","topics/ai/cnn.md",{"_path":12952,"_dir":12807,"_draft":7,"_partial":7,"_locale":8,"_empty":7,"title":12953,"description":12954,"author":11,"slug":12955,"tag":12955,"img":6472,"body":12956,"_type":6462,"_id":14389,"_source":6464,"_file":14390,"_extension":6466},"/topics/ai/linear-mpc","Linear Model Predictive Control","Introduction to Linear Model Predictive Control","linear-mpc",{"type":15,"children":12957,"toc":14379},[12958,12962,12966,12980,12986,12990,12995,13000,13008,13013,13017,13021,13026,13030,13034,13067,13073,13077,13086,13091,13097,13111,13119,13124,13189,13194,13368,13380,13589,13599,14024,14041,14250,14255,14332,14344,14348,14353,14357,14375],{"type":18,"tag":19,"props":12959,"children":12960},{"id":35},[12961],{"type":24,"value":38},{"type":18,"tag":27,"props":12963,"children":12964},{},[12965],{"type":24,"value":43},{"type":18,"tag":6484,"props":12967,"children":12969},{"className":12968},[6487,6488,6489,6490,6491],[12970,12976],{"type":18,"tag":6320,"props":12971,"children":12975},{"className":12972,"src":6472,"width":12973,"height":12974},[6323],"600px","300px",[],{"type":18,"tag":6320,"props":12977,"children":12979},{"className":12978,"src":6502,"width":12973,"height":12974},[6323],[],{"type":18,"tag":6329,"props":12981,"children":12983},{"className":12982},[68,6332,6333,6334],[12984],{"type":24,"value":12985},"\n      A car with finite horizons prediction and set point prediction over finite horizons.\n",{"type":18,"tag":19,"props":12987,"children":12988},{"id":10482},[12989],{"type":24,"value":10485},{"type":18,"tag":27,"props":12991,"children":12992},{},[12993],{"type":24,"value":12994},"It works by solving the cost function that is produced by the sum of quadratic costs. For example, imagine you are riding a bike, and you want to get an ice cream because it is summer, and it tastes good 😆. So, to get the ice cream, you need to grab your bike and ride it to the mart to buy one. What does it take to get you from your home to the mart store? Of course, it must be the energy produced by your muscles to pedal the bike and move. Another way to think about it is the cost of how the system would react to the desired position or point that you want it to reach. MPC have two types, they are Linear MPC and Nonlinear MPC. In this blog, we will only talk about Linear MPC.",{"type":18,"tag":19,"props":12996,"children":12997},{"id":12955},[12998],{"type":24,"value":12999},"Linear MPC",{"type":18,"tag":27,"props":13001,"children":13002},{},[13003,13005],{"type":24,"value":13004},"Linear MPC or Linear Model Predictive Control is an optimal control method that use with the system that it behavors linearly. It means that we can easily control this system with lost cost computation of the optimization and also ensure the lower risk of the system too!. ",{"type":18,"tag":56,"props":13006,"children":13007},{},[],{"type":18,"tag":27,"props":13009,"children":13010},{},[13011],{"type":24,"value":13012},"Here is the formulation of the linear discrete system.",{"type":18,"tag":84,"props":13014,"children":13016},{":dist-cond":6689,":latex-express":13015,":styles":68}," \\begin{equation*} X_{k+1}=AX_{k}+BU_{k} \\end{equation*}",[],{"type":18,"tag":19,"props":13018,"children":13019},{"id":10493},[13020],{"type":24,"value":10496},{"type":18,"tag":27,"props":13022,"children":13023},{},[13024],{"type":24,"value":13025},"As I mentioned, this is quadratic cost. It consists of summation of all the cost that was produced over the number of horizontal prediction.",{"type":18,"tag":84,"props":13027,"children":13029},{"latex-express":13028,"styles":68},"J(x,u) = \\displaystyle\\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N}, U_{N})",[],{"type":18,"tag":27,"props":13031,"children":13032},{},[13033],{"type":24,"value":6552},{"type":18,"tag":76,"props":13035,"children":13036},{},[13037,13046,13053,13060],{"type":18,"tag":80,"props":13038,"children":13039},{},[13040,13044],{"type":18,"tag":84,"props":13041,"children":13043},{"latex-express":6561,"styles":13042},"inline-flex space-x-3",[],{"type":24,"value":13045}," is the state of the system. This shall be obtained from the optimiztion problem",{"type":18,"tag":80,"props":13047,"children":13048},{},[13049,13052],{"type":18,"tag":84,"props":13050,"children":13051},{"latex-express":6570,"styles":13042},[],{"type":24,"value":6573},{"type":18,"tag":80,"props":13054,"children":13055},{},[13056,13059],{"type":18,"tag":84,"props":13057,"children":13058},{"latex-express":6579,"styles":13042},[],{"type":24,"value":6582},{"type":18,"tag":80,"props":13061,"children":13062},{},[13063,13066],{"type":18,"tag":84,"props":13064,"children":13065},{"latex-express":6588,"styles":13042},[],{"type":24,"value":6591},{"type":18,"tag":19,"props":13068,"children":13070},{"id":13069},"was-it-really-that-good",[13071],{"type":24,"value":13072},"Was it really that good ?",{"type":18,"tag":27,"props":13074,"children":13075},{},[13076],{"type":24,"value":10373},{"type":18,"tag":6310,"props":13078,"children":13080},{"className":13079},[6313,6314,6315],[13081,13082],{"type":24,"value":6318},{"type":18,"tag":6320,"props":13083,"children":13085},{"className":13084,"src":10382,"width":12973,"height":12974},[6323],[],{"type":18,"tag":6329,"props":13087,"children":13089},{"className":13088},[68,6332,6333,6334],[13090],{"type":24,"value":10389},{"type":18,"tag":19,"props":13092,"children":13094},{"id":13093},"how-to-implement-it-in-python",[13095],{"type":24,"value":13096},"How to implement it in Python?",{"type":18,"tag":27,"props":13098,"children":13099},{},[13100,13102,13107,13108],{"type":24,"value":13101},"There are so many great way to implement this control everywhere with many mathematical optimization library!!!. But for the sake of god, I use Casadi and CVXPY which I think one of the most easy tool to use. I will draft some python code here, but I cannot include them all in this post. You can check it more on my github repository, I do open-source some of my work !!! ",{"type":18,"tag":6367,"props":13103,"children":13105},{"href":10434,"rel":13104},[6371],[13106],{"type":24,"value":12247},{"type":24,"value":176},{"type":18,"tag":56,"props":13109,"children":13110},{},[],{"type":18,"tag":27,"props":13112,"children":13113},{},[13114,13116],{"type":24,"value":13115},"I recommend you guys to have your own virtual enviroment, so I would be easier to work with any other related project of control system. ",{"type":18,"tag":56,"props":13117,"children":13118},{},[],{"type":18,"tag":27,"props":13120,"children":13121},{},[13122],{"type":24,"value":13123},"Make sure that you have install.",{"type":18,"tag":614,"props":13125,"children":13130},{"className":13126,"code":13128,"language":13129,"meta":8},[13127],"language-bash","pip3 install casadi && pip3 install cvxpy\n","bash",[13131],{"type":18,"tag":622,"props":13132,"children":13133},{},[13134],{"type":18,"tag":614,"props":13135,"children":13136},{"__ignoreMap":8},[13137],{"type":18,"tag":629,"props":13138,"children":13139},{"class":631,"line":632},[13140,13145,13149,13154,13158,13163,13168,13172,13176,13180,13184],{"type":18,"tag":629,"props":13141,"children":13142},{"class":648},[13143],{"type":24,"value":13144},"pip3",{"type":18,"tag":629,"props":13146,"children":13147},{"class":642},[13148],{"type":24,"value":645},{"type":18,"tag":629,"props":13150,"children":13151},{"class":5364},[13152],{"type":24,"value":13153},"install",{"type":18,"tag":629,"props":13155,"children":13156},{"class":642},[13157],{"type":24,"value":645},{"type":18,"tag":629,"props":13159,"children":13160},{"class":5364},[13161],{"type":24,"value":13162},"casadi",{"type":18,"tag":629,"props":13164,"children":13165},{"class":642},[13166],{"type":24,"value":13167}," && ",{"type":18,"tag":629,"props":13169,"children":13170},{"class":648},[13171],{"type":24,"value":13144},{"type":18,"tag":629,"props":13173,"children":13174},{"class":642},[13175],{"type":24,"value":645},{"type":18,"tag":629,"props":13177,"children":13178},{"class":5364},[13179],{"type":24,"value":13153},{"type":18,"tag":629,"props":13181,"children":13182},{"class":642},[13183],{"type":24,"value":645},{"type":18,"tag":629,"props":13185,"children":13186},{"class":5364},[13187],{"type":24,"value":13188},"cvxpy",{"type":18,"tag":27,"props":13190,"children":13191},{},[13192],{"type":24,"value":13193},"It is a good idea to write your robot model as a class object in Python, because it can help handle the update state of your system. For me, I am gonna use Numpy for mathematical operation.",{"type":18,"tag":614,"props":13195,"children":13198},{"className":13196,"code":13197,"language":619,"meta":8},[617],"import numpy as np\n\nclass DifferentialDrive:\n\n    def forward_kinematic(self, yaw, v, omega):\n        vx = v * np.cos(yaw)\n        vy = v * np.sin(yaw)\n        vyaw = omega\n\n        return vx, vy, vyaw\n",[13199],{"type":18,"tag":622,"props":13200,"children":13201},{},[13202],{"type":18,"tag":614,"props":13203,"children":13204},{"__ignoreMap":8},[13205,13224,13231,13250,13257,13281,13306,13330,13345,13352],{"type":18,"tag":629,"props":13206,"children":13207},{"class":631,"line":632},[13208,13212,13216,13220],{"type":18,"tag":629,"props":13209,"children":13210},{"class":636},[13211],{"type":24,"value":6727},{"type":18,"tag":629,"props":13213,"children":13214},{"class":642},[13215],{"type":24,"value":6732},{"type":18,"tag":629,"props":13217,"children":13218},{"class":636},[13219],{"type":24,"value":6737},{"type":18,"tag":629,"props":13221,"children":13222},{"class":642},[13223],{"type":24,"value":6742},{"type":18,"tag":629,"props":13225,"children":13226},{"class":631,"line":659},[13227],{"type":18,"tag":629,"props":13228,"children":13229},{},[13230],{"type":24,"value":665},{"type":18,"tag":629,"props":13232,"children":13233},{"class":631,"line":668},[13234,13238,13242,13246],{"type":18,"tag":629,"props":13235,"children":13236},{"class":636},[13237],{"type":24,"value":639},{"type":18,"tag":629,"props":13239,"children":13240},{"class":642},[13241],{"type":24,"value":645},{"type":18,"tag":629,"props":13243,"children":13244},{"class":648},[13245],{"type":24,"value":10697},{"type":18,"tag":629,"props":13247,"children":13248},{"class":642},[13249],{"type":24,"value":656},{"type":18,"tag":629,"props":13251,"children":13252},{"class":631,"line":697},[13253],{"type":18,"tag":629,"props":13254,"children":13255},{},[13256],{"type":24,"value":665},{"type":18,"tag":629,"props":13258,"children":13259},{"class":631,"line":705},[13260,13264,13268,13272,13276],{"type":18,"tag":629,"props":13261,"children":13262},{"class":642},[13263],{"type":24,"value":674},{"type":18,"tag":629,"props":13265,"children":13266},{"class":636},[13267],{"type":24,"value":679},{"type":18,"tag":629,"props":13269,"children":13270},{"class":642},[13271],{"type":24,"value":645},{"type":18,"tag":629,"props":13273,"children":13274},{"class":648},[13275],{"type":24,"value":10802},{"type":18,"tag":629,"props":13277,"children":13278},{"class":642},[13279],{"type":24,"value":13280},"(self, yaw, v, omega):\n",{"type":18,"tag":629,"props":13282,"children":13283},{"class":631,"line":734},[13284,13288,13292,13297,13301],{"type":18,"tag":629,"props":13285,"children":13286},{"class":642},[13287],{"type":24,"value":10815},{"type":18,"tag":629,"props":13289,"children":13290},{"class":636},[13291],{"type":24,"value":726},{"type":18,"tag":629,"props":13293,"children":13294},{"class":642},[13295],{"type":24,"value":13296}," v ",{"type":18,"tag":629,"props":13298,"children":13299},{"class":636},[13300],{"type":24,"value":1071},{"type":18,"tag":629,"props":13302,"children":13303},{"class":642},[13304],{"type":24,"value":13305}," np.cos(yaw)\n",{"type":18,"tag":629,"props":13307,"children":13308},{"class":631,"line":760},[13309,13313,13317,13321,13325],{"type":18,"tag":629,"props":13310,"children":13311},{"class":642},[13312],{"type":24,"value":10840},{"type":18,"tag":629,"props":13314,"children":13315},{"class":636},[13316],{"type":24,"value":726},{"type":18,"tag":629,"props":13318,"children":13319},{"class":642},[13320],{"type":24,"value":13296},{"type":18,"tag":629,"props":13322,"children":13323},{"class":636},[13324],{"type":24,"value":1071},{"type":18,"tag":629,"props":13326,"children":13327},{"class":642},[13328],{"type":24,"value":13329}," np.sin(yaw)\n",{"type":18,"tag":629,"props":13331,"children":13332},{"class":631,"line":786},[13333,13337,13341],{"type":18,"tag":629,"props":13334,"children":13335},{"class":642},[13336],{"type":24,"value":10865},{"type":18,"tag":629,"props":13338,"children":13339},{"class":636},[13340],{"type":24,"value":726},{"type":18,"tag":629,"props":13342,"children":13343},{"class":642},[13344],{"type":24,"value":10874},{"type":18,"tag":629,"props":13346,"children":13347},{"class":631,"line":794},[13348],{"type":18,"tag":629,"props":13349,"children":13350},{},[13351],{"type":24,"value":665},{"type":18,"tag":629,"props":13353,"children":13354},{"class":631,"line":820},[13355,13359,13363],{"type":18,"tag":629,"props":13356,"children":13357},{"class":642},[13358],{"type":24,"value":711},{"type":18,"tag":629,"props":13360,"children":13361},{"class":636},[13362],{"type":24,"value":1235},{"type":18,"tag":629,"props":13364,"children":13365},{"class":642},[13366],{"type":24,"value":13367}," vx, vy, vyaw",{"type":18,"tag":27,"props":13369,"children":13370},{},[13371,13373,13378],{"type":24,"value":13372},"Next add this update state function into our ",{"type":18,"tag":170,"props":13374,"children":13375},{},[13376],{"type":24,"value":13377},"DifferentialDrive ",{"type":24,"value":13379}," class, by doing this we would have all the attribute of our robot system.",{"type":18,"tag":614,"props":13381,"children":13384},{"className":13382,"code":13383,"language":619,"meta":8},[617],"def update_state(self, x0, y0, yaw0, yaw, v, omega):\n\n  dx, dy, dyaw = self.robot_model.forward_kinematic(yaw, v, omega)\n\n  x_next = x0 + dx*self.dtau\n  y_next = y0 + dy*self.dtau\n  yaw_next = yaw0 + dyaw*self.dtau\n\n  return x_next, y_next, yaw_next\n",[13385],{"type":18,"tag":622,"props":13386,"children":13387},{},[13388],{"type":18,"tag":614,"props":13389,"children":13390},{"__ignoreMap":8},[13391,13412,13419,13444,13451,13490,13528,13566,13573],{"type":18,"tag":629,"props":13392,"children":13393},{"class":631,"line":632},[13394,13398,13402,13407],{"type":18,"tag":629,"props":13395,"children":13396},{"class":636},[13397],{"type":24,"value":679},{"type":18,"tag":629,"props":13399,"children":13400},{"class":642},[13401],{"type":24,"value":645},{"type":18,"tag":629,"props":13403,"children":13404},{"class":648},[13405],{"type":24,"value":13406},"update_state",{"type":18,"tag":629,"props":13408,"children":13409},{"class":642},[13410],{"type":24,"value":13411},"(self, x0, y0, yaw0, yaw, v, omega):\n",{"type":18,"tag":629,"props":13413,"children":13414},{"class":631,"line":659},[13415],{"type":18,"tag":629,"props":13416,"children":13417},{},[13418],{"type":24,"value":665},{"type":18,"tag":629,"props":13420,"children":13421},{"class":631,"line":668},[13422,13427,13431,13435,13439],{"type":18,"tag":629,"props":13423,"children":13424},{"class":642},[13425],{"type":24,"value":13426},"  dx, dy, dyaw ",{"type":18,"tag":629,"props":13428,"children":13429},{"class":636},[13430],{"type":24,"value":726},{"type":18,"tag":629,"props":13432,"children":13433},{"class":642},[13434],{"type":24,"value":645},{"type":18,"tag":629,"props":13436,"children":13437},{"class":686},[13438],{"type":24,"value":716},{"type":18,"tag":629,"props":13440,"children":13441},{"class":642},[13442],{"type":24,"value":13443},".robot_model.forward_kinematic(yaw, v, omega)\n",{"type":18,"tag":629,"props":13445,"children":13446},{"class":631,"line":697},[13447],{"type":18,"tag":629,"props":13448,"children":13449},{},[13450],{"type":24,"value":665},{"type":18,"tag":629,"props":13452,"children":13453},{"class":631,"line":705},[13454,13459,13463,13468,13472,13477,13481,13485],{"type":18,"tag":629,"props":13455,"children":13456},{"class":642},[13457],{"type":24,"value":13458},"  x_next ",{"type":18,"tag":629,"props":13460,"children":13461},{"class":636},[13462],{"type":24,"value":726},{"type":18,"tag":629,"props":13464,"children":13465},{"class":642},[13466],{"type":24,"value":13467}," x0 ",{"type":18,"tag":629,"props":13469,"children":13470},{"class":636},[13471],{"type":24,"value":1192},{"type":18,"tag":629,"props":13473,"children":13474},{"class":642},[13475],{"type":24,"value":13476}," dx",{"type":18,"tag":629,"props":13478,"children":13479},{"class":636},[13480],{"type":24,"value":1071},{"type":18,"tag":629,"props":13482,"children":13483},{"class":686},[13484],{"type":24,"value":716},{"type":18,"tag":629,"props":13486,"children":13487},{"class":642},[13488],{"type":24,"value":13489},".dtau\n",{"type":18,"tag":629,"props":13491,"children":13492},{"class":631,"line":734},[13493,13498,13502,13507,13511,13516,13520,13524],{"type":18,"tag":629,"props":13494,"children":13495},{"class":642},[13496],{"type":24,"value":13497},"  y_next ",{"type":18,"tag":629,"props":13499,"children":13500},{"class":636},[13501],{"type":24,"value":726},{"type":18,"tag":629,"props":13503,"children":13504},{"class":642},[13505],{"type":24,"value":13506}," y0 ",{"type":18,"tag":629,"props":13508,"children":13509},{"class":636},[13510],{"type":24,"value":1192},{"type":18,"tag":629,"props":13512,"children":13513},{"class":642},[13514],{"type":24,"value":13515}," dy",{"type":18,"tag":629,"props":13517,"children":13518},{"class":636},[13519],{"type":24,"value":1071},{"type":18,"tag":629,"props":13521,"children":13522},{"class":686},[13523],{"type":24,"value":716},{"type":18,"tag":629,"props":13525,"children":13526},{"class":642},[13527],{"type":24,"value":13489},{"type":18,"tag":629,"props":13529,"children":13530},{"class":631,"line":760},[13531,13536,13540,13545,13549,13554,13558,13562],{"type":18,"tag":629,"props":13532,"children":13533},{"class":642},[13534],{"type":24,"value":13535},"  yaw_next ",{"type":18,"tag":629,"props":13537,"children":13538},{"class":636},[13539],{"type":24,"value":726},{"type":18,"tag":629,"props":13541,"children":13542},{"class":642},[13543],{"type":24,"value":13544}," yaw0 ",{"type":18,"tag":629,"props":13546,"children":13547},{"class":636},[13548],{"type":24,"value":1192},{"type":18,"tag":629,"props":13550,"children":13551},{"class":642},[13552],{"type":24,"value":13553}," dyaw",{"type":18,"tag":629,"props":13555,"children":13556},{"class":636},[13557],{"type":24,"value":1071},{"type":18,"tag":629,"props":13559,"children":13560},{"class":686},[13561],{"type":24,"value":716},{"type":18,"tag":629,"props":13563,"children":13564},{"class":642},[13565],{"type":24,"value":13489},{"type":18,"tag":629,"props":13567,"children":13568},{"class":631,"line":786},[13569],{"type":18,"tag":629,"props":13570,"children":13571},{},[13572],{"type":24,"value":665},{"type":18,"tag":629,"props":13574,"children":13575},{"class":631,"line":794},[13576,13581,13585],{"type":18,"tag":629,"props":13577,"children":13578},{"class":642},[13579],{"type":24,"value":13580},"  ",{"type":18,"tag":629,"props":13582,"children":13583},{"class":636},[13584],{"type":24,"value":1235},{"type":18,"tag":629,"props":13586,"children":13587},{"class":642},[13588],{"type":24,"value":11072},{"type":18,"tag":27,"props":13590,"children":13591},{},[13592,13594,13597],{"type":24,"value":13593},"How to define the quadratic cost in Python with CVXPY ? and set the constraint for your system ? ",{"type":18,"tag":56,"props":13595,"children":13596},{},[],{"type":24,"value":13598},"\nHere, how you would write it.",{"type":18,"tag":614,"props":13600,"children":13603},{"className":13601,"code":13602,"language":619,"meta":8},[617],"for t in range(T):\n    cost += cvxpy.quad_form(u[:, t], R)\n\n    if t != 0:\n        cost += cvxpy.quad_form(x_ref[:, t] - x[:, t], Q)\n\n    A, B, C = get_linear_model_matrix(x_ref, u_ref)\n    constraints += [x[:, t + 1] == A @ x[:, t] + B @ u[:, t] + C]\n\n    if t \u003C (T - 1):\n        cost += cvxpy.quad_form(u[:, t + 1] - u[:, t], Rd)\n        constraints += [cvxpy.abs(u[1, t + 1] - u[1, t]) \u003C= DESIRED_CONTROL]\n\ncost += cvxpy.quad_form(xref[:, T] - x[:, T], Q)\n",[13604],{"type":18,"tag":622,"props":13605,"children":13606},{},[13607],{"type":18,"tag":614,"props":13608,"children":13609},{"__ignoreMap":8},[13610,13639,13656,13663,13695,13721,13728,13745,13824,13831,13872,13913,13991,13998],{"type":18,"tag":629,"props":13611,"children":13612},{"class":631,"line":632},[13613,13617,13622,13626,13630,13634],{"type":18,"tag":629,"props":13614,"children":13615},{"class":636},[13616],{"type":24,"value":2805},{"type":18,"tag":629,"props":13618,"children":13619},{"class":642},[13620],{"type":24,"value":13621}," t ",{"type":18,"tag":629,"props":13623,"children":13624},{"class":636},[13625],{"type":24,"value":2815},{"type":18,"tag":629,"props":13627,"children":13628},{"class":642},[13629],{"type":24,"value":645},{"type":18,"tag":629,"props":13631,"children":13632},{"class":686},[13633],{"type":24,"value":2824},{"type":18,"tag":629,"props":13635,"children":13636},{"class":642},[13637],{"type":24,"value":13638},"(T):\n",{"type":18,"tag":629,"props":13640,"children":13641},{"class":631,"line":659},[13642,13647,13651],{"type":18,"tag":629,"props":13643,"children":13644},{"class":642},[13645],{"type":24,"value":13646},"    cost ",{"type":18,"tag":629,"props":13648,"children":13649},{"class":636},[13650],{"type":24,"value":7527},{"type":18,"tag":629,"props":13652,"children":13653},{"class":642},[13654],{"type":24,"value":13655}," cvxpy.quad_form(u[:, t], R)\n",{"type":18,"tag":629,"props":13657,"children":13658},{"class":631,"line":668},[13659],{"type":18,"tag":629,"props":13660,"children":13661},{},[13662],{"type":24,"value":665},{"type":18,"tag":629,"props":13664,"children":13665},{"class":631,"line":697},[13666,13670,13674,13678,13683,13687,13691],{"type":18,"tag":629,"props":13667,"children":13668},{"class":642},[13669],{"type":24,"value":674},{"type":18,"tag":629,"props":13671,"children":13672},{"class":636},[13673],{"type":24,"value":11998},{"type":18,"tag":629,"props":13675,"children":13676},{"class":642},[13677],{"type":24,"value":13621},{"type":18,"tag":629,"props":13679,"children":13680},{"class":636},[13681],{"type":24,"value":13682},"!=",{"type":18,"tag":629,"props":13684,"children":13685},{"class":642},[13686],{"type":24,"value":645},{"type":18,"tag":629,"props":13688,"children":13689},{"class":686},[13690],{"type":24,"value":882},{"type":18,"tag":629,"props":13692,"children":13693},{"class":642},[13694],{"type":24,"value":656},{"type":18,"tag":629,"props":13696,"children":13697},{"class":631,"line":705},[13698,13703,13707,13712,13716],{"type":18,"tag":629,"props":13699,"children":13700},{"class":642},[13701],{"type":24,"value":13702},"        cost ",{"type":18,"tag":629,"props":13704,"children":13705},{"class":636},[13706],{"type":24,"value":7527},{"type":18,"tag":629,"props":13708,"children":13709},{"class":642},[13710],{"type":24,"value":13711}," cvxpy.quad_form(x_ref[:, t] ",{"type":18,"tag":629,"props":13713,"children":13714},{"class":636},[13715],{"type":24,"value":1061},{"type":18,"tag":629,"props":13717,"children":13718},{"class":642},[13719],{"type":24,"value":13720}," x[:, t], Q)\n",{"type":18,"tag":629,"props":13722,"children":13723},{"class":631,"line":734},[13724],{"type":18,"tag":629,"props":13725,"children":13726},{},[13727],{"type":24,"value":665},{"type":18,"tag":629,"props":13729,"children":13730},{"class":631,"line":760},[13731,13736,13740],{"type":18,"tag":629,"props":13732,"children":13733},{"class":642},[13734],{"type":24,"value":13735},"    A, B, C ",{"type":18,"tag":629,"props":13737,"children":13738},{"class":636},[13739],{"type":24,"value":726},{"type":18,"tag":629,"props":13741,"children":13742},{"class":642},[13743],{"type":24,"value":13744}," get_linear_model_matrix(x_ref, u_ref)\n",{"type":18,"tag":629,"props":13746,"children":13747},{"class":631,"line":786},[13748,13753,13757,13762,13766,13770,13774,13778,13782,13787,13792,13797,13801,13806,13810,13815,13819],{"type":18,"tag":629,"props":13749,"children":13750},{"class":642},[13751],{"type":24,"value":13752},"    constraints ",{"type":18,"tag":629,"props":13754,"children":13755},{"class":636},[13756],{"type":24,"value":7527},{"type":18,"tag":629,"props":13758,"children":13759},{"class":642},[13760],{"type":24,"value":13761}," [x[:, t ",{"type":18,"tag":629,"props":13763,"children":13764},{"class":636},[13765],{"type":24,"value":1192},{"type":18,"tag":629,"props":13767,"children":13768},{"class":642},[13769],{"type":24,"value":645},{"type":18,"tag":629,"props":13771,"children":13772},{"class":686},[13773],{"type":24,"value":992},{"type":18,"tag":629,"props":13775,"children":13776},{"class":642},[13777],{"type":24,"value":2926},{"type":18,"tag":629,"props":13779,"children":13780},{"class":636},[13781],{"type":24,"value":12008},{"type":18,"tag":629,"props":13783,"children":13784},{"class":642},[13785],{"type":24,"value":13786}," A ",{"type":18,"tag":629,"props":13788,"children":13789},{"class":636},[13790],{"type":24,"value":13791},"@",{"type":18,"tag":629,"props":13793,"children":13794},{"class":642},[13795],{"type":24,"value":13796}," x[:, t] ",{"type":18,"tag":629,"props":13798,"children":13799},{"class":636},[13800],{"type":24,"value":1192},{"type":18,"tag":629,"props":13802,"children":13803},{"class":642},[13804],{"type":24,"value":13805}," B ",{"type":18,"tag":629,"props":13807,"children":13808},{"class":636},[13809],{"type":24,"value":13791},{"type":18,"tag":629,"props":13811,"children":13812},{"class":642},[13813],{"type":24,"value":13814}," u[:, t] ",{"type":18,"tag":629,"props":13816,"children":13817},{"class":636},[13818],{"type":24,"value":1192},{"type":18,"tag":629,"props":13820,"children":13821},{"class":642},[13822],{"type":24,"value":13823}," C]\n",{"type":18,"tag":629,"props":13825,"children":13826},{"class":631,"line":794},[13827],{"type":18,"tag":629,"props":13828,"children":13829},{},[13830],{"type":24,"value":665},{"type":18,"tag":629,"props":13832,"children":13833},{"class":631,"line":820},[13834,13838,13842,13846,13851,13856,13860,13864,13868],{"type":18,"tag":629,"props":13835,"children":13836},{"class":642},[13837],{"type":24,"value":674},{"type":18,"tag":629,"props":13839,"children":13840},{"class":636},[13841],{"type":24,"value":11998},{"type":18,"tag":629,"props":13843,"children":13844},{"class":642},[13845],{"type":24,"value":13621},{"type":18,"tag":629,"props":13847,"children":13848},{"class":636},[13849],{"type":24,"value":13850},"\u003C",{"type":18,"tag":629,"props":13852,"children":13853},{"class":642},[13854],{"type":24,"value":13855}," (T ",{"type":18,"tag":629,"props":13857,"children":13858},{"class":636},[13859],{"type":24,"value":1061},{"type":18,"tag":629,"props":13861,"children":13862},{"class":642},[13863],{"type":24,"value":645},{"type":18,"tag":629,"props":13865,"children":13866},{"class":686},[13867],{"type":24,"value":992},{"type":18,"tag":629,"props":13869,"children":13870},{"class":642},[13871],{"type":24,"value":5513},{"type":18,"tag":629,"props":13873,"children":13874},{"class":631,"line":846},[13875,13879,13883,13888,13892,13896,13900,13904,13908],{"type":18,"tag":629,"props":13876,"children":13877},{"class":642},[13878],{"type":24,"value":13702},{"type":18,"tag":629,"props":13880,"children":13881},{"class":636},[13882],{"type":24,"value":7527},{"type":18,"tag":629,"props":13884,"children":13885},{"class":642},[13886],{"type":24,"value":13887}," cvxpy.quad_form(u[:, t ",{"type":18,"tag":629,"props":13889,"children":13890},{"class":636},[13891],{"type":24,"value":1192},{"type":18,"tag":629,"props":13893,"children":13894},{"class":642},[13895],{"type":24,"value":645},{"type":18,"tag":629,"props":13897,"children":13898},{"class":686},[13899],{"type":24,"value":992},{"type":18,"tag":629,"props":13901,"children":13902},{"class":642},[13903],{"type":24,"value":2926},{"type":18,"tag":629,"props":13905,"children":13906},{"class":636},[13907],{"type":24,"value":1061},{"type":18,"tag":629,"props":13909,"children":13910},{"class":642},[13911],{"type":24,"value":13912}," u[:, t], Rd)\n",{"type":18,"tag":629,"props":13914,"children":13915},{"class":631,"line":854},[13916,13921,13925,13930,13934,13939,13943,13947,13951,13955,13959,13964,13968,13973,13978,13982,13987],{"type":18,"tag":629,"props":13917,"children":13918},{"class":642},[13919],{"type":24,"value":13920},"        constraints ",{"type":18,"tag":629,"props":13922,"children":13923},{"class":636},[13924],{"type":24,"value":7527},{"type":18,"tag":629,"props":13926,"children":13927},{"class":642},[13928],{"type":24,"value":13929}," [cvxpy.abs(u[",{"type":18,"tag":629,"props":13931,"children":13932},{"class":686},[13933],{"type":24,"value":992},{"type":18,"tag":629,"props":13935,"children":13936},{"class":642},[13937],{"type":24,"value":13938},", t ",{"type":18,"tag":629,"props":13940,"children":13941},{"class":636},[13942],{"type":24,"value":1192},{"type":18,"tag":629,"props":13944,"children":13945},{"class":642},[13946],{"type":24,"value":645},{"type":18,"tag":629,"props":13948,"children":13949},{"class":686},[13950],{"type":24,"value":992},{"type":18,"tag":629,"props":13952,"children":13953},{"class":642},[13954],{"type":24,"value":2926},{"type":18,"tag":629,"props":13956,"children":13957},{"class":636},[13958],{"type":24,"value":1061},{"type":18,"tag":629,"props":13960,"children":13961},{"class":642},[13962],{"type":24,"value":13963}," u[",{"type":18,"tag":629,"props":13965,"children":13966},{"class":686},[13967],{"type":24,"value":992},{"type":18,"tag":629,"props":13969,"children":13970},{"class":642},[13971],{"type":24,"value":13972},", t]) ",{"type":18,"tag":629,"props":13974,"children":13975},{"class":636},[13976],{"type":24,"value":13977},"\u003C=",{"type":18,"tag":629,"props":13979,"children":13980},{"class":642},[13981],{"type":24,"value":645},{"type":18,"tag":629,"props":13983,"children":13984},{"class":686},[13985],{"type":24,"value":13986},"DESIRED_CONTROL",{"type":18,"tag":629,"props":13988,"children":13989},{"class":642},[13990],{"type":24,"value":887},{"type":18,"tag":629,"props":13992,"children":13993},{"class":631,"line":890},[13994],{"type":18,"tag":629,"props":13995,"children":13996},{},[13997],{"type":24,"value":665},{"type":18,"tag":629,"props":13999,"children":14000},{"class":631,"line":923},[14001,14006,14010,14015,14019],{"type":18,"tag":629,"props":14002,"children":14003},{"class":642},[14004],{"type":24,"value":14005},"cost ",{"type":18,"tag":629,"props":14007,"children":14008},{"class":636},[14009],{"type":24,"value":7527},{"type":18,"tag":629,"props":14011,"children":14012},{"class":642},[14013],{"type":24,"value":14014}," cvxpy.quad_form(xref[:, T] ",{"type":18,"tag":629,"props":14016,"children":14017},{"class":636},[14018],{"type":24,"value":1061},{"type":18,"tag":629,"props":14020,"children":14021},{"class":642},[14022],{"type":24,"value":14023}," x[:, T], Q)",{"type":18,"tag":27,"props":14025,"children":14026},{},[14027,14029,14034,14036,14039],{"type":24,"value":14028},"The function ",{"type":18,"tag":170,"props":14030,"children":14031},{},[14032],{"type":24,"value":14033}," get_linear_model_matrix ",{"type":24,"value":14035}," would return the linearized model as the shown as the formula above. ",{"type":18,"tag":56,"props":14037,"children":14038},{},[],{"type":24,"value":14040},"\nWe can set more constraint by adding",{"type":18,"tag":614,"props":14042,"children":14045},{"className":14043,"code":14044,"language":619,"meta":8},[617],"  constraints += [x[:, 0] == x0]\n  constraints += [x[2, :] \u003C= MAX_SPEED]\n  constraints += [x[2, :] >= MIN_SPEED]\n  constraints += [cvxpy.abs(u[0, :]) \u003C= MAX_ACCEL]\n  constraints += [cvxpy.abs(u[1, :]) \u003C= MAX_STEER]\n",[14046],{"type":18,"tag":622,"props":14047,"children":14048},{},[14049],{"type":18,"tag":614,"props":14050,"children":14051},{"__ignoreMap":8},[14052,14086,14128,14169,14210],{"type":18,"tag":629,"props":14053,"children":14054},{"class":631,"line":632},[14055,14060,14064,14069,14073,14077,14081],{"type":18,"tag":629,"props":14056,"children":14057},{"class":642},[14058],{"type":24,"value":14059},"  constraints ",{"type":18,"tag":629,"props":14061,"children":14062},{"class":636},[14063],{"type":24,"value":7527},{"type":18,"tag":629,"props":14065,"children":14066},{"class":642},[14067],{"type":24,"value":14068}," [x[:, ",{"type":18,"tag":629,"props":14070,"children":14071},{"class":686},[14072],{"type":24,"value":882},{"type":18,"tag":629,"props":14074,"children":14075},{"class":642},[14076],{"type":24,"value":2926},{"type":18,"tag":629,"props":14078,"children":14079},{"class":636},[14080],{"type":24,"value":12008},{"type":18,"tag":629,"props":14082,"children":14083},{"class":642},[14084],{"type":24,"value":14085}," x0]\n",{"type":18,"tag":629,"props":14087,"children":14088},{"class":631,"line":659},[14089,14093,14097,14102,14106,14111,14115,14119,14124],{"type":18,"tag":629,"props":14090,"children":14091},{"class":642},[14092],{"type":24,"value":14059},{"type":18,"tag":629,"props":14094,"children":14095},{"class":636},[14096],{"type":24,"value":7527},{"type":18,"tag":629,"props":14098,"children":14099},{"class":642},[14100],{"type":24,"value":14101}," [x[",{"type":18,"tag":629,"props":14103,"children":14104},{"class":686},[14105],{"type":24,"value":1368},{"type":18,"tag":629,"props":14107,"children":14108},{"class":642},[14109],{"type":24,"value":14110},", :] ",{"type":18,"tag":629,"props":14112,"children":14113},{"class":636},[14114],{"type":24,"value":13977},{"type":18,"tag":629,"props":14116,"children":14117},{"class":642},[14118],{"type":24,"value":645},{"type":18,"tag":629,"props":14120,"children":14121},{"class":686},[14122],{"type":24,"value":14123},"MAX_SPEED",{"type":18,"tag":629,"props":14125,"children":14126},{"class":642},[14127],{"type":24,"value":887},{"type":18,"tag":629,"props":14129,"children":14130},{"class":631,"line":668},[14131,14135,14139,14143,14147,14151,14156,14160,14165],{"type":18,"tag":629,"props":14132,"children":14133},{"class":642},[14134],{"type":24,"value":14059},{"type":18,"tag":629,"props":14136,"children":14137},{"class":636},[14138],{"type":24,"value":7527},{"type":18,"tag":629,"props":14140,"children":14141},{"class":642},[14142],{"type":24,"value":14101},{"type":18,"tag":629,"props":14144,"children":14145},{"class":686},[14146],{"type":24,"value":1368},{"type":18,"tag":629,"props":14148,"children":14149},{"class":642},[14150],{"type":24,"value":14110},{"type":18,"tag":629,"props":14152,"children":14153},{"class":636},[14154],{"type":24,"value":14155},">=",{"type":18,"tag":629,"props":14157,"children":14158},{"class":642},[14159],{"type":24,"value":645},{"type":18,"tag":629,"props":14161,"children":14162},{"class":686},[14163],{"type":24,"value":14164},"MIN_SPEED",{"type":18,"tag":629,"props":14166,"children":14167},{"class":642},[14168],{"type":24,"value":887},{"type":18,"tag":629,"props":14170,"children":14171},{"class":631,"line":697},[14172,14176,14180,14184,14188,14193,14197,14201,14206],{"type":18,"tag":629,"props":14173,"children":14174},{"class":642},[14175],{"type":24,"value":14059},{"type":18,"tag":629,"props":14177,"children":14178},{"class":636},[14179],{"type":24,"value":7527},{"type":18,"tag":629,"props":14181,"children":14182},{"class":642},[14183],{"type":24,"value":13929},{"type":18,"tag":629,"props":14185,"children":14186},{"class":686},[14187],{"type":24,"value":882},{"type":18,"tag":629,"props":14189,"children":14190},{"class":642},[14191],{"type":24,"value":14192},", :]) ",{"type":18,"tag":629,"props":14194,"children":14195},{"class":636},[14196],{"type":24,"value":13977},{"type":18,"tag":629,"props":14198,"children":14199},{"class":642},[14200],{"type":24,"value":645},{"type":18,"tag":629,"props":14202,"children":14203},{"class":686},[14204],{"type":24,"value":14205},"MAX_ACCEL",{"type":18,"tag":629,"props":14207,"children":14208},{"class":642},[14209],{"type":24,"value":887},{"type":18,"tag":629,"props":14211,"children":14212},{"class":631,"line":705},[14213,14217,14221,14225,14229,14233,14237,14241,14246],{"type":18,"tag":629,"props":14214,"children":14215},{"class":642},[14216],{"type":24,"value":14059},{"type":18,"tag":629,"props":14218,"children":14219},{"class":636},[14220],{"type":24,"value":7527},{"type":18,"tag":629,"props":14222,"children":14223},{"class":642},[14224],{"type":24,"value":13929},{"type":18,"tag":629,"props":14226,"children":14227},{"class":686},[14228],{"type":24,"value":992},{"type":18,"tag":629,"props":14230,"children":14231},{"class":642},[14232],{"type":24,"value":14192},{"type":18,"tag":629,"props":14234,"children":14235},{"class":636},[14236],{"type":24,"value":13977},{"type":18,"tag":629,"props":14238,"children":14239},{"class":642},[14240],{"type":24,"value":645},{"type":18,"tag":629,"props":14242,"children":14243},{"class":686},[14244],{"type":24,"value":14245},"MAX_STEER",{"type":18,"tag":629,"props":14247,"children":14248},{"class":642},[14249],{"type":24,"value":2612},{"type":18,"tag":27,"props":14251,"children":14252},{},[14253],{"type":24,"value":14254},"Finally, we define the optimizer for our system by",{"type":18,"tag":614,"props":14256,"children":14259},{"className":14257,"code":14258,"language":619,"meta":8},[617],"prob = cvxpy.Problem(cvxpy.Minimize(cost), constraints)\nprob.solve(solver=cvxpy.ECOS, verbose=False)\n",[14260],{"type":18,"tag":622,"props":14261,"children":14262},{},[14263],{"type":18,"tag":614,"props":14264,"children":14265},{"__ignoreMap":8},[14266,14283],{"type":18,"tag":629,"props":14267,"children":14268},{"class":631,"line":632},[14269,14274,14278],{"type":18,"tag":629,"props":14270,"children":14271},{"class":642},[14272],{"type":24,"value":14273},"prob ",{"type":18,"tag":629,"props":14275,"children":14276},{"class":636},[14277],{"type":24,"value":726},{"type":18,"tag":629,"props":14279,"children":14280},{"class":642},[14281],{"type":24,"value":14282}," cvxpy.Problem(cvxpy.Minimize(cost), constraints)\n",{"type":18,"tag":629,"props":14284,"children":14285},{"class":631,"line":659},[14286,14291,14296,14300,14305,14310,14314,14319,14323,14328],{"type":18,"tag":629,"props":14287,"children":14288},{"class":642},[14289],{"type":24,"value":14290},"prob.solve(",{"type":18,"tag":629,"props":14292,"children":14293},{"class":5354},[14294],{"type":24,"value":14295},"solver",{"type":18,"tag":629,"props":14297,"children":14298},{"class":636},[14299],{"type":24,"value":726},{"type":18,"tag":629,"props":14301,"children":14302},{"class":642},[14303],{"type":24,"value":14304},"cvxpy.",{"type":18,"tag":629,"props":14306,"children":14307},{"class":686},[14308],{"type":24,"value":14309},"ECOS",{"type":18,"tag":629,"props":14311,"children":14312},{"class":642},[14313],{"type":24,"value":2432},{"type":18,"tag":629,"props":14315,"children":14316},{"class":5354},[14317],{"type":24,"value":14318},"verbose",{"type":18,"tag":629,"props":14320,"children":14321},{"class":636},[14322],{"type":24,"value":726},{"type":18,"tag":629,"props":14324,"children":14325},{"class":686},[14326],{"type":24,"value":14327},"False",{"type":18,"tag":629,"props":14329,"children":14330},{"class":642},[14331],{"type":24,"value":12210},{"type":18,"tag":27,"props":14333,"children":14334},{},[14335,14337],{"type":24,"value":14336},"For more detail about using CVXPY, here is the link ",{"type":18,"tag":6367,"props":14338,"children":14341},{"href":14339,"rel":14340},"https://www.cvxpy.org",[6371],[14342],{"type":24,"value":14343},"CVXPY",{"type":18,"tag":19,"props":14345,"children":14346},{"id":6377},[14347],{"type":24,"value":10394},{"type":18,"tag":27,"props":14349,"children":14350},{},[14351],{"type":24,"value":14352},"In my opinion, I think MPC is suitable for the control system, since it can provide the significant control input that was predicted over the finite future of time. This can ensure the safety of the system and also can provide a quick look or reaction to the control action of the system too. Next post, I will explain about Nonlinear Model Predictive Control by using Casadi framework for mathematical optimization.",{"type":18,"tag":19,"props":14354,"children":14355},{"id":10402},[14356],{"type":24,"value":10405},{"type":18,"tag":280,"props":14358,"children":14359},{},[14360,14365,14370],{"type":18,"tag":80,"props":14361,"children":14362},{},[14363],{"type":24,"value":14364},"PythonRobotics: https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathTracking/model_predictive_speed_and_steer_control",{"type":18,"tag":80,"props":14366,"children":14367},{},[14368],{"type":24,"value":14369},"Implementation of Linear Model Predictive Control: https://arxiv.org/abs/2109.11986",{"type":18,"tag":80,"props":14371,"children":14372},{},[14373],{"type":24,"value":14374},"CVXPY: https://www.cvxpy.org/",{"type":18,"tag":6446,"children":14376},[14377],{"type":24,"value":14378},".ct-806137{color:#B392F0;}\n.ct-767297{color:#E1E4E8;}\n.ct-244866{color:#9ECBFF;}\n.ct-857441{color:#F97583;}\n.ct-533739{color:#79B8FF;}\n.ct-657843{color:#FFAB70;}",{"title":8,"searchDepth":659,"depth":659,"links":14380},[14381,14382,14383,14384,14385,14386,14387,14388],{"id":35,"depth":659,"text":38},{"id":10482,"depth":659,"text":10485},{"id":12955,"depth":659,"text":12999},{"id":10493,"depth":659,"text":10496},{"id":13069,"depth":659,"text":13072},{"id":13093,"depth":659,"text":13096},{"id":6377,"depth":659,"text":10394},{"id":10402,"depth":659,"text":10405},"content:topics:ai:linear-mpc.md","topics/ai/linear-mpc.md",1706842916072]