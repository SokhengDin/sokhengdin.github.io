[{"_path":"/topics/robotics/nonlinear-mpc","_dir":"robotics","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Nonlinear Model Predictive Control","description":"Introduction to Nonlinear Model Predictive Control","author":"Din Sokheng","slug":"nonlinear-mpc","tag":"nonlinear-mpc","img":"/topics/robotics/nmpc/predict_horizon.png","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"what-is-model-predictive-control"},"children":[{"type":"text","value":"What is Model Predictive Control ?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Model Predictive Control (MPC) is the optimal control method that use optimization algorithms to solve the cost function the occurs from the desired input and obtain back the optimal input control over the finite and infinite horizons. Recently, MPC is hyping up among the control system researcher, since it is fast, efficiency and robustness for any high complex system."}]},{"type":"element","tag":"div","props":{"className":["grid","grid-cols-2","space-x-10","justify-center","items-center"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"img","props":{"className":["mx-auto"],"src":"/topics/robotics/nmpc/predict_horizon.png","width":600,"height":300},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tag":"img","props":{"className":["mx-auto"],"src":"/topics/robotics/nmpc/set_points.png","width":600,"height":300},"children":[]}]},{"type":"element","tag":"figcaption","props":{"className":["text-center","text-sm","text-neutral-600","dark:text-neutral-400"]},"children":[{"type":"text","value":"\n  A car with finite horizons prediction and set point prediction over finite horizons.\n"}]},{"type":"element","tag":"h2","props":{"id":"nonlinear-model-predictive-control"},"children":[{"type":"text","value":"Nonlinear Model Predictive Control ?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nonlinear Model Predictive Control has the same basic core of its control algorithms. The different is about the mathematical solving over the system. "},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nIn the real-life application, most of the system certainly nonlinear and it's more complex than linear model. Linear systems are mostly time-invariant, meaning that the response of the system input is time-independent. Nonlinear systems are time-varying meaning that the response of the system to any input is time-dependent."},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The system model can be represent as state-space model"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"$$ \\dot{X} = f(X,U) $$"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nonlinear Model Predictive Control also works by solving the quardratic cost subject to the nonlinear function over a future finite horizons. The quadractic cost can be define as"}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"J(x,u) = \\displaystyle\\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})","styles":"text-center"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Notation"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"X","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the state of the system. This shall be obtained from the optimiztion problem."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"X_{ref}","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the reference state of the system or desired input state."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"U","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the input control of the system. This is a solution obtained from the optimization problem."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"U_{ref}","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the reference control of the system or desired input control."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Rewrite the optimization of NMPC problem."}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\begin{align*}\n            \\min_{u_{0}, u_{1}, ..., u_{N-1} } \\quad \\sum_{k=0}^{N-1}(X_{k, ref}-X_{k})^{T}&Q(X_{k, ref}-X_{k})+(U_{k,ref}-U_{k})^{T}R(U_{k,ref}-U_{k}) + \\phi(X_{N})\\\\\n            \\text{subject to} \\quad & x_{k+1} = f(x_k, u_k) \\quad \\text{(System dynamics)} \\\\\n            & g(x_k, x_k) \\leq 0 \\quad \\text{(State constraints)} \\\\\n            & h(x_k, x_k) \\leq 0 \\quad \\text{(Input constraints)} \\\\\n            & p(x_k) \\leq 0 \\quad \\text{(Path constraints)} \\\\\n            & x_0=x(0)  \\quad \\text{(Initial condition)}\n      \\end{align*}\n            ","styles":"text-center"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Which,"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"f","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the system dynamics model."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"g","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the state constraints of the system."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"h","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the input constraints of the system."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"p","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the path constraint, it help to ensure the safety following path of our system."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"\\phi(X_{N})","styles":"inline-flex","dist-cond":"false"},"children":[]},{"type":"text","value":" is the terminal cost of the system."}]}]},{"type":"element","tag":"h2","props":{"id":"discretize-the-system-model-with-runge-kutta-4th-order"},"children":[{"type":"text","value":"Discretize the system model with Runge-Kutta 4th order"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I will choose a simple system mode robot "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":" DifferentialDrive "}]},{"type":"text","value":".\nThe forward kinematic equation"}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix}\n ","styles":"text-center"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"State constraints are the restriction imposed on the state variable of the system. It helps our optimizer not to obtain the solution that is outside the boundary region and also ensure the system to always perform the minimal action control in any critical condition."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We, then can do the approximation"}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n    \\begin{align*}\n        k_{1} &= f(x^{*}, u^{*}) \\\\\n        k_{2} &= f(x^{*}+k_{1}\\frac{dt}{2}, u^{*}) \\\\ \n        k_{3} &= f(x^{*}+k_{2}\\frac{dt}{2}, u^{*}) \\\\\n        k_{4} &= f(x^{*}+k_{3}dt, u^{*}) \\\\ \n        \\Rightarrow{x_{k+1} } &= x_{k} + (k_{1}+2k_{2}+2k_{3}+k_{4})\\frac{dt}{6}\n    \\end{align*}\n","styles":"text-center","dist-cond":"true"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's evaluate it with our model."}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\begin{align*}\n        k_{1} &= \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n        k_{2} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{3} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} \\\\\n        k_{4} &= \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix} \\\\\n    \\end{align*}\n      ","styles":"text-center"},"children":[]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\Rightarrow{x_{k+1} } = x_{k} + \\left( \\begin{bmatrix} v^{*}\\cos{(\\theta)} \\\\ v^{*}\\sin{(\\theta)} \\\\ \\omega^{*}  \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{1})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{1})} \\\\ \\omega^{*} \\end{bmatrix} + 2 \\times \\begin{bmatrix} v^{*}\\cos{(\\theta + \\frac{dt}{2} \\times k_{2})} \\\\ v^{*}\\sin{(\\theta+ \\frac{dt}{2}\\times k_{2})} \\\\ \\omega^{*} \\end{bmatrix} + \\begin{bmatrix} v^{*}\\cos{(\\theta + dt \\times k_{3})} \\\\ v^{*}\\sin{(\\theta+ dt\\times k_{3})} \\\\ \\omega^{*}  \\end{bmatrix}   \\right) \\frac{dt}{6}\n","styles":"text-center"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"How to implement it in Python ???"}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"import numpy as np\n\n## Define sampling time dt 100Hz\ndt = 0.01\n## Define the num steps for function approximation \nnum_steps = 100\n## Define initial states\nx = 0.0\ny = 0.0\nyaw = 0.0\n## Define input control\nv = 1.5 #m/s\nomega = 1.57 #rad/s\n## Define state represent model\n### define lambda function take variable x\nf = lambda x, u :  np.array([\n      [u[0]*np.cos(x[2])],\n      [u[0]*np.sin(x[2])],\n      [u[1]]\n])\n\nfor _ in range(num_steps):\n    k1 = f([x, y, yaw], [v, omega])\n    k2 = f([x + (dt / 2) * k1[0], y + (dt / 2) * k1[1], yaw + (dt / 2) * k1[2]], [v, omega])\n    k3 = f([x + (dt / 2) * k2[0], y + (dt / 2) * k2[1], yaw + (dt / 2) * k2[2]], [v, omega])\n    k4 = f([x + dt * k3[0], y + dt * k3[1], yaw + dt * k3[2]], [v, omega])\n\n    # Update state of the robot\n    x += (k1[0] + 2 * k2[0] + 2 * k3[0] + k4[0]) * dt / 6\n    y += (k1[1] + 2 * k2[1] + 2 * k3[1] + k4[1]) * dt / 6\n    yaw += (k1[2] + 2 * k2[2] + 2 * k3[2] + k4[2]) * dt / 6\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" numpy "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" np\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## Define sampling time dt 100Hz\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0.01\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## Define the num steps for function approximation \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"num_steps "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"100\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## Define initial states\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0.0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"y "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0.0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"yaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0.0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## Define input control\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"v "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1.5"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"#m/s\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"omega "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1.57"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"#rad/s\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## Define state represent model\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"### define lambda function take variable x\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"f "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"lambda"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" x, u :  np.array([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"      [u["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"np.cos(x["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"])],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"      [u["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"np.sin(x["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"])],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"      [u["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" _ "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"(num_steps):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    k1 "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" f([x, y, yaw], [v, omega])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    k2 "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" f([x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k1["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"], y "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k1["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"], yaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k1["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]], [v, omega])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    k3 "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" f([x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k2["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"], y "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k2["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"], yaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k2["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]], [v, omega])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    k4 "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" f([x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k3["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"], y "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k3["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"], yaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k3["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]], [v, omega])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"# Update state of the robot\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (k1["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k2["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k3["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k4["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]) "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"6\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    y "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (k1["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k2["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k3["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k4["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]) "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"6\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    yaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (k1["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k2["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k3["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" k4["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]) "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"6"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"single-shooting-method"},"children":[{"type":"text","value":"Single Shooting Method"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Single Shooting Method is a method that we transform the optimal control problem to the nonlinear programming problem with just one decision variable."}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}\\right]\n        \\end{align*}\n","styles":"text-center"},"children":[]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\begin{align*}\n            x_{u} &= F(w,x_{0},t_{k}) \\\\\n            F(w,x_{0},t_{0}) &= x_{0} \\\\\n        \\end{align*}\n","styles":"text-center"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then solve the NLP"}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\begin{align*}\n            \\min_{w}\\Phi(F(w,x_{0},t_{k}), w) \\\\ \n            \\text{Subject to} \\hspace{1cm}  g_{1}(F(w,x_{0},t_{k}),w) \\leq{0}\n        \\end{align*}\n","styles":"text-center"},"children":[]},{"type":"element","tag":"h2","props":{"id":"multiple-shooting-method"},"children":[{"type":"text","value":"Multiple Shooting Method"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Multiple Shooting Method is a method that consist of transforming of optimal control problem to the nonlinear programming problem with multiple decision variables."}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\begin{align*}\n            \\text{Problem Decision Variable} \\\\\n            w = \\left [ u_{0}, ..., u_{N-1}, x_{0}, ..., x_{N}\\right]\n        \\end{align*}\n","styles":"text-center"},"children":[]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"X","styles":"inline-flex"},"children":[]},{"type":"text","value":" becoming decision variable in the opimization problem as well as u"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"We apply path constraint at each iteration step"}]}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\begin{equation*}\n                x_{k+1}-f(x_{k},u_{k}) = 0\n            \\end{equation*}\n","styles":"text-center"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then solve the NLP"}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n      \\begin{align*}\n            \\min_{w}  \\Phi(F(w,x_{0},t_{k}),& w) \\\\ \n            \\text{s.t}\\hspace{0.5cm}  g_{1}(F(w,x_{0},t_{k}),w) &\\leq{0} \\\\ \n                               g_{2}(w) = \\begin{bmatrix}\n                                  \\bar{x}_{0}-x_{0} \\\\\n                                  f(x_{0},u_{0})-x_{1} \\\\ \n                                  \\vdots \\\\\n                                  f(x_{N-1}, u_{N-1}-x_{N})\n                              \\end{bmatrix} &= 0\n        \\end{align*}\n","styles":"text-center"},"children":[]},{"type":"element","tag":"h2","props":{"id":"full-implement-in-python"},"children":[{"type":"text","value":"Full Implement in Python"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We will use "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Casadi"}]},{"type":"text","value":" as a numerical optimization framework."}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"import casadi as ca\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" casadi "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Define state representation and input control of our nonlinear model."}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"# Symbolic Variables\n## States\nx = ca.SX.sym(\"x\")\ny = ca.SX.sym(\"y\")\ntheta = ca.SX.sym(\"theta\")\nstates = ca.vertcat(x, y, theta)\nnum_states = states.numel()\n\n## Control\nu1 = ca.SX.sym(\"u1\")\nu2 = ca.SX.sym(\"u2\")\ncontrols = ca.vertcat(u1, u2)\nnum_controls = controls.numel()\n\n# Define Nonlinear model\n## Rotation Matrix\nrot_mat = ca.vertcat(\n    ca.horzcat(ca.cos(theta), ca.sin(theta), 0),\n    ca.horzcat(-ca.sin(theta), ca.cos(theta), 0),\n    ca.horzcat(0, 0, 1)\n)\n\nvx = u1 * ca.cos(theta)\nvy = u1 * ca.sin(theta)\nvyaw = u2\n\nrhs = ca.vertcat(vx, vy, vyaw)\n## Define mapped nonlinear function f(x,u) -> rhs\nf = ca.Function('f', [states, controls], [rhs])\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"# Symbolic Variables\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## States\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"x\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"y "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"y\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"theta "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"theta\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.vertcat(x, y, theta)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" states.numel()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## Control\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"u1 "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"u1\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"u2 "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"u2\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"controls "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.vertcat(u1, u2)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"num_controls "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" controls.numel()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"# Define Nonlinear model\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## Rotation Matrix\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"rot_mat "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.vertcat(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    ca.horzcat(ca.cos(theta), ca.sin(theta), "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    ca.horzcat("}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"ca.sin(theta), ca.cos(theta), "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    ca.horzcat("}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"vx "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" u1 "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.cos(theta)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"vy "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" u1 "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.sin(theta)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"vyaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" u2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"rhs "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.vertcat(vx, vy, vyaw)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"## Define mapped nonlinear function f(x,u) -> rhs\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"f "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.Function("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'f'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", [states, controls], [rhs])"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Declare symbolic matrix"}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"X = ca.SX.sym('X', num_states, prediction_horizons + 1)\nX_ref = ca.SX.sym('X_ref', num_states, prediction_horizons + 1)\nU = ca.SX.sym('U', num_controls, prediction_horizons)\nU_ref = ca.SX.sym('U_ref', num_controls, prediction_horizons)\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"X "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'X'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", num_states, prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"X_ref "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'X_ref'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", num_states, prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"U "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'U'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", num_controls, prediction_horizons)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"U_ref "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"SX"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".sym("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'U_ref'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", num_controls, prediction_horizons)"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Define nonlinear programming and options for "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Casadi"}]}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"nlp_prob = {\n    'f': cost_fn,\n    'x': opt_var,\n    'p': opt_dec,\n    'g': g\n}\n\nnlp_opts = {\n    'ipopt.max_iter': 5000,\n    'ipopt.print_level': 0,\n    'ipopt.acceptable_tol': 1e-6,\n    'ipopt.acceptable_obj_change_tol': 1e-4,\n    'print_time': 0\n}\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"nlp_prob "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'f'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": cost_fn,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'x'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": opt_var,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'p'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": opt_dec,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'g'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": g\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"nlp_opts "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'ipopt.max_iter'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"5000"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'ipopt.print_level'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'ipopt.acceptable_tol'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1e-6"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'ipopt.acceptable_obj_change_tol'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1e-4"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'print_time'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Determine boundary and constraint for our optimizer"}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"lbx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\nubx = ca.DM.zeros((num_states * (prediction_horizons + 1) + num_controls * prediction_horizons, 1))\n\nlbx[0: num_states * (prediction_horizons + 1): num_states] = x_min\nlbx[1: num_states * (prediction_horizons + 1): num_states] = y_min\nlbx[2: num_states * (prediction_horizons + 1): num_states] = theta_min\n\nubx[0: num_states * (prediction_horizons + 1): num_states] = x_max\nubx[1: num_states * (prediction_horizons + 1): num_states] = y_max\nubx[2: num_states * (prediction_horizons + 1): num_states] = theta_max\n\nlbx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\nlbx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_min\n\nubx[num_states * (prediction_horizons + 1): num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\nubx[num_states * (prediction_horizons + 1) + 1: num_states * (prediction_horizons + 1) + num_controls * prediction_horizons: num_controls] = u_max\n\nargs = {\n    'lbg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'ubg': ca.DM.zeros((num_states * (prediction_horizons + 1), 1)),\n    'lbx': lbx,\n    'ubx': ubx\n}\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"lbx "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"DM"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".zeros((num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" num_controls "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" prediction_horizons, "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"ubx "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"DM"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".zeros((num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" num_controls "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" prediction_horizons, "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"lbx["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"): num_states] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" x_min\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"lbx["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"): num_states] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" y_min\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"lbx["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"): num_states] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" theta_min\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"ubx["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"): num_states] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" x_max\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"ubx["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"): num_states] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" y_max\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"ubx["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"): num_states] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" theta_max\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"lbx[num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"): num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" num_controls "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" prediction_horizons: num_controls] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" u_min\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"lbx[num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" num_controls "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" prediction_horizons: num_controls] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" u_min\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"ubx[num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"): num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" num_controls "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" prediction_horizons: num_controls] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" u_max\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"ubx[num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" num_controls "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" prediction_horizons: num_controls] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" u_max\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"args "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'lbg'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"DM"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".zeros((num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"), "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'ubg'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": ca."}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"DM"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".zeros((num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"), "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'lbx'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": lbx,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'ubx'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":": ubx\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Obtain the solution from the solver at each iteration"}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"sol = solver(\n            x0=args['x0'],\n            p=args['p'],\n            lbx=args['lbx'],\n            ubx=args['ubx'],\n            lbg=args['lbg'],\n            ubg=args['ubg'],\n        )\n\n        sol_x = ca.reshape(sol['x'][:num_states * (prediction_horizons + 1)], 3, prediction_horizons + 1)\n        sol_u = ca.reshape(sol['x'][num_states * (prediction_horizons + 1):], 2, prediction_horizons)\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"sol "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" solver(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"x0"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"args["}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'x0'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"p"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"args["}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'p'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"lbx"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"args["}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'lbx'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"ubx"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"args["}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'ubx'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"lbg"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"args["}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'lbg'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"ubg"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"args["}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'ubg'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        )\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        sol_x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.reshape(sol["}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'x'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"][:num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")], "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"3"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        sol_u "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ca.reshape(sol["}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'x'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"][num_states "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (prediction_horizons "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"):], "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", prediction_horizons)"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"result"},"children":[{"type":"text","value":"Result"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I use MPC to control the differential drive robot to move from it zero position the the desired postion that I want to follow !.\nI generate a circle trajectory and I fit this curve into my beautiful and robustness cost and then volia !!!."}]},{"type":"element","tag":"figure","props":{"className":["mb-4","inline-block","max-w-sm"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"img","props":{"className":["mx-auto"],"src":"/topics/robotics/nmpc/diff_mpc.png","width":600,"height":300},"children":[]}]},{"type":"element","tag":"figcaption","props":{"className":["text-center","text-sm","text-neutral-600","dark:text-neutral-400"]},"children":[{"type":"text","value":"\n    Plot of differential drive robot follow the circle trajectory !!!.\n"}]},{"type":"element","tag":"h2","props":{"id":"in-conclusion"},"children":[{"type":"text","value":"In conclusion"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In my opinion, I think MPC is suitable for the control system, since it can provide the significant control input that was predicted over the finite future of time. This can ensure the safety of the system and also can provide a quick look or reaction to the control action of the system too."}]},{"type":"element","tag":"h2","props":{"id":"reference"},"children":[{"type":"text","value":"Reference"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"MPC-and-MHE-implementation-in-MATLAB-using-Casadi: https://github.com/MMehrez/MPC-and-MHE-implementation-in-MATLAB-using-Casadi"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CasAdi: https://web.casadi.org"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"PathTracking: https://github.com/SokhengDin/PathTracking"}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-326375{color:#6A737D;}\n.ct-533739{color:#79B8FF;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"what-is-model-predictive-control","depth":2,"text":"What is Model Predictive Control ?"},{"id":"nonlinear-model-predictive-control","depth":2,"text":"Nonlinear Model Predictive Control ?"},{"id":"discretize-the-system-model-with-runge-kutta-4th-order","depth":2,"text":"Discretize the system model with Runge-Kutta 4th order"},{"id":"single-shooting-method","depth":2,"text":"Single Shooting Method"},{"id":"multiple-shooting-method","depth":2,"text":"Multiple Shooting Method"},{"id":"full-implement-in-python","depth":2,"text":"Full Implement in Python"},{"id":"result","depth":2,"text":"Result"},{"id":"in-conclusion","depth":2,"text":"In conclusion"},{"id":"reference","depth":2,"text":"Reference"}]}},"_type":"markdown","_id":"content:topics:robotics:nonlinear-mpc.md","_source":"content","_file":"topics/robotics/nonlinear-mpc.md","_extension":"md"},{"_path":"/topics/robotics/pid-controller","_dir":"robotics","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Introduction to PID Controller in Python","description":"PID Control is a feedback control","author":"DIN SOKHENG","slug":"pid","tag":"pid","img":"/topics/robotics/nmpc/PID.png","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"what-is-pid-controller"},"children":[{"type":"text","value":"What is PID Controller ?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Proportional Integral Derivative (PID) controller is a traditional method in control systems that has found widespread use in control system engineering and industrial applications since its emergence in the 1940s. A PID controller is considered a feedback controller, aiming to minimize the error between the system's feedback and the desired setpoint by manually or automatically fine-tuning the coefficients "},{"type":"element","tag":"math-render","props":{"latex-express":"K_{P}, K_{I}, K_{D}","styles":"inline-flex"},"children":[]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"how-it-works"},"children":[{"type":"text","value":"How it works ?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Imagine you want to control the speed of a DC motor to reach 300 RPM, but due to the natural response of the DC motor, it cannot reach the desired angular speed. PID offers a solution to this natural response by adjusting the system's time response using its three components, as shown in the formula below."}]},{"type":"element","tag":"h2","props":{"id":"formulation"},"children":[{"type":"text","value":"Formulation"}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"u(t) = K_{p}e(t) + K_{I} \\int_{0}^{t} e(t) dt + K_{D} \\frac{d e(t)}{dt} ","styles":"text-center"},"children":[]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"K_{P}","styles":"inline-flex"},"children":[]},{"type":"text","value":" represents the proportional gain."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"K_{I}","styles":"inline-flex"},"children":[]},{"type":"text","value":" represents the integral gain."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"K_{D}","styles":"inline-flex"},"children":[]},{"type":"text","value":" represents the derivative gain."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"math-render","props":{"latex-express":"e(t)=target-feedback","styles":"inline-flex"},"children":[]},{"type":"text","value":" is the error between target point and feedback of the system"}]}]},{"type":"element","tag":"figure","props":{"className":["mb-4","inline-block","max-w-sm"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"img","props":{"className":["mx-auto"],"src":"/topics/robotics/nmpc/PID.png"},"children":[]}]},{"type":"element","tag":"figcaption","props":{"className":["text-center","text-sm","text-neutral-600","dark:text-neutral-400"]},"children":[{"type":"text","value":"\n    The Block diagram of PID Controller\n"}]},{"type":"element","tag":"h2","props":{"id":"response-time"},"children":[{"type":"text","value":"Response Time"}]},{"type":"element","tag":"figure","props":{"className":["mb-4","inline-block","max-w-sm"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"img","props":{"className":["mx-auto"],"src":"/topics/robotics/nmpc/response_timepid.png"},"children":[]}]},{"type":"element","tag":"figcaption","props":{"className":["text-center","text-sm","text-neutral-600","dark:text-neutral-400"]},"children":[{"type":"text","value":"\n    The response time of the system with each K_P, K_I, K_D\n"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As you can see in the figure above, the response time of the system is difference."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The response time with "},{"type":"element","tag":"math-render","props":{"latex-express":"K_{I}=2","styles":"inline-flex"},"children":[]},{"type":"text","value":" the system is likely to overshoot before reaching the steady-state, which may not be suitable for applications like controlling a DC motor."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The response time with "},{"type":"element","tag":"math-render","props":{"latex-express":"K_{i}=0.5, ","styles":"inline-flex"},"children":[]},{"type":"text","value":"  the response does not overshoot but has a slower response to reach the steady-state."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The response time with "},{"type":"element","tag":"math-render","props":{"latex-express":"K_{p}=1, K_{i}=1, K_{d}=1","styles":"inline-flex"},"children":[]},{"type":"text","value":"  there is a slight overshoot, but the steady-state is reached faster."}]}]},{"type":"element","tag":"h2","props":{"id":"how-can-we-write-pid-code-in-python"},"children":[{"type":"text","value":"How can we write PID code in Python ?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's use a differential drive robot as a case study system. A differential drive robot is commonly used in robotics and automation, making it an ideal choice for a demonstration."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The configuration of Differential Drive Robot in axes OXY."}]},{"type":"element","tag":"figure","props":{"className":["mb-4","inline-block","max-w-sm"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"img","props":{"className":["mx-auto"],"src":"/topics/robotics/nmpc/diff_drive.png"},"children":[]}]},{"type":"element","tag":"figcaption","props":{"className":["text-center","text-sm","text-neutral-600","dark:text-neutral-400"]},"children":[{"type":"text","value":"\n    The configuration of Differential Drive Robot in axes OXY.\n"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The forward kinematic equation"}]},{"type":"element","tag":"math-render-b","props":{"latex-express":"\n\\begin{bmatrix} v_{x} \\\\ v_{y} \\\\ v_{\\theta} \\end{bmatrix} = \\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{\\theta} \\\\ \\omega \\end{bmatrix}\n ","styles":"text-center"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"So, if we discretize the forward kinematic with a certain sampling time, we will get"}]},{"type":"element","tag":"math-render","props":{"latex-express":"\n\\begin{bmatrix} x_{t+1} \\\\ y_{t+1} \\\\ \\theta_{t+1} \\end{bmatrix} = \\begin{bmatrix} x_{t} \\\\ y_{t} \\\\ \\theta_{t} \\end{bmatrix} +\\begin{bmatrix} v\\sin{(\\theta)} \\\\ v\\cos{(\\theta)} \\\\ \\omega \\end{bmatrix} \\times \\Delta t\n ","styles":"text-center"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In Python,"}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"class DifferentialDrive:\n    def __init__(self):\n        self.r = 0.05\n        self.L = 0.25\n    def forward_kinematic(self, v, omega, yaw):\n        vx = v*np.cos(yaw)\n        vy = v*np.sin(yaw)\n        vyaw = omega\n\n        return vx, vy, vyaw\n    def discrete_state(self, x, y, yaw, v, omega, dt):\n        dx, dy, dyaw = self.forward_kinematic(v, omega, yaw)\n        x_next = x + dx * dt\n        y_next = y + dy * dt\n        yaw_next = yaw + dyaw * dt\n\n        return x_next, y_next, yaw_next\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-806137"},"children":[{"type":"text","value":"DifferentialDrive"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"__init__"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"(self):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".r "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0.05\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".L "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0.25\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-806137"},"children":[{"type":"text","value":"forward_kinematic"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"(self, v, omega, yaw):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        vx "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" v"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"np.cos(yaw)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        vy "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" v"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"np.sin(yaw)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        vyaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" omega\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" vx, vy, vyaw\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-806137"},"children":[{"type":"text","value":"discrete_state"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"(self, x, y, yaw, v, omega, dt):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        dx, dy, dyaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".forward_kinematic(v, omega, yaw)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        x_next "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dx "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        y_next "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" y "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dy "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        yaw_next "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" yaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dyaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" x_next, y_next, yaw_next"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":" DifferentialDrive "}]},{"type":"text","value":" class that we defined, has all the need attribute to use for PID control !!. We just need to write another class for our "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":" PID Controller "}]},{"type":"text","value":"."}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"class PIDController:\n    def __init__(self, kp, ki, kd, dt):\n\n        self.kp = kp\n        self.ki = ki\n        self.kd = kd\n        self.dt = dt\n        self.integral = 0\n\n    def calculate_pid(self, errors):\n        # Calculate proportional error\n        proportional = self.kp * errors[-1]\n        # Calculate integration error\n        integral = self.integral + self.ki * (errors[-1]) * self.dt\n        self.integral = integral\n        # Calculate derivative error\n        derivative = self.kd * (errors[-1] - errors[-2])/self.dt\n\n        output = proportional + integral + derivative\n\n        return output\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-806137"},"children":[{"type":"text","value":"PIDController"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"__init__"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"(self, kp, ki, kd, dt):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".kp "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" kp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".ki "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" ki\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".kd "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" kd\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".dt "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" dt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".integral "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-806137"},"children":[{"type":"text","value":"calculate_pid"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"(self, errors):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"# Calculate proportional error\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        proportional "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".kp "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" errors["}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"# Calculate integration error\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        integral "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".integral "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".ki "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (errors["}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]) "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".dt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".integral "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" integral\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"# Calculate derivative error\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        derivative "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".kd "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" (errors["}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" errors["}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"])"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":".dt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        output "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" proportional "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" integral "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" derivative\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" output"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Don't worry, this class just defined as the PID formula. So, by doing this, we will be able to use all the characteristic of our PID controller."}]},{"type":"element","tag":"h2","props":{"id":"experiment"},"children":[{"type":"text","value":"Experiment"}]},{"type":"element","tag":"h3","props":{"id":"pid-for-point-control"},"children":[{"type":"text","value":"PID for point control"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If I want my DifferentialDrive robot go to point "},{"type":"element","tag":"math-render","props":{"latex-express":"x_{ref}, y_{ref}, \\theta_{ref}","styles":"inline-flex"},"children":[]},{"type":"text","value":", Then I can calculate the error between the reference point and the feedback position of the robot. I simulated my robot in the  "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"for loop"}]},{"type":"text","value":" and calculate this error recursively."}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"error_x.append(ref_path[0]-current_x)\nerror_y.append(ref_path[1]-current_y)\nerror_yaw.append(ref_path[2]-current_yaw)\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"error_x.append(ref_path["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"current_x)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"error_y.append(ref_path["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"current_y)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"error_yaw.append(ref_path["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"current_yaw)"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then, let's apply PID"}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"output_vx = pid_controller_x.calculate_pid(error_x)\noutput_vy = pid_controller_y.calculate_pid(error_y)\noutput_omega = pid_controller_yaw.calculate_pid(error_yaw)\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"output_vx "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" pid_controller_x.calculate_pid(error_x)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"output_vy "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" pid_controller_y.calculate_pid(error_y)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"output_omega "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" pid_controller_yaw.calculate_pid(error_yaw)"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We will also need to update current position of the robot with the given optimal value from the PID controller."}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"x_next, y_next, yaw_next = diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) # Skip for omega we only look for x, y\ncurrent_x = x_next\ncurrent_y = y_next\ncurrent_yaw = yaw_next\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"x_next, y_next, yaw_next "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" diff_drive.discrete_state(current_x, current_y, current_yaw, v_pid, omega_pid, sampling_time) "}]},{"type":"element","tag":"span","props":{"class":"ct-326375"},"children":[{"type":"text","value":"# Skip for omega we only look for x, y\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"current_x "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" x_next\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"current_y "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" y_next\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"current_yaw "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" yaw_next"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I use "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"matplotlib"}]},{"type":"text","value":" library to simulate my robot."}]},{"type":"element","tag":"code","props":{"className":["language-python"],"code":"plt.clf()\nplt.gcf().canvas.mpl_connect('key_release_event',\n            lambda event: [exit(0) if event.key == 'escape' else None])\nplot_arrow(current_x, current_y, current_yaw)\nplt.plot(5, 5)\nplt.plot(ref_path[0], ref_path[1], marker=\"x\", color=\"blue\", label=\"Input Trajectory\")\nplt.axis(\"equal\")\nplt.grid(True)\nplt.legend()\nplt.pause(0.0001)\n","language":"python","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plt.clf()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plt.gcf().canvas.mpl_connect("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'key_release_event'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"lambda"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" event: ["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"exit"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" event.key "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"'escape'"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"else"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plot_arrow(current_x, current_y, current_yaw)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plt.plot("}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plt.plot(ref_path["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"], ref_path["}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"], "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"marker"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"x\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"color"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"blue\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-657843"},"children":[{"type":"text","value":"label"}]},{"type":"element","tag":"span","props":{"class":"ct-857441"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"Input Trajectory\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plt.axis("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"equal\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plt.grid("}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"True"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plt.legend()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"plt.pause("}]},{"type":"element","tag":"span","props":{"class":"ct-533739"},"children":[{"type":"text","value":"0.0001"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"path-tracking"},"children":[{"type":"text","value":"Path Tracking"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The code is all way the same. The different is that, I fit the continuous point into the robot instead of fixed goal point. I use "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"BeizerCurve"}]},{"type":"text","value":" function to generate "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":" Spline Trajectory "}]},{"type":"text","value":" for the robot."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The full code is published open-source on my Github. Link here "},{"type":"element","tag":"a","props":{"href":"https://github.com/SokhengDin/PathTracking/tree/main/PID","rel":["nofollow"]},"children":[{"type":"text","value":"Github"}]},{"type":"text","value":". Hit the star for me if you like my work 🙂."}]},{"type":"element","tag":"h3","props":{"id":"result"},"children":[{"type":"text","value":"Result"}]},{"type":"element","tag":"figure","props":{"className":["mb-4","inline-block","max-w-sm"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"img","props":{"className":["mx-auto"],"src":"/topics/robotics/nmpc/Figure_pid_p.png"},"children":[]}]},{"type":"element","tag":"figcaption","props":{"className":["text-center","text-sm","text-neutral-600","dark:text-neutral-400"]},"children":[{"type":"text","value":"\n    PID Controller with position control on Differential Drive Robot\n"}]},{"type":"element","tag":"figure","props":{"className":["mb-4","inline-block","max-w-sm"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"img","props":{"className":["mx-auto"],"src":"/topics/robotics/nmpc/Figure_pid_t.png"},"children":[]}]},{"type":"element","tag":"figcaption","props":{"className":["text-center","text-sm","text-neutral-600","dark:text-neutral-400"]},"children":[{"type":"text","value":"\n    PID Controller with path tracking control on Differential Drive Robot\n"}]},{"type":"element","tag":"h2","props":{"id":"in-conclusion"},"children":[{"type":"text","value":"In Conclusion"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In my opinion, the PID Controller is an excellent choice for most control system applications due to its simplicity and powerful capabilities in handling complex control challenges arising from various systems."}]},{"type":"element","tag":"h2","props":{"id":"references"},"children":[{"type":"text","value":"References"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"BeizerCurve: https://en.wikipedia.org/wiki/Bézier_curve."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"PID Controller: Control Systems Engineering by Normal S. Nise."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Beizer Path : https://github.com/AtsushiSakai/PythonRobotics/tree/master/PathPlanning/BezierPath"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"PID Lecture : https://www.cds.caltech.edu/~murray/courses/cds101/fa02/caltech/astrom-ch6.pdf"}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-857441{color:#F97583;}\n.ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-533739{color:#79B8FF;}\n.ct-326375{color:#6A737D;}\n.ct-244866{color:#9ECBFF;}\n.ct-657843{color:#FFAB70;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"what-is-pid-controller","depth":2,"text":"What is PID Controller ?"},{"id":"how-it-works","depth":2,"text":"How it works ?"},{"id":"formulation","depth":2,"text":"Formulation"},{"id":"response-time","depth":2,"text":"Response Time"},{"id":"how-can-we-write-pid-code-in-python","depth":2,"text":"How can we write PID code in Python ?"},{"id":"experiment","depth":2,"text":"Experiment","children":[{"id":"pid-for-point-control","depth":3,"text":"PID for point control"},{"id":"path-tracking","depth":3,"text":"Path Tracking"},{"id":"result","depth":3,"text":"Result"}]},{"id":"in-conclusion","depth":2,"text":"In Conclusion"},{"id":"references","depth":2,"text":"References"}]}},"_type":"markdown","_id":"content:topics:robotics:pid-controller.md","_source":"content","_file":"topics/robotics/pid-controller.md","_extension":"md"},{"_path":"/topics/robotics/pure-pursuit","_dir":"robotics","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Pure Pursuit Controller","description":"Introduction to Pure Pursuit Controller","slug":"pure-pursuit","tag":"pure-pursuit","img":"/topics/robotics/nmpc/pure_pursuit.png","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"pure-pursuit-controller"},"children":[{"type":"text","value":"Pure Pursuit Controller"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Pure Pursuit Controller"}]},{"type":"text","value":" is a widely-used path-tracking algorithm in robotics and autonomous vehicle navigation. Its primary objective is to guide a vehicle or robot along a predefined path while ensuring precise path-following."}]},{"type":"element","tag":"h3","props":{"id":"principle-of-operation"},"children":[{"type":"text","value":"Principle of Operation"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The operation of the Pure Pursuit Controller is based on a straightforward concept:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Path Definition"}]},{"type":"text","value":": The controller works with a defined path, often represented as a series of waypoints or a continuous curve, each associated with specific coordinates (x, y) and curvature information."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Target Point Selection"}]},{"type":"text","value":": The controller continuously selects a target point ahead of the vehicle. This target point is typically chosen as the point on the path that is a certain fixed distance (known as the \"lookahead distance\") in front of the vehicle."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Steering Command Calculation"}]},{"type":"text","value":": To navigate toward the target point, the controller calculates the steering command, often represented as the desired steering angle or curvature, required to reach the target point. Commonly, this involves computing the angle between the vehicle's current heading and the vector pointing from the current position to the target point."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Vehicle Control"}]},{"type":"text","value":": The calculated steering command is used to control the vehicle's steering mechanism (e.g., steering wheel or wheel angles) to guide it toward the target point."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Iterative Process"}]},{"type":"text","value":": The process is iterative, with the controller continuously selecting new target points ahead as the vehicle advances along the path and adjusting its steering to reach them."}]}]},{"type":"element","tag":"h3","props":{"id":"advantages"},"children":[{"type":"text","value":"Advantages"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Pure Pursuit Controller offers several advantages:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Simplicity"}]},{"type":"text","value":": It is conceptually simple and easy to implement, making it suitable for a wide range of robotic and vehicle navigation applications."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Path Tracking"}]},{"type":"text","value":": The controller excels at accurate path tracking, even in complex environments with curves and turns."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Real-Time Operation"}]},{"type":"text","value":": It can operate in real-time, making it well-suited for dynamic environments where quick decision-making is crucial."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Adaptability"}]},{"type":"text","value":": The controller can adapt to changes in the path, such as deviations caused by obstacles or unexpected conditions, by continuously updating the target point."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Low Computational Overhead"}]},{"type":"text","value":": Compared to some other control algorithms, the Pure Pursuit Controller often has low computational requirements, which is advantageous for resource-constrained systems."}]}]},{"type":"element","tag":"h3","props":{"id":"limitations"},"children":[{"type":"text","value":"Limitations"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Despite its advantages, the Pure Pursuit Controller has some limitations:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Lookahead Distance Sensitivity"}]},{"type":"text","value":": Its performance can be sensitive to the choice of the lookahead distance, which requires careful tuning for optimal path tracking."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Non-Holonomic Assumption"}]},{"type":"text","value":": The controller assumes that the vehicle is non-holonomic, meaning it cannot move sideways. This assumption may not hold for certain types of vehicles, such as omnidirectional robots."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In summary, the Pure Pursuit Controller is a straightforward yet effective algorithm for path tracking and navigation. Its ability to calculate a steering command based on a selected target point ahead of the vehicle makes it a valuable tool for applications ranging from autonomous cars to mobile robots."}]},{"type":"element","tag":"code","props":{"className":["language-js"],"code":"console.log(\"Hello world\")\n\n","language":"js","meta":""},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"console."}]},{"type":"element","tag":"span","props":{"class":"ct-806137"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-244866"},"children":[{"type":"text","value":"\"Hello world\""}]},{"type":"element","tag":"span","props":{"class":"ct-767297"},"children":[{"type":"text","value":")"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-767297{color:#E1E4E8;}\n.ct-806137{color:#B392F0;}\n.ct-244866{color:#9ECBFF;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"pure-pursuit-controller","depth":2,"text":"Pure Pursuit Controller","children":[{"id":"principle-of-operation","depth":3,"text":"Principle of Operation"},{"id":"advantages","depth":3,"text":"Advantages"},{"id":"limitations","depth":3,"text":"Limitations"}]}]}},"_type":"markdown","_id":"content:topics:robotics:pure-pursuit.md","_source":"content","_file":"topics/robotics/pure-pursuit.md","_extension":"md"},{"_path":"/topics/robotics/stanley-controller","_dir":"robotics","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Stanley Controller","description":"Introduction to Stanley Controller","slug":"stanley","tag":"stanley","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"stanley-controller"},"children":[{"type":"text","value":"Stanley Controller"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Stanley Controller"}]},{"type":"text","value":" is an advanced path-tracking algorithm primarily used in the field of autonomous vehicle navigation. It is named after its creator, Professor John K. Hedrick, who developed it at Stanford University. The Stanley Controller is designed to enable a vehicle to follow a predefined path with high accuracy and stability."}]},{"type":"element","tag":"h3","props":{"id":"principle-of-operation"},"children":[{"type":"text","value":"Principle of Operation"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Stanley Controller operates based on a combination of control and feedback mechanisms:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Path Definition"}]},{"type":"text","value":": A predefined path is represented as a series of waypoints or a continuous curve. Each waypoint is associated with specific coordinates (x, y) and often includes additional information like desired speed and curvature."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Cross-Track Error (CTE) Calculation"}]},{"type":"text","value":": The controller calculates the cross-track error, which is the perpendicular distance between the vehicle's current position and the desired path. This error represents how far the vehicle has deviated from the path."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Heading Error Calculation"}]},{"type":"text","value":": The heading error, which is the difference between the vehicle's current heading (yaw angle) and the desired path's tangent angle at the nearest waypoint, is also computed."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Control Command Generation"}]},{"type":"text","value":": Using the calculated cross-track error and heading error, the Stanley Controller generates control commands. These commands typically include steering angle adjustments and throttle/brake control to minimize both errors."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Vehicle Control"}]},{"type":"text","value":": The generated control commands are applied to the vehicle's steering and throttle/brake systems to guide it back to the desired path."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Iterative Feedback"}]},{"type":"text","value":": The process is iterative, with the controller continuously recalculating the cross-track and heading errors and adjusting the control commands to keep the vehicle on track."}]}]},{"type":"element","tag":"h3","props":{"id":"advantages"},"children":[{"type":"text","value":"Advantages"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Stanley Controller offers several advantages:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"High Accuracy"}]},{"type":"text","value":": It is known for its ability to achieve precise path-following, even in challenging conditions and complex road geometries."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Stability"}]},{"type":"text","value":": The controller's feedback mechanisms contribute to stable and smooth vehicle motion, reducing the risk of overshooting or oscillations."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Adaptability"}]},{"type":"text","value":": The Stanley Controller can adapt to changes in the path, such as deviations caused by obstacles or dynamic road conditions."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Real-Time Operation"}]},{"type":"text","value":": It can operate in real-time, making it suitable for autonomous vehicle navigation in dynamic environments."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Versatility"}]},{"type":"text","value":": While primarily used in autonomous vehicles, the Stanley Controller's principles can be applied to various path-tracking tasks."}]}]},{"type":"element","tag":"h3","props":{"id":"limitations"},"children":[{"type":"text","value":"Limitations"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Despite its advantages, the Stanley Controller has some limitations:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Complexity"}]},{"type":"text","value":": Implementing the Stanley Controller can be more complex than some other control algorithms due to its mathematical calculations and tuning requirements."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Initialization"}]},{"type":"text","value":": It relies on accurate initialization, including knowledge of the vehicle's initial position and heading relative to the path."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Sensitivity to Noise"}]},{"type":"text","value":": Like many feedback-based controllers, the Stanley Controller can be sensitive to noisy sensor data and require robust sensor fusion techniques."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In summary, the Stanley Controller is an advanced path-tracking algorithm known for its accuracy and stability, making it a valuable tool in the field of autonomous vehicle navigation. Proper implementation and tuning are essential to harness its full potential."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"stanley-controller","depth":2,"text":"Stanley Controller","children":[{"id":"principle-of-operation","depth":3,"text":"Principle of Operation"},{"id":"advantages","depth":3,"text":"Advantages"},{"id":"limitations","depth":3,"text":"Limitations"}]}]}},"_type":"markdown","_id":"content:topics:robotics:stanley-controller.md","_source":"content","_file":"topics/robotics/stanley-controller.md","_extension":"md"}]